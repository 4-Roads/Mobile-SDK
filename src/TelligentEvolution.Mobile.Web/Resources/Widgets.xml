<scriptedContentFragments>
  <scriptedContentFragment name="${resource:ActivityStory_Name}" version="7.0.0.1" description="" instanceIdentifier="6252ef55611d4b26955d695433396c27" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="activity-story">
    <contentScript>
		

#set ($activityId = $core_v2_utility.ParseGuid($mobile_v1_urlToken.Value('ActivityStoryId')))
#set ($story = $core_v2_activityStory.Get($activityId))

#set ($accessingUser = $core_v2_user.Accessing)
#set ($accessingUserIsRegistered = false)
#if ($core_v2_user.IsRegistered($accessingUser.Id))
	#set ($accessingUserIsRegistered = true)
#end

#set ($widgetUniqueStoryId = "${core_v2_widget.WrapperElementId}_story_${message.StoryId}")

#set ($primaryStoryUser = $story.PrimaryUser)

#set ($primaryStoryUserIsRegistered = false)
#set ($primaryStoryUserIsRegistered = $core_v2_user.IsRegistered($primaryStoryUser.Id))
#set ($primaryStoryUserIsAccessingUser = false)
#if ($accessingUser.Id == $primaryStoryUser.Id)
	#set ($primaryStoryUserIsAccessingUser = true)
#end

#set ($commentsSupported = false)
#set ($commentsSupported = $core_v2_comments.SupportsComments($story.ContentTypeId))

#set ($accessingUserCanComment = false)
#if ($commentsSupported)
	#set ($accessingUserCanComment = $core_v2_comments.CanCreateComment($story.ContentId, $story.ContentTypeId))
#end

#set ($widgetUniqueStoryId = "${core_v2_widget.WrapperElementId}_story_${story.StoryId}")
#set ($storyType = $story.StoryTypeId)

&lt;div class="post activity isolated"&gt;
	&lt;div class="avatar"&gt;
		#if ($primaryStoryUser.ProfileUrl)
			&lt;a href="$core_v2_encoding.HtmlAttributeEncode($primaryStoryUser.ProfileUrl)" class="internal-link view-user-profile"&gt;
				$core_v2_ui.GetResizedImageHtml($primaryStoryUser.AvatarUrl, 40, 40, "%{border='0', alt=$primaryStoryUser.DisplayName, ResizeMethod='ZoomAndCrop',border='0'}")
			&lt;/a&gt;
		#else
			$core_v2_ui.GetResizedImageHtml($primaryStoryUser.AvatarUrl, 40, 40, "%{border='0', alt=$primaryStoryUser.DisplayName, ResizeMethod='ZoomAndCrop',border='0'}")
		#end
	&lt;/div&gt;

	&lt;div class="date"&gt;$core_v2_language.FormatAgoDate($story.CreatedDate)&lt;/div&gt;
	&lt;div class="content"&gt;
		$mobile_v1_dataFormat.Detect($story.ViewHtml('Web'))
	&lt;/div&gt;

	&lt;div class="ui-links actions" data-maxlinks="1"&gt;
		#if ($accessingUserIsRegistered &amp;&amp; $core_v2_like.CanLike($story.ContentId, $story.ContentTypeId))
			&lt;li class="action-like-message"&gt;
				#set($format = '{toggle} &lt;span class="count"&gt;&lt;span class="icon"&gt;&lt;/span&gt;{count}&lt;/span&gt;')
				#set ($likeOptions = "%{ Format = $format }")
				#if ($story.TypeId)
					$likeOptions.Add('LikeTypeId', $story.TypeId)
				#end
				$core_v2_ui.Like($story.ContentId, $story.ContentTypeId, $likeOptions)
			&lt;/li&gt;
		#end

		#if($core_v2_activityStory.CanDelete($story.StoryId))
			&lt;li class="action-delete"&gt;&lt;a href="#" class="delete" data-storyid="$story.StoryId"&gt;$core_v2_language.GetResource('delete')&lt;/a&gt;&lt;/li&gt;
		#end
		&lt;li class="action-moderate"&gt;$core_v2_ui.Moderate($story.ContentId, $story.ContentTypeId)&lt;/li&gt;
		&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('Cancel')&lt;/a&gt;&lt;/li&gt;
	&lt;/div&gt;
&lt;/div&gt;
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;

&lt;script&gt;
var deleteContext = {
	confirm: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('deleteActivityMessage'))'
}
## Handle Delete clicks
jQuery('#$core_v2_widget.WrapperElementId a.delete').each(function(){
	var delLink = $(this);
	delLink.off('tap').on('tap', function(){
		jQuery.telligent.evolution.widgets.activityStory.del(delLink.data('storyid'), deleteContext);
	});
});
&lt;/script&gt;

#set($commentOptions = "%{ CanFlagAsAbusive = $accessingUserIsRegistered, AccessingUserId = $accessingUser.Id }")
#if ($story.TypeId)
	$commentOptions.Add('TypeId', $story.TypeId)
#end
$mobile_v1_ui.Comments($story.ContentId, $story.ContentTypeId, $commentOptions)

		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="ActivityStory_Name">Activity Story</resource>
		<resource name="deleteActivityMessage">Are you sure you want to delete this story?</resource>
		<resource name="deleteCommentMessage">Are you sure you want to delete this comment?</resource>
		<resource name="delete">Delete</resource>
		<resource name="comment">Comment</resource>
		<resource name="comments">Comments</resource>
		<resource name="Cancel">Cancel</resource>
	  </language>
	</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCg0KCQl9LA0KCQlkZWw6IGZ1bmN0aW9uKGlkLCBjb250ZXh0KSB7DQoJCQlpZihjb25maXJtKGNvbnRleHQuY29uZmlybSkpIHsNCgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNob3dMb2FkaW5nKCQudGVsbGlnZW50LmV2b2x1dGlvbi5kZWwoew0KCQkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi9zdG9yaWVzL3tTdG9yeUlkfS5qc29uJywNCgkJCQkJZGF0YTogeyBTdG9yeUlkOiBpZCB9LA0KCQkJCQljYWNoZTogZmFsc2UNCgkJCQl9KSkuZG9uZShmdW5jdGlvbigpew0KCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmJhY2sodHJ1ZSk7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuaGlkZVNoZWV0KCk7DQoJCQkJfSkNCgkJCX0gZWxzZSB7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlU2hlZXQoKTsNCgkJCX0NCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMuYWN0aXZpdHlTdG9yeSA9IGFwaTsNCg0KfSkoalF1ZXJ5KTsNCg==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:ActivityStoryStream_Name}" version="7.0.0.1" description="" instanceIdentifier="cb7d40730a64458792894cec206da723" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="activity-story-stream">
    <contentScript>


#set ($pageSize = $core_v2_widget.GetIntValue('pageSize', 7))
#set ($endlessScroll = $core_v2_widget.GetBoolValue('endlessScroll', true))

#set($filterType = false)
#set($filterType = $core_v2_widget.GetStringValue('filterType', ''))

#set($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))

#set ($user = false)
#if ($filterType == 'User')
	#set ($userId = false)
	#set ($userId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('UserId')))

	#set ($user = false)
	#set ($user = $core_v2_user.Get("%{ Id = $userId }"))

	#if (!$user)
		#set ($user = $core_v2_user.Accessing)
	#end
	## if contextual/accessing user is anonymous, fall back to site filter mode
	#if (!$core_v2_user.IsRegistered($user.Id))
		#set ($filterType = 'Site')
	#else
		&lt;div class="banner condensed"&gt;
			&lt;div class="context"&gt;
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($user.ProfileUrl)"&gt;$user.DisplayName&lt;/a&gt;
				&lt;h1&gt;$!core_v2_language.FormatString($core_v2_language.GetResource('User_Activity'), $user.DisplayName)&lt;/h1&gt;
			&lt;/div&gt;
			&lt;div class="avatar"&gt;$!core_v2_ui.GetResizedImageHtml($user.AvatarUrl, 40, 40, "%{ alt = $user.DisplayName, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
		&lt;/div&gt;
	#end
#else
	#set($user = $core_v2_user.Accessing)
#end

#set ($isAdministrator = false)
#if ($core_v2_nodePermission.Get('Site_ModerateUserContent').IsAllowed)
	#set($isAdministrator = true)
#end

#set ($accessingUser = $core_v2_user.Accessing)
#set ($accessingUserIsRegistered = false)
#if ($core_v2_user.IsRegistered($accessingUser.Id))
	#set ($accessingUserIsRegistered = true)
#end

#set ($group = false)
#set ($enablePosting = false)
#if ($groupId &gt; 0)
	#set($group = $core_v2_group.Get("%{Id = $groupId}"))
	#set ($enablePosting = $group.EnableGroupMessages)
	#if ($group.GroupType == 'Joinless')
		#set ($enablePosting = $enablePosting &amp;&amp; $core_v2_user.IsRegistered($core_v2_user.Accessing.Id))
	#else
		#set ($groupUserMember = false)
		#set ($groupUserMember = $core_v2_groupUserMember.Get($group.Id, "%{ UserId = $accessingUser.Id }"))
		#set ($enablePosting = $enablePosting &amp;&amp; $groupUserMember != false &amp;&amp; ($groupUserMember.MembershipType == "Owner" || $groupUserMember.MembershipType == "Manager" || $groupUserMember.MembershipType == "Member"))
	#end
#else
	#set($enablePosting = $core_v2_user.IsRegistered($core_v2_user.Accessing.Id))
#end
#set ($enablePosting = $enablePosting &amp;&amp; $core_v2_activityStoryUserPreference.Get($core_v2_statusMessage.StoryTypeId).IsLoggingEnabled)

## Hide the stream if private and not a member
#set ($hasAcess = true)
#if ($group)
	#set ($member = $core_v2_groupUserMember.Get($group.Id, "%{ UserId = $accessingUser.Id }"))
	#if (($group.GroupType == 'PrivateListed' || $group.GroupType == 'PrivateUnlisted') &amp;&amp; !($member.IsRoleMember || $member.MembershipType == "Owner" || $member.MembershipType == "Manager" || $member.MembershipType == "Member"))
		#set ($hasAcess = false)
	#end
#end

#if ($hasAcess)

	## ######################
	## Determine Configured Filters
	## ######################

	#set ($filterName0 = $core_v2_widget.ApplyTokens($core_v2_widget.GetStringValue('filterName0',$core_v2_language.GetResource('filterNameDefault'))))
	#set ($filterTypes0 = false)
	#if($filterType == 'User')
		#set ($filterTypes0 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterUserActivityTypes0','')))
	#else
		#set ($filterTypes0 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterActivityTypes0','')))
	#end

	#set ($filterName1 = $core_v2_widget.ApplyTokens($core_v2_widget.GetStringValue('filterName1',$core_v2_language.GetResource('filterNameDefault'))))
	#set ($filterTypes1 = false)
	#if($filterType == 'User')
		#set ($filterTypes1 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterUserActivityTypes1','')))
	#else
		#set ($filterTypes1 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterActivityTypes1','')))
	#end

	#set ($filterName2 = $core_v2_widget.ApplyTokens($core_v2_widget.GetStringValue('filterName2',$core_v2_language.GetResource('filterNameDefault'))))
	#set ($filterTypes2 = false)
	#if($filterType == 'User')
		#set ($filterTypes2 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterUserActivityTypes2','')))
	#else
		#set ($filterTypes2 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterActivityTypes2','')))
	#end

	#set ($filterName3 = $core_v2_widget.ApplyTokens($core_v2_widget.GetStringValue('filterName3',$core_v2_language.GetResource('filterNameDefault'))))
	#set ($filterTypes3 = false)
	#if($filterType == 'User')
		#set ($filterTypes3 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterUserActivityTypes3','')))
	#else
		#set ($filterTypes3 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterActivityTypes3','')))
	#end

	#set ($filterName4 = $core_v2_widget.ApplyTokens($core_v2_widget.GetStringValue('filterName4',$core_v2_language.GetResource('filterNameDefault'))))
	#set ($filterTypes4 = false)
	#if($filterType == 'User')
		#set ($filterTypes4 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterUserActivityTypes4','')))
	#else
		#set ($filterTypes4 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterActivityTypes4','')))
	#end


	## ######################
	## Render Filters
	## ######################

	## get any querystring-sent parameters

	## end date (endless scrolling)

	#set ($endDate = false)
	#if ($core_v2_page.GetQueryStringValue('w_endDate').length &gt; 0)
		#set($endDate = $core_v2_utility.ParseDate($core_v2_page.GetQueryStringValue('w_endDate')))
	#end

	## filter index

	#set ($filterIndex = 0)
	#set ($filterIndex = $core_v2_page.GetQueryStringValue('w_filterIndex'))

	## only show filters if there's more than one defined
	#set ($explicitFilters = 0)
	#if ($filterTypes0.Values('filters').Count &gt; 0)
		#set ($explicitFilters = $explicitFilters + 1)
	#end
	#if ($filterTypes1.Values('filters').Count &gt; 0)
		#set ($explicitFilters = $explicitFilters + 1)
	#end
	#if ($filterTypes2.Values('filters').Count &gt; 0)
		#set ($explicitFilters = $explicitFilters + 1)
	#end
	#if ($filterTypes3.Values('filters').Count &gt; 0)
		#set ($explicitFilters = $explicitFilters + 1)
	#end
	#if ($filterTypes4.Values('filters').Count &gt; 0)
		#set ($explicitFilters = $explicitFilters + 1)
	#end

	#if ($explicitFilters &gt; 1 &amp;&amp; ($filterTypes0.Values('filters').Count &gt; 0 || $filterTypes1.Values('filters').Count &gt; 0 || $filterTypes2.Values('filters').Count &gt; 0 || $filterTypes3.Values('filters').Count &gt; 0 || $filterTypes4.Values('filters').Count &gt; 0))
		&lt;div class="ui-links filters" data-minlinks="50" data-animate="true"&gt;
			&lt;ul class="activity-filters"&gt;
				#if ($filterTypes0.Values('filters').Count &gt; 0 &amp;&amp; $filterName0.length &gt; 0)
					&lt;li&gt;&lt;a class="#if($filterIndex == 0)selected #end" href="#" data-filterindex="0" #if($filterIndex == 0)data-selected #end&gt;$filterName0&lt;/a&gt;&lt;/li&gt;
				#end
				#if ($filterTypes1.Values('filters').Count &gt; 0 &amp;&amp; $filterName1.length &gt; 0)
					&lt;li&gt;&lt;a class="#if($filterIndex == 1)selected #end" href="#" data-filterindex="1" #if($filterIndex == 1)data-selected #end&gt;$filterName1&lt;/a&gt;&lt;/li&gt;
				#end
				#if ($filterTypes2.Values('filters').Count &gt; 0 &amp;&amp; $filterName2.length &gt; 0)
					&lt;li&gt;&lt;a class="#if($filterIndex == 2)selected #end" href="#" data-filterindex="2" #if($filterIndex == 2)data-selected #end&gt;$filterName2&lt;/a&gt;&lt;/li&gt;
				#end
				#if ($filterTypes3.Values('filters').Count &gt; 0 &amp;&amp; $filterName3.length &gt; 0)
					&lt;li&gt;&lt;a class="#if($filterIndex == 3)selected #end" href="#" data-filterindex="3" #if($filterIndex == 3)data-selected #end&gt;$filterName3&lt;/a&gt;&lt;/li&gt;
				#end
				#if ($filterTypes4.Values('filters').Count &gt; 0 &amp;&amp; $filterName4.length &gt; 0)
					&lt;li&gt;&lt;a class="#if($filterIndex == 4)selected #end" href="#" data-filterindex="4" #if($filterIndex == 4)data-selected #end&gt;$filterName4&lt;/a&gt;&lt;/li&gt;
				#end
			&lt;/ul&gt;
		&lt;/div&gt;
	#end

	## load and render stories
	&lt;div class="post-list stream"&gt;
		$core_v2_widget.ExecuteFile("stream.vm")
	&lt;/div&gt;

	## render client script inline since it's short and to avoid extra http requests
	&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
	&lt;script&gt;
	jQuery(function(){
		jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
			jQuery.telligent.evolution.widgets.activityStoryStream.register({
				wrapper: '#$core_v2_widget.WrapperElementId',
				currentFilterIndex: $filterIndex,
				pageSize: $pageSize,
				filterType: '$filterType',
				groupId: $groupId,
				moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
				postUrl: #if ($enablePosting) #if ($groupId &gt; 0) '$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('group-status-add', $groupId))' #else '$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('status-add'))' #end #else null #end,
				postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('Post'))'
			});
		});
	})
	&lt;/script&gt;

#else
	&lt;div class="post topic full"&gt;
		&lt;div class="content"&gt;
			$core_v2_language.GetResource('access_denied')
		&lt;/div&gt;
	&lt;/div&gt;
#end


	</contentScript>
    <headerScript>
	</headerScript>
    <configuration>
	  
&lt;propertyGroup id="options" resourceName="options"&gt;
	&lt;property id="fragmentHeader" resourceName="title" dataType="string" defaultValue="${resource:activityStoryStream_name}" /&gt;
	&lt;property id="pageSize" resourceName="pageSize" dataType="int" defaultValue="10" /&gt;
	&lt;property id="filterType" resourceName="filterType" descriptionResourceName="filterType_Desc" dataType="string" defaultValue="" &gt;
		&lt;propertyValue value="Site" resourceName="filterType_site"
			propertiesToHide="includeSubGroups,filterUserActivityTypes0,filterUserActivityTypes1,filterUserActivityTypes2,filterUserActivityTypes3,filterUserActivityTypes4"
			propertiesToShow="activityTypes0,filterActivityTypes1,filterActivityTypes2,filterActivityTypes3,filterActivityTypes4" /&gt;
		&lt;propertyValue value="Group" resourceName="filterType_group"
			propertiesToHide="filterUserActivityTypes0,filterUserActivityTypes1,filterUserActivityTypes2,filterUserActivityTypes3,filterUserActivityTypes4"
			propertiesToShow="includeSubGroups,filterActivityTypes0,filterActivityTypes1,filterActivityTypes2,filterActivityTypes3,filterActivityTypes4" /&gt;
		&lt;propertyValue value="User" resourceName="filterType_userProfile"
			propertiesToHide="includeSubGroups,filterActivityTypes0,filterActivityTypes1,filterActivityTypes2,filterActivityTypes3,activityTypes4"
			propertiesToShow="filterUserActivityTypes0,filterUserActivityTypes1,filterUserActivityTypes2,filterUserActivityTypes3,filterUserActivityTypes4" /&gt;
	&lt;/property&gt;
	&lt;property id="includeSubGroups" resourceName="includeSubGroups" dataType="bool" defaultValue="false" /&gt;
	&lt;property id="endlessScroll" resourceName="endlessScroll" descriptionResourceName="endlessScrollDesc" dataType="bool" defaultValue="true" /&gt;
&lt;/propertyGroup&gt;
&lt;propertyGroup id="filter0" resourceName="filter0" descriptionResourceName="filter_desc"&gt;
	&lt;property id="filterName0" resourceName="filterName" descriptionResourceName="filterDesc" dataType="string"
		defaultValue="${resource:filterNameDefault}" /&gt;
	&lt;property id="filterActivityTypes0" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom"
		defaultValue="filters=948477cb045b40778bf17ce1a091db11&amp;amp;filters=44a697e2d1b348f6951945cfa2bfc4fd&amp;amp;filters=0f7404b7d8f24a1b97c9175af1be4570&amp;amp;filters=06336ce1600c40e4b32d97ff811ad7bd&amp;amp;filters=acf00be657174a25a17de2036c694444&amp;amp;filters=0a680cf3f19648c592dbdf8cebe3fe92&amp;amp;filters=ecf7e9ef76f0447c9b252a531c7bb651&amp;amp;filters=edebd6ada45a470f89e63dfc31714bd6&amp;amp;filters=a23334fb669a421d85e91945a7b80581&amp;amp;filters=14656a259a034311b8e346cef57ac02b&amp;amp;filters=333cc77c019644c5aefa6e35a0011ee8&amp;amp;filters=276a9e5128394ae98291e3f24b49cbc4&amp;amp;filters=e9dd0cb7adf74518b0961b00f3f51246&amp;amp;filters=3d10e9df357b42038f7d3bf15f60fd61&amp;amp;filters=cf26068cf6644050bf69f1d5c3e7eb1a&amp;amp;filters=432f675c15bb429c98a99e99d539587b&amp;amp;948477cb045b40778bf17ce1a091db11=All&amp;amp;44a697e2d1b348f6951945cfa2bfc4fd=All&amp;amp;0f7404b7d8f24a1b97c9175af1be4570=All&amp;amp;06336ce1600c40e4b32d97ff811ad7bd=All&amp;amp;acf00be657174a25a17de2036c694444=All&amp;amp;0a680cf3f19648c592dbdf8cebe3fe92=All&amp;amp;ecf7e9ef76f0447c9b252a531c7bb651=All&amp;amp;edebd6ada45a470f89e63dfc31714bd6=All&amp;amp;a23334fb669a421d85e91945a7b80581=All&amp;amp;14656a259a034311b8e346cef57ac02b=All&amp;amp;333cc77c019644c5aefa6e35a0011ee8=All&amp;amp;276a9e5128394ae98291e3f24b49cbc4=All&amp;amp;e9dd0cb7adf74518b0961b00f3f51246=All&amp;amp;3d10e9df357b42038f7d3bf15f60fd61=All&amp;amp;cf26068cf6644050bf69f1d5c3e7eb1a=All&amp;amp;432f675c15bb429c98a99e99d539587b=All"&gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_User" /&gt;
		&lt;propertyValue value="Followed" resourceName="activityTypeUsers_Followed" /&gt;
		&lt;propertyValue value="User,Followed" resourceName="activityTypeUsers_UserAndFollowed" /&gt;
		&lt;propertyValue value="All" resourceName="activityTypeUsers_All" /&gt;
	&lt;/property&gt;
	&lt;property id="filterUserActivityTypes0" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom" &gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_Include" /&gt;
	&lt;/property&gt;
&lt;/propertyGroup&gt;
&lt;propertyGroup id="filter1" resourceName="filter1" descriptionResourceName="filter_desc"&gt;
	&lt;property id="filterName1" resourceName="filterName" descriptionResourceName="filterDesc" dataType="string"
		defaultValue="${resource:filterNameDefault}" /&gt;
	&lt;property id="filterActivityTypes1" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom"&gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_User" /&gt;
		&lt;propertyValue value="Followed" resourceName="activityTypeUsers_Followed" /&gt;
		&lt;propertyValue value="User,Followed" resourceName="activityTypeUsers_UserAndFollowed" /&gt;
		&lt;propertyValue value="All" resourceName="activityTypeUsers_All" /&gt;
	&lt;/property&gt;
	&lt;property id="filterUserActivityTypes1" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom"&gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_Include" /&gt;
	&lt;/property&gt;
&lt;/propertyGroup&gt;
&lt;propertyGroup id="filter2" resourceName="filter2" descriptionResourceName="filter_desc"&gt;
	&lt;property id="filterName2" resourceName="filterName" descriptionResourceName="filterDesc" dataType="string"
		defaultValue="${resource:filterNameDefault}" /&gt;
	&lt;property id="filterActivityTypes2" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom" &gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_User" /&gt;
		&lt;propertyValue value="Followed" resourceName="activityTypeUsers_Followed" /&gt;
		&lt;propertyValue value="User,Followed" resourceName="activityTypeUsers_UserAndFollowed" /&gt;
		&lt;propertyValue value="All" resourceName="activityTypeUsers_All" /&gt;
	&lt;/property&gt;
	&lt;property id="filterUserActivityTypes2" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom"&gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_Include" /&gt;
	&lt;/property&gt;
&lt;/propertyGroup&gt;
&lt;propertyGroup id="filter3" resourceName="filter3" descriptionResourceName="filter_desc"&gt;
	&lt;property id="filterName3" resourceName="filterName" descriptionResourceName="filterDesc" dataType="string"
		defaultValue="${resource:filterNameDefault}" /&gt;
	&lt;property id="filterActivityTypes3" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom"&gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_User" /&gt;
		&lt;propertyValue value="Followed" resourceName="activityTypeUsers_Followed" /&gt;
		&lt;propertyValue value="User,Followed" resourceName="activityTypeUsers_UserAndFollowed" /&gt;
		&lt;propertyValue value="All" resourceName="activityTypeUsers_All" /&gt;
	&lt;/property&gt;
	&lt;property id="filterUserActivityTypes3" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom"&gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_Include" /&gt;
	&lt;/property&gt;
&lt;/propertyGroup&gt;
&lt;propertyGroup id="filter4" resourceName="filter4" descriptionResourceName="filter_desc"&gt;
	&lt;property id="filterName4" resourceName="filterName" descriptionResourceName="filterDesc" dataType="string"
		defaultValue="${resource:filterNameDefault}" /&gt;
	&lt;property id="filterActivityTypes4" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom"&gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_User" /&gt;
		&lt;propertyValue value="Followed" resourceName="activityTypeUsers_Followed" /&gt;
		&lt;propertyValue value="User,Followed" resourceName="activityTypeUsers_UserAndFollowed" /&gt;
		&lt;propertyValue value="All" resourceName="activityTypeUsers_All" /&gt;
	&lt;/property&gt;
	&lt;property id="filterUserActivityTypes4" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom"&gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_Include" /&gt;
	&lt;/property&gt;
&lt;/propertyGroup&gt;

	
	</configuration>
    <languageResources>
	  <language key="en-us">
		<resource name="ActivityStoryStream_Name">Activity Story Stream</resource>
		<resource name="options">Options</resource>
		<resource name="pageSize">Number of Items to Display</resource>
		<resource name="filterType">Activity Stream Mode</resource>
		<resource name="filterType_site">Site (all site activity)</resource>
		<resource name="filterType_group">Group (activity in a group and optionally subgroups)</resource>
		<resource name="filterType_userProfile">User (activity for contextual user)</resource>
		<resource name="filterType_Desc">Determines the default view of the Activity Stream and the set of filters to display</resource>
		<resource name="includeSubGroups">Include subgroup activity</resource>
		<resource name="endlessScroll">Endless Stream</resource>
		<resource name="endlessScrollDesc">Automatically load more stories when scrolled near the end</resource>
		<resource name="loading">Loading...</resource>
		<resource name="showMore">Show More</resource>
		<resource name="hideOriginalPost">Hide original post</resource>
		<resource name="showOriginalPost">Show original post</resource>
		<resource name="hideHistory">Hide revision history</resource>
		<resource name="showHistory">Show revision history</resource>
		<resource name="deleteActivityMessage">Are you sure you want to delete this story?</resource>
		<resource name="deleteCommentMessage">Are you sure you want to delete this comment?</resource>
		<resource name="delete">Delete</resource>
		<resource name="message">Send a Private Message</resource>
		<resource name="comment">Comment</resource>
		<resource name="comment_format">{0} comment</resource>
		<resource name="comments_format">{0} comments</resource>
		<resource name="comments">Comments</resource>
		<resource name="writeComment">Write a comment...</resource>
		<resource name="filterName">Filter Name</resource>
		<resource name="filterDesc">Determines the display name of the filter</resource>
		<resource name="filterNameDefault">Filter</resource>
		<resource name="filter0">Filter 1</resource>
		<resource name="filter1">Filter 2</resource>
		<resource name="filter2">Filter 3</resource>
		<resource name="filter3">Filter 4</resource>
		<resource name="filter4">Filter 5</resource>
		<resource name="filter_desc">Configures an optional filter</resource>
		<resource name="activityTypes">Activity Story Types</resource>
		<resource name="activityTypesDesc">Determines which activities from which users are included in this filter. If no types are selected, the filter will not be displayed.</resource>
		<resource name="activityTypeUsers_Exclude">Exclude activity</resource>
		<resource name="activityTypeUsers_Include">Include contextual user's activity</resource>
		<resource name="activityTypeUsers_User">Include accessing user's activity</resource>
		<resource name="activityTypeUsers_Followed">Include accessing user's followed users' activity</resource>
		<resource name="activityTypeUsers_UserAndFollowed">Include accessing user's and followed users' activity</resource>
		<resource name="activityTypeUsers_All">Include all users' activity</resource>
		<resource name="today">Today</resource>
		<resource name="View">View</resource>
		<resource name="no_messages">There was no activity to display.</resource>
		<resource name="view_more_comments">View more comments</resource>
		<resource name="CF_Comment_ModeratedMessaage">Thank you, your comment requires moderation so it may take a while to appear.</resource>
		<resource name="Cancel">Cancel</resource>
		<resource name="User_Activity">Activity</resource>
		<resource name="Post">Post</resource>
		<resource name="access_denied">You must be a member to view this group's activity.</resource>
	  </language>
	</languageResources>
    <files>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBwcmUtcmVuZGVyZWQgc3Rvcmllcw0KIyMNCiNzZXQgKCRmaWx0ZXJUeXBlID0gJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCdGaWx0ZXJUeXBlJykpDQojc2V0ICgkZmlsdGVySW5kZXggPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ0ZpbHRlckluZGV4JykpDQojc2V0ICgkcGFnZVNpemUgPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlSW50KCRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnUGFnZVNpemUnKSkpDQojc2V0ICgkZ3JvdXBJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCdHcm91cElkJykpKQ0KI3NldCAoJGVuZERhdGUgPSBmYWxzZSkNCiNpZiAoJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCdFbmREYXRlJykubGVuZ3RoID4gMCkNCgkjc2V0KCRlbmREYXRlID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZURhdGUoJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCdFbmREYXRlJykpKQ0KI2VuZA0KDQojc2V0ICgkYWNjZXNzaW5nVXNlciA9ICRjb3JlX3YyX3VzZXIuQWNjZXNzaW5nKQ0KI3NldCAoJGFjY2Vzc2luZ1VzZXJJc1JlZ2lzdGVyZWQgPSBmYWxzZSkNCiNpZiAoJGNvcmVfdjJfdXNlci5Jc1JlZ2lzdGVyZWQoJGFjY2Vzc2luZ1VzZXIuSWQpKQ0KCSNzZXQgKCRhY2Nlc3NpbmdVc2VySXNSZWdpc3RlcmVkID0gdHJ1ZSkNCiNlbmQNCg0KJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCdzdHJlYW0udm0nKQ0K</file>
      <file name="story.vm">IyMNCiMjIFJlbmRlcnMgYW4gaW5kaXZpZHVhbCBhY3Rpdml0eSBzdG9yeQ0KIyMgUmVxdWlyZXMgaW4gc2NvcGU6DQojIyAgICRzdG9yeSBpbnN0YW5jZQ0KIyMNCg0KI3NldCAoJHdpZGdldFVuaXF1ZVN0b3J5SWQgPSAiJHtjb3JlX3YyX3dpZGdldC5XcmFwcGVyRWxlbWVudElkfV9zdG9yeV8ke21lc3NhZ2UuU3RvcnlJZH0iKQ0KDQojc2V0ICgkcHJpbWFyeVN0b3J5VXNlciA9ICRzdG9yeS5QcmltYXJ5VXNlcikNCg0KI3NldCAoJHByaW1hcnlTdG9yeVVzZXJJc1JlZ2lzdGVyZWQgPSBmYWxzZSkNCiNzZXQgKCRwcmltYXJ5U3RvcnlVc2VySXNSZWdpc3RlcmVkID0gJGNvcmVfdjJfdXNlci5Jc1JlZ2lzdGVyZWQoJHByaW1hcnlTdG9yeVVzZXIuSWQpKQ0KI3NldCAoJHByaW1hcnlTdG9yeVVzZXJJc0FjY2Vzc2luZ1VzZXIgPSBmYWxzZSkNCiNpZiAoJGFjY2Vzc2luZ1VzZXIuSWQgPT0gJHByaW1hcnlTdG9yeVVzZXIuSWQpDQoJI3NldCAoJHByaW1hcnlTdG9yeVVzZXJJc0FjY2Vzc2luZ1VzZXIgPSB0cnVlKQ0KI2VuZA0KDQojc2V0ICgkY29tbWVudHNTdXBwb3J0ZWQgPSBmYWxzZSkNCiNzZXQgKCRjb21tZW50c1N1cHBvcnRlZCA9ICRjb3JlX3YyX2NvbW1lbnRzLlN1cHBvcnRzQ29tbWVudHMoJHN0b3J5LkNvbnRlbnRUeXBlSWQpKQ0KDQojc2V0ICgkYWNjZXNzaW5nVXNlckNhbkNvbW1lbnQgPSBmYWxzZSkNCiNpZiAoJGNvbW1lbnRzU3VwcG9ydGVkKQ0KCSNzZXQgKCRhY2Nlc3NpbmdVc2VyQ2FuQ29tbWVudCA9ICRjb3JlX3YyX2NvbW1lbnRzLkNhbkNyZWF0ZUNvbW1lbnQoJHN0b3J5LkNvbnRlbnRJZCwgJHN0b3J5LkNvbnRlbnRUeXBlSWQpKQ0KI2VuZA0KDQojc2V0ICgkd2lkZ2V0VW5pcXVlU3RvcnlJZCA9ICIke2NvcmVfdjJfd2lkZ2V0LldyYXBwZXJFbGVtZW50SWR9X3N0b3J5XyR7c3RvcnkuU3RvcnlJZH0iKQ0KI3NldCAoJHN0b3J5VHlwZSA9ICRzdG9yeS5TdG9yeVR5cGVJZCkNCg0KI3NldCAoJHN0b3J5VXJsID0gJHN0b3J5LkNvbnRlbnQuVXJsKQ0KI2lmICgkc3RvcnkuVHlwZUlkKQ0KCSNzZXQoJHN0b3J5VXJsID0gJG1vYmlsZV92MV91cmwuRm9ybWF0KCdhY3Rpdml0eXN0b3J5JywgJHN0b3J5LlN0b3J5SWQpKQ0KI2VuZA0KDQo8ZGl2IGlkPSIkIXdpZGdldFVuaXF1ZVN0b3J5SWQiIGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gYWN0aXZpdHktc3RvcnkgJCFzdG9yeVR5cGUgY29udGVudC10eXBlLSR7c3RvcnkuQ29udGVudFR5cGVJZH0iDQoJZGF0YS1hdXRob3JpZD0iJCFsYXRlc3RBY3Rvci5Vc2VyLklkIg0KCWRhdGEtYWN0aXZpdHlpZD0iJCFzdG9yeS5TdG9yeUlkIg0KCWRhdGEtYWN0aXZpdHl0eXBlPSIkIXN0b3J5VHlwZSINCglkYXRhLWFjdGl2aXR5ZGF0ZT0iJCFjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdERhdGUoJHN0b3J5Lkxhc3RVcGRhdGUsICRkYXRlVGltZVJvdW5kVHJpcEZvcm1hdCkiDQoJZGF0YS1jb250ZW50aWQ9IiQhc3RvcnkuQ29udGVudElkIg0KCWRhdGEtY29udGVudHR5cGVpZD0iJCFzdG9yeS5Db250ZW50VHlwZUlkIg0KCWRhdGEtdHlwZWlkPSIkIXN0b3J5LlR5cGVJZCINCglkYXRhLXRhcmdldHVybD0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkc3RvcnlVcmwpIj4NCg0KCTxkaXYgY2xhc3M9InBvc3QgYWN0aXZpdHkiPg0KCQk8ZGl2IGNsYXNzPSJhdmF0YXIiPg0KCQkJI2lmICgkcHJpbWFyeVN0b3J5VXNlci5Qcm9maWxlVXJsKQ0KCQkJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJHByaW1hcnlTdG9yeVVzZXIuUHJvZmlsZVVybCkiIGNsYXNzPSJpbnRlcm5hbC1saW5rIHZpZXctdXNlci1wcm9maWxlIj4NCgkJCQkJJGNvcmVfdjJfdWkuR2V0UmVzaXplZEltYWdlSHRtbCgkcHJpbWFyeVN0b3J5VXNlci5BdmF0YXJVcmwsIDQwLCA0MCwgIiV7Ym9yZGVyPScwJywgYWx0PSRwcmltYXJ5U3RvcnlVc2VyLkRpc3BsYXlOYW1lLCBSZXNpemVNZXRob2Q9J1pvb21BbmRDcm9wJyxib3JkZXI9JzAnfSIpDQoJCQkJPC9hPg0KCQkJI2Vsc2UNCgkJCQkkY29yZV92Ml91aS5HZXRSZXNpemVkSW1hZ2VIdG1sKCRwcmltYXJ5U3RvcnlVc2VyLkF2YXRhclVybCwgNDAsIDQwLCAiJXtib3JkZXI9JzAnLCBhbHQ9JHByaW1hcnlTdG9yeVVzZXIuRGlzcGxheU5hbWUsIFJlc2l6ZU1ldGhvZD0nWm9vbUFuZENyb3AnLGJvcmRlcj0nMCd9IikNCgkJCSNlbmQNCgkJPC9kaXY+DQoJCTxkaXYgY2xhc3M9ImRhdGUiPiRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdEFnb0RhdGUoJHN0b3J5LkNyZWF0ZWREYXRlKTwvZGl2Pg0KCQk8ZGl2IGNsYXNzPSJjb250ZW50Ij4NCgkJCSRtb2JpbGVfdjFfZGF0YUZvcm1hdC5EZXRlY3QoJHN0b3J5LlZpZXdIdG1sKCdXZWInKSkNCgkJPC9kaXY+DQoJCTxkaXYgY2xhc3M9InVpLWxpbmtzIGFjdGlvbnMiIGRhdGEtbWF4bGlua3M9IjIiIGRhdGEtbWlubGlua3M9IjIiPg0KCQkJPHVsIGNsYXNzPSJhY3Rpb25zIj4NCgkJCQkjIyBMaWtlcw0KCQkJCSNpZiAoJGFjY2Vzc2luZ1VzZXJJc1JlZ2lzdGVyZWQgJiYgJGNvcmVfdjJfbGlrZS5DYW5MaWtlKCRzdG9yeS5Db250ZW50SWQsICRzdG9yeS5Db250ZW50VHlwZUlkKSkNCgkJCQkJPGxpIGNsYXNzPSJhY3Rpb24tbGlrZSI+DQoJCQkJCQkjc2V0KCRmb3JtYXQgPSAne3RvZ2dsZX0gPHNwYW4gY2xhc3M9ImNvdW50Ij48c3BhbiBjbGFzcz0iaWNvbiI+PC9zcGFuPntjb3VudH08L3NwYW4+JykNCgkJCQkJCSNzZXQgKCRsaWtlT3B0aW9ucyA9ICIleyBGb3JtYXQgPSAkZm9ybWF0IH0iKQ0KCQkJCQkJI2lmICgkc3RvcnkuVHlwZUlkKQ0KCQkJCQkJCSRsaWtlT3B0aW9ucy5BZGQoJ0xpa2VUeXBlSWQnLCAkc3RvcnkuVHlwZUlkKQ0KCQkJCQkJI2VuZA0KCQkJCQkJJGNvcmVfdjJfdWkuTGlrZSgkc3RvcnkuQ29udGVudElkLCAkc3RvcnkuQ29udGVudFR5cGVJZCwgJGxpa2VPcHRpb25zKQ0KCQkJCQk8L2xpPg0KCQkJCSNlbmQNCg0KCQkJCSMjIENvbW1lbnRzDQoJCQkJI2lmICgkY29tbWVudHNTdXBwb3J0ZWQpDQoJCQkJCSNzZXQgKCRjb21tZW50Q291bnQgPSAwKQ0KCQkJCQkjc2V0ICgkY29tbWVudE9wdGlvbnMgPSAiJXsgUGFnZUluZGV4ID0gMCwgUGFnZVNpemUgPSAxLCBDb250ZW50SWQgPSAkc3RvcnkuQ29udGVudElkLCBDb250ZW50VHlwZUlkID0gJHN0b3J5LkNvbnRlbnRUeXBlSWQgfSIpDQoJCQkJCSNpZiAoJHN0b3J5LlR5cGVJZCkNCgkJCQkJCSRjb21tZW50T3B0aW9ucy5BZGQoJ0NvbW1lbnRUeXBlJywgJHN0b3J5LlR5cGVJZCkNCgkJCQkJI2VuZA0KCQkJCQkjc2V0ICgkY29tbWVudHMgPSAkY29yZV92Ml9jb21tZW50cy5MaXN0KCRjb21tZW50T3B0aW9ucykpDQoJCQkJCSNzZXQgKCRjb21tZW50Q291bnQgPSAkY29tbWVudHMuVG90YWxDb3VudCkNCgkJCQkJPGxpIGNsYXNzPSJhY3Rpb24tY29tbWVudCI+DQoJCQkJCQk8YSBjbGFzcz0iY29tbWVudCIgaHJlZj0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkc3RvcnlVcmwpIj4NCgkJCQkJCSNpZiAoJGNvbW1lbnRDb3VudCA9PSAwKQ0KCQkJCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdjb21tZW50JykNCgkJCQkJCSNlbHNlaWYgKCRjb21tZW50Q291bnQgPT0gMSkNCgkJCQkJCQkkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRTdHJpbmcoJGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ2NvbW1lbnRfZm9ybWF0JyksICRjb21tZW50Q291bnQpDQoJCQkJCQkjZWxzZQ0KCQkJCQkJCSNpZiAoJGNvbW1lbnRDb3VudCA+IDEwMDAwMDApDQoJCQkJCQkJCSNzZXQoJGNvbW1lbnRDb3VudCA9ICRjb21tZW50Q291bnQgLyAxMDAwMDAwKQ0KCQkJCQkJCQkjc2V0KCRjb21tZW50Q291bnQgPSAiJHtjb21tZW50Q291bnR9TSIpDQoJCQkJCQkJI2Vsc2VpZiAoJGNvbW1lbnRDb3VudCA+IDEwMDApDQoJCQkJCQkJCSNzZXQoJGNvbW1lbnRDb3VudCA9ICRjb21tZW50Q291bnQgLyAxMDAwKQ0KCQkJCQkJCQkjc2V0KCRjb21tZW50Q291bnQgPSAiJHtjb21tZW50Q291bnR9ayIpDQoJCQkJCQkJI2VuZA0KCQkJCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdFN0cmluZygkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnY29tbWVudHNfZm9ybWF0JyksICRjb21tZW50Q291bnQpDQoJCQkJCQkjZW5kDQoJCQkJCQk8L2E+DQoJCQkJCTwvbGk+DQoJCQkJI2VuZA0KCQkJPC91bD4NCgkJPC9kaXY+DQoJPC9kaXY+DQo8L2Rpdj4NCg==</file>
      <file name="stream.vm">I3NldCgkc3RvcmllcyA9IGZhbHNlKQ0KDQojc2V0ICgkZGF0ZVRpbWVSb3VuZFRyaXBGb3JtYXQgPSAieXl5eS1NTS1kZFRISDptbTpzcy5mZmYiKQ0KDQojaWYgKCRmaWx0ZXJUeXBlID09ICdVc2VyJykNCgkjc2V0ICgkZmlsdGVyQWN0aXZpdHlUeXBlc1Byb3BlcnR5ID0gImZpbHRlclVzZXJBY3Rpdml0eVR5cGVzJHtmaWx0ZXJJbmRleH0iKQ0KI2Vsc2UNCgkjc2V0ICgkZmlsdGVyQWN0aXZpdHlUeXBlc1Byb3BlcnR5ID0gImZpbHRlckFjdGl2aXR5VHlwZXMke2ZpbHRlckluZGV4fSIpDQojZW5kDQoNCiNzZXQgKCRmaWx0ZXJBY3Rpdml0eVR5cGVzID0gZmFsc2UpDQojc2V0ICgkZmlsdGVyQWN0aXZpdHlUeXBlcyA9ICRjb3JlX3YyX3BhZ2UuUGFyc2VRdWVyeVN0cmluZygkY29yZV92Ml93aWRnZXQuR2V0Q3VzdG9tVmFsdWUoJGZpbHRlckFjdGl2aXR5VHlwZXNQcm9wZXJ0eSwnJykpKQ0KI2lmICgkZmlsdGVyVHlwZSA9PSAnVXNlcicpICMjIHVzZXIgaWQNCgkjc2V0ICgkcXVlcnkgPSAiJXsgU29ydEJ5ID0gJ0RhdGUnLCBTb3J0T3JkZXIgPSAnRGVzY2VuZGluZycsIFBhZ2VTaXplID0gJHBhZ2VTaXplIH0iKQ0KI2Vsc2VpZiAoJGZpbHRlclR5cGUgPT0gJ0dyb3VwJykgIyMgZ3JvdXANCgkjc2V0ICgkY3VycmVudEdyb3VwID0gZmFsc2UpDQoJI3NldCAoJGN1cnJlbnRHcm91cCA9ICRjb3JlX3YyX2dyb3VwLkdldCgiJXtJZD0kZ3JvdXBJZH0iKSkNCgkjc2V0ICgkaW5jbHVkZVN1Ykdyb3VwcyA9ICRjb3JlX3YyX3dpZGdldC5HZXRCb29sVmFsdWUoJ2luY2x1ZGVTdWJHcm91cHMnLCBmYWxzZSkpDQoJI3NldCAoJGNvbnRhaW5lcklkcyA9ICIiKQ0KCSNpZiAoJGN1cnJlbnRHcm91cCkNCgkJI3NldCAoJGNvbnRhaW5lcklkcyA9ICIkY3VycmVudEdyb3VwLkNvbnRhaW5lcklkIikNCgkjaWYgKCRpbmNsdWRlU3ViR3JvdXBzKQ0KCQkjc2V0ICgkc3ViR3JvdXBzID0gJGNvcmVfdjJfZ3JvdXAuTGlzdCgiJXsgSW5jbHVkZUFsbFN1Ykdyb3VwcyA9ICd0cnVlJywgUGFnZVNpemUgPSA1MCwgUGFyZW50R3JvdXBJZCA9ICRjdXJyZW50R3JvdXAuSWQsIFBlcm1pc3Npb24gPSAnR3JvdXBfUmVhZEdyb3VwJyB9IikpDQoJCSNmb3JlYWNoICgkc3ViR3JvdXAgaW4gJHN1Ykdyb3VwcykNCgkJCSNzZXQgKCRjb250YWluZXJJZHMgPSAiJHtjb250YWluZXJJZHN9LCR7c3ViR3JvdXAuQ29udGFpbmVySWR9IikNCgkJI2VuZA0KCSNlbmQNCgkjZW5kDQoJI3NldCAoJHF1ZXJ5ID0gIiV7IFNvcnRCeSA9ICdEYXRlJywgU29ydE9yZGVyID0gJ0Rlc2NlbmRpbmcnLCBQYWdlU2l6ZSA9ICRwYWdlU2l6ZSwgQ29udGFpbmVySWRzID0gJGNvbnRhaW5lcklkcyB9IikNCiNlbHNlICAjIyBzaXRlDQoJI3NldCAoJHF1ZXJ5ID0gIiV7IFNvcnRCeSA9ICdEYXRlJywgU29ydE9yZGVyID0gJ0Rlc2NlbmRpbmcnLCBQYWdlU2l6ZSA9ICRwYWdlU2l6ZSB9IikNCiNlbmQNCg0KI2lmICghJHN0b3JpZXMpDQoJIyMgaW5jbHVkZSBmaWx0ZXJzLCBpZiBzcGVjaWZpZWQNCgkjc2V0ICgkaGFzVXNlckZpbHRlcnMgPSBmYWxzZSkNCgkjaWYgKCRmaWx0ZXJBY3Rpdml0eVR5cGVzICYmICRmaWx0ZXJBY3Rpdml0eVR5cGVzLlZhbHVlcygnZmlsdGVycycpLkNvdW50ID4gMCkNCgkJI3NldCAoJGluY2x1ZGVkU3RvcnlUeXBlcyA9IGZhbHNlKQ0KCQkjc2V0ICgkaW5jbHVkZWRTdG9yeVR5cGVzID0gJGZpbHRlckFjdGl2aXR5VHlwZXMuVmFsdWVzKCdmaWx0ZXJzJykpDQoJCSNmb3JlYWNoICgkc3RvcnlUeXBlIGluICRpbmNsdWRlZFN0b3J5VHlwZXMpDQoJCQkjc2V0ICgkaW5jbHVkZWRVc2VycyA9IGZhbHNlKQ0KCQkJI3NldCAoJGluY2x1ZGVkVXNlcnMgPSAkZmlsdGVyQWN0aXZpdHlUeXBlcy5WYWx1ZSgkc3RvcnlUeXBlKSkNCgkJCSNpZiAoJGluY2x1ZGVkVXNlcnMpDQoJCQkJI3NldCAoJGZpbHRlck5hbWUgPSAiX0ZpbHRlcl8ke3N0b3J5VHlwZX0iKQ0KCQkJCSNzZXQgKCRoYXNVc2VyRmlsdGVycyA9IHRydWUpDQoJCQkJJHF1ZXJ5LkFkZCgkZmlsdGVyTmFtZSwgJGluY2x1ZGVkVXNlcnMpDQoJCQkjZW5kDQoJCSNlbmQNCgkjZW5kDQoNCgkjaWYgKCRoYXNVc2VyRmlsdGVycyB8fCAkZmlsdGVyVHlwZSA9PSAnVXNlcicpDQoJCSNzZXQoJHVzZXJJZCA9IGZhbHNlKQ0KCQkjc2V0ICgkdXNlcklkID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUludCgkbW9iaWxlX3YxX3VybFRva2VuLlZhbHVlKCdVc2VySWQnKSkpDQoJCSNpZighJHVzZXJJZCB8fCAkdXNlcklkIDw9IDApDQoJCQkjc2V0KCR1c2VySWQgPSAkY29yZV92Ml91c2VyLkFjY2Vzc2luZy5JZCkNCgkJI2VuZA0KCQkkcXVlcnkuQWRkKCdVc2VySWQnLCAkdXNlcklkKQ0KCSNlbmQNCg0KCSMjIGluY2x1ZGUgZGF0ZSBvZmZzZXQsIGlmIHNwZWNpZmllZA0KCSNpZiAoJGVuZERhdGUpDQoJCSRxdWVyeS5BZGQoJ0VuZERhdGUnLCAkZW5kRGF0ZSkNCgkjZW5kDQoNCgkjc2V0ICgkc3RvcmllcyA9ICRjb3JlX3YyX2FjdGl2aXR5U3RvcnkuTGlzdCgkcXVlcnkpKQ0KI2VuZA0KDQojc2V0KCRoYWREYXRlRmlsdGVyID0gZmFsc2UpDQojaWYgKCEkZW5kRGF0ZSkNCgkjc2V0KCRoYWREYXRlRmlsdGVyID0gdHJ1ZSkNCiNlbmQNCiNzZXQoJGVuZERhdGUgPSBmYWxzZSkNCg0KI2ZvcmVhY2goJHN0b3J5IGluICRzdG9yaWVzKQ0KI2VhY2gNCgkjc2V0ICgkZW5kRGF0ZSA9ICRzdG9yeS5MYXN0VXBkYXRlKQ0KCSRjb3JlX3YyX3dpZGdldC5FeGVjdXRlRmlsZSgic3Rvcnkudm0iKQ0KI25vZGF0YQ0KCTxkaXYgaWQ9IiR7Y29yZV92Ml93aWRnZXQuV3JhcHBlckVsZW1lbnRJZH1fbWVzc2FnZV9ub3JlY29yZHMiPjxkaXYgY2xhc3M9Im1lc3NhZ2Ugbm9yZWNvcmRzIj4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbm9fbWVzc2FnZXMnKTwvZGl2PjwvZGl2Pg0KI2FmdGVyYWxsDQoJPGRpdiBjbGFzcz0iZGF0YSIgZGF0YS1sYXN0bWVzc2FnZWRhdGU9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJGVuZERhdGUuVG9TdHJpbmcoJGRhdGVUaW1lUm91bmRUcmlwRm9ybWF0KSkiPjwvZGl2Pg0KI2VuZA0K</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCg0KCQkJLy8gaGFuZGxlIGZpbHRlciBjaGFuZ2VzDQoJCQkkKG9wdGlvbnMud3JhcHBlciArICcgdWwuYWN0aXZpdHktZmlsdGVycyBhJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkgew0KCQkJCXZhciBmaWx0ZXJJbmRleCA9ICQodGhpcykuZGF0YSgnZmlsdGVyaW5kZXgnKTsNCgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmFkZFJlZnJlc2hQYXJhbWV0ZXIoJ3dfZmlsdGVySW5kZXgnLCBmaWx0ZXJJbmRleCk7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5yZWZyZXNoKCk7DQoJCQkJcmV0dXJuIGZhbHNlOw0KCQkJfSk7DQoNCgkJCS8vIGlmIHRoZXJlJ3MgYSBjdXJyZW50bHktYXBwbGllZCBmaWx0ZXIgaW5kZXgNCgkJCS8vIHJlLWFwcGx5IGl0IHNvIGl0J3MgcmVhZHkgZm9yIGFueSBtYW51YWwgcHVsbC10by1yZWZyZXNoZXMNCgkJCWlmKG9wdGlvbnMuY3VycmVudEZpbHRlckluZGV4KSB7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5hZGRSZWZyZXNoUGFyYW1ldGVyKCd3X2ZpbHRlckluZGV4Jywgb3B0aW9ucy5jdXJyZW50RmlsdGVySW5kZXgpOw0KCQkJfQ0KDQoJCQlpZiAob3B0aW9ucy5wb3N0VXJsKSB7DQoJCQkJdmFyIHBvc3RMaW5rID0gJCgnPGEgaHJlZj0iIyIgY2xhc3M9ImFkZCI+JyArIG9wdGlvbnMucG9zdExhYmVsICsgJzwvYT4nKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuY2xlYXJDb250ZW50KCk7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUubG9hZChvcHRpb25zLnBvc3RVcmwpOw0KCQkJCX0pOw0KCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2V0SGVhZGVyQnV0dG9uKHBvc3RMaW5rKTsNCgkJCX0NCg0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zY3JvbGxhYmxlKHsNCgkJCQlyZWdpb246ICdjb250ZW50JywNCgkJCQlsb2FkOiBmdW5jdGlvbihwYWdlSW5kZXgsIHN1Y2Nlc3MsIGVycm9yKSB7DQoJCQkJCXZhciBsYXN0RGF0ZSA9ICQob3B0aW9ucy53cmFwcGVyICsgJyBkaXYuZGF0YTpsYXN0JykuZGF0YSgnbGFzdG1lc3NhZ2VkYXRlJyk7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoew0KCQkJCQkJdXJsOiBvcHRpb25zLm1vcmVVcmwsDQoJCQkJCQlkYXRhOiB7DQoJCQkJCQkJRmlsdGVyVHlwZTogb3B0aW9ucy5maWx0ZXJUeXBlLA0KCQkJCQkJCUZpbHRlckluZGV4OiBvcHRpb25zLmN1cnJlbnRGaWx0ZXJJbmRleCwNCgkJCQkJCQlQYWdlU2l6ZTogb3B0aW9ucy5wYWdlU2l6ZSwNCgkJCQkJCQlFbmREYXRlOiBsYXN0RGF0ZSwNCgkJCQkJCQlHcm91cElkOiBvcHRpb25zLmdyb3VwSWQNCgkJCQkJCX0sDQoJCQkJCQlzdWNjZXNzOiBmdW5jdGlvbihyKSB7DQoJCQkJCQkJdmFyIHJlc3BvbnNlID0gJChyKSwNCgkJCQkJCQkJaGFzTm9SZWNvcmRzID0gcmVzcG9uc2UuZmluZCgnLm1lc3NhZ2Uubm9yZWNvcmRzOmZpcnN0JykubGVuZ3RoID4gMDsNCgkJCQkJCQlpZihoYXNOb1JlY29yZHMpIHsNCgkJCQkJCQkJc3VjY2VzcygpOw0KCQkJCQkJCX0gZWxzZSB7DQoJCQkJCQkJCXN1Y2Nlc3MocmVzcG9uc2UpOw0KCQkJCQkJCX0NCgkJCQkJCX0sDQoJCQkJCQllcnJvcjogZnVuY3Rpb24oKSB7DQoJCQkJCQkJZXJyb3IoKTsNCgkJCQkJCX0NCgkJCQkJfSkNCgkJCQl9LA0KCQkJCWNvbXBsZXRlOiBmdW5jdGlvbihjb250ZW50KSB7DQoJCQkJCWNvbnRlbnQgPSAkKGNvbnRlbnQpLmNzcyh7IG9wYWNpdHk6IDAgfSk7DQoJCQkJCSQob3B0aW9ucy53cmFwcGVyKS5maW5kKCdkaXYuc3RyZWFtJykuYXBwZW5kKGNvbnRlbnQpOw0KCQkJCQljb250ZW50LmV2b2x1dGlvblRyYW5zZm9ybSh7IG9wYWNpdHk6IDEgfSwgeyBkdXJhdGlvbjogNDAwIH0pOw0KCQkJCX0NCgkJCX0pOw0KCQl9DQoJfQ0KDQoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24gPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24gfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5hY3Rpdml0eVN0b3J5U3RyZWFtID0gYXBpOw0KDQp9KShqUXVlcnkpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:BlogList_Name}" version="7.0.0.1" description="" instanceIdentifier="e6cd209c87184394b6e2921019d204f6" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="blog-list">
    <contentScript>
		

#set ($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#set ($showSubGroups = $core_v2_widget.GetBoolValue('groupAndSubGroups', true))
#set ($pageSize = $core_v2_widget.GetIntValue('pageSize', 5))
#set ($pageIndex = 0)

#set($group = false)
#set($group = $core_v2_group.Get("%{Id=$groupId}"))
#if (!$group)
	$core_v2_widget.Hide()
#end

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($group.Url)"&gt;$group.Name&lt;/a&gt;
		&lt;h1&gt;$core_v2_language.GetResource('blogs')&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 40, 40, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
&lt;/div&gt;

&lt;div class="post-list blogs"&gt;
	$core_v2_widget.ExecuteFile('list.vm')
&lt;/div&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;

&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.blogList.register({
		moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
				wrapper: '#$core_v2_widget.WrapperElementId',
		pageSize: $pageSize,
			showSubGroups: '$showSubGroups'
		});
	});
})
&lt;/script&gt;
		
	</contentScript>
    <headerScript>
	</headerScript>
    <configuration>
		
&lt;propertyGroup id="options" resourceName="Options"&gt;
	&lt;property id="groupAndSubGroups" resourceName="groupAndSubGroups" dataType="bool" defaultValue="false" /&gt;
	&lt;property id="pageSize" resourceName="itemsToShow" dataType="int" defaultValue="5" /&gt;
&lt;/propertyGroup&gt;
		
	</configuration>
    <languageResources>
<language key="en-us">
	<resource name="BlogList_Name">Blog List</resource>
	<resource name="options">Options</resource>
	<resource name="itemsToShow">Number of results to display</resource>
	<resource name="groupAndSubGroups">Show data from Group and all Subgroups</resource>
	<resource name="blogs">Blogs</resource>
	<resource name="no_blogs">There were no blogs to display.</resource>
	<resource name="no_posts">No blog posts</resource>
	<resource name="post_count">{0} blog post</resource>
	<resource name="posts_count">{0} blog posts</resource>
	<resource name="NA">N/A</resource>
</language>
		</languageResources>
    <files>
      <file name="list.vm">I3NldCgkYmxvZ3MgPSBmYWxzZSkNCiNzZXQoJGJsb2dzID0gJGNvcmVfdjJfYmxvZy5MaXN0KCIle0dyb3VwSWQ9JGdyb3VwSWQsSW5jbHVkZVN1Ykdyb3Vwcz0kc2hvd1N1Ykdyb3VwcyxQYWdlSW5kZXg9JHBhZ2VJbmRleCxQYWdlU2l6ZT0kcGFnZVNpemV9IikpDQoNCiNmb3JlYWNoKCRibG9nIGluICRibG9ncykNCiNlYWNoDQoNCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gYmxvZyIgZGF0YS10YXJnZXR1cmw9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJGJsb2cuVXJsKSI+DQoJCTxkaXYgY2xhc3M9InBvc3Qgd2l0aG91dC1hdmF0YXIiPg0KCQkJPGRpdiBjbGFzcz0iZGV0YWlscyI+DQoJCQkJPGRpdiBjbGFzcz0iZGF0ZSI+I2lmKCRibG9nLlBvc3RDb3VudCA+IDApJHtjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdEFnb0RhdGUoJGJsb2cuTGF0ZXN0UG9zdERhdGUpfSNlbHNlJHtjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdOQScpfSNlbmQNCgkJCQk8L2Rpdj4NCgkJCTwvZGl2Pg0KCQkJPGRpdiBjbGFzcz0iY29udGVudCI+DQoJCQkJPGEgaHJlZj0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkYmxvZy5VcmwpIj4kYmxvZy5OYW1lPC9hPg0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJhY3Rpb25zIj4NCgkJCQk8dWw+DQoJCQkJCTxsaT4NCgkJCQkJCTxkaXYgY2xhc3M9ImRldGFpbCBibG9ncG9zdHMiPg0KCQkJCQkJCSNpZiAoJGJsb2cuUG9zdENvdW50ID09IDApDQoJCQkJCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdub19wb3N0cycpDQoJCQkJCQkJI2Vsc2VpZiAoJGJsb2cuUG9zdENvdW50ID09IDEpDQoJCQkJCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdFN0cmluZygkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgncG9zdF9jb3VudCcpLCAkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXROdW1iZXIoJGJsb2cuUG9zdENvdW50KSkNCgkJCQkJCQkjZWxzZQ0KCQkJCQkJCQkkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRTdHJpbmcoJGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ3Bvc3RzX2NvdW50JyksICRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdE51bWJlcigkYmxvZy5Qb3N0Q291bnQpKQ0KCQkJCQkJCSNlbmQNCgkJCQkJCTwvZGl2Pg0KCQkJCQk8L2xpPg0KCQkJCTwvdWw+DQoJCQk8L2Rpdj4NCgkJPC9kaXY+DQoJPC9kaXY+DQoNCiNub2RhdGENCgk8ZGl2IGlkPSIke2NvcmVfdjJfd2lkZ2V0LldyYXBwZXJFbGVtZW50SWR9X21lc3NhZ2Vfbm9yZWNvcmRzIj48ZGl2IGNsYXNzPSJtZXNzYWdlIG5vcmVjb3JkcyI+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ25vX2Jsb2dzJyk8L2Rpdj48L2Rpdj4NCiNhZnRlcmFsbA0KCSNzZXQgKCRoYXNNb3JlID0gZmFsc2UpDQoJI2lmICgkYmxvZ3MuVG90YWxDb3VudCA+ICgoJGJsb2dzLlBhZ2VJbmRleCArIDEpICogJGJsb2dzLlBhZ2VTaXplKSkNCgkJI3NldCgkaGFzTW9yZSA9IHRydWUpDQoJI2VuZA0KCTxkaXYgY2xhc3M9ImRhdGEiICNpZigkaGFzTW9yZSlkYXRhLWhhc21vcmU9InRydWUiI2VuZD48L2Rpdj4NCiNlbmQNCg==</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBibG9ncw0KIyMNCiNzZXQgKCRwYWdlSW5kZXggPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlSW50KCRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnUGFnZUluZGV4JykpKQ0KI3NldCAoJHBhZ2VTaXplID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUludCgkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ1BhZ2VTaXplJykpKQ0KI3NldCAoJGdyb3VwSWQgPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlSW50KCRtb2JpbGVfdjFfdXJsVG9rZW4uVmFsdWUoJ0dyb3VwSWQnKSkpDQojc2V0ICgkc2hvd1N1Ykdyb3VwcyA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VCb29sKCRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnU2hvd1N1Ykdyb3VwcycpKSkNCg0KJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCdsaXN0LnZtJyk=</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2Nyb2xsYWJsZSh7DQoJCQkJcmVnaW9uOiAnY29udGVudCcsDQoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgew0KCQkJCQlpZiAoJChvcHRpb25zLndyYXBwZXIgKyAnIGRpdi5kYXRhOmxhc3QnKS5kYXRhKCdoYXNtb3JlJykpIHsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoew0KCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLA0KCQkJCQkJCWRhdGE6IHsNCgkJCQkJCQkJUGFnZVNpemU6IG9wdGlvbnMucGFnZVNpemUsDQoJCQkJCQkJCVBhZ2VJbmRleDogcGFnZUluZGV4LA0KCQkJCQkJCQlTaG93U3ViR3JvdXBzOiBvcHRpb25zLnNob3dTdWJHcm91cHMNCgkJCQkJCQl9LA0KCQkJCQkJCXN1Y2Nlc3M6IGZ1bmN0aW9uKHIpIHsNCgkJCQkJCQkJc3VjY2VzcyhyKTsNCgkJCQkJCQl9LA0KCQkJCQkJCWVycm9yOiBmdW5jdGlvbigpIHsNCgkJCQkJCQkJZXJyb3IoKTsNCgkJCQkJCQl9DQoJCQkJCQl9KTsNCgkJCQkJfSBlbHNlIHsNCgkJCQkJCXN1Y2Nlc3MoKTsNCgkJCQkJfQ0KCQkJCX0sDQoJCQkJY29tcGxldGU6IGZ1bmN0aW9uKGNvbnRlbnQpIHsNCgkJCQkJY29udGVudCA9ICQoY29udGVudCkuY3NzKHsgb3BhY2l0eTogMCB9KTsNCgkJCQkJJChvcHRpb25zLndyYXBwZXIpLmZpbmQoJ2Rpdi5wb3N0LWxpc3QnKS5hcHBlbmQoY29udGVudCk7DQoJCQkJCWNvbnRlbnQuZXZvbHV0aW9uVHJhbnNmb3JtKHsgb3BhY2l0eTogMSB9LCB7IGR1cmF0aW9uOiA0MDAgfSk7DQoJCQkJfQ0KCQkJfSk7DQoJCX0NCgl9DQoNCgkkLnRlbGxpZ2VudCA9ICQudGVsbGlnZW50IHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyA9ICQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzLmJsb2dMaXN0ID0gYXBpOw0KDQp9KShqUXVlcnkpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:BlogPost_Name}" version="7.0.0.1" description="" instanceIdentifier="4f1a3378c9f84f129702bef3fab4eefc" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="blogpost">
    <contentScript>
		
#set($postId = false)
#set($postId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('BlogPostId')))
#set($post = $core_v2_blogPost.Get("%{Id = $postId}"))
#if (!$post)
	$core_v2_widget.Hide()
#end
#set($blog = $core_v2_blog.Get("%{Id = $post.BlogId}"))

#set ($accessingUser = $core_v2_user.Accessing)
#set ($accessingUserIsRegistered = false)
#if ($core_v2_user.IsRegistered($accessingUser.Id))
	#set ($accessingUserIsRegistered = true)
#end

&lt;div class="post topic full"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($blog.Group.Url)"&gt;$blog.Group.Name&lt;/a&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($blog.Url)"&gt;$blog.Name&lt;/a&gt;
	&lt;/div&gt;
	&lt;h1&gt;$post.Title&lt;/h1&gt;
	&lt;div class="details"&gt;
		&lt;div class="date"&gt;$core_v2_language.FormatAgoDate($post.PublishedDate)&lt;/div&gt;
		&lt;div class="avatar"&gt;
			#if ($post.Author.ProfileUrl)
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($post.Author.ProfileUrl)" class="internal-link view-user-profile"&gt;
					$core_v2_ui.GetResizedImageHtml($post.Author.AvatarUrl, 24, 24, "%{border='0', alt=$post.Author.DisplayName, ResizeMethod='ZoomAndCrop',border='0'}")
				&lt;/a&gt;
			#else
				$core_v2_ui.GetResizedImageHtml($post.Author.AvatarUrl, 24, 24, "%{border='0', alt=$post.Author.DisplayName, ResizeMethod='ZoomAndCrop',border='0'}")
			#end
		&lt;/div&gt;
		&lt;div class="author"&gt;
			#if ($post.Author.ProfileUrl)
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($post.Author.ProfileUrl)" class="internal-link view-user-profile"&gt;
					$post.Author.DisplayName
				&lt;/a&gt;
			#else
				$post.Author.DisplayName
			#end
		&lt;/div&gt;
	&lt;/div&gt;
	&lt;div class="content user-generated-content"&gt;
		$mobile_v1_dataFormat.Detect($post.Body('Web'))
		#if ($post.File)
			&lt;p&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($post.File.FileUrl)" class="internal-link download-attachment"&gt;$post.File.FileName&lt;/a&gt;&lt;/p&gt;
		#end
	&lt;/div&gt;

	#set ($canEditBlogPost = false)
	#set ($canEditBlogPost = $core_v2_nodePermission.Get("blogs", $post.BlogId, "Blog_ModifyPost").IsAllowed)

	#set ($canDeleteBlogPost = false)
	#set ($canDeleteBlogPost = $core_v2_nodePermission.Get("blogs", $post.BlogId, "Blog_DeletePost").IsAllowed)

	#set($showLikes = false)
	#if($accessingUserIsRegistered &amp;&amp; $core_v2_like.CanLike($post.ContentId, $core_v2_blogPost.ContentTypeId))
		#set($showLikes = true)
	#end

	&lt;div class="actions ui-links" data-maxlinks="#if($showLikes)1#else 0#end"&gt;
			#if ($showLikes)
				&lt;li class="action-like"&gt;
					#set($format = '{toggle} &lt;span class="count"&gt;&lt;span class="icon"&gt;&lt;/span&gt;{count}&lt;/span&gt;')
					$core_v2_ui.Like($post.ContentId, $core_v2_blogPost.ContentTypeId, "%{ Format = $format }")
				&lt;/li&gt;
			#end

			#if ($canEditBlogPost)
				&lt;li&gt;
					&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('blogpost-edit', $post.Id))"&gt;$core_v2_language.GetResource('edit')&lt;/a&gt;
				&lt;/li&gt;
			#end
			#if ($canDeleteBlogPost)
				&lt;li&gt;
					&lt;a href="#" data-messagename="blogpost.delete"&gt;$core_v2_language.GetResource('delete')&lt;/a&gt;
				&lt;/li&gt;
			#end

			#if ($accessingUserIsRegistered &amp;&amp; $core_v2_bookmark.CanBookmark($post.ContentId, $core_v2_blogPost.ContentTypeId))
				&lt;li class="action-bookmark"&gt;
					$core_v2_ui.Bookmark($post.ContentId, $core_v2_blogPost.ContentTypeId)
				&lt;/li&gt;
			#end&gt;
			&lt;li class="action-moderate"&gt;$core_v2_ui.Moderate($post.ContentId, $core_v2_blogPost.ContentTypeId)&lt;/li&gt;

			&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;&lt;/a&gt;&lt;/li&gt;
			&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
	&lt;/div&gt;
&lt;/div&gt;

$mobile_v1_ui.Comments($post.ContentId, $core_v2_blogPost.ContentTypeId, "%{ CanFlagAsAbusive = $accessingUserIsRegistered, AccessingUserId = $accessingUser.Id }")

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.blogPost.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			blogUrl: '$core_v2_encoding.JavascriptEncode($blog.Url)',
			blogId: '$blog.Id',
			postId: '$post.Id',
			postDeleteConfirmation: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post_delete_confirmation'))'
		});
	});
})
&lt;/script&gt;

		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="BlogPost_Name">Blog Post</resource>
		<resource name="edit">Edit</resource>
		<resource name="delete">Delete</resource>
		<resource name="cancel">Cancel</resource>
		<resource name="post_delete_confirmation">Are you sure you want to delete this post?</resource>
	  </language>
	</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIG1vZGVsID0gew0KCQlkZWxldGVQb3N0OiBmdW5jdGlvbiAoYmxvZ0lkLCBwb3N0SWQpIHsNCgkJCXJldHVybiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uZGVsKHsNCgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi9ibG9ncy97QmxvZ0lkfS9wb3N0cy97UG9zdElkfS5qc29uJywNCgkJCQlkYXRhOiB7DQoJCQkJCUJsb2dJZDogYmxvZ0lkLA0KCQkJCQlQb3N0SWQ6IHBvc3RJZA0KCQkJCX0NCgkJCX0pOw0KCQl9DQoJfQ0KDQoJZnVuY3Rpb24gaGFuZGxlQmxvZ1Bvc3REZWxldGlvbkV2ZW50cyhvcHRpb25zKSB7DQoJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tZXNzYWdpbmcuc3Vic2NyaWJlKCdibG9ncG9zdC5kZWxldGUnLCBmdW5jdGlvbiAoZGF0YSkgew0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlU2hlZXQoKTsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuY29uZmlybShvcHRpb25zLnBvc3REZWxldGVDb25maXJtYXRpb24sIGZ1bmN0aW9uIChjb25maXJtZWQpIHsNCgkJCQlpZiAoY29uZmlybWVkKSB7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcobW9kZWwuZGVsZXRlUG9zdChvcHRpb25zLmJsb2dJZCwgb3B0aW9ucy5wb3N0SWQpKQ0KCQkJCQkJLmRvbmUoZnVuY3Rpb24gKCkgew0KCQkJCQkJCS8vIG5hdmlnYXRlIGJhY2sgdG8gdGhlIGRlbGV0ZWQgcG9zdCdzIGJsb2csIGNsZWFyaW5nIGl0cyBjYWNoZQ0KCQkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUubG9hZChvcHRpb25zLmJsb2dVcmwsIHsgcmVmcmVzaDogdHJ1ZSB9KTsNCgkJCQkJCX0pOw0KCQkJCX0NCgkJCX0pOw0KCQl9KTsNCgl9DQoNCgl2YXIgYXBpID0gew0KCQlyZWdpc3RlcjogZnVuY3Rpb24gKG9wdGlvbnMpIHsNCgkJCWhhbmRsZUJsb2dQb3N0RGVsZXRpb25FdmVudHMob3B0aW9ucyk7DQoJCX0NCgl9DQoNCgkkLnRlbGxpZ2VudCA9ICQudGVsbGlnZW50IHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyA9ICQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzLmJsb2dQb3N0ID0gYXBpOw0KDQp9KShqUXVlcnkpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:BlogPostList_Name}" version="7.0.0.1" description="" instanceIdentifier="42d200b69fd4471b8e7dabce5fa81806" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="blogpost-list">
    <contentScript>
		

#set($pageSize = $core_v2_widget.GetIntValue('pageSize', 5))
#set($pageIndex = 0)


#set($blogId = false)
#set($blogId = $mobile_v1_urlToken.Value('BlogId'))

#if ($blogId)
	#set($blogId = $core_v2_utility.ParseInt($blogId))
	#set($blog = false)
	#set($blog = $core_v2_blog.Get("%{Id = $blogId}"))
	#if (!$blog)
		$core_v2_widget.Hide()
	#end

	#set($contextUrl = $blog.Group.Url)
	#set($contextName = $blog.Group.Name)
	#set($avatarUrl = $blog.Group.AvatarUrl)
	#set($name = $blog.Name)
#else
	#set($userId = false)
	#set($userId = $mobile_v1_urlToken.Value('UserId'))
	#if (!$userId)
		$core_v2_widget.Hide()
	#end

	#set($userId =$core_v2_utility.ParseInt($userId))
	#set ($user = false)
	#set ($user = $core_v2_user.Get("%{ Id = $userId }"))
	#if (!$user)
		$core_v2_widget.Hide()
	#end

	#set($contextUrl = $user.ProfileUrl)
	#set($contextName = $user.DisplayName)
	#set($avatarUrl = $user.AvatarUrl)
	#set($name = $core_v2_language.FormatString($core_v2_language.GetResource('Core_UserBlogPosts_Title'), $user.DisplayName))
#end


&lt;div class="banner condensed with-avatar"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($contextUrl)"&gt;$!contextName&lt;/a&gt;
		&lt;h1&gt;$!name&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($avatarUrl, 40, 40, "%{ alt = $contextName, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
	#if ($blog)
		&lt;div class="ui-links actions" data-maxlinks="0"&gt;
			&lt;ul&gt;
				#set ($bookmarkableContentId = $blog.ApplicationId)
				#set ($bookmarkableContentTypeId = $core_v2_blog.ContentTypeId)
				#if ($core_v2_bookmark.SupportsBookmarks($bookmarkableContentTypeId) &amp;&amp; $core_v2_bookmark.CanBookmark($bookmarkableContentId, $bookmarkableContentTypeId) &amp;&amp; $core_v2_bookmark.CanUnBookmark($bookmarkableContentId, $bookmarkableContentTypeId))
					&lt;li&gt;$core_v2_ui.Bookmark($bookmarkableContentId, $bookmarkableContentTypeId)&lt;/li&gt;
				#end
				&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;$core_v2_language.GetResource('more')&lt;/a&gt;&lt;/li&gt;
				&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
			&lt;/ul&gt;
		&lt;/div&gt;
	#end
&lt;/div&gt;


## load and render blog posts
&lt;div class="post-list blogposts"&gt;
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.blogPostList.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
			pageSize: $pageSize
		});

		#if($blogId &amp;&amp; $core_v2_nodePermission.Get("blogs", $blogId, "Blog_CreatePost").IsAllowed)
			jQuery.telligent.evolution.mobile.setHeaderButton(jQuery('&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('blog-addblogpost', $blogId))" class="add"&gt;$core_v2_language.GetResource('post')&lt;/a&gt;'));
		#end
	});
})

&lt;/script&gt;

</contentScript>
    <headerScript>
		</headerScript>
    <configuration>
		
		&lt;propertyGroup id="options"&gt;
			&lt;property id="pageSize" dataType="int" defaultValue="5" /&gt;
		&lt;/propertyGroup&gt;
		
	</configuration>
    <languageResources>
		<language key="en-us">
			<resource name="BlogPostList_Name">Blog Post List</resource>
			<resource name="no_posts">There are no posts in this blog.</resource>
			<resource name="no_comments">No comments</resource>
			<resource name="comment_count">1 comment</resource>
			<resource name="comments_count">{0} comments</resource>
			<resource name="post">New</resource>
			<resource name="Core_UserBlogPosts_Title">Blog Posts</resource>
			<resource name="more">More</resource>
			<resource name="cancel">Cancel</resource>
		</language>
	</languageResources>
    <files>
      <file name="list.vm">I3NldCAoJGFjY2Vzc2luZ1VzZXIgPSAkY29yZV92Ml91c2VyLkFjY2Vzc2luZykNCiNzZXQgKCRhY2Nlc3NpbmdVc2VySXNSZWdpc3RlcmVkID0gZmFsc2UpDQojaWYgKCRjb3JlX3YyX3VzZXIuSXNSZWdpc3RlcmVkKCRhY2Nlc3NpbmdVc2VyLklkKSkNCgkjc2V0ICgkYWNjZXNzaW5nVXNlcklzUmVnaXN0ZXJlZCA9IHRydWUpDQojZW5kDQoNCiNzZXQoJHF1ZXJ5ID0gIiV7UGFnZUluZGV4PSRwYWdlSW5kZXgsUGFnZVNpemU9JHBhZ2VTaXplLFNvcnRCeT0nTW9zdFJlY2VudCcsU29ydE9yZGVyPSdEZXNjZW5kaW5nJ30iKQ0KI2lmICgkYmxvZ0lkKQ0KCSRxdWVyeS5BZGQoJ0Jsb2dJZCcsICRibG9nSWQpDQojZWxzZWlmICgkdXNlcklkKQ0KCSRxdWVyeS5BZGQoJ0F1dGhvcklkJywgJHVzZXJJZCkNCgkkcXVlcnkuQWRkKCdHcm91cElkJywgJGNvcmVfdjJfZ3JvdXAuUm9vdC5JZCkNCgkkcXVlcnkuQWRkKCdJbmNsdWRlU3ViR3JvdXBzJywgdHJ1ZSkNCiNlbHNlDQoJJGNvcmVfdjJfd2lkZ2V0LkhpZGUoKQ0KI2VuZA0KDQoNCiNzZXQoJHBvc3RzID0gJGNvcmVfdjJfYmxvZ1Bvc3QuTGlzdCgkcXVlcnkpKQ0KDQojZm9yZWFjaCgkcG9zdCBpbiAkcG9zdHMpDQojZWFjaA0KCTxkaXYgY2xhc3M9InBvc3QtbGlzdC1pdGVtIGNvbnRlbnQtaXRlbSBibG9ncG9zdCIgZGF0YS10YXJnZXR1cmw9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJHBvc3QuVXJsKSI+DQoJCTxkaXYgY2xhc3M9InBvc3QiPg0KCQkJPGRpdiBjbGFzcz0iYXZhdGFyIj4NCgkJCQkjaWYgKCRwb3N0LkF1dGhvci5Qcm9maWxlVXJsKQ0KCQkJCQkJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJHBvc3QuQXV0aG9yLlByb2ZpbGVVcmwpIiBjbGFzcz0iaW50ZXJuYWwtbGluayB2aWV3LXVzZXItcHJvZmlsZSI+DQoJCQkJCQkJCSRjb3JlX3YyX3VpLkdldFJlc2l6ZWRJbWFnZUh0bWwoJHBvc3QuQXV0aG9yLkF2YXRhclVybCwgNDAsIDQwLCAiJXtib3JkZXI9JzAnLCBhbHQ9JHBvc3QuQXV0aG9yLkRpc3BsYXlOYW1lLCBSZXNpemVNZXRob2Q9J1pvb21BbmRDcm9wJyxib3JkZXI9JzAnfSIpDQoJCQkJCQkJPC9hPg0KCQkJCQkJI2Vsc2UNCgkJCQkJCQkkY29yZV92Ml91aS5HZXRSZXNpemVkSW1hZ2VIdG1sKCRwb3N0LkF1dGhvci5BdmF0YXJVcmwsIDQwLCA0MCwgIiV7Ym9yZGVyPScwJywgYWx0PSRwb3N0LkF1dGhvci5EaXNwbGF5TmFtZSwgUmVzaXplTWV0aG9kPSdab29tQW5kQ3JvcCcsYm9yZGVyPScwJ30iKQ0KCQkJCQkJI2VuZA0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJkZXRhaWxzIj4NCgkJCQk8ZGl2IGNsYXNzPSJkYXRlIj4kY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRBZ29EYXRlKCRwb3N0LlB1Ymxpc2hlZERhdGUpPC9kaXY+DQoJCQk8L2Rpdj4NCgkJCTxkaXYgY2xhc3M9ImNvbnRlbnQiPg0KCQkJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJHBvc3QuVXJsKSI+JHBvc3QuVGl0bGU8L2E+DQoJCQk8L2Rpdj4NCgkJCTxkaXYgY2xhc3M9ImFjdGlvbnMgdWktbGlua3MiPg0KCQkJCTx1bD4NCgkJCQkJI2lmICgkYWNjZXNzaW5nVXNlcklzUmVnaXN0ZXJlZCAmJiAkY29yZV92Ml9saWtlLkNhbkxpa2UoJHBvc3QuQ29udGVudElkLCAkY29yZV92Ml9ibG9nUG9zdC5Db250ZW50VHlwZUlkKSkNCgkJCQkJCTxsaSBjbGFzcz0iYWN0aW9uLWxpa2UiPg0KCQkJCQkJCSNzZXQoJGZvcm1hdCA9ICd7dG9nZ2xlfSA8c3BhbiBjbGFzcz0iY291bnQiPjxzcGFuIGNsYXNzPSJpY29uIj48L3NwYW4+e2NvdW50fTwvc3Bhbj4nKQ0KCQkJCQkJCSRjb3JlX3YyX3VpLkxpa2UoJHBvc3QuQ29udGVudElkLCAkY29yZV92Ml9ibG9nUG9zdC5Db250ZW50VHlwZUlkLCAiJXsgRm9ybWF0ID0gJGZvcm1hdCB9IikNCgkJCQkJCTwvbGk+DQoJCQkJCSNlbmQNCg0KCQkJCQk8bGkgY2xhc3M9ImFjdGlvbi1jb21tZW50Ij4NCgkJCQkJCTxhIGNsYXNzPSJpbnRlcm5hbC1saW5rIGNvbW1lbnQiIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJHBvc3QuVXJsKSI+DQoJCQkJCQkJI2lmICgkcG9zdC5Db21tZW50Q291bnQgPT0gMCkNCgkJCQkJCQkJJGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ25vX2NvbW1lbnRzJykNCgkJCQkJCQkjZWxzZWlmICgkcG9zdC5Db21tZW50Q291bnQgPT0gMSkNCgkJCQkJCQkJJGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0U3RyaW5nKCRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdjb21tZW50X2NvdW50JyksICRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdE51bWJlcigkcG9zdC5Db21tZW50Q291bnQpKQ0KCQkJCQkJCSNlbHNlDQoJCQkJCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdFN0cmluZygkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnY29tbWVudF9jb3VudCcpLCAkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXROdW1iZXIoJHBvc3QuQ29tbWVudENvdW50KSkNCgkJCQkJCQkjZW5kDQoJCQkJCQk8L2E+DQoJCQkJCTwvbGk+DQoJCQkJPC91bD4NCgkJCTwvZGl2Pg0KCQk8L2Rpdj4NCgk8L2Rpdj4NCiNub2RhdGENCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gYmxvZyI+PGRpdiBjbGFzcz0ibWVzc2FnZSBub3JlY29yZHMiPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdub19wb3N0cycpPC9kaXY+PC9kaXY+DQojYWZ0ZXJhbGwNCgkjc2V0ICgkaGFzTW9yZSA9IGZhbHNlKQ0KCSNpZiAoJHBvc3RzLlRvdGFsQ291bnQgPiAoKCRwb3N0cy5QYWdlSW5kZXggKyAxKSAqICRwb3N0cy5QYWdlU2l6ZSkpDQoJCSNzZXQoJGhhc01vcmUgPSB0cnVlKQ0KCSNlbmQNCgk8ZGl2IGNsYXNzPSJkYXRhIiAjaWYoJGhhc01vcmUpZGF0YS1oYXNtb3JlPSJ0cnVlIiNlbmQ+PC9kaXY+DQojZW5k</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBibG9nIHBvc3RzDQojIw0KI3NldCAoJHBhZ2VJbmRleCA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19wYWdlSW5kZXgnKSkNCiNzZXQgKCRwYWdlU2l6ZSA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19wYWdlU2l6ZScpKQ0KDQojc2V0KCRibG9nSWQgPSBmYWxzZSkNCiNzZXQoJGJsb2dJZCA9ICRtb2JpbGVfdjFfdXJsVG9rZW4uVmFsdWUoJ0Jsb2dJZCcpKQ0KI2lmICgkYmxvZ0lkKQ0KCSNzZXQoJGJsb2dJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJGJsb2dJZCkpDQojZWxzZQ0KCSNzZXQoJHVzZXJJZCA9IGZhbHNlKQ0KCSNzZXQoJHVzZXJJZCA9ICRtb2JpbGVfdjFfdXJsVG9rZW4uVmFsdWUoJ1VzZXJJZCcpKQ0KCSNpZiAoJHVzZXJJZCkNCgkJI3NldCgkdXNlcklkID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUludCgkdXNlcklkKSkNCgkjZWxzZQ0KCQkkY29yZV92Ml93aWRnZXQuSGlkZSgpDQoJI2VuZA0KI2VuZA0KJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCdsaXN0LnZtJykNCg==</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2Nyb2xsYWJsZSh7DQoJCQkJcmVnaW9uOiAnY29udGVudCcsDQoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgew0KCQkJCQlpZiAoJChvcHRpb25zLndyYXBwZXIgKyAnIGRpdi5kYXRhOmxhc3QnKS5kYXRhKCdoYXNtb3JlJykpIHsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoew0KCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLA0KCQkJCQkJCWRhdGE6IHsNCgkJCQkJCQkJd19wYWdlSW5kZXg6IHBhZ2VJbmRleCwNCgkJCQkJCQkJd19wYWdlU2l6ZTogb3B0aW9ucy5wYWdlU2l6ZQ0KCQkJCQkJCX0sDQoJCQkJCQkJc3VjY2VzczogZnVuY3Rpb24ocikgew0KCQkJCQkJCQlzdWNjZXNzKHIpOw0KCQkJCQkJCX0sDQoJCQkJCQkJZXJyb3I6IGZ1bmN0aW9uKCkgew0KCQkJCQkJCQllcnJvcigpOw0KCQkJCQkJCX0NCgkJCQkJCX0pOw0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJc3VjY2VzcygpOw0KCQkJCQl9DQoJCQkJfSwNCgkJCQljb21wbGV0ZTogZnVuY3Rpb24oY29udGVudCkgew0KCQkJCQljb250ZW50ID0gJChjb250ZW50KS5jc3MoeyBvcGFjaXR5OiAwIH0pOw0KCQkJCQkkKG9wdGlvbnMud3JhcHBlcikuZmluZCgnZGl2LnBvc3QtbGlzdCcpLmFwcGVuZChjb250ZW50KTsNCgkJCQkJY29udGVudC5ldm9sdXRpb25UcmFuc2Zvcm0oeyBvcGFjaXR5OiAxIH0sIHsgZHVyYXRpb246IDQwMCB9KTsNCgkJCQl9DQoJCQl9KTsNCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMuYmxvZ1Bvc3RMaXN0ID0gYXBpOw0KDQp9KShqUXVlcnkpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:Conversation_Name}" version="7.0.0.1" description="" instanceIdentifier="607b7626a40345c38821ae6a76b9ff47" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="conversation">
    <contentScript>
		
#set($conversationId = false)
#set($conversationId = $core_v2_utility.ParseGuid($mobile_v1_urlToken.Value('ConversationId')))
#if (!$conversationId)
	$core_v2_widget.Hide()
#end

#set($conversation = $core_v2_conversation.Get($conversationId))
&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('conversations'))"&gt;$core_v2_language.GetResource('conversations')&lt;/a&gt;
		&lt;h1&gt;$conversation.FirstMessage.Subject&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="description"&gt;
#foreach ($participant in $conversation.Participants)
#beforeall
$core_v2_language.GetResource('participants_before')
#each
&lt;a href="$core_v2_encoding.HtmlAttributeEncode($participant.Url)"&gt;$participant.DisplayName&lt;/a&gt;
#between
$core_v2_language.GetResource('participants_between')
#afterall
$core_v2_language.GetResource('participants_after')
#end
	&lt;/div&gt;
&lt;/div&gt;

&lt;div class="post-list messages"&gt;
	#set($pageIndex = 0)
	#set($messages = $core_v2_conversationMessage.List($conversationId, "%{PageSize=5,PageIndex=$pageIndex}"))
	#set($lastPageIndex = $messages.TotalCount / 5)
	#if ($lastPageIndex * 5 &gt;= $messages.TotalCount)
		#set($lastPageIndex = $lastPageIndex - 1)
	#end
	#set($pageIndex = $lastPageIndex)
	#if ($pageIndex &gt;= 1)
		#set($messages = false)
	#end

	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;
&lt;div class="reply-form"&gt;
	&lt;fieldset&gt;
		&lt;div class="form-field"&gt;
			&lt;textarea placeholder="$core_v2_language.GetResource('reply_placeholder')"&gt;&lt;/textarea&gt;
		&lt;/div&gt;
	&lt;/fieldset&gt;
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.conversation.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
			replyUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('reply.vm'))',
			conversationsUrl: '$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('conversations'))',
			conversationId: '$conversationId.ToString()',
			deleteConfirmation: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('conversation_delete_confirmation'))',
			replyText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('reply'))',
			deleteText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('delete'))',
			conversationNotificationTypeId: '$core_v2_conversationMessage.NotificationTypeId.ToString()',
			conversationId: '$conversationId.ToString()',
			getLatestUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('get-latest.vm'))'
		});
	});
})
&lt;/script&gt;
		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="Conversation_Name">Conversation</resource>
		<resource name="conversations">Inbox</resource>
		<resource name="delete">Delete</resource>
		<resource name="conversation_delete_confirmation">Are you sure you want to delete this conversation?</resource>
		<resource name="message_load_more">Load more messages...</resource>
		<resource name="reply_placeholder">Reply...</resource>
		<resource name="reply">Reply</resource>
		<resource name="participants_before">with </resource>
		<resource name="participants_between">, </resource>
		<resource name="participants_after"></resource>
	  </language>
	</languageResources>
    <files>
      <file name="get-latest.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBtZXNzYWdlcw0KIyMNCg0KI3NldCAoJGFjY2Vzc2luZ1VzZXIgPSAkY29yZV92Ml91c2VyLkFjY2Vzc2luZykNCiNzZXQgKCRhY2Nlc3NpbmdVc2VySXNSZWdpc3RlcmVkID0gZmFsc2UpDQojaWYgKCRjb3JlX3YyX3VzZXIuSXNSZWdpc3RlcmVkKCRhY2Nlc3NpbmdVc2VyLklkKSkNCiAgICAjc2V0ICgkYWNjZXNzaW5nVXNlcklzUmVnaXN0ZXJlZCA9IHRydWUpDQojZW5kDQoNCiNzZXQoJGNvbnZlcnNhdGlvbklkID0gZmFsc2UpDQojc2V0KCRjb252ZXJzYXRpb25JZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VHdWlkKCRtb2JpbGVfdjFfdXJsVG9rZW4uVmFsdWUoJ0NvbnZlcnNhdGlvbklkJykpKQ0KI2lmICghJGNvbnZlcnNhdGlvbklkKQ0KCSRjb3JlX3YyX3dpZGdldC5IaWRlKCkNCiNlbmQNCg0KI3NldCgkbWVzc2FnZXMgPSAkY29yZV92Ml9jb252ZXJzYXRpb25NZXNzYWdlLkxpc3QoJGNvbnZlcnNhdGlvbklkLCAiJXtQYWdlU2l6ZT01LFBhZ2VJbmRleD0wfSIpKQ0KI3NldCgkbGFzdFBhZ2VJbmRleCA9ICRtZXNzYWdlcy5Ub3RhbENvdW50IC8gNSkNCiNpZiAoJGxhc3RQYWdlSW5kZXggKiA1ID49ICRtZXNzYWdlcy5Ub3RhbENvdW50KQ0KCSNzZXQoJGxhc3RQYWdlSW5kZXggPSAkbGFzdFBhZ2VJbmRleCAtIDEpDQojZW5kDQojc2V0KCRwYWdlSW5kZXggPSAkbGFzdFBhZ2VJbmRleCkNCiNpZiAoJHBhZ2VJbmRleCA+PSAxKQ0KCSNzZXQoJG1lc3NhZ2VzID0gJGNvcmVfdjJfY29udmVyc2F0aW9uTWVzc2FnZS5MaXN0KCRjb252ZXJzYXRpb25JZCwgIiV7UGFnZVNpemU9NSxQYWdlSW5kZXg9JHBhZ2VJbmRleH0iKSkNCiNlbmQNCg0KI2ZvcmVhY2goJG1lc3NhZ2UgaW4gJG1lc3NhZ2VzKQ0KI2VhY2gNCgkkY29yZV92Ml93aWRnZXQuRXhlY3V0ZUZpbGUoJ3JlbmRlci1yZXBseS52bScpDQojZW5kDQoNCg==</file>
      <file name="list.vm">I2lmICghJG1lc3NhZ2VzKQ0KCSNzZXQoJG1lc3NhZ2VzID0gJGNvcmVfdjJfY29udmVyc2F0aW9uTWVzc2FnZS5MaXN0KCRjb252ZXJzYXRpb25JZCwgIiV7UGFnZVNpemU9NSxQYWdlSW5kZXg9JHBhZ2VJbmRleH0iKSkNCiNlbmQNCiNpZiAoJHBhZ2VJbmRleCA+IDApDQoJI3NldCgkdGFyZ2V0UGFnZUluZGV4ID0gJHBhZ2VJbmRleCAtIDEpDQoJPGEgaHJlZj0iIyIgZGF0YS1wYWdlaW5kZXg9IiR0YXJnZXRQYWdlSW5kZXgiIGNsYXNzPSJ2aWV3LW1vcmUiPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdtZXNzYWdlX2xvYWRfbW9yZScpPC9hPg0KI2VuZA0KI2ZvcmVhY2goJG1lc3NhZ2UgaW4gJG1lc3NhZ2VzKQ0KI2VhY2gNCgkkY29yZV92Ml93aWRnZXQuRXhlY3V0ZUZpbGUoJ3JlbmRlci1yZXBseS52bScpDQojZW5k</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBtZXNzYWdlcw0KIyMNCg0KI3NldCAoJGFjY2Vzc2luZ1VzZXIgPSAkY29yZV92Ml91c2VyLkFjY2Vzc2luZykNCiNzZXQgKCRhY2Nlc3NpbmdVc2VySXNSZWdpc3RlcmVkID0gZmFsc2UpDQojaWYgKCRjb3JlX3YyX3VzZXIuSXNSZWdpc3RlcmVkKCRhY2Nlc3NpbmdVc2VyLklkKSkNCiAgICAjc2V0ICgkYWNjZXNzaW5nVXNlcklzUmVnaXN0ZXJlZCA9IHRydWUpDQojZW5kDQoNCiNzZXQgKCRwYWdlSW5kZXggPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfcGFnZUluZGV4JykpDQojc2V0KCRjb252ZXJzYXRpb25JZCA9IGZhbHNlKQ0KI3NldCgkY29udmVyc2F0aW9uSWQgPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlR3VpZCgkbW9iaWxlX3YxX3VybFRva2VuLlZhbHVlKCdDb252ZXJzYXRpb25JZCcpKSkNCiNpZiAoISRjb252ZXJzYXRpb25JZCkNCgkkY29yZV92Ml93aWRnZXQuSGlkZSgpDQojZW5kDQoNCiNzZXQoJG1lc3NhZ2VzID0gZmFsc2UpDQoNCiRjb3JlX3YyX3dpZGdldC5FeGVjdXRlRmlsZSgnbGlzdC52bScp</file>
      <file name="render-reply.vm">PGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIG1lc3NhZ2UiIGRhdGEtcmVwbHlpZD0iJG1lc3NhZ2UuSWQuVG9TdHJpbmcoKSI+DQoJPGRpdiBjbGFzcz0icG9zdCBmdWxsIj4NCgkJPGRpdiBjbGFzcz0iZGV0YWlscyI+DQoJCQk8ZGl2IGNsYXNzPSJkYXRlIj4kY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRBZ29EYXRlKCRtZXNzYWdlLkNyZWF0ZWREYXRlKTwvZGl2Pg0KCQkJPGRpdiBjbGFzcz0iYXZhdGFyIj4NCgkJCQkjaWYgKCRtZXNzYWdlLkF1dGhvci5Qcm9maWxlVXJsKQ0KICAgICAgICAgICAgCQkJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJG1lc3NhZ2UuQXV0aG9yLlByb2ZpbGVVcmwpIiBjbGFzcz0iaW50ZXJuYWwtbGluayB2aWV3LXVzZXItcHJvZmlsZSI+DQogICAgICAgICAgICAgICAgCQkJCSRjb3JlX3YyX3VpLkdldFJlc2l6ZWRJbWFnZUh0bWwoJG1lc3NhZ2UuQXV0aG9yLkF2YXRhclVybCwgMjQsIDI0LCAiJXtib3JkZXI9JzAnLCBhbHQ9JG1lc3NhZ2UuQXV0aG9yLkRpc3BsYXlOYW1lLCBSZXNpemVNZXRob2Q9J1pvb21BbmRDcm9wJyxib3JkZXI9JzAnfSIpDQogICAgICAgICAgICAJCQkJPC9hPg0KICAgICAgICAJCQkjZWxzZQ0KICAgICAgICAgICAgCQkJCSRjb3JlX3YyX3VpLkdldFJlc2l6ZWRJbWFnZUh0bWwoJG1lc3NhZ2UuQXV0aG9yLkF2YXRhclVybCwgMjQsIDI0LCAiJXtib3JkZXI9JzAnLCBhbHQ9JG1lc3NhZ2UuQXV0aG9yLkRpc3BsYXlOYW1lLCBSZXNpemVNZXRob2Q9J1pvb21BbmRDcm9wJyxib3JkZXI9JzAnfSIpDQogICAgICAgIAkJCSNlbmQNCgkJCTwvZGl2Pg0KCQkJPGRpdiBjbGFzcz0iYXV0aG9yIj4NCgkJCQkjaWYgKCRtZXNzYWdlLkF1dGhvci5Qcm9maWxlVXJsKQ0KCQkgICAgICAgICAgICAJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJG1lc3NhZ2UuQXV0aG9yLlByb2ZpbGVVcmwpIiBjbGFzcz0iaW50ZXJuYWwtbGluayB2aWV3LXVzZXItcHJvZmlsZSI+DQoJCSAgICAgICAgICAgICAgICAJCSRtZXNzYWdlLkF1dGhvci5EaXNwbGF5TmFtZQ0KCQkgICAgICAgICAgICAJCTwvYT4NCgkJICAgICAgICAJI2Vsc2UNCgkJICAgICAgICAgICAgCQkkbWVzc2FnZS5BdXRob3IuRGlzcGxheU5hbWUNCgkJICAgICAgICAJI2VuZA0KCQkJPC9kaXY+DQoJCTwvZGl2Pg0KCQk8ZGl2IGNsYXNzPSJjb250ZW50IHVzZXItZ2VuZXJhdGVkLWNvbnRlbnQiPg0KCQkJJG1lc3NhZ2UuUmVuZGVyZWRCb2R5DQoJCTwvZGl2Pg0KCTwvZGl2Pg0KPC9kaXY+</file>
      <file name="reply.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgdG8gYWRkIGEgcmVwbHkNCiMjDQoNCiRjb3JlX3YyX3BhZ2UuU2V0Q29udGVudFR5cGUoJ2FwcGxpY2F0aW9uL2pzb24nKQ0KDQojc2V0KCRjb252ZXJzYXRpb25JZCA9IGZhbHNlKQ0KI3NldCgkY29udmVyc2F0aW9uSWQgPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlR3VpZCgkbW9iaWxlX3YxX3VybFRva2VuLlZhbHVlKCdDb252ZXJzYXRpb25JZCcpKSkNCiNpZiAoISRjb252ZXJzYXRpb25JZCkNCgkkY29yZV92Ml9wYWdlLlNlbmRKc29uRXJyb3IoJ1RoZSBzcGVjaWZpZWQgY29udmVyc2F0aW9uIGNvdWxkIG5vdCBiZSBkZXRlcm1pbmVkJykNCiNlbmQNCg0KI3NldCgkYm9keSA9ICRjb3JlX3YyX3VpLkZvcm1hdFRleHRBc0h0bWwoJGNvcmVfdjJfcGFnZS5HZXRGb3JtVmFsdWUoJ0JvZHknKSwgIiV7Q29udmVydFRvUGFyYWdyYXBocz0ndHJ1ZScsIERldGVjdE1lZGlhVXJscz0ndHJ1ZSd9IikpDQoNCiNzZXQoJHJlc3BvbnNlID0gJGNvcmVfdjJfY29udmVyc2F0aW9uTWVzc2FnZS5DcmVhdGUoJGNvbnZlcnNhdGlvbklkLCAkYm9keSwgIiV7fSIpKQ0KI2lmICgkcmVzcG9uc2UuRXJyb3JzLkNvdW50ID4gMCkNCgkkY29yZV92Ml9wYWdlLlNlbmRKc29uRXJyb3IoJHJlc3BvbnNlLkVycm9ycykNCiNlbHNlDQoJeyJzdWNjZXNzIjoidHJ1ZSJ9DQojZW5k</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIG1vZGVsID0gew0KCQlkZWxldGVDb252ZXJzYXRpb246IGZ1bmN0aW9uKGNvbnZlcnNhdGlvbklkKSB7DQoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygkLnRlbGxpZ2VudC5ldm9sdXRpb24uZGVsKHsNCgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi9jb252ZXJzYXRpb25zL3tDb252ZXJzYXRpb25JZH0uanNvbicsDQoJCQkJZGF0YTogew0KCQkJCQlDb252ZXJzYXRpb25JZDogY29udmVyc2F0aW9uSWQNCgkJCQl9DQoJCQl9KSk7DQoJCX0sDQoJCWFkZE1lc3NhZ2U6IGZ1bmN0aW9uKHJlcGx5VXJsLCBjb252ZXJzYXRpb25JZCwgdGV4dCkgew0KCQkJcmV0dXJuICQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnBvc3Qoew0KCQkJCXVybDogcmVwbHlVcmwsDQoJCQkJZGF0YTogew0KCQkJCQlDb252ZXJzYXRpb25JZDogY29udmVyc2F0aW9uSWQsDQoJCQkJCUJvZHk6IHRleHQNCgkJCQl9DQoJCQl9KSk7DQoJCX0sDQoJCWdldExhdGVzdE1lc3NhZ2VzOiBmdW5jdGlvbihsYXRlc3RNZXNzYWdlVXJsKSB7DQoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsNCgkJCQl1cmw6IGxhdGVzdE1lc3NhZ2VVcmwsDQoJCQkJY2FjaGU6IGZhbHNlDQoJCQl9KSk7DQoJCX0sDQoJCW1hcmtBc1JlYWQ6IGZ1bmN0aW9uKGNvbnZlcnNhdGlvbklkKSB7DQoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7DQoJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvY29udmVyc2F0aW9ucy97Q29udmVyc2F0aW9uSWR9L3JlYWQuanNvbicsDQoJCQkJZGF0YTogew0KCQkJCQlDb252ZXJzYXRpb25JZDogY29udmVyc2F0aW9uSWQsDQoJCQkJCUhhc1JlYWQ6ICdUcnVlJw0KCQkJCX0NCgkJCX0pOw0KCQl9LA0KCQlsb2FkTW9yZTogZnVuY3Rpb24obW9yZVVybCwgcGFnZUluZGV4KSB7DQoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsNCgkJCQl1cmw6IG1vcmVVcmwsDQoJCQkJZGF0YTogew0KCQkJCQl3X3BhZ2VJbmRleDogcGFnZUluZGV4DQoJCQkJfQ0KCQkJfSkpOw0KCQl9DQoJfQ0KDQoJZnVuY3Rpb24gcmVuZGVyTGF0ZXN0TWVzc2FnZXMod3JhcHBlciwgbWVzc2FnZXMpIHsNCgkJdmFyIHAgPSAkKHdyYXBwZXIgKyAnIC5wb3N0LWxpc3QubWVzc2FnZXMnKTsNCgkJJCgnPGRpdj4nICsgbWVzc2FnZXMgKyAnPC9kaXY+JykuZmluZCgnLnBvc3QtbGlzdC1pdGVtLm1lc3NhZ2UnKS5lYWNoKGZ1bmN0aW9uKCkgew0KCQkJdmFyIHBhcmVudCA9ICQodGhpcyk7DQoJCQl2YXIgcmVwbHlJZCA9IHBhcmVudC5kYXRhKCdyZXBseWlkJyk7DQoJCQlpZiAocC5maW5kKCcucG9zdC1saXN0LWl0ZW0ubWVzc2FnZVtkYXRhLXJlcGx5aWQ9IicgKyByZXBseUlkICsgJyJdJykubGVuZ3RoID09IDApIHsNCgkJCQlwLmFwcGVuZChwYXJlbnQpOw0KCQkJfQ0KCQl9KTsNCgl9DQoNCglmdW5jdGlvbiBoYW5kbGVEZWxldGVFdmVudChvcHRpb25zKSB7DQoJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuY29uZmlybShvcHRpb25zLmRlbGV0ZUNvbmZpcm1hdGlvbiwgZnVuY3Rpb24oY29uZmlybWVkKSB7DQoJCQlpZiAoY29uZmlybWVkKSB7DQoJCQkJbW9kZWwuZGVsZXRlQ29udmVyc2F0aW9uKG9wdGlvbnMuY29udmVyc2F0aW9uSWQpDQoJCQkJCS5kb25lKGZ1bmN0aW9uKCl7DQoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmxvYWQob3B0aW9ucy5jb252ZXJzYXRpb25zVXJsKTsNCgkJCQkJfSk7DQoJCQl9DQoJCX0pOw0KCX0NCg0KCWZ1bmN0aW9uIGhhbmRsZVJlcGx5RXZlbnQob3B0aW9ucykgew0KCQl2YXIgaW5wdXQgPSAkKG9wdGlvbnMud3JhcHBlciArICcgLnJlcGx5LWZvcm0gdGV4dGFyZWEnKTsNCgkJaWYgKGlucHV0LnZhbCgpLmxlbmd0aCA+IDApIHsNCgkJCWlucHV0LmJsdXIoKTsNCgkJCW1vZGVsLmFkZE1lc3NhZ2Uob3B0aW9ucy5yZXBseVVybCwgb3B0aW9ucy5jb252ZXJzYXRpb25JZCwgaW5wdXQudmFsKCkpDQoJCQkJLmRvbmUoZnVuY3Rpb24oKSB7DQoJCQkJCWlucHV0LnZhbCgnJyk7DQoJCQkJCW1vZGVsLmdldExhdGVzdE1lc3NhZ2VzKG9wdGlvbnMuZ2V0TGF0ZXN0VXJsKS50aGVuKGZ1bmN0aW9uKHIpew0KCQkJCQkJcmVuZGVyTGF0ZXN0TWVzc2FnZXMob3B0aW9ucy53cmFwcGVyLCByKTsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuY29udGVudFNjcm9sbFRvcChpbnB1dC5nZXQoMCkpOw0KCQkJCQl9KQ0KCQkJCX0pOw0KCQl9DQoJfQ0KDQoJZnVuY3Rpb24gaW5pdFBhZ2luZyhvcHRpb25zKSB7DQoJCSQob3B0aW9ucy53cmFwcGVyKS5vbigndGFwJywgJy5wb3N0LWxpc3QubWVzc2FnZXMgYS52aWV3LW1vcmUnLCBmdW5jdGlvbihlKSB7DQoJCQl2YXIgbCA9ICQodGhpcyk7DQoJCQl2YXIgcGkgPSBwYXJzZUludChsLmRhdGEoJ3BhZ2VpbmRleCcpLCAxMCk7DQoJCQlpZiAoaXNOYU4ocGkpKSB7DQoJCQkJcmV0dXJuOw0KCQkJfQ0KDQoJCQltb2RlbC5sb2FkTW9yZShvcHRpb25zLm1vcmVVcmwsIHBpKS5kb25lKGZ1bmN0aW9uKHIpew0KCQkJCXZhciB0b3AgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmNvbnRlbnRTY3JvbGxUb3AoKTsNCgkJCQl2YXIgbGlzdCA9IGwucGFyZW50cygnLnBvc3QtbGlzdC5tZXNzYWdlcycpOw0KCQkJCXZhciBoID0gbGlzdC5vdXRlckhlaWdodCgpOw0KCQkJCWwuYmVmb3JlKHIpOw0KCQkJCWwuaGlkZSgpOw0KCQkJCXRvcCA9IHRvcCArIGxpc3Qub3V0ZXJIZWlnaHQoKSAtIGg7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5jb250ZW50U2Nyb2xsVG9wKHRvcCk7DQoJCQl9KTsNCg0KCQkJcmV0dXJuIGZhbHNlOw0KCQl9KTsNCgl9DQoNCgl2YXIgYXBpID0gew0KCQlyZWdpc3RlcjogZnVuY3Rpb24ob3B0aW9ucykgew0KDQoJCQlpbml0UGFnaW5nKG9wdGlvbnMpOw0KDQoJCQl2YXIgZGVsZXRlTGluayA9ICQoJzxhIGhyZWY9IiMiPicgKyBvcHRpb25zLmRlbGV0ZVRleHQgKyAnPC9hPicpOw0KCQkJZGVsZXRlTGluay5vbignY2xpY2snLCBmdW5jdGlvbigpIHsNCgkJCQloYW5kbGVEZWxldGVFdmVudChvcHRpb25zKTsNCgkJCX0pOw0KDQoJCQl2YXIgcmVwbHlMaW5rID0gJCgnPGEgaHJlZj0iIyI+JyArIG9wdGlvbnMucmVwbHlUZXh0ICsgJzwvYT4nKTsNCgkJCXJlcGx5TGluay5vbignY2xpY2snLCBmdW5jdGlvbigpIHsNCgkJCQloYW5kbGVSZXBseUV2ZW50KG9wdGlvbnMpOw0KCQkJfSk7DQoNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2V0SGVhZGVyQnV0dG9uKGRlbGV0ZUxpbmspOw0KCQkJJChvcHRpb25zLndyYXBwZXIgKyAnIC5yZXBseS1mb3JtIHRleHRhcmVhJykNCgkJCQkub24oJ2ZvY3VzJywgZnVuY3Rpb24oKSB7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2V0SGVhZGVyQnV0dG9uKHJlcGx5TGluayk7DQoJCQkJfSkNCgkJCQkub24oJ2JsdXInLCBmdW5jdGlvbigpIHsNCgkJCQkJd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7DQoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNldEhlYWRlckJ1dHRvbihkZWxldGVMaW5rKTsNCgkJCQkJfSwgMjQ5KTsNCgkJCQl9KTsNCg0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ25vdGlmaWNhdGlvbi5yYWlzZWQnLCBmdW5jdGlvbihkKSB7DQoJCQkJaWYgKGQudHlwZUlkID09IG9wdGlvbnMuY29udmVyc2F0aW9uTm90aWZpY2F0aW9uVHlwZUlkICYmIGQuY29udGVudElkID09IG9wdGlvbnMuY29udmVyc2F0aW9uSWQpIHsNCgkJCQkJbW9kZWwuZ2V0TGF0ZXN0TWVzc2FnZXMob3B0aW9ucy5nZXRMYXRlc3RVcmwpLnRoZW4oZnVuY3Rpb24ocil7DQoJCQkJCQlyZW5kZXJMYXRlc3RNZXNzYWdlcyhvcHRpb25zLndyYXBwZXIsIHIpOw0KCQkJCQl9KTsNCgkJCQkJbW9kZWwubWFya0FzUmVhZChkLmNvbnRlbnRJZCkudGhlbihmdW5jdGlvbihyKXsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tZXNzYWdpbmcucHVibGlzaCgnbm90aWZpY2F0aW9uLnJlYWQnLCB7DQoJCQkJCQkJdHlwZUlkOiBvcHRpb25zLmNvbnZlcnNhdGlvbk5vdGlmaWNhdGlvblR5cGVJZCwNCgkJCQkJCQl1bnJlYWRDb3VudDogJy09MScNCgkJCQkJCX0pOw0KCQkJCQl9KTsNCgkJCQl9DQoJCQl9KTsNCg0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5jb250ZW50U2Nyb2xsVG9wKCQob3B0aW9ucy53cmFwcGVyICsgJyAucmVwbHktZm9ybScpLm9mZnNldCgpLnRvcCk7DQoJCX0NCgl9DQoNCgkkLnRlbGxpZ2VudCA9ICQudGVsbGlnZW50IHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyA9ICQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzLmNvbnZlcnNhdGlvbiA9IGFwaTsNCg0KfSkoalF1ZXJ5KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:ConversationList_Name}" version="7.0.0.1" description="" instanceIdentifier="5bf0e5f843ca4cd8a69bbab3ac7a6629" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="conversation-list">
    <contentScript>
		
&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;h1&gt;$core_v2_language.GetResource('conversations')&lt;/h1&gt;
	&lt;/div&gt;
&lt;/div&gt;

## load and render threads
&lt;div class="post-list conversations"&gt;
	#set($pageIndex = 0)
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.conversationList.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
			notificationTypeId: '$core_v2_encoding.JavascriptEncode($core_v2_conversationMessage.NotificationTypeId.ToString())',
			newConversationUrl: '$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('conversation-add'))',
			newConversationLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('new_conversation'))'
		});
	});
})
&lt;/script&gt;
		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="ConversationList_Name">Conversation List</resource>
		<resource name="conversations">Inbox</resource>
		<resource name="no_conversations">There are no messages in your inbox.</resource>
		<resource name="no_messages">No messages</resource>
		<resource name="message_count">{0} message</resource>
		<resource name="messages_count">{0} messages</resource>
		<resource name="participants_before">with </resource>
	  </language>
	</languageResources>
    <files>
      <file name="list.vm">I3NldCAoJGFjY2Vzc2luZ1VzZXIgPSAkY29yZV92Ml91c2VyLkFjY2Vzc2luZykNCiNzZXQgKCRhY2Nlc3NpbmdVc2VySXNSZWdpc3RlcmVkID0gZmFsc2UpDQojaWYgKCRjb3JlX3YyX3VzZXIuSXNSZWdpc3RlcmVkKCRhY2Nlc3NpbmdVc2VyLklkKSkNCgkjc2V0ICgkYWNjZXNzaW5nVXNlcklzUmVnaXN0ZXJlZCA9IHRydWUpDQojZW5kDQoNCiNzZXQoJGNvbnZlcnNhdGlvbnMgPSAkY29yZV92Ml9jb252ZXJzYXRpb24uTGlzdCgiJXtQYWdlSW5kZXg9JHBhZ2VJbmRleCxQYWdlU2l6ZT03fSIpKQ0KI2ZvcmVhY2goJGNvbnZlcnNhdGlvbiBpbiAkY29udmVyc2F0aW9ucykNCiNlYWNoDQoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIGNvbnZlcnNhdGlvbiAjaWYgKCEkY29udmVyc2F0aW9uLkhhc1JlYWQpIHVucmVhZCNlbmQiIGRhdGEtdGFyZ2V0dXJsPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRjb252ZXJzYXRpb24uVXJsKSIgZGF0YS1jb252ZXJzYXRpb25pZD0iJGNvbnZlcnNhdGlvbi5JZC5Ub1N0cmluZygpIj4NCgkJPGRpdiBjbGFzcz0icG9zdCI+DQoJCQk8ZGl2IGNsYXNzPSJhdmF0YXIiPg0KCQkJCSNpZiAoJGNvbnZlcnNhdGlvbi5GaXJzdE1lc3NhZ2UuQXV0aG9yLlByb2ZpbGVVcmwpDQoJCQkJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJGNvbnZlcnNhdGlvbi5GaXJzdE1lc3NhZ2UuQXV0aG9yLlByb2ZpbGVVcmwpIiBjbGFzcz0iaW50ZXJuYWwtbGluayB2aWV3LXVzZXItcHJvZmlsZSI+DQoJCQkJCQkkY29yZV92Ml91aS5HZXRSZXNpemVkSW1hZ2VIdG1sKCRjb252ZXJzYXRpb24uRmlyc3RNZXNzYWdlLkF1dGhvci5BdmF0YXJVcmwsIDQwLCA0MCwgIiV7Ym9yZGVyPScwJywgYWx0PSRjb252ZXJzYXRpb24uRmlyc3RNZXNzYWdlLkF1dGhvci5EaXNwbGF5TmFtZSwgUmVzaXplTWV0aG9kPSdab29tQW5kQ3JvcCcsYm9yZGVyPScwJ30iKQ0KCQkJCQk8L2E+DQoJCQkJI2Vsc2UNCgkJCQkJJGNvcmVfdjJfdWkuR2V0UmVzaXplZEltYWdlSHRtbCgkY29udmVyc2F0aW9uLkZpcnN0TWVzc2FnZS5BdXRob3IuQXZhdGFyVXJsLCA0MCwgNDAsICIle2JvcmRlcj0nMCcsIGFsdD0kY29udmVyc2F0aW9uLkZpcnN0TWVzc2FnZS5BdXRob3IuRGlzcGxheU5hbWUsIFJlc2l6ZU1ldGhvZD0nWm9vbUFuZENyb3AnLGJvcmRlcj0nMCd9IikNCgkJCQkjZW5kDQoJCQk8L2Rpdj4NCgkJCTxkaXYgY2xhc3M9ImRldGFpbHMiPg0KCQkJCTxkaXYgY2xhc3M9ImRhdGUiPiRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdEFnb0RhdGUoJGNvbnZlcnNhdGlvbi5MYXN0TWVzc2FnZS5DcmVhdGVkRGF0ZSk8L2Rpdj4NCgkJCTwvZGl2Pg0KCQkJPGRpdiBjbGFzcz0iY29udGVudCI+DQoJCQkJPGEgaHJlZj0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkY29udmVyc2F0aW9uLlVybCkiPiRjb252ZXJzYXRpb24uRmlyc3RNZXNzYWdlLlN1YmplY3Q8L2E+DQoJCQkJI3NldCAoJERRID0gJyInKQ0KCQkJCSNzZXQgKCRhdXRob3JzID0gIiIpDQoJCQkJI2ZvcmVhY2ggKCRwYXJ0aWNpcGFudCBpbiAkY29udmVyc2F0aW9uLlBhcnRpY2lwYW50cykNCgkJCQkjYmVmb3JlYWxsDQoJCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdwYXJ0aWNpcGFudHNfYmVmb3JlJykNCgkJCQkjZWFjaA0KCQkJCQkjc2V0ICgkYXV0aG9ycyA9ICIkYXV0aG9yczxhIGhyZWY9JHtEUX0kY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRwYXJ0aWNpcGFudC5Qcm9maWxlVXJsKSR7RFF9PiRwYXJ0aWNpcGFudC5EaXNwbGF5TmFtZTwvYT4iKQ0KCQkJCSNiZXR3ZWVuDQoJCQkJCSNzZXQgKCRhdXRob3JzID0gIiRhdXRob3JzLCAiKQ0KCQkJCSNlbmQNCgkJCQkkYXV0aG9ycw0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJhY3Rpb25zIHVpLWxpbmtzIj4NCgkJCQk8dWw+DQoJCQkJCTxsaT4NCgkJCQkJCTxzcGFuIGNsYXNzPSJkZXRhaWwgY29tbWVudCI+DQoJCQkJCQkJI2lmICgkY29udmVyc2F0aW9uLk1lc3NhZ2VDb3VudCA9PSAwKQ0KCQkJCQkJCQkkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbm9fbWVzc2FnZXMnKQ0KCQkJCQkJCSNlbHNlaWYgKCRjb252ZXJzYXRpb24uTWVzc2FnZUNvdW50ID09IDEpDQoJCQkJCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdFN0cmluZygkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbWVzc2FnZV9jb3VudCcpLCAkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXROdW1iZXIoJGNvbnZlcnNhdGlvbi5NZXNzYWdlQ291bnQpKQ0KCQkJCQkJCSNlbHNlDQoJCQkJCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdFN0cmluZygkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbWVzc2FnZXNfY291bnQnKSwgJGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0TnVtYmVyKCRjb252ZXJzYXRpb24uTWVzc2FnZUNvdW50KSkNCgkJCQkJCQkjZW5kDQoJCQkJCQk8L3NwYW4+DQoJCQkJCTwvbGk+DQoJCQkJPC91bD4NCgkJCTwvZGl2Pg0KCQk8L2Rpdj4NCgk8L2Rpdj4NCiNub2RhdGENCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gY29udmVyc2F0aW9uIj48ZGl2IGNsYXNzPSJtZXNzYWdlIG5vcmVjb3JkcyI+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ25vX2NvbnZlcnNhdGlvbnMnKTwvZGl2PjwvZGl2Pg0KI2FmdGVyYWxsDQoJI3NldCAoJGhhc01vcmUgPSBmYWxzZSkNCgkjaWYgKCRjb252ZXJzYXRpb25zLlRvdGFsQ291bnQgPiAoKCRjb252ZXJzYXRpb25zLlBhZ2VJbmRleCArIDEpICogJGNvbnZlcnNhdGlvbnMuUGFnZVNpemUpKQ0KCQkjc2V0KCRoYXNNb3JlID0gdHJ1ZSkNCgkjZW5kDQoJPGRpdiBjbGFzcz0iZGF0YSIgI2lmKCRoYXNNb3JlKWRhdGEtaGFzbW9yZT0idHJ1ZSIjZW5kPjwvZGl2Pg0KI2VuZA==</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBjb252ZXJzYXRpb25zDQojIw0KI3NldCAoJHBhZ2VJbmRleCA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19wYWdlSW5kZXgnKSkNCiRjb3JlX3YyX3dpZGdldC5FeGVjdXRlRmlsZSgnbGlzdC52bScpDQo=</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCSQob3B0aW9ucy53cmFwcGVyKS5vbigndGFwJywgJ2Rpdi5jb252ZXJzYXRpb24nLCBmdW5jdGlvbihlKXsNCgkJCQl2YXIgbiA9ICQodGhpcyk7DQoJCQkJaWYgKG4uaGFzQ2xhc3MoJ3VucmVhZCcpKSB7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5wdXQoew0KCQkJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvY29udmVyc2F0aW9ucy97Q29udmVyc2F0aW9uSWR9L3JlYWQuanNvbicsDQoJCQkJCQlkYXRhOiB7DQoJCQkJCQkJQ29udmVyc2F0aW9uSWQ6IG4uZGF0YSgnY29udmVyc2F0aW9uaWQnKSwNCgkJCQkJCQlIYXNSZWFkOiAnVHJ1ZScNCgkJCQkJCX0sDQoJCQkJCQlzdWNjZXNzOiBmdW5jdGlvbihyKSB7DQoJCQkJCQkJbi5yZW1vdmVDbGFzcygndW5yZWFkJyk7DQoJCQkJCQkJalF1ZXJ5LnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnB1Ymxpc2goJ25vdGlmaWNhdGlvbi5yZWFkJywgew0KCQkJCQkJCQl0eXBlSWQ6IG9wdGlvbnMubm90aWZpY2F0aW9uVHlwZUlkLA0KCQkJCQkJCQl1bnJlYWRDb3VudDogJy09MScNCgkJCQkJCQl9KTsNCgkJCQkJCX0NCgkJCQkJfSk7DQoJCQkJCS8vIGZvcmNlIGEgcmVsb2FkIG9mIHRoaXMgcGFnZSBvbiBuZXh0IHZpZXcgdG8gaW5kaWNhdGUgcmVhZCBzdGF0ZQ0KCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmNsZWFyQ29udGVudCgpOw0KCQkJCX0NCgkJCX0pOw0KDQoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNjcm9sbGFibGUoew0KCQkJCXJlZ2lvbjogJ2NvbnRlbnQnLA0KCQkJCWxvYWQ6IGZ1bmN0aW9uKHBhZ2VJbmRleCwgc3VjY2VzcywgZXJyb3IpIHsNCgkJCQkJaWYgKCQob3B0aW9ucy53cmFwcGVyICsgJyBkaXYuZGF0YTpsYXN0JykuZGF0YSgnaGFzbW9yZScpKSB7DQoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsNCgkJCQkJCQl1cmw6IG9wdGlvbnMubW9yZVVybCwNCgkJCQkJCQlkYXRhOiB7DQoJCQkJCQkJCXdfcGFnZUluZGV4OiBwYWdlSW5kZXgNCgkJCQkJCQl9LA0KCQkJCQkJCXN1Y2Nlc3M6IGZ1bmN0aW9uKHIpIHsNCgkJCQkJCQkJc3VjY2VzcyhyKTsNCgkJCQkJCQl9LA0KCQkJCQkJCWVycm9yOiBmdW5jdGlvbigpIHsNCgkJCQkJCQkJZXJyb3IoKTsNCgkJCQkJCQl9DQoJCQkJCQl9KTsNCgkJCQkJfSBlbHNlIHsNCgkJCQkJCXN1Y2Nlc3MoKTsNCgkJCQkJfQ0KCQkJCX0sDQoJCQkJY29tcGxldGU6IGZ1bmN0aW9uKGNvbnRlbnQpIHsNCgkJCQkJY29udGVudCA9ICQoY29udGVudCkuY3NzKHsgb3BhY2l0eTogMCB9KTsNCgkJCQkJJChvcHRpb25zLndyYXBwZXIpLmZpbmQoJ2Rpdi5wb3N0LWxpc3QnKS5hcHBlbmQoY29udGVudCk7DQoJCQkJCWNvbnRlbnQuZXZvbHV0aW9uVHJhbnNmb3JtKHsgb3BhY2l0eTogMSB9LCB7IGR1cmF0aW9uOiA0MDAgfSk7DQoJCQkJfQ0KCQkJfSk7DQoNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tZXNzYWdpbmcuc3Vic2NyaWJlKCdub3RpZmljYXRpb24ucmFpc2VkJywgZnVuY3Rpb24oZCkgew0KCQkJCWlmIChkLnR5cGVJZCAhPSBvcHRpb25zLm5vdGlmaWNhdGlvblR5cGVJZCkgew0KCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnJlZnJlc2goKTsNCgkJCQl9DQoJCQl9KTsNCg0KCQkJdmFyIG5ld0xpbmsgPSAkKCc8YSBocmVmPSInICsgb3B0aW9ucy5uZXdDb252ZXJzYXRpb25VcmwgKyAnIiBjbGFzcz0iYWRkIj4nICsgb3B0aW9ucy5uZXdDb252ZXJzYXRpb25MYWJlbCArICc8L2E+Jyk7DQoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNldEhlYWRlckJ1dHRvbihuZXdMaW5rKTsNCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMuY29udmVyc2F0aW9uTGlzdCA9IGFwaTsNCg0KfSkoalF1ZXJ5KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:CreateConversation_Name}" version="7.0.0.1" description="" instanceIdentifier="e87b6c2fb05a48718565338e6f5243d2" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="create-conversation">
    <contentScript>
			
#set($userId = false)
#set($userId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('UserId')))
#if (!$userId)
	$core_v2_widget.Hide()
#end

#set($user = false)
#set($user = $core_v2_user.Get("%{Id=$userId}"))
#if ($user &amp;&amp; !$core_v2_urls.AddConversation($userId))
	&lt;div class="message error"&gt;
		$core_v2_language.GetResource('message_not_allowed')
	&lt;/div&gt;
#end

#set ($bodyId = $core_v2_widget.UniqueId('Body'))
#set ($subjectId = $core_v2_widget.UniqueId('Subject'))
#set ($recipientsId = $core_v2_widget.UniqueId('Recipients'))

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('conversations'))"&gt;$core_v2_language.GetResource('conversations')&lt;/a&gt;
		&lt;h1&gt;$core_v2_language.GetResource('create_conversation')&lt;/h1&gt;
	&lt;/div&gt;
&lt;/div&gt;
&lt;fieldset&gt;

	## Participants
	&lt;div class="form-field username lookup"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;$core_v2_language.GetResource('participants')&lt;/label&gt;
		&lt;input type="text" id="$core_v2_encoding.HtmlAttributeEncode($recipientsId)" value="#if ($user)$user.Username#end" /&gt;
	&lt;/div&gt;

	## Subject
	&lt;div class="form-field text"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($subjectId)"&gt;$core_v2_language.GetResource('subject')&lt;/label&gt;
		&lt;input type="text" maxlength="256" id="$core_v2_encoding.HtmlAttributeEncode($subjectId)" /&gt;
	&lt;/div&gt;

	## Body
	&lt;div class="form-field textarea"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;$core_v2_language.GetResource('body')&lt;/label&gt;
		&lt;textarea id="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;&lt;/textarea&gt;
	&lt;/div&gt;
&lt;/fieldset&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.createConversation.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			addConversationUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('add-conversation.vm'))',
			lookupUserUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('lookup-user.vm'))',
			bodyInput: '#$core_v2_encoding.JavascriptEncode($bodyId)',
			recipientInput: '#$core_v2_encoding.JavascriptEncode($recipientsId)',
			subjectInput: '#$core_v2_encoding.JavascriptEncode($subjectId)',
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			selectedUserDisplayName:#if($user) '$core_v2_encoding.JavascriptEncode($user.DisplayName)'#else null#end,
			userLookupLoadingText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('participants_loading'))',
			noUserMatchesText:'$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('participants_nomatch'))'
		});

		jQuery.telligent.evolution.mobile.refreshable(false);
		jQuery.telligent.evolution.mobile.excludeFromHistory();
	});
})
&lt;/script&gt;
		
		</contentScript>
    <languageResources>
		  <language key="en-us">
			<resource name="CreateConversation_Name">Create Conversation</resource>
			<resource name="conversations">Inbox</resource>
			<resource name="subject">Subject</resource>
			<resource name="body">Message</resource>
			<resource name="participants">Send to</resource>
			<resource name="post">Send</resource>
			<resource name="message_not_allowed">The person you attempted to send a message to does not accept messages.</resource>
			<resource name="participants_loading">Finding matching people...</resource>
			<resource name="participants_nomatch">No matches accepting messages could be found</resource>
			<resource name="create_conversation">New private message</resource>
		  </language>
		</languageResources>
    <files>
      <file name="add-conversation.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgdG8gYWRkIGEgY29udmVyc2F0aW9uDQojIw0KDQokY29yZV92Ml9wYWdlLlNldENvbnRlbnRUeXBlKCdhcHBsaWNhdGlvbi9qc29uJykNCg0KI3NldCgkYm9keSA9ICRjb3JlX3YyX3VpLkZvcm1hdFRleHRBc0h0bWwoJGNvcmVfdjJfcGFnZS5HZXRGb3JtVmFsdWUoJ0JvZHknKSwgIiV7Q29udmVydFRvUGFyYWdyYXBocz0ndHJ1ZScsIERldGVjdE1lZGlhVXJscz0ndHJ1ZSd9IikpDQoNCiNzZXQoJHJlc3BvbnNlID0gJGNvcmVfdjJfY29udmVyc2F0aW9uLkNyZWF0ZSgkY29yZV92Ml9wYWdlLkdldEZvcm1WYWx1ZSgnU3ViamVjdCcpLCAkYm9keSwgJGNvcmVfdjJfcGFnZS5HZXRGb3JtVmFsdWUoJ1BhcnRpY2lwYW50cycpKSkNCiNpZiAoJHJlc3BvbnNlLkVycm9ycy5Db3VudCA+IDApDQoJJGNvcmVfdjJfcGFnZS5TZW5kSnNvbkVycm9yKCRyZXNwb25zZS5FcnJvcnMpDQojZWxzZQ0KCXsiY29udmVyc2F0aW9uVXJsIjoiJGNvcmVfdjJfZW5jb2RpbmcuSmF2YXNjcmlwdEVuY29kZSgkcmVzcG9uc2UuVXJsKSJ9DQojZW5k</file>
      <file name="lookup-user.vm">I3NldCgkc2VhcmNoVGV4dCA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19TZWFyY2hUZXh0JykpDQoNCiNzZXQoJGxvd2VyZWRTZWFyY2hUZXh0ID0gIiRjb3JlX3YyX2xhbmd1YWdlLkxvd2VyY2FzZSgkc2VhcmNoVGV4dCkqIikNCiNzZXQoJHF1ZXJ5ID0gJycpDQojc2V0KCR0b2tlbkNvdW50ID0gMCkNCiNmb3JlYWNoKCR0b2tlbiBpbiAkY29yZV92Ml91dGlsaXR5LlNwbGl0KCcgJywgJHNlYXJjaFRleHQpKQ0KCSNpZiAoJHRva2VuICYmICR0b2tlbi5MZW5ndGggPiAwKQ0KCQkjaWYgKCR0b2tlbkNvdW50ID4gMCkNCgkJCSNzZXQoJHF1ZXJ5ID0gIiRxdWVyeSBBTkQgIikNCgkJI2VuZA0KCQkjc2V0KCRxdWVyeSA9ICIke3F1ZXJ5fSR7Y29yZV92Ml9sYW5ndWFnZS5Mb3dlcmNhc2UoJHRva2VuKX0qIikNCgkJI3NldCgkdG9rZW5Db3VudCA9ICR0b2tlbkNvdW50ICsgMSkNCgkjZW5kDQojZW5kDQojaWYgKCR0b2tlbkNvdW50ID4gMSkNCgkjc2V0KCRxdWVyeSA9ICJ1c2VybmFtZTooJHF1ZXJ5KSBPUiB0aXRsZWxvb2t1cDooJHF1ZXJ5KSIpDQojZWxzZQ0KCSNzZXQoJHF1ZXJ5ID0gInVzZXJuYW1lOiRxdWVyeSBPUiB0aXRsZWxvb2t1cDokcXVlcnkiKQ0KI2VuZA0KDQojc2V0KCRtYXRjaGluZ1VzZXJzID0gJGNvcmVfdjJfc2VhcmNoUmVzdWx0Lkxpc3QoIiV7UXVlcnk9JHF1ZXJ5LEZpbHRlcnM9J3R5cGU6OnVzZXInLFBhZ2VTaXplPTEwfSIpKQ0KDQojc2V0KCRleGFjdFVzZXIgPSBmYWxzZSkNCiNzZXQoJGV4YWN0VXNlciA9ICRjb3JlX3YyX3VzZXIuR2V0KCIle1VzZXJuYW1lPSRzZWFyY2hUZXh0fSIpKQ0KDQokY29yZV92Ml9wYWdlLlNldENvbnRlbnRUeXBlKCdhcHBsaWNhdGlvbi9qc29uJykNCg0KI3NldCgkYWNjZXNzaW5nVXNlciA9ICRjb3JlX3YyX3VzZXIuQWNjZXNzaW5nKQ0KDQp7InRvdGFsTWF0Y2hlcyI6JG1hdGNoaW5nVXNlcnMuVG90YWxDb3VudCwNCiAibWF0Y2hlcyI6Ww0KCSNpZiAoJGV4YWN0VXNlciAmJiAkZXhhY3RVc2VyLklkICE9ICRhY2Nlc3NpbmdVc2VyLklkICYmICRjb3JlX3YyX3VybHMuQWRkQ29udmVyc2F0aW9uKCRleGFjdFVzZXIuSWQpKQ0KCQl7InVzZXJOYW1lIjoiJGNvcmVfdjJfZW5jb2RpbmcuSmF2YXNjcmlwdEVuY29kZSgkZXhhY3RVc2VyLlVzZXJuYW1lKSIsInRpdGxlIjoiJGNvcmVfdjJfZW5jb2RpbmcuSmF2YXNjcmlwdEVuY29kZSgkZXhhY3RVc2VyLkRpc3BsYXlOYW1lKSNpZigkZXhhY3RVc2VyLkRpc3BsYXlOYW1lICE9ICRleGFjdFVzZXIuVXNlcm5hbWUpICgkY29yZV92Ml9lbmNvZGluZy5KYXZhc2NyaXB0RW5jb2RlKCRleGFjdFVzZXIuVXNlcm5hbWUpKSNlbmQifSwNCgkjZW5kDQoJI2lmKCRtYXRjaGluZ1VzZXJzKQ0KCQkjZm9yZWFjaCgkbWF0Y2hlZFVzZXIgaW4gJG1hdGNoaW5nVXNlcnMpDQoJCQkjZm9yZWFjaCgkdXNlciBpbiAkbWF0Y2hlZFVzZXIuVXNlcnMpDQoJCQkJI2lmICgkdXNlciAmJiAoISRleGFjdFVzZXIgfHwgJGV4YWN0VXNlci5JZCAhPSAkdXNlci5JZCkgJiYgJHVzZXIuSWQgIT0gJGFjY2Vzc2luZ1VzZXIuSWQgJiYgJGNvcmVfdjJfdXJscy5BZGRDb252ZXJzYXRpb24oJHVzZXIuSWQpKQ0KCQkJCQl7InVzZXJOYW1lIjoiJGNvcmVfdjJfZW5jb2RpbmcuSmF2YXNjcmlwdEVuY29kZSgkdXNlci5Vc2VybmFtZSkiLCJ0aXRsZSI6IiRjb3JlX3YyX2VuY29kaW5nLkphdmFzY3JpcHRFbmNvZGUoJHVzZXIuRGlzcGxheU5hbWUpI2lmKCR1c2VyLkRpc3BsYXlOYW1lICE9ICR1c2VyLlVzZXJuYW1lKSAoJGNvcmVfdjJfZW5jb2RpbmcuSmF2YXNjcmlwdEVuY29kZSgkdXNlci5Vc2VybmFtZSkpI2VuZCJ9LA0KCQkJCSNlbmQNCgkJCSNlbmQNCgkJI2VuZA0KCSNlbmQNCm51bGxdfQ==</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCwgdW5kZWYpew0KDQoJdmFyIG1vZGVsID0gew0KCQlhZGRDb252ZXJzYXRpb246IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCXZhciBkYXRhID0gew0KCQkJCVBhcnRpY2lwYW50czogb3B0aW9ucy5wYXJ0aWNpcGFudHMsDQoJCQkJQm9keTogb3B0aW9ucy5ib2R5LA0KCQkJCVN1YmplY3Q6IG9wdGlvbnMuc3ViamVjdA0KCQkJfTsNCg0KCQkJcmV0dXJuICQudGVsbGlnZW50LmV2b2x1dGlvbi5wb3N0KHsNCgkJCQl1cmw6IG9wdGlvbnMuYWRkQ29udmVyc2F0aW9uVXJsLA0KCQkJCWRhdGE6IGRhdGENCgkJCX0pOw0KCQl9DQoJfQ0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCXZhciBzdWJqZWN0SW5wdXQgPSAkKG9wdGlvbnMuc3ViamVjdElucHV0KSwNCgkJCQlib2R5SW5wdXQgPSAkKG9wdGlvbnMuYm9keUlucHV0KSwNCgkJCQlwYXJ0aWNpcGFudHMgPSAkKG9wdGlvbnMucmVjaXBpZW50SW5wdXQpLA0KCQkJCXBvc3RMaW5rID0gJCgnPGEgaHJlZj0iIyIgY2xhc3M9InN1Ym1pdCI+JyArIG9wdGlvbnMucG9zdExhYmVsICsgJzwvYT4nKSwNCgkJCQlmb3JtYXRTdWdnZXN0aW9uID0gZnVuY3Rpb24odGV4dCkgew0KCQkJCQlyZXR1cm4gJzxkaXYgc3R5bGU9InBhZGRpbmc6IDRweCAwOyI+JyArIHRleHQgKyAiPC9kaXY+IjsNCgkJCQl9Ow0KDQoJCQlwb3N0TGluay5vbigndGFwJywgZnVuY3Rpb24oKXsNCgkJCQl2YXIgYm9keSA9ICQudHJpbShib2R5SW5wdXQudmFsKCkpLA0KCQkJCQlzdWJqZWN0ID0gJC50cmltKHN1YmplY3RJbnB1dC52YWwoKSksDQoJCQkJCXVzZXJMaXN0ID0gJyc7DQoNCgkJCQlmb3IgKHZhciBpID0gMDsgaSA8IHBhcnRpY2lwYW50cy5nbG93TG9va1VwVGV4dEJveCgnY291bnQnKTsgaSsrKSB7DQoJCQkJCWlmICh1c2VyTGlzdC5sZW5ndGggPiAwKSB7DQoJCQkJCQl1c2VyTGlzdCArPSAnLCc7DQoJCQkJCX0NCgkJCQkJdXNlckxpc3QgKz0gcGFydGljaXBhbnRzLmdsb3dMb29rVXBUZXh0Qm94KCdnZXRCeUluZGV4JywgaSkuVmFsdWU7DQoJCQkJfQ0KDQoJCQkJaWYoYm9keS5sZW5ndGggPiAwICYmIHN1YmplY3QubGVuZ3RoID4gMCAmJiB1c2VyTGlzdC5sZW5ndGggPiAwKSB7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcobW9kZWwuYWRkQ29udmVyc2F0aW9uKHsNCgkJCQkJCWFkZENvbnZlcnNhdGlvblVybDogb3B0aW9ucy5hZGRDb252ZXJzYXRpb25VcmwsDQoJCQkJCQlzdWJqZWN0OiBzdWJqZWN0LA0KCQkJCQkJYm9keTogYm9keSwNCgkJCQkJCXBhcnRpY2lwYW50czogdXNlckxpc3QNCgkJCQkJfSkpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2Upew0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5sb2FkKHJlc3BvbnNlLmNvbnZlcnNhdGlvblVybCwgeyByZWZyZXNoOiB0cnVlIH0pOw0KCQkJCQl9KTsNCgkJCQl9DQoJCQl9KTsNCg0KCQkJcGFydGljaXBhbnRzLmdsb3dMb29rVXBUZXh0Qm94KHsNCgkJCSAgICBlbXB0eUh0bWw6ICcnLA0KCQkJICAgIG1heFZhbHVlczogMjAsDQoJCQkgICAgb25HZXRMb29rVXBzOiBmdW5jdGlvbiAodGIsIHNlYXJjaFRleHQpIHsNCgkJCSAgICAgICAgd2luZG93LmNsZWFyVGltZW91dChvcHRpb25zLmxvb2t1cFRpbWVvdXQpOw0KCQkJICAgICAgICBpZiAoc2VhcmNoVGV4dCAmJiBzZWFyY2hUZXh0Lmxlbmd0aCA+PSAyKSB7DQoJCQkgICAgICAgICAgICB0Yi5nbG93TG9va1VwVGV4dEJveCgndXBkYXRlU3VnZ2VzdGlvbnMnLCBbdGIuZ2xvd0xvb2tVcFRleHRCb3goJ2NyZWF0ZUxvb2tVcCcsICcnLCBvcHRpb25zLnVzZXJMb29rdXBMb2FkaW5nVGV4dCwgZm9ybWF0U3VnZ2VzdGlvbihvcHRpb25zLnVzZXJMb29rdXBMb2FkaW5nVGV4dCksIGZhbHNlKV0pOw0KCQkJICAgICAgICAgICAgb3B0aW9ucy5sb29rdXBUaW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkgew0KCQkJICAgICAgICAgICAgICAgICQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoew0KCQkJICAgICAgICAgICAgICAgICAgICB1cmw6IG9wdGlvbnMubG9va3VwVXNlclVybCwNCgkJCSAgICAgICAgICAgICAgICAgICAgZGF0YTogeyB3X1NlYXJjaFRleHQ6IHNlYXJjaFRleHQgfSwNCgkJCSAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3BvbnNlKSB7DQoJCQkgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2UubWF0Y2hlcy5sZW5ndGggPiAxKSB7DQoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Z2dlc3Rpb25zID0gW107DQoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXNwb25zZS5tYXRjaGVzLmxlbmd0aCAtIDE7IGkrKykgew0KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IHJlc3BvbnNlLm1hdGNoZXNbaV07DQoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zW3N1Z2dlc3Rpb25zLmxlbmd0aF0gPSB0Yi5nbG93TG9va1VwVGV4dEJveCgnY3JlYXRlTG9va1VwJywgaXRlbS51c2VyTmFtZSwgaXRlbS50aXRsZSwgZm9ybWF0U3VnZ2VzdGlvbihpdGVtLnRpdGxlKSwgdHJ1ZSk7DQoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGIuZ2xvd0xvb2tVcFRleHRCb3goJ3VwZGF0ZVN1Z2dlc3Rpb25zJywgc3VnZ2VzdGlvbnMpOw0KCQkJICAgICAgICAgICAgICAgICAgICAgICAgfQ0KCQkJICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQ0KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRiLmdsb3dMb29rVXBUZXh0Qm94KCd1cGRhdGVTdWdnZXN0aW9ucycsIFt0Yi5nbG93TG9va1VwVGV4dEJveCgnY3JlYXRlTG9va1VwJywgJycsIG9wdGlvbnMubm9Vc2VyTWF0Y2hlc1RleHQsIGZvcm1hdFN1Z2dlc3Rpb24ob3B0aW9ucy5ub1VzZXJNYXRjaGVzVGV4dCksIGZhbHNlKV0pOw0KCQkJICAgICAgICAgICAgICAgICAgICB9DQoJCQkgICAgICAgICAgICAgICAgfSk7DQoJCQkgICAgICAgICAgICB9LCA3NDkpOw0KCQkJICAgICAgICB9DQoJCQkgICAgfSwNCgkJCSAgICBzZWxlY3RlZExvb2tVcHNIdG1sOiBvcHRpb25zLnNlbGVjdGVkVXNlckRpc3BsYXlOYW1lID8gW29wdGlvbnMuc2VsZWN0ZWRVc2VyRGlzcGxheU5hbWVdIDogW10sDQoJCQkgICAgbG9va1VwUG9wVXBIZWlnaHQ6IDc1DQoJCQl9KTsNCg0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zZXRIZWFkZXJCdXR0b24ocG9zdExpbmspOw0KCQl9DQoJfQ0KDQoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24gPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24gfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5jcmVhdGVDb252ZXJzYXRpb24gPSBhcGk7DQoNCn0pKGpRdWVyeSwgd2luZG93KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:CreateEditBlogPost_Name}" version="7.0.0.1" description="" instanceIdentifier="48d3b46f0c164d9eb36ef4ab8dabaa2f" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="create-edit-blog-post">
    <contentScript>
			
#set ($pageName = $mobile_v1_url.Current)
#set ($contentTypeId = $core_v2_blogPost.ContentTypeId)

#set ($title = "")
#set ($body = "")

#set ($blogId = false)
#set ($blogPostId = false)
#set ($blogPost = false)



#if ($pageName == 'blog-addblogpost')

	#set($blogId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('BlogId')))

#elseif($pageName == 'blogpost-edit')


	#set($blogPostId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('BlogPostId')))

	#set ($blogPost = $core_v2_blogPost.Get("%{Id=$blogPostId}"))
	#if (!$blogPost)
		$core_v2_widget.Hide()
	#end

	#set($blogId = $blogPost.BlogId)
	#set($title = $blogPost.Title)
	#set($body = $blogPost.Body('raw'))

#end

#if (!$blogId)
	$core_v2_widget.Hide()
#end

#set ($blog = false)
#set ($blog = $core_v2_blog.Get("%{Id= $blogId}"))

#if (!$blog)
	$core_v2_widget.Hide()
#end



#set ($bodyId = $core_v2_widget.UniqueId('PostBody'))
#set ($titleId = $core_v2_widget.UniqueId('Title'))

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($blog.Group.Url)"&gt;$blog.Group.Name&lt;/a&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($blog.Url)"&gt;$blog.Name&lt;/a&gt;
		&lt;h1&gt;
			#if ($blogPost)
				$blogPost.Title
			#else
				$core_v2_language.GetResource('new_post')
			#end
		&lt;/h1&gt;
	&lt;/div&gt;
&lt;/div&gt;
&lt;fieldset&gt;

	&lt;div class="form-field text"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($subjectId)"&gt;$core_v2_language.GetResource('title')&lt;/label&gt;
		&lt;input type="text" maxlength="256" id="$core_v2_encoding.HtmlAttributeEncode($titleId)" value="$!core_v2_encoding.HtmlAttributeEncode($title)" /&gt;
	&lt;/div&gt;

	&lt;div class="form-field editor"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;$core_v2_language.GetResource('body')&lt;/label&gt;
		$core_v2_editor.Render('PostBody', "%{Width='100%', Height='60px', Value=$body, ContentTypeId=$contentTypeId}")
	&lt;/div&gt;

&lt;/fieldset&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
	jQuery.telligent.evolution.widgets.createEditBlogPost.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			blogId: $blogId,
			blogPostId: #if ($blogPost) $blogPost.Id #else null #end,
			getBodyContent: function() { return $core_v2_editor.GetContentScript('PostBody') },
			titleInput: '#$core_v2_encoding.JavascriptEncode($titleId)',
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			editLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('edit'))'
		});

		jQuery.telligent.evolution.mobile.refreshable(false);
		jQuery.telligent.evolution.mobile.excludeFromHistory();
	});
})
&lt;/script&gt;
		
		</contentScript>
    <languageResources>
		  <language key="en-us">
			<resource name="CreateEditBlogPost_Name">Create Edit Blog Post</resource>
			<resource name="title">Title</resource>
			<resource name="body">Description</resource>
			<resource name="post">Post</resource>
			<resource name="edit">Edit</resource>
			<resource name="new_post">New post</resource>
		  </language>
		</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCwgdW5kZWYpew0KDQoJdmFyIG1vZGVsID0gew0KCQlhZGRCbG9nUG9zdDogZnVuY3Rpb24oZGF0YSkgew0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygpOw0KCQkJdmFyIGFkZEJsb2dQb3N0UHJvbWlzZSA9ICQudGVsbGlnZW50LmV2b2x1dGlvbi5wb3N0KHsNCgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi9ibG9ncy97QmxvZ0lkfS9wb3N0cy5qc29uJywNCgkJCQlkYXRhOiBkYXRhDQoJCQl9KS5mYWlsKGZ1bmN0aW9uKCl7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlTG9hZGluZygpOw0KCQkJfSk7DQoJCQlyZXR1cm4gYWRkQmxvZ1Bvc3RQcm9taXNlOw0KCQl9LA0KCQllZGl0QmxvZ1Bvc3Q6IGZ1bmN0aW9uKGRhdGEpIHsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoKTsNCgkJCXZhciBlZGl0QmxvZ1Bvc3RQcm9taXNlID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7DQoJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvYmxvZ3Mve0Jsb2dJZH0vcG9zdHMve0Jsb2dQb3N0SWR9Lmpzb24nLA0KCQkJCWRhdGE6IGRhdGENCgkJCX0pLmZhaWwoZnVuY3Rpb24oKXsNCgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmhpZGVMb2FkaW5nKCk7DQoJCQl9KTsNCgkJCXJldHVybiBlZGl0QmxvZ1Bvc3RQcm9taXNlOw0KCQl9DQoJfQ0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCXZhciBwb3N0TGluayA9ICQoJzxhIGhyZWY9IiMiIGNsYXNzPSJzdWJtaXQiPicgKyAoIW9wdGlvbnMuYmxvZ1Bvc3RJZCA/IG9wdGlvbnMucG9zdExhYmVsIDogb3B0aW9ucy5lZGl0TGFiZWwpICsgJzwvYT4nKTsNCg0KCQkJcG9zdExpbmsub24oJ3RhcCcsIGZ1bmN0aW9uKCl7DQoNCgkJCQl2YXIgZGF0YSA9IHsNCgkJCQkJQm9keTogJC50cmltKG9wdGlvbnMuZ2V0Qm9keUNvbnRlbnQoKSksDQoJCQkJCVRpdGxlOiAkLnRyaW0oJChvcHRpb25zLnRpdGxlSW5wdXQpLnZhbCgpKSwNCgkJCQkJQmxvZ0lkOiBvcHRpb25zLmJsb2dJZCwNCgkJCQkJQmxvZ1Bvc3RJZDogb3B0aW9ucy5ibG9nUG9zdElkDQoJCQkJfQ0KDQoJCQkJaWYoZGF0YS5Cb2R5Lmxlbmd0aCA+IDAgJiYgZGF0YS5UaXRsZS5sZW5ndGggPiAwKSB7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoKCFvcHRpb25zLmJsb2dQb3N0SWQgPyBtb2RlbC5hZGRCbG9nUG9zdChkYXRhKSA6IG1vZGVsLmVkaXRCbG9nUG9zdChkYXRhKSkpDQoJCQkJCQkudGhlbihmdW5jdGlvbihyZXNwb25zZSl7DQoJCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5sb2FkKHJlc3BvbnNlLkJsb2dQb3N0LlVybCwgeyByZWZyZXNoOiB0cnVlIH0pOw0KCQkJCQkJfSk7DQoJCQkJfQ0KCQkJfSk7DQoNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2V0SGVhZGVyQnV0dG9uKHBvc3RMaW5rKTsNCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMuY3JlYXRlRWRpdEJsb2dQb3N0ID0gYXBpOw0KDQp9KShqUXVlcnksIHdpbmRvdyk7</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:CreateEditForumReply_Name}" version="7.0.0.1" description="" instanceIdentifier="df209287ea8d4eccaf8cbb08a568c8f9" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="create-edit-forum-reply">
    <contentScript>
			
#set ($pageName = $mobile_v1_url.Current)
#set ($mode = false)
#set ($contentTypeId = $core_v2_forumThread.ContentTypeId)

#set ($forumThread = false)
#set ($forumThreadId = false)
#set ($forumThreadId = $mobile_v1_urlToken.Value('ForumThreadId'))
#if ($forumThreadId)
	#set ($forumThreadId = $core_v2_utility.ParseInt($forumThreadId))
#end

#set ($forumReply = false)
#set ($forumReplyId = false)
#set ($forumReplyId = $mobile_v1_urlToken.Value('ForumReplyId'))
#if ($forumReplyId)
	#set ($forumReplyId = $core_v2_utility.ParseInt($forumReplyId))
#end

#if ($pageName == 'forumthread-addreply' || $pageName == 'forumreply-addreply')
	#set ($mode = 'add')
	#if (!$forumReplyId &amp;&amp; !$forumThreadId)
		$core_v2_widget.Hide()
	#end
	#if ($forumReplyId)
		#set ($forumReply = $core_v2_forumReply.Get($forumReplyId))
		#if (!$forumReply)
			$core_v2_widget.Hide()
		#end
		#set ($forumThread = $core_v2_forumThread.Get($forumReply.ThreadId))
		#set($forum = $core_v2_forum.Get($forumReply.ForumId))
	#elseif ($forumThreadId)
		#set ($forumThread = $core_v2_forumThread.Get($forumThreadId))
		#if (!$forumThread)
			$core_v2_widget.Hide()
		#end
		#set($forum = $core_v2_forum.Get($forumThread.ForumId))
	#end
#elseif($pageName == 'forumreply-edit')
	#set ($mode = 'edit')
	#if (!$forumReplyId)
		$core_v2_widget.Hide()
	#end
	#set ($forumReply = $core_v2_forumReply.Get($forumReplyId))
	#if (!$forumReply)
		$core_v2_widget.Hide()
	#end
	#set ($forumThread = $core_v2_forumThread.Get($forumReply.ThreadId))
	#set($forum = $core_v2_forum.Get($forumReply.ForumId))
#end

#set ($bodyId = $core_v2_widget.UniqueId('Body'))
#set ($suggestAnswerId = $core_v2_widget.UniqueId('SuggestAnswer'))
#set ($subscribeId = $core_v2_widget.UniqueId('Subscribe'))

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($forum.Group.Url)"&gt;$forum.Group.Name&lt;/a&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($forum.Url)"&gt;$forum.Name&lt;/a&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($forumThread.Url)"&gt;$forumThread.Subject&lt;/a&gt;
		#if ($mode == 'add')
			&lt;h1&gt;$core_v2_language.GetResource('add_reply')&lt;/h1&gt;
		#else
			&lt;h1&gt;$core_v2_language.GetResource('edit_reply')&lt;/h1&gt;
		#end
	&lt;/div&gt;
&lt;/div&gt;
&lt;fieldset&gt;
	## Body
	&lt;div class="form-field editor"&gt;
		#set ($body = '')
		#if ($forumReply &amp;&amp; $mode == 'edit')
			#set ($body = $forumReply.Body('raw'))
		#end
		$core_v2_editor.Render('PostBody', "%{Width='100%', Height='60px', Value=$body, ContentTypeId=$contentTypeId}")
	&lt;/div&gt;

	## Suggest as answer
	#set($replyToThread = false)
	#if($forumReply)
		#set($replyToThread = $core_v2_forumThread.Get($forumReply.ThreadId))
	#else
		#set($replyToThread = $forumThread)
	#end
	#if($replyToThread &amp;&amp; $replyToThread.ThreadType == 'QuestionAndAnswer')
		&lt;div class="form-field checkbox inline-label"&gt;
			&lt;label for="$core_v2_encoding.HtmlAttributeEncode($suggestAnswerId)"&gt;$core_v2_language.GetResource('suggest_answer')&lt;/label&gt;
			&lt;input id="$core_v2_encoding.HtmlAttributeEncode($suggestAnswerId)" type="checkbox" #if ($threadOrReply &amp;&amp; $threadOrReply.IsSuggestedAnswer) checked="checked" #end /&gt;
		&lt;/div&gt;
	#end

	## Email Replies
	#if ($mode == "add" &amp;&amp; $core_v2_user.IsRegistered($core_v2_user.Accessing.Id))
		&lt;div class="form-field checkbox inline-label"&gt;
			&lt;label for="$core_v2_encoding.HtmlAttributeEncode($subscribeId)"&gt;$core_v2_language.GetResource('subscribe')&lt;/label&gt;
			&lt;input id="$core_v2_encoding.HtmlAttributeEncode($subscribeId)" type="checkbox" checked/&gt;
		&lt;/div&gt;
	#end
&lt;/fieldset&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.createEditForumReply.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			forumId: $replyToThread.ForumId,
			forumThreadId: #if ($replyToThread) $replyToThread.Id #else null #end,
			forumReplyId: #if ($forumReplyId) $forumReplyId	#else null #end,
			mode: '$core_v2_encoding.JavascriptEncode($mode)',
			getBodyContent: function() { return $core_v2_editor.GetContentScript('PostBody') },
			suggestAsAnswerInput: '#$core_v2_encoding.JavascriptEncode($suggestAnswerId)',
			subscribeInput: '#$core_v2_encoding.JavascriptEncode($subscribeId)',
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			editLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('edit'))'
		});

		jQuery.telligent.evolution.mobile.refreshable(false);
		jQuery.telligent.evolution.mobile.excludeFromHistory();
	});
})
&lt;/script&gt;
		
		</contentScript>
    <headerScript>
			Placeholder
		</headerScript>
    <languageResources>
		  <language key="en-us">
			<resource name="CreateEditForumReply_Name">Create Edit Forum Reply</resource>
			<resource name="reply">Reply...</resource>
			<resource name="suggest_answer">Suggest as answer</resource>
			<resource name="subscribe">Notify me about replies</resource>
			<resource name="post">Reply</resource>
			<resource name="edit">Edit</resource>
			<resource name="add_reply">Reply</resource>
			<resource name="edit_reply">Edit reply</resource>
		  </language>
		</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCwgdW5kZWYpew0KDQoJdmFyIG1vZGVsID0gew0KCQlhZGRSZXBseTogZnVuY3Rpb24ob3B0aW9ucykgew0KCQkJdmFyIGRhdGEgPSB7DQoJCQkJVGhyZWFkSWQ6IG9wdGlvbnMudGhyZWFkSWQsDQoJCQkJQm9keTogb3B0aW9ucy5ib2R5DQoJCQl9Ow0KDQoJCQlpZihvcHRpb25zLnBhcmVudFJlcGx5SWQpDQoJCQkJZGF0YS5QYXJlbnRSZXBseUlkID0gb3B0aW9ucy5wYXJlbnRSZXBseUlkOw0KCQkJaWYob3B0aW9ucy5zdWJzY3JpYmVUb1RocmVhZCAhPSB1bmRlZiAmJiBvcHRpb25zLnN1YnNjcmliZVRvVGhyZWFkICE9IG51bGwpDQoJCQkJZGF0YS5TdWJzY3JpYmVUb1RocmVhZCA9IG9wdGlvbnMuc3Vic2NyaWJlVG9UaHJlYWQ7DQoJCQlpZihvcHRpb25zLmlzU3VnZ2VzdGVkQW5zd2VyICE9IHVuZGVmICYmIG9wdGlvbnMuaXNTdWdnZXN0ZWRBbnN3ZXIgIT0gbnVsbCkNCgkJCQlkYXRhLklzU3VnZ2VzdGVkQW5zd2VyID0gb3B0aW9ucy5pc1N1Z2dlc3RlZEFuc3dlcjsNCg0KCQkJcmV0dXJuICQudGVsbGlnZW50LmV2b2x1dGlvbi5wb3N0KHsNCgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi9mb3J1bXMvdGhyZWFkcy97VGhyZWFkSWR9L3JlcGxpZXMuanNvbicsDQoJCQkJZGF0YTogZGF0YQ0KCQkJfSk7DQoJCX0sDQoJCWVkaXRSZXBseTogZnVuY3Rpb24ob3B0aW9ucykgew0KCQkJdmFyIGRhdGEgPSB7DQoJCQkJRm9ydW1JZDogb3B0aW9ucy5mb3J1bUlkLA0KCQkJCVRocmVhZElkOiBvcHRpb25zLnRocmVhZElkLA0KCQkJCVJlcGx5SWQ6IG9wdGlvbnMucmVwbHlJZCwNCgkJCQlCb2R5OiBvcHRpb25zLmJvZHkNCgkJCX07DQoNCgkJCWlmKG9wdGlvbnMuc3Vic2NyaWJlVG9UaHJlYWQgIT0gdW5kZWYgJiYgb3B0aW9ucy5zdWJzY3JpYmVUb1RocmVhZCAhPSBudWxsKQ0KCQkJCWRhdGEuU3Vic2NyaWJlVG9UaHJlYWQgPSBvcHRpb25zLnN1YnNjcmliZVRvVGhyZWFkOw0KCQkJaWYob3B0aW9ucy5pc1N1Z2dlc3RlZEFuc3dlciAhPSB1bmRlZiAmJiBvcHRpb25zLmlzU3VnZ2VzdGVkQW5zd2VyICE9IG51bGwpDQoJCQkJZGF0YS5Jc1N1Z2dlc3RlZEFuc3dlciA9IG9wdGlvbnMuaXNTdWdnZXN0ZWRBbnN3ZXI7DQoNCgkJCXJldHVybiAkLnRlbGxpZ2VudC5ldm9sdXRpb24ucHV0KHsNCgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi9mb3J1bXMve0ZvcnVtSWR9L3RocmVhZHMve1RocmVhZElkfS9yZXBsaWVzL3tSZXBseUlkfS5qc29uJywNCgkJCQlkYXRhOiBkYXRhDQoJCQl9KTsNCgkJfQ0KCX0NCg0KCXZhciBhcGkgPSB7DQoJCXJlZ2lzdGVyOiBmdW5jdGlvbihvcHRpb25zKSB7DQoNCgkJCXZhciBzdWdnZXN0QXNBbnN3ZXJJbnB1dCA9ICQob3B0aW9ucy5zdWdnZXN0QXNBbnN3ZXJJbnB1dCksDQoJCQkJc3Vic2NyaWJlSW5wdXQgPSAkKG9wdGlvbnMuc3Vic2NyaWJlSW5wdXQpLA0KCQkJCXBvc3RMaW5rID0gJCgnPGEgaHJlZj0iIyIgY2xhc3M9InN1Ym1pdCI+JyArIChvcHRpb25zLm1vZGUgPT0gJ2FkZCcgPyBvcHRpb25zLnBvc3RMYWJlbCA6IG9wdGlvbnMuZWRpdExhYmVsKSArICc8L2E+Jyk7DQoNCgkJCXBvc3RMaW5rLm9uKCd0YXAnLCBmdW5jdGlvbigpew0KCQkJCXZhciBib2R5ID0gJC50cmltKG9wdGlvbnMuZ2V0Qm9keUNvbnRlbnQoKSksDQoJCQkJCXN1Ym1pdEFjdGlvbjsNCg0KCQkJCWlmKGJvZHkubGVuZ3RoID4gMCkgew0KDQoJCQkJCWlmKG9wdGlvbnMubW9kZSA9PSAnYWRkJykgew0KCQkJCQkJc3VibWl0QWN0aW9uID0gbW9kZWwuYWRkUmVwbHkoew0KCQkJCQkJCXRocmVhZElkOiBvcHRpb25zLmZvcnVtVGhyZWFkSWQsDQoJCQkJCQkJcGFyZW50UmVwbHlJZDogb3B0aW9ucy5mb3J1bVJlcGx5SWQsDQoJCQkJCQkJYm9keTogYm9keSwNCgkJCQkJCQlpc1N1Z2dlc3RlZEFuc3dlcjogc3VnZ2VzdEFzQW5zd2VySW5wdXQubGVuZ3RoID09IDAgPyBudWxsIDogc3VnZ2VzdEFzQW5zd2VySW5wdXQuaXMoJzpjaGVja2VkJyksDQoJCQkJCQkJc3Vic2NyaWJlVG9UaHJlYWQ6IHN1YnNjcmliZUlucHV0Lmxlbmd0aCA9PSAwID8gbnVsbCA6IHN1YnNjcmliZUlucHV0LmlzKCc6Y2hlY2tlZCcpDQoJCQkJCQl9KTsNCgkJCQkJfSBlbHNlIGlmKG9wdGlvbnMubW9kZSA9PSAnZWRpdCcpIHsNCgkJCQkJCXN1Ym1pdEFjdGlvbiA9IG1vZGVsLmVkaXRSZXBseSh7DQoJCQkJCQkJZm9ydW1JZDogb3B0aW9ucy5mb3J1bUlkLA0KCQkJCQkJCXRocmVhZElkOiBvcHRpb25zLmZvcnVtVGhyZWFkSWQsDQoJCQkJCQkJcmVwbHlJZDogb3B0aW9ucy5mb3J1bVJlcGx5SWQsDQoJCQkJCQkJYm9keTogYm9keSwNCgkJCQkJCQlpc1N1Z2dlc3RlZEFuc3dlcjogc3VnZ2VzdEFzQW5zd2VySW5wdXQubGVuZ3RoID09IDAgPyBudWxsIDogc3VnZ2VzdEFzQW5zd2VySW5wdXQuaXMoJzpjaGVja2VkJyksDQoJCQkJCQkJc3Vic2NyaWJlVG9UaHJlYWQ6IHN1YnNjcmliZUlucHV0Lmxlbmd0aCA9PSAwID8gbnVsbCA6IHN1YnNjcmliZUlucHV0LmlzKCc6Y2hlY2tlZCcpDQoJCQkJCQl9KTsNCgkJCQkJfQ0KDQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoKTsNCgkJCQkJc3VibWl0QWN0aW9uLmRvbmUoZnVuY3Rpb24ocmVzcG9uc2Upew0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5sb2FkKHJlc3BvbnNlLlJlcGx5LlVybCwgeyByZWZyZXNoOiB0cnVlIH0pOw0KCQkJCQl9KS5mYWlsKGZ1bmN0aW9uKCl7DQoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmhpZGVMb2FkaW5nKCk7DQoJCQkJCX0pDQoJCQkJfQ0KCQkJfSk7DQoNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2V0SGVhZGVyQnV0dG9uKHBvc3RMaW5rKTsNCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMuY3JlYXRlRWRpdEZvcnVtUmVwbHkgPSBhcGk7DQoNCn0pKGpRdWVyeSwgd2luZG93KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:CreateEditForumThread_Name}" version="7.0.0.1" description="" instanceIdentifier="f50a8f2949d2477c9fb18ffa47f64cbf" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="create-edit-forum-thread">
    <contentScript>
			
#set ($pageName = $mobile_v1_url.Current)
#set ($mode = false)
#set ($contentTypeId = $core_v2_forumThread.ContentTypeId)

#set ($forum = false)
#set ($forumId = false)
#set ($forumId = $mobile_v1_urlToken.Value('ForumId'))
#if ($forumId)
	#set ($forumId = $core_v2_utility.ParseInt($forumId))
#end

#set ($forumThread = false)
#set ($forumThreadId = false)
#set ($forumThreadId = $mobile_v1_urlToken.Value('ForumThreadId'))
#if ($forumThreadId)
	#set ($forumThreadId = $core_v2_utility.ParseInt($forumThreadId))
#end

#if ($pageName == 'forum-addthread')
	#set ($mode = 'add')
	#if (!$forumId)
		$core_v2_widget.Hide()
	#end
	#set ($forum = $core_v2_forum.Get($forumId))
	#if (!$forum)
		$core_v2_widget.Hide()
	#end
#elseif($pageName == 'forumthread-edit')
	#set ($mode = 'edit')
	#if (!$forumThreadId)
		$core_v2_widget.Hide()
	#end
	#set ($forumThread = $core_v2_forumThread.Get($forumThreadId))
	#if (!$forumThread)
		$core_v2_widget.Hide()
	#end
	#set ($forum = $core_v2_forum.Get($forumThread.ForumId))
	#if (!$forum)
		$core_v2_widget.Hide()
	#end
#end

#set ($bodyId = $core_v2_widget.UniqueId('PostBody'))
#set ($subjectId = $core_v2_widget.UniqueId('Subject'))
#set ($threadTypeId = $core_v2_widget.UniqueId('ThreadType'))
#set ($subscribeId = $core_v2_widget.UniqueId('Subscribe'))

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($forum.Group.Url)"&gt;$forum.Group.Name&lt;/a&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($forum.Url)"&gt;$forum.Name&lt;/a&gt;
		#if ($mode == 'add')
			#if ($forum.AllowedThreadTypes.Count &gt; 1)
				&lt;h1&gt;$core_v2_language.GetResource('NewQuestionOrDiscussion')&lt;/h1&gt;
			#elseif ($forum.AllowedThreadTypes.get_Item(0) == 'QuestionAndAnswer')
				&lt;h1&gt;$core_v2_language.GetResource('NewQuestion')&lt;/h1&gt;
			#else
				&lt;h1&gt;$core_v2_language.GetResource('NewDiscussion')&lt;/h1&gt;
			#end
		#else
			&lt;h1&gt;$forumThread.Subject&lt;/h1&gt;
		#end
	&lt;/div&gt;
&lt;/div&gt;


&lt;fieldset&gt;

	## Thread Type
	#if ($core_v2_forumConfiguration.EnableThreadStatus &amp;&amp; $forum.AllowedThreadTypes.Count &gt; 1)
		#set($threadType = $forum.DefaultThreadType)
		#set($threadType = $forumThread.ThreadType)
		&lt;div class="form-field select"&gt;
			&lt;select id="$core_v2_encoding.HtmlAttributeEncode($threadTypeId)"&gt;
				&lt;option value="QuestionAndAnswer" #if($threadType == 'QuestionAndAnswer') selected="selected"#end&gt;$core_v2_language.GetResource('threadType_QA')&lt;/option&gt;
				&lt;option value="Discussion" #if($threadType == 'Discussion') selected="selected"#end&gt;$core_v2_language.GetResource('threadType_Discussion')&lt;/option&gt;
			&lt;/select&gt;
		&lt;/div&gt;
	#end

	## Subject
	&lt;div class="form-field text"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($subjectId)"&gt;$core_v2_language.GetResource('subject')&lt;/label&gt;
		&lt;input type="text" maxlength="256" id="$core_v2_encoding.HtmlAttributeEncode($subjectId)" value="#if($forumThread)$!core_v2_encoding.HtmlAttributeEncode($forumThread.Subject)#end" /&gt;
	&lt;/div&gt;

	## Body
	&lt;div class="form-field editor"&gt;
		#set ($body = '')
		#if ($forumThread &amp;&amp; $mode == 'edit')
			#set ($body = $forumThread.Body('raw'))
		#end
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;$core_v2_language.GetResource('body')&lt;/label&gt;
		$core_v2_editor.Render('PostBody', "%{Width='100%', Height='60px', Value=$body, ContentTypeId=$contentTypeId}")
	&lt;/div&gt;

	## Email Replies
	#if ($mode == "add" &amp;&amp; $core_v2_user.IsRegistered($core_v2_user.Accessing.Id))
		&lt;div class="form-field checkbox inline-label"&gt;
			&lt;label for="$core_v2_encoding.HtmlAttributeEncode($subscribeId)"&gt;$core_v2_language.GetResource('subscribe')&lt;/label&gt;
			&lt;input id="$core_v2_encoding.HtmlAttributeEncode($subscribeId)" type="checkbox" checked/&gt;
		&lt;/div&gt;
	#end
&lt;/fieldset&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.createEditForumThread.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			threadUrl: #if ($forumThread) '$core_v2_encoding.JavascriptEncode($forumThread.Url)' #else null #end,
			forumId: $forum.Id,
			forumThreadId: #if ($forumThread) $forumThread.Id #else null #end,
			mode: '$core_v2_encoding.JavascriptEncode($mode)',
			getBodyContent: function() { return $core_v2_editor.GetContentScript('PostBody') },
			subjectInput: '#$core_v2_encoding.JavascriptEncode($subjectId)',
			threadTypeInput: '#$core_v2_encoding.JavascriptEncode($threadTypeId)',
			subscribeInput: '#$core_v2_encoding.JavascriptEncode($subscribeId)',
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			editLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('edit'))'
		});

		jQuery.telligent.evolution.mobile.refreshable(false);
		jQuery.telligent.evolution.mobile.excludeFromHistory();
	});
})
&lt;/script&gt;
		
		</contentScript>
    <languageResources>
		  <language key="en-us">
			<resource name="CreateEditForumThread_Name">Create Edit Forum Thread</resource>
			<resource name="subject">Subject</resource>
			<resource name="body">Description</resource>
			<resource name="threadType">Thread type</resource>
			<resource name="threadType_QA">Question</resource>
			<resource name="threadType_Discussion">Discussion</resource>
			<resource name="subscribe">Notify me about replies</resource>
			<resource name="post">Post</resource>
			<resource name="edit">Edit</resource>
			<resource name="NewQuestionOrDiscussion">Ask a question or start a discussion</resource>
			<resource name="NewQuestion">Ask a question</resource>
			<resource name="NewDiscussion">Start a discussion</resource>
		  </language>
		</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCwgdW5kZWYpew0KDQoJdmFyIG1vZGVsID0gew0KCQlhZGRUaHJlYWQ6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCXZhciBkYXRhID0gew0KCQkJCUZvcnVtSWQ6IG9wdGlvbnMuZm9ydW1JZCwNCgkJCQlCb2R5OiBvcHRpb25zLmJvZHksDQoJCQkJU3ViamVjdDogb3B0aW9ucy5zdWJqZWN0DQoJCQl9Ow0KDQoJCQlpZihvcHRpb25zLmlzUXVlc3Rpb24gIT0gdW5kZWYgJiYgb3B0aW9ucy5pc1F1ZXN0aW9uICE9IG51bGwpDQoJCQkJZGF0YS5Jc1F1ZXN0aW9uID0gb3B0aW9ucy5pc1F1ZXN0aW9uOw0KCQkJaWYob3B0aW9ucy5zdWJzY3JpYmVUb1RocmVhZCAhPSB1bmRlZiAmJiBvcHRpb25zLnN1YnNjcmliZVRvVGhyZWFkICE9IG51bGwpDQoJCQkJZGF0YS5TdWJzY3JpYmVUb1RocmVhZCA9IG9wdGlvbnMuc3Vic2NyaWJlVG9UaHJlYWQ7DQoNCgkJCXJldHVybiAkLnRlbGxpZ2VudC5ldm9sdXRpb24ucG9zdCh7DQoJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvZm9ydW1zL3tGb3J1bUlkfS90aHJlYWRzLmpzb24nLA0KCQkJCWRhdGE6IGRhdGENCgkJCX0pOw0KCQl9LA0KCQllZGl0VGhyZWFkOiBmdW5jdGlvbihvcHRpb25zKSB7DQoJCQl2YXIgZGF0YSA9IHsNCgkJCQlGb3J1bUlkOiBvcHRpb25zLmZvcnVtSWQsDQoJCQkJVGhyZWFkSWQ6IG9wdGlvbnMudGhyZWFkSWQsDQoJCQkJQm9keTogb3B0aW9ucy5ib2R5LA0KCQkJCVN1YmplY3Q6IG9wdGlvbnMuc3ViamVjdA0KCQkJfTsNCg0KCQkJaWYob3B0aW9ucy5pc1F1ZXN0aW9uICE9IHVuZGVmICYmIG9wdGlvbnMuaXNRdWVzdGlvbiAhPSBudWxsKQ0KCQkJCWRhdGEuSXNRdWVzdGlvbiA9IG9wdGlvbnMuaXNRdWVzdGlvbjsNCgkJCWlmKG9wdGlvbnMuc3Vic2NyaWJlVG9UaHJlYWQgIT0gdW5kZWYgJiYgb3B0aW9ucy5zdWJzY3JpYmVUb1RocmVhZCAhPSBudWxsKQ0KCQkJCWRhdGEuU3Vic2NyaWJlVG9UaHJlYWQgPSBvcHRpb25zLnN1YnNjcmliZVRvVGhyZWFkOw0KDQoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7DQoJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvZm9ydW1zL3tGb3J1bUlkfS90aHJlYWRzL3tUaHJlYWRJZH0uanNvbicsDQoJCQkJZGF0YTogZGF0YQ0KCQkJfSk7DQoJCX0NCgl9DQoNCgl2YXIgYXBpID0gew0KCQlyZWdpc3RlcjogZnVuY3Rpb24ob3B0aW9ucykgew0KCQkJdmFyIHRpdGxlSW5wdXQgPSAkKG9wdGlvbnMuc3ViamVjdElucHV0KSwNCgkJCQlib2R5SW5wdXQgPSAkKG9wdGlvbnMuYm9keUlucHV0KSwNCgkJCQl0aHJlYWRUeXBlSW5wdXQgPSAkKG9wdGlvbnMudGhyZWFkVHlwZUlucHV0KSwNCgkJCQlzdWJzY3JpYmVJbnB1dCA9ICQob3B0aW9ucy5zdWJzY3JpYmVJbnB1dCksDQoJCQkJcG9zdExpbmsgPSAkKCc8YSBocmVmPSIjIiBjbGFzcz0ic3VibWl0Ij4nICsgKG9wdGlvbnMubW9kZSA9PSAnYWRkJyA/IG9wdGlvbnMucG9zdExhYmVsIDogb3B0aW9ucy5lZGl0TGFiZWwpICsgJzwvYT4nKTsNCg0KCQkJcG9zdExpbmsub24oJ3RhcCcsIGZ1bmN0aW9uKCl7DQoJCQkJdmFyIGJvZHkgPSAkLnRyaW0ob3B0aW9ucy5nZXRCb2R5Q29udGVudCgpKSwNCgkJCQkJc3ViamVjdCA9ICQudHJpbSh0aXRsZUlucHV0LnZhbCgpKSwNCgkJCQkJc3VibWl0QWN0aW9uOw0KDQoJCQkJaWYoYm9keS5sZW5ndGggPiAwICYmIHN1YmplY3QubGVuZ3RoID4gMCkgew0KDQoJCQkJCWlmKG9wdGlvbnMubW9kZSA9PSAnYWRkJykgew0KCQkJCQkJc3VibWl0QWN0aW9uID0gbW9kZWwuYWRkVGhyZWFkKHsNCgkJCQkJCQlmb3J1bUlkOiBvcHRpb25zLmZvcnVtSWQsDQoJCQkJCQkJdGhyZWFkSWQ6IG9wdGlvbnMuZm9ydW1UaHJlYWRJZCwNCgkJCQkJCQlzdWJqZWN0OiBzdWJqZWN0LA0KCQkJCQkJCWJvZHk6IGJvZHksDQoJCQkJCQkJaXNRdWVzdGlvbjogKHRocmVhZFR5cGVJbnB1dC5sZW5ndGggPT0gMCA/IG51bGwgOiB0aHJlYWRUeXBlSW5wdXQudmFsKCkgPT0gJ1F1ZXN0aW9uQW5kQW5zd2VyJyksDQoJCQkJCQkJc3Vic2NyaWJlVG9UaHJlYWQ6IHN1YnNjcmliZUlucHV0Lmxlbmd0aCA9PSAwID8gbnVsbCA6IHN1YnNjcmliZUlucHV0LmlzKCc6Y2hlY2tlZCcpDQoJCQkJCQl9KTsNCgkJCQkJfSBlbHNlIGlmKG9wdGlvbnMubW9kZSA9PSAnZWRpdCcpIHsNCgkJCQkJCXN1Ym1pdEFjdGlvbiA9IG1vZGVsLmVkaXRUaHJlYWQoew0KCQkJCQkJCWZvcnVtSWQ6IG9wdGlvbnMuZm9ydW1JZCwNCgkJCQkJCQl0aHJlYWRJZDogb3B0aW9ucy5mb3J1bVRocmVhZElkLA0KCQkJCQkJCXN1YmplY3Q6IHN1YmplY3QsDQoJCQkJCQkJYm9keTogYm9keSwNCgkJCQkJCQlpc1F1ZXN0aW9uOiAodGhyZWFkVHlwZUlucHV0Lmxlbmd0aCA9PSAwID8gbnVsbCA6IHRocmVhZFR5cGVJbnB1dC52YWwoKSA9PSAnUXVlc3Rpb25BbmRBbnN3ZXInKSwNCgkJCQkJCQlzdWJzY3JpYmVUb1RocmVhZDogKHN1YnNjcmliZUlucHV0Lmxlbmd0aCA9PSAwID8gbnVsbCA6IHN1YnNjcmliZUlucHV0LmlzKCc6Y2hlY2tlZCcpKQ0KCQkJCQkJfSk7DQoJCQkJCX0NCg0KCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNob3dMb2FkaW5nKCk7DQoJCQkJCXN1Ym1pdEFjdGlvbi5kb25lKGZ1bmN0aW9uKHJlc3BvbnNlKXsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUubG9hZChyZXNwb25zZS5UaHJlYWQuVXJsLCB7IHJlZnJlc2g6IHRydWUgfSk7DQoJCQkJCX0pLmZhaWwoZnVuY3Rpb24oKXsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuaGlkZUxvYWRpbmcoKTsNCgkJCQkJfSk7DQoJCQkJfQ0KCQkJfSk7DQoNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2V0SGVhZGVyQnV0dG9uKHBvc3RMaW5rKTsNCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMuY3JlYXRlRWRpdEZvcnVtVGhyZWFkID0gYXBpOw0KDQp9KShqUXVlcnksIHdpbmRvdyk7</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:CreateStatus_Name}" version="7.0.0.1" description="" instanceIdentifier="710ffc21661e48ca877df34037d90d94" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="create-status">
    <contentScript>
		
#set($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#set ($accessingUser = $core_v2_user.Accessing)

#set ($enablePosting = false)
#if ($groupId &gt; 0)
	#set($group = $core_v2_group.Get("%{Id = $groupId}"))
	#set ($enablePosting = $group.EnableGroupMessages)
	#if ($group.GroupType == 'Joinless')
		#set ($enablePosting = $enablePosting &amp;&amp; $core_v2_user.IsRegistered($accessingUser.Id))
	#else
		#set ($groupUserMember = false)
		#set ($groupUserMember = $core_v2_groupUserMember.Get($group.Id, "%{ UserId = $accessingUser.Id }"))
		#set ($enablePosting = $enablePosting &amp;&amp; $groupUserMember != false &amp;&amp; ($groupUserMember.MembershipType == "Owner" || $groupUserMember.MembershipType == "Manager" || $groupUserMember.MembershipType == "Member"))
	#end
#else
	#set($enablePosting = true)
#end
#set ($enablePosting = $enablePosting &amp;&amp; $core_v2_activityStoryUserPreference.Get($core_v2_statusMessage.StoryTypeId).IsLoggingEnabled)

#if (!$enablePosting)
	$core_v2_widget.Hide()
#end

#set($userId = $accessingUser.Id)
#set($contextId = $core_v2_uploadedFile.CreateContextId())
#set($uploadUrl = $core_v2_uploadedFile.GetUploadUrl($contextId))

#set($uploadContainer = $core_v2_widget.UniqueId('uploadFileContainer'))
#set($uploadInput = $core_v2_widget.UniqueId('uploadFileInput'))
#set($uploadFileStateId = $core_v2_widget.UniqueId('uploadFileState'))
#set($uploadButtonId = $core_v2_widget.UniqueId('upload'))
#set($removeButtonId = $core_v2_widget.UniqueId('remove'))

#set($bodyId = $core_v2_widget.UniqueId('Body'))

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		#if ($group)
			&lt;a href="$core_v2_encoding.HtmlAttributeEncode($group.Url)"&gt;$group.Name&lt;/a&gt;
		#else
			&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('home'))"&gt;$core_v2_language.GetResource('home')&lt;/a&gt;
		#end
		&lt;h1&gt;$core_v2_language.GetResource('create_status')&lt;/h1&gt;
	&lt;/div&gt;
&lt;/div&gt;
&lt;fieldset&gt;
	&lt;div class="form-field editor"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;$core_v2_language.GetResource('body')&lt;/label&gt;
		&lt;textarea id="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;&lt;/textarea&gt;
	&lt;/div&gt;

	&lt;div class="form-field"&gt;
		&lt;div class="preview" style="display: none;"&gt;&lt;/div&gt;
		&lt;a href="#" class="upload with-icon" id="$core_v2_encoding.HtmlAttributeEncode($uploadButtonId)"&gt;$core_v2_language.GetResource('StatusMessage_UploadFile')&lt;/a&gt;
		&lt;a href="#" class="remove" id="$core_v2_encoding.HtmlAttributeEncode($removeButtonId)" style="display: none;"&gt;$core_v2_language.GetResource('RemoveFile')&lt;/a&gt;
	&lt;/div&gt;

&lt;/fieldset&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.createStatus.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			bodyId : '#$core_v2_encoding.JavascriptEncode($bodyId)',
			uploadFileUrl : '$core_v2_encoding.JavascriptEncode($uploadUrl)',
			uploadContextId : '$core_v2_encoding.JavascriptEncode($contextId)',
			uploadButtonId: "$core_v2_encoding.JavascriptEncode($uploadButtonId)",
			removeButtonId: "$core_v2_encoding.JavascriptEncode($removeButtonId)",
			previewAttachmentUrl: "$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('preview-attachment.vm'))",
			progressMessage: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('Uploading'))',
			changeFileMessage: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('ChangeFile'))',
			uploadFileMessage: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('StatusMessage_UploadFile'))',
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			addStatusUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('add-status.vm'))',
			groupId: $groupId
		});

		jQuery.telligent.evolution.mobile.refreshable(false);
		jQuery.telligent.evolution.mobile.excludeFromHistory();
	});
})
&lt;/script&gt;
		

		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
			<resource name="CreateStatus_Name">Create Status</resource>
			<resource name="post">Post</resource>
			<resource name="invalid_file_type">The file type is invalid.</resource>
			<resource name="StatusMessage_UploadFile">Add a photo, video or file</resource>
			<resource name="RemoveFile">Remove file</resource>
			<resource name="ChangeFile">Change file</resource>
			<resource name="Uploading">Uploading ({0}%)...</resource>
			<resource name="home">Home</resource>
			<resource name="create_status">Add status</resource>
		  </language>
		</languageResources>
    <files>
      <file name="add-status.vm">JGNvcmVfdjJfcGFnZS5TZXRDb250ZW50VHlwZSgnYXBwbGljYXRpb24vanNvbicpDQoNCiNpZiAoJGNvcmVfdjJfcGFnZS5Jc1Bvc3QpDQoJI3NldCgkZ3JvdXBJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJGNvcmVfdjJfcGFnZS5HZXRGb3JtVmFsdWUoJ2dyb3VwSWQnKSkpDQoJI3NldCgkbWVzc2FnZUJvZHkgPSAkY29yZV92Ml9wYWdlLkdldEZvcm1WYWx1ZSgnbWVzc2FnZScpKQ0KCSNzZXQoJGdyb3VwID0gZmFsc2UpDQoJI3NldCgkZ3JvdXAgPSAkY29yZV92Ml9ncm91cC5HZXQoIiV7IElkID0gJyR7Z3JvdXBJZH0nfSIpKQ0KCSNzZXQoJGZpbGVOYW1lID0gZmFsc2UpDQoJI3NldCgkZmlsZU5hbWUgPSAkY29yZV92Ml9wYWdlLkdldEZvcm1WYWx1ZSgnZmlsZU5hbWUnKSkNCgkjc2V0KCRjb250ZXh0SWQgPSBmYWxzZSkNCgkjc2V0KCRjb250ZXh0SWQgPSAkY29yZV92Ml9wYWdlLkdldEZvcm1WYWx1ZSgnY29udGV4dElkJykpDQoJI3NldCgkb3B0aW9ucyA9ICIle30iKQ0KDQoJI2lmICgkZmlsZU5hbWUgJiYgJGZpbGVOYW1lLmxlbmd0aCA+IDAgJiYgJGNvbnRleHRJZCkNCgkJI3NldCAoJGF0dGFjaGVkRmlsZSA9ICRjb3JlX3YyX3VwbG9hZGVkRmlsZS5HZXQoJGNvbnRleHRJZCwgJGZpbGVOYW1lKSkNCgkJI2lmICgkYXR0YWNoZWRGaWxlKQ0KCQkJJG9wdGlvbnMuQWRkKCdBdHRhY2hlZFVybCcsICRhdHRhY2hlZEZpbGUuVXJsKQ0KCQkjZW5kDQoJI2VuZA0KDQoJI2lmICgkZ3JvdXAgJiYgJGdyb3VwLlBhcmVudEdyb3VwSWQgIT0gLTEpDQoJCSRvcHRpb25zLkFkZCgnR3JvdXBJZCcsICRncm91cC5JZCkNCgkjZW5kDQoNCgkjc2V0ICgkbWVzc2FnZSA9ICRjb3JlX3YyX3N0YXR1c01lc3NhZ2UuQ3JlYXRlKCRtZXNzYWdlQm9keSwgJG9wdGlvbnMpKQ0KCSNpZiAoJG1lc3NhZ2UuRXJyb3JzLkNvdW50ID4gMCkNCgkJJGNvcmVfdjJfcGFnZS5TZW5kSnNvbkVycm9yKCRtZXNzYWdlLkVycm9ycykNCgkjZWxzZQ0KCQkkY29yZV92Ml9wYWdlLlNldENvbnRlbnRUeXBlKCdhcHBsaWNhdGlvbi9qc29uJykNCgkJeyJzdWNjZXNzIjogInRydWUifQ0KCSNlbmQNCiNlbmQ=</file>
      <file name="preview-attachment.vm">IyMgTG9hZHMgQXR0YWNobWVudCBQcmV2aWV3DQojc2V0KCRtZXNzYWdlQm9keSA9ICRjb3JlX3YyX3BhZ2UuR2V0Rm9ybVZhbHVlKCd3X21lc3NhZ2VCb2R5JykpDQojc2V0KCRncm91cElkID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUludCgkY29yZV92Ml9wYWdlLkdldEZvcm1WYWx1ZSgnd19ncm91cElkJykpKQ0KDQojc2V0ICgkYXR0YWNoZWRGaWxlTmFtZSA9IGZhbHNlKQ0KI3NldCAoJGF0dGFjaGVkRmlsZU5hbWUgPSAkY29yZV92Ml9wYWdlLkdldEZvcm1WYWx1ZSgnd19hdHRhY2hlZEZpbGVOYW1lJykpDQojc2V0ICgkYXR0YWNoZWRGaWxlQ29udGV4dCA9IGZhbHNlKQ0KI3NldCAoJGF0dGFjaGVkRmlsZUNvbnRleHQgPSAkY29yZV92Ml9wYWdlLkdldEZvcm1WYWx1ZSgnd19hdHRhY2hlZEZpbGVDb250ZXh0JykpDQojc2V0ICgkYXR0YWNoZWRVcmwgPSBmYWxzZSkNCiNpZiAoJGF0dGFjaGVkRmlsZU5hbWUubGVuZ3RoID4gMCAmJiAkYXR0YWNoZWRGaWxlQ29udGV4dC5sZW5ndGggPiAwKQ0KICAgICNzZXQgKCRhdHRhY2hlZEZpbGUgPSBmYWxzZSkNCgkjc2V0ICgkYXR0YWNoZWRGaWxlID0gJGNvcmVfdjJfdXBsb2FkZWRGaWxlLkdldCgkYXR0YWNoZWRGaWxlQ29udGV4dCwgJGF0dGFjaGVkRmlsZU5hbWUpKQ0KCSNpZiAoJGF0dGFjaGVkRmlsZSkNCgkgICAjc2V0ICgkYXR0YWNoZWRVcmwgPSAkYXR0YWNoZWRGaWxlLlVybCkNCgkjZW5kDQojZW5kDQoNCiNzZXQgKCRvcHRpb25zID0gIiV7IEdyb3VwSWQgPSAkZ3JvdXBJZCB9IikNCiNpZiAoJGF0dGFjaGVkVXJsKQ0KICAgICRvcHRpb25zLkFkZCgnQXR0YWNoZWRVcmwnLCAkYXR0YWNoZWRVcmwpDQojZW5kDQoNCiRjb3JlX3YyX3N0YXR1c01lc3NhZ2UuUHJldmlld0F0dGFjaG1lbnQoJG1lc3NhZ2VCb2R5LCAkb3B0aW9ucyk=</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCwgdW5kZWYpew0KDQoJdmFyIGNyZWF0ZVN0YXR1cyA9IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygpOw0KCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnBvc3Qoew0KCQkJdXJsOiBvcHRpb25zLmFkZFN0YXR1c1VybCwNCgkJCWRhdGE6IHsNCgkJCQltZXNzYWdlOiBvcHRpb25zLm1lc3NhZ2UuZXZvbHV0aW9uQ29tcG9zZXIoJ3ZhbCcpLA0KCQkJCWZpbGVOYW1lOiBvcHRpb25zLmF0dGFjaGVkRmlsZU5hbWUsDQoJCQkJY29udGV4dElkOiBvcHRpb25zLnVwbG9hZENvbnRleHRJZCwNCgkJCQlncm91cElkOiBvcHRpb25zLmdyb3VwSWQNCgkJCX0sDQoJCQlzdWNjZXNzOiBmdW5jdGlvbihyZXNwb25zZSkgew0KCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuYmFjayh0cnVlKTsNCgkJCX0sDQoJCQlmYWlsOiBmdW5jdGlvbigpIHsNCgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmhpZGVMb2FkaW5nKCk7DQoJCQl9DQoJCX0pOw0KCX0sDQoJbG9hZFByZXZpZXcgPSAgZnVuY3Rpb24oY29udGV4dCwgZmlsZU5hbWUpIHsNCgkJaWYoZmlsZU5hbWUpICB7DQoJCQljb250ZXh0LmF0dGFjaGVkRmlsZU5hbWUgPSBmaWxlTmFtZTsNCgkJfQ0KCQljbGVhclRpbWVvdXQoY29udGV4dC5wcmV2aWV3VGltZW91dCk7DQoJCWNvbnRleHQucHJldmlld1RpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7DQoJCQl2YXIgZGF0YSA9IHsNCgkJCQl3X21lc3NhZ2VCb2R5OiBjb250ZXh0Lm1lc3NhZ2UuZXZvbHV0aW9uQ29tcG9zZXIoJ3ZhbCcpLA0KCQkJCXdfZ3JvdXBJZDogY29udGV4dC5ncm91cElkDQoJCQl9Ow0KCQkJaWYoY29udGV4dC5hdHRhY2hlZEZpbGVOYW1lKSB7DQoJCQkJZGF0YS53X2F0dGFjaGVkRmlsZU5hbWUgPSBjb250ZXh0LmF0dGFjaGVkRmlsZU5hbWU7DQoJCQkJZGF0YS53X2F0dGFjaGVkRmlsZUNvbnRleHQgPSBjb250ZXh0LnVwbG9hZENvbnRleHRJZDsNCgkJCX0NCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5wb3N0KHsNCgkJCQl1cmw6IGNvbnRleHQucHJldmlld0F0dGFjaG1lbnRVcmwsDQoJCQkJZGF0YTogZGF0YSwNCgkJCQlzdWNjZXNzOiBmdW5jdGlvbihyZXNwb25zZSkgew0KCQkJCQlyZXNwb25zZSA9ICQudHJpbShyZXNwb25zZSk7DQoJCQkJCWlmKHJlc3BvbnNlICYmIHJlc3BvbnNlLmxlbmd0aCA+IDApIHsNCgkJCQkJCWlmIChyZXNwb25zZSAhPT0gY29udGV4dC5wcmV2aWV3Q29udGVudCkgew0KCQkJCQkJCWNvbnRleHQucHJldmlld0NvbnRlbnQgPSByZXNwb25zZTsNCgkJCQkJCQljb250ZXh0LnByZXZpZXdDb250YWluZXIuaHRtbChjb250ZXh0LnByZXZpZXdDb250ZW50KTsNCgkJCQkJCQljb250ZXh0LnByZXZpZXdDb250YWluZXIuc2xpZGVEb3duKDEwMCk7DQoJCQkJCQkJaWYoY29udGV4dC5wb3N0KQ0KCQkJCQkJCQljb250ZXh0LnBvc3Quc2hvdygpOw0KCQkJCQkJfQ0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJY29udGV4dC5wcmV2aWV3Q29udGVudCA9ICcnOw0KCQkJCQkJY29udGV4dC5wcmV2aWV3Q29udGFpbmVyLmh0bWwoJycpOw0KCQkJCQkJY29udGV4dC5wcmV2aWV3Q29udGFpbmVyLnNsaWRlVXAoMTAwKTsNCgkJCQkJCWlmKCEkKCdib2R5JykuaGFzQ2xhc3MoJ3RvdWNoJykgJiYgY29udGV4dC5wb3N0KQ0KCQkJCQkJCWNvbnRleHQucG9zdC5oaWRlKCk7DQoJCQkJCX0NCgkJCQl9DQoJCQl9KTsNCgkJfSwgMTUwKTsNCgl9LA0KCWNsZWFyUHJldmlldyA9IGZ1bmN0aW9uKGNvbnRleHQpIHsNCgkJY29udGV4dC5wcmV2aWV3Q29udGFpbmVyLnNsaWRlVXAoMTAwKTsNCgkJY2xlYXJUaW1lb3V0KGNvbnRleHQucHJldmlld1RpbWVvdXQpOw0KCQljb250ZXh0LmF0dGFjaGVkRmlsZU5hbWUgPSBudWxsOw0KCQljb250ZXh0LnByZXZpZXdDb250ZW50ID0gbnVsbDsNCgkJY29udGV4dC5wcmV2aWV3Q29udGFpbmVyLmVtcHR5KCk7DQoJfSwNCglpbml0aWFsaXplRmlsZVVwbG9hZCA9IGZ1bmN0aW9uKGNvbnRleHQpIHsNCgkJY29udGV4dC5maWxlVXBsb2FkLmdsb3dVcGxvYWQoew0KCQkJZmlsZUZpbHRlcjogbnVsbCwNCgkJCXVwbG9hZFVybDogY29udGV4dC51cGxvYWRGaWxlVXJsLA0KCQkJcmVuZGVyTW9kZTogJ2xpbmsnDQoJCX0pLm9uKCdnbG93VXBsb2FkQmVndW4nLCBmdW5jdGlvbihlKSB7DQoJCQljb250ZXh0LnVwbG9hZGluZyA9IHRydWU7DQoJCQl2YWxpZGF0ZShjb250ZXh0KTsNCgkJCWNvbnRleHQuZmlsZVVwbG9hZC5odG1sKGNvbnRleHQucHJvZ3Jlc3NNZXNzYWdlLnJlcGxhY2UoJ3swfScsIDApKTsNCgkJCSQoJyMnICsgY29udGV4dC51cGxvYWRCdXR0b25JZCkucmVtb3ZlQ2xhc3MoJ3dpdGgtaWNvbicpOw0KCQl9KS5vbignZ2xvd1VwbG9hZENvbXBsZXRlJywgZnVuY3Rpb24oZSwgZmlsZSkgew0KCQkJbG9hZFByZXZpZXcoY29udGV4dCwgZmlsZS5uYW1lKTsNCgkJCWNvbnRleHQudXBsb2FkaW5nID0gZmFsc2U7DQoJCQljb250ZXh0LmZpbGVVcGxvYWQuaHRtbChjb250ZXh0LmNoYW5nZUZpbGVNZXNzYWdlKS5yZW1vdmVDbGFzcygndXBsb2FkJykuYWRkQ2xhc3MoJ2NoYW5nZScpOw0KCQkJY29udGV4dC5maWxlUmVtb3ZlLnNob3coKTsNCgkJCXZhbGlkYXRlKGNvbnRleHQpOw0KCQl9KS5vbignZ2xvd1VwbG9hZEZpbGVQcm9ncmVzcycsIGZ1bmN0aW9uKGUsIGRldGFpbHMpIHsNCgkJCWNvbnRleHQuZmlsZVVwbG9hZC5odG1sKGNvbnRleHQucHJvZ3Jlc3NNZXNzYWdlLnJlcGxhY2UoJ3swfScsIGRldGFpbHMucGVyY2VudCkpOw0KCQl9KTsNCgl9LA0KCXZhbGlkYXRlID0gZnVuY3Rpb24oY29udGV4dCkgew0KCQlpZiAoJC50cmltKGNvbnRleHQubWVzc2FnZS52YWwoKSkgPT0gIiIgfHwgY29udGV4dC51cGxvYWRpbmcgPT09IHRydWUpIHsNCgkJCXJldHVybiBmYWxzZTsNCgkJfQ0KDQoJCXJldHVybiB0cnVlOw0KCX0sDQoJcmVtb3ZlRmlsZSA9IGZ1bmN0aW9uKGNvbnRleHQpIHsNCgkJY29udGV4dC5maWxlUmVtb3ZlLmhpZGUoKTsNCgkJY29udGV4dC5hdHRhY2hlZEZpbGVOYW1lID0gbnVsbDsNCgkJY29udGV4dC51cGxvYWRpbmcgPSBmYWxzZTsNCgkJbG9hZFByZXZpZXcoY29udGV4dCk7DQoJCWNvbnRleHQuZmlsZVVwbG9hZC5odG1sKGNvbnRleHQudXBsb2FkRmlsZU1lc3NhZ2UpLmFkZENsYXNzKCd1cGxvYWQnKS5yZW1vdmVDbGFzcygnY2hhbmdlJyk7DQoJCSQoJyMnICsgY29udGV4dC51cGxvYWRCdXR0b25JZCkuYWRkQ2xhc3MoJ3dpdGgtaWNvbicpOw0KCX07DQoNCgl2YXIgYXBpID0gew0KCQlyZWdpc3RlcjogZnVuY3Rpb24ob3B0aW9ucykgew0KCQkJb3B0aW9ucy53cmFwcGVyID0gJChvcHRpb25zLndyYXBwZXIpOw0KCQkJb3B0aW9ucy5maWxlVXBsb2FkID0gJCgnLnVwbG9hZCcsIG9wdGlvbnMud3JhcHBlcik7DQoJCQlvcHRpb25zLnByZXZpZXdDb250YWluZXIgPSAkKCcucHJldmlldycsIG9wdGlvbnMud3JhcHBlcik7DQoJCQlvcHRpb25zLmZpbGVSZW1vdmUgPSAkKCcucmVtb3ZlJywgb3B0aW9ucy53cmFwcGVyKTsNCgkJCW9wdGlvbnMubWVzc2FnZSA9ICQob3B0aW9ucy5ib2R5SWQpOw0KCQkJb3B0aW9ucy5wcmV2aWV3VGltZW91dCA9IG51bGw7DQoJCQlvcHRpb25zLmF0dGFjaGVkRmlsZU5hbWUgPSBudWxsOw0KCQkJb3B0aW9ucy5wcmV2aWV3Q29udGVudCA9IG51bGw7DQoJCQlvcHRpb25zLnVwbG9hZGluZyA9IGZhbHNlOw0KCQkJdmFyIHBvc3RMaW5rOw0KDQoJCQlwb3N0TGluayA9ICQoJzxhIGhyZWY9IiMiIGNsYXNzPSJzdWJtaXQiPicgKyBvcHRpb25zLnBvc3RMYWJlbCArICc8L2E+Jyk7DQoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNldEhlYWRlckJ1dHRvbihwb3N0TGluayk7DQoJCQlwb3N0TGluay5oaWRlKCk7DQoNCgkJCW9wdGlvbnMubWVzc2FnZS5ldm9sdXRpb25Db21wb3Nlcih7DQoJCQkJcGx1Z2luczogWydtZW50aW9ucycsJ2hhc2h0YWdzJywndXJsaGlnaGxpZ2h0J10sDQoJCQkJZm9jdXM6IGZhbHNlDQoJCQl9KS5ldm9sdXRpb25Db21wb3Nlcignb25pbnB1dCcsIGZ1bmN0aW9uKGUpew0KCQkJCWNsZWFyVGltZW91dChvcHRpb25zLmlucHV0UHJldmlld0hhbmRsZSk7DQoJCQkJb3B0aW9ucy5pbnB1dFByZXZpZXdIYW5kbGUgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgew0KCQkJCQlsb2FkUHJldmlldyhvcHRpb25zKTsNCgkJCQl9LCA5OTkpOw0KCQkJfSkuZm9jdXMoZnVuY3Rpb24oKXsNCgkJCQlwb3N0TGluay5zaG93KCk7DQoJCQl9KS5ibHVyKGZ1bmN0aW9uKCl7DQoJCQkJdmFsaWRhdGUob3B0aW9ucyk7DQoJCQl9KS5mb2N1cygpOw0KDQoJCQlpbml0aWFsaXplRmlsZVVwbG9hZChvcHRpb25zKTsNCg0KCQkJb3B0aW9ucy5maWxlUmVtb3ZlLmNsaWNrKGZ1bmN0aW9uKCkgew0KCQkJCXJlbW92ZUZpbGUob3B0aW9ucyk7DQoJCQkJcmV0dXJuIGZhbHNlOw0KCQkJfSk7DQoNCg0KCQkJcG9zdExpbmsub24oJ3RhcCcsIGZ1bmN0aW9uKCl7DQoJCQkJaWYgKHZhbGlkYXRlKG9wdGlvbnMpKSB7DQoJCQkJCWNyZWF0ZVN0YXR1cyhvcHRpb25zKTsNCgkJCQl9DQoJCQkJcmV0dXJuIGZhbHNlOw0KCQkJfSk7DQoNCgkJCXZhbGlkYXRlKG9wdGlvbnMpOw0KCQl9DQoJfQ0KDQoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24gPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24gfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5jcmVhdGVTdGF0dXMgPSBhcGk7DQoNCn0pKGpRdWVyeSwgd2luZG93KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:FeaturedContentSlider_Name}" description="" instanceIdentifier="387656725d5b48bdae2c451035b95d4d" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="featured-content-slider">
    <contentScript>
	
#set ($pageSize = 5)
#set ($transition = 'transitionAutomatic')
#set ($duration = 5000)
#set ($shadowText = true)
#set ($featureCount = 0)
#set ($featureBackground = '#444')
#set ($featureForeground = false)

#set ($previousId = $core_v2_widget.UniqueId('previous'))
#set ($nextId = $core_v2_widget.UniqueId('next'))

## collect content features
#set ($group = $core_v2_group.Current)
#set ($contentFeatures = $core_v2_feature.List("%{ GroupId = $group.Id, Count = $pageSize }"))
#if (!$contentFeatures || $contentFeatures.Count == 0)
	$core_v2_widget.Hide()
#end

#foreach ($featuredContent in $contentFeatures)
#beforeall
	&lt;div class="featured-content-slider"&gt;
		&lt;div class="content-list-wrapper"&gt;
			&lt;ul class="content-list content"&gt;
#each
				#set ($feature = "%{ Shadow = $shadowText, Image = $featuredContent.Image, Url = $featuredContent.Url, Title = $featuredContent.Title, Description = $featuredContent.Content, Background = $featureBackground, Foreground = $featureForeground }")
				#if ($featuredContent.User)
					$feature.Add('UserAvatarUrl', $featuredContent.User.AvatarUrl)
					$feature.Add('UserProfileUrl', $featuredContent.User.ProfileUrl)
					$feature.Add('UserDisplayName', $featuredContent.User.DisplayName)
				#end

				#set ($hasImageMedia = false)
				#if ($feature.Image &amp;&amp; $feature.Image.length &gt; 0)
					#set ($mediaType = $core_v2_ui.GetMediaType($feature.Image, "%{ ViewType = 'View' }"))
					#if ($mediaType == 'Image')
						#set ($hasImageMedia = true)
					#end
				#end

				&lt;li class="content-item"
					style="
						#if ($feature.Foreground)
							color: $feature.Foreground;
						#end
						#if ($feature.Background)
							background-color: $feature.Background;
						#end
					"&gt;
					#if ($hasImageMedia)
						&lt;div class="avatar-container"&gt;
							&lt;div class="avatar-wrapper"&gt;
								&lt;div class="avatar #if ($hasImageMedia &amp;&amp; $feature.Shadow) shadowed #end"&gt;
									$core_v2_ui.GetResizedImageHtml($feature.Image, 640, 214, "%{ border='0px', ResizeMethod = 'ZoomAndCrop' }")
								&lt;/div&gt;
							&lt;/div&gt;
						&lt;/div&gt;
					#end

					&lt;div class="caption #if ($hasImageMedia &amp;&amp; $feature.Shadow) shadowed #end"&gt;
						#if ($feature.Title &amp;&amp; $feature.Title.length &gt; 0)
							&lt;h3 class="name"&gt;
								#if ($feature.Url &amp;&amp; $feature.Url.length &gt; 0)
									&lt;a href="$core_v2_encoding.HtmlAttributeEncode($feature.Url)"
										class="internal-link view-post"
										#if ($feature.Foreground) style="color: $feature.Foreground" #end
										&gt;
										$core_v2_language.Truncate($feature.Title, 35, '...')
									&lt;/a&gt;
								#else
									$core_v2_language.Truncate($feature.Title, 35, '...')
								#end
							&lt;/h3&gt;
						#end

						#if ($feature.UserAvatarUrl &amp;&amp; $feature.UserAvatarUrl.length &gt; 0 &amp;&amp; $feature.UserDisplayName &amp;&amp; $feature.UserDisplayName.length &gt; 0)
							&lt;div class="author"&gt;
								&lt;div class="avatar"&gt;
									#if ($feature.UserProfileUrl &amp;&amp; $feature.UserProfileUrl.length &gt; 0)
										&lt;a href="$core_v2_encoding.HtmlAttributeEncode($feature.UserProfileUrl)"&gt;
											$core_v2_ui.GetResizedImageHtml($feature.UserAvatarUrl, 20, 20, "%{border='0px', alt=$feature.UserDisplayName, ResizeMethod = 'ZoomAndCrop' }")
										&lt;/a&gt;
									#else
										$core_v2_ui.GetResizedImageHtml($feature.UserAvatarUrl, 20, 20, "%{border='0px', alt=$feature.UserDisplayName, ResizeMethod = 'ZoomAndCrop' }")
									#end
								&lt;/div&gt;
								&lt;span class="user-name"&gt;
									#if ($feature.UserProfileUrl &amp;&amp; $feature.UserProfileUrl.length &gt; 0)
										&lt;a href="$core_v2_encoding.HtmlAttributeEncode($feature.UserProfileUrl)" class="internal-link view-user-profile"&gt;
											$core_v2_language.Truncate($feature.UserDisplayName, 50, '...')
										&lt;/a&gt;
									#else
										$core_v2_language.Truncate($feature.UserDisplayName, 50, '...')
									#end
								&lt;/span&gt;
							&lt;/div&gt;
						#end

						#if ($feature.Description &amp;&amp; $feature.Description.length &gt; 0)
							&lt;div class="content"&gt;
								$core_v2_language.Truncate($feature.Description, 25, '...')
							&lt;/div&gt;
						#end
					&lt;/div&gt;
				&lt;/li&gt;
#afterall
			&lt;/ul&gt;
		&lt;/div&gt;
		#if ($contentFeatures.Count &gt; 1)
			&lt;a href="#" id="$core_v2_encoding.HtmlAttributeEncode($previousId)" class="navigation previous"&gt;Previous&lt;/a&gt;
			&lt;a href="#" id="$core_v2_encoding.HtmlAttributeEncode($nextId)" class="navigation next"&gt;Next&lt;/a&gt;
			#set ($maxFeatutureIndex = $contentFeatures.Count - 1)
			#foreach($i in [0..$maxFeatutureIndex])
			#beforeall
				&lt;div class="feature-links"&gt;
					&lt;ul&gt;
			#each
						&lt;li&gt;
							&lt;a href="#" class="feature-link" data-featureindex="$i"&gt;
								$core_v2_language.FormatString($core_v2_language.GetResource("feature"), $i.ToString())
							&lt;/a&gt;
						&lt;/li&gt;
			#afterall
					&lt;/ul&gt;
				&lt;/div&gt;
			#end
		#end
	&lt;/div&gt;

	&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
	&lt;script&gt;
		jQuery(function(){
			jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
				jQuery.telligent.evolution.widgets.featuredContentList.register({
					wrapper: '#$core_v2_widget.WrapperElementId',
					automatic: #if ($transition == 'transitionAutomatic') true #else false #end,
					duration: $duration,
					previousId: '#$core_v2_encoding.JavascriptEncode($previousId)',
					nextId: '#$core_v2_encoding.JavascriptEncode($nextId)'
				});
			});
		});
	&lt;/script&gt;
#end

	
	</contentScript>
    <headerScript>
	</headerScript>
    <languageResources>
<language key="en-us">
	<resource name="FeaturedContentSlider_Name">Featured Content Slider</resource>
	<resource name="feature">Feature {0}</resource>
</language>
		</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCkgew0KDQoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24gPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24gfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyB8fCB7fTsNCg0KCWZ1bmN0aW9uIGluaXQoY29udGV4dCwgcmVzaXplZCkgew0KCQlpZihyZXNpemVkKSB7DQoJCQljb250ZXh0Lmxpc3RXcmFwcGVyLmNzcyh7DQoJCQkJJ29wYWNpdHknOiAwDQoJCQl9KTsNCgkJCWNvbnRleHQubGlzdC5jc3Moew0KCQkJCXBvc2l0aW9uOiAnc3RhdGljJywNCgkJCQl3aWR0aDogJzEwMCUnDQoJCQl9KTsNCgkJCWNvbnRleHQubGlzdC5maW5kKCcuY29udGVudC1pdGVtJykuY3NzKHsNCgkJCQknd2lkdGgnOiAnMTAwJScsDQoJCQkJJ2Zsb2F0JzogJ25vbmUnDQoJCQl9KTsNCgkJfQ0KCQljb250ZXh0Lmxpc3RXcmFwcGVyLmNzcyh7DQoJCQknb3BhY2l0eSc6IDAsDQoJCQknb3ZlcmZsb3cnOiAnaGlkZGVuJw0KCQl9KTsNCg0KCQkvLyBjb2xsZWN0IGxpc3QgaXRlbXMNCgkJLy8gY29sbGVjdCB0aGUgZnVsbCB3aWR0aCwgYW5kIG1ha2UgdGhlIHdpZHRoIG9mIGVhY2ggcGFuZSBleHBsaWNpdA0KCQl2YXIgZnVsbFdpZHRoID0gMDsNCgkJY29udGV4dC5saXN0SXRlbXMgPSBbXTsNCgkJY29udGV4dC5saXN0LmZpbmQoJy5jb250ZW50LWl0ZW0nKS5lYWNoKGZ1bmN0aW9uKCl7DQoJCQl2YXIgcGFuZSA9ICQodGhpcyk7DQoJCQl2YXIgd2lkdGggPSBwYW5lLndpZHRoKCk7DQoJCQljb250ZXh0Lmxpc3RJdGVtcy5wdXNoKHsNCgkJCQllbG06IHBhbmUsDQoJCQkJb2Zmc2V0OiBmdWxsV2lkdGgNCgkJCX0pOw0KCQkJcGFuZS5jc3Moew0KCQkJCSd3aWR0aCc6IHdpZHRoLA0KCQkJCSdwb3NpdGlvbic6ICdhYnNvbHV0ZScsDQoJCQkJJ2xlZnQnOiBmdWxsV2lkdGggKyAncHgnLA0KCQkJCSd0b3AnOiAnMHB4Jw0KCQkJfSk7DQoNCgkJCXZhciBvZmZzZXQgPSBmdWxsV2lkdGgsDQoJCQkJc3RhcnRYLA0KCQkJCW1vdmVUaHJlc2hvbGQgPSB3aWR0aCAvIDIsDQoJCQkJZGlmZjsNCgkJCXBhbmUub2ZmKCdzd2lwZWxlZnQnKQ0KCQkJCS5vZmYoJ3N3aXBlcmlnaHQnKQ0KCQkJCS5vZmYoJ3BhbnN0YXJ0JykNCgkJCQkub2ZmKCdwYW4nKQ0KCQkJCS5vZmYoJ3BhbmVuZCcpDQoJCQkJLm9uKHsNCgkJCQkJc3dpcGVsZWZ0OiBmdW5jdGlvbihlKSB7DQoJCQkJCQlpZihjb250ZXh0LnN1cHByZXNzUGFubmluZykgcmV0dXJuOw0KCQkJCQkJaWYoIWNvbnRleHQuc2hvdWxkSGFuZGxlR2VzdHVyZXMpIHJldHVybjsNCgkJCQkJCW1vdmVOZXh0KGNvbnRleHQpOw0KCQkJCQkJc3RhcnRSZXNldEF1dG9QYWdlKGNvbnRleHQpOw0KCQkJCQkJZS5wcmV2ZW50RGVmYXVsdCgpOw0KCQkJCQkJcmV0dXJuIGZhbHNlOw0KCQkJCQl9LA0KCQkJCQlzd2lwZXJpZ2h0OiBmdW5jdGlvbihlKSB7DQoJCQkJCQlpZihjb250ZXh0LmN1cnJlbnRJbmRleCA+IDApDQoJCQkJCQkJZS5wcmV2ZW50RGVmYXVsdCgpOw0KDQoJCQkJCQlpZihjb250ZXh0LnN1cHByZXNzUGFubmluZykgcmV0dXJuOw0KCQkJCQkJaWYoIWNvbnRleHQuc2hvdWxkSGFuZGxlR2VzdHVyZXMpIHJldHVybjsNCgkJCQkJCW1vdmVQcmV2aW91cyhjb250ZXh0KTsNCgkJCQkJCXN0YXJ0UmVzZXRBdXRvUGFnZShjb250ZXh0KTsNCgkJCQkJCWUucHJldmVudERlZmF1bHQoKTsNCgkJCQkJCXJldHVybiBmYWxzZTsNCgkJCQkJfSwNCgkJCQkJcG9pbnRlcm1vdmU6IGZ1bmN0aW9uKGUpIHsNCgkJCQkJCWlmKGNvbnRleHQucGFubmluZykgew0KCQkJCQkJCWUucHJldmVudERlZmF1bHQoKTsNCgkJCQkJCQlyZXR1cm4gZmFsc2U7DQoJCQkJCQl9DQoJCQkJCX0sDQoJCQkJCXBhbnN0YXJ0OiBmdW5jdGlvbihlKSB7DQoJCQkJCQlpZighKGUuZGlyZWN0aW9uID09ICdsZWZ0JyB8fCAoZS5kaXJlY3Rpb24gPT0gJ3JpZ2h0JyAmJiBjb250ZXh0LmN1cnJlbnRJbmRleCA+IDApKSkgcmV0dXJuOw0KCQkJCQkJaWYoIWNvbnRleHQuc2hvdWxkSGFuZGxlR2VzdHVyZXMpIHJldHVybjsNCgkJCQkJCXN0YXJ0WCA9IGUucGFnZVg7DQoJCQkJCQljb250ZXh0LnBhbm5pbmcgPSB0cnVlOw0KCQkJCQkJc3RvcEF1dG9QYWdlKGNvbnRleHQpOw0KCQkJCQl9LA0KCQkJCQlwYW46IGZ1bmN0aW9uKGUpIHsNCgkJCQkJCWlmKChlLmRpcmVjdGlvbiA9PSAnbGVmdCcgfHwgKGUuZGlyZWN0aW9uID09ICdyaWdodCcgJiYgY29udGV4dC5jdXJyZW50SW5kZXggPiAwKSkpDQoJCQkJCQkJZS5wcmV2ZW50RGVmYXVsdCgpOw0KCQkJCQkJaWYoIWNvbnRleHQuc3VwcHJlc3NQYW5uaW5nICYmIChlLmRpcmVjdGlvbiA9PSAnbGVmdCcgfHwgKGUuZGlyZWN0aW9uID09ICdyaWdodCcgJiYgY29udGV4dC5jdXJyZW50SW5kZXggPiAwKSkpIHsNCgkJCQkJCQllLnByZXZlbnREZWZhdWx0KCk7DQoJCQkJCQkJaWYoIWNvbnRleHQuc2hvdWxkSGFuZGxlR2VzdHVyZXMpIHJldHVybjsNCgkJCQkJCQlkaWZmID0gZS5wYWdlWCAtIHN0YXJ0WDsNCgkJCQkJCQljb250ZXh0Lmxpc3QuZXZvbHV0aW9uVHJhbnNmb3JtKHsNCgkJCQkJCQkJbGVmdDogKC0xICogKG9mZnNldCAtIGRpZmYpKQ0KCQkJCQkJCX0pDQoJCQkJCQkJcmV0dXJuIGZhbHNlOw0KCQkJCQkJfQ0KCQkJCQl9LA0KCQkJCQlwYW5lbmQ6IGZ1bmN0aW9uKGUpIHsNCgkJCQkJCWlmKGNvbnRleHQuc3VwcHJlc3NQYW5uaW5nKSByZXR1cm47DQoJCQkJCQlpZighY29udGV4dC5zaG91bGRIYW5kbGVHZXN0dXJlcykgcmV0dXJuOw0KCQkJCQkJZGlmZiA9IGUucGFnZVggLSBzdGFydFg7DQoJCQkJCQlpZihNYXRoLmFicyhkaWZmKSA+PSBtb3ZlVGhyZXNob2xkKSB7DQoJCQkJCQkJaWYoZGlmZiA+IDApIHsNCgkJCQkJCQkJaWYoY29udGV4dC5jdXJyZW50SW5kZXggPiAwKQ0KCQkJCQkJCQkJbW92ZVByZXZpb3VzKGNvbnRleHQpOw0KCQkJCQkJCQllbHNlDQoJCQkJCQkJCQltb3ZlVG8oY29udGV4dCwgY29udGV4dC5saXN0SXRlbXMubGVuZ3RoIC0gMSk7DQoJCQkJCQkJfQ0KCQkJCQkJCWVsc2UgaWYoZGlmZiA8PSAwKSB7DQoJCQkJCQkJCWlmKGNvbnRleHQuY3VycmVudEluZGV4IDwgY29udGV4dC5saXN0SXRlbXMubGVuZ3RoIC0gMSkNCgkJCQkJCQkJCW1vdmVOZXh0KGNvbnRleHQpOw0KCQkJCQkJCQllbHNlDQoJCQkJCQkJCQltb3ZlVG8oY29udGV4dCwgMCk7DQoJCQkJCQkJfQ0KCQkJCQkJCWVsc2Ugew0KCQkJCQkJCQltb3ZlVG8oY29udGV4dCwgY29udGV4dC5jdXJyZW50SW5kZXggfHwgMCk7DQoJCQkJCQkJfQ0KCQkJCQkJCXJldHVybiBmYWxzZTsNCgkJCQkJCX0gZWxzZSB7DQoJCQkJCQkJbW92ZVRvKGNvbnRleHQsIGNvbnRleHQuY3VycmVudEluZGV4IHx8IDApOw0KCQkJCQkJfQ0KCQkJCQkJY29udGV4dC5wYW5uaW5nID0gZmFsc2U7DQoJCQkJCQlzdGFydFJlc2V0QXV0b1BhZ2UoY29udGV4dCk7DQoJCQkJCX0NCgkJCQl9KTsNCg0KCQkJZnVsbFdpZHRoID0gZnVsbFdpZHRoICsgd2lkdGg7DQoJCX0pDQoNCgkJaWYoIWNvbnRleHQubGlzdEl0ZW1zIHx8IGNvbnRleHQubGlzdEl0ZW1zLmxlbmd0aCA9PSAwKQ0KCQkJcmV0dXJuOw0KDQoJCWNvbnRleHQuc2hvdWxkSGFuZGxlR2VzdHVyZXMgPSBjb250ZXh0Lmxpc3RJdGVtcy5sZW5ndGggPiAxOw0KDQoJCS8vIG1ha2UgdGhlIHdyYXBwZXINCgkJY29udGV4dC5saXN0LmNzcyh7DQoJCQkncG9zaXRpb24nOiAncmVsYXRpdmUnLA0KCQkJJ3dpZHRoJzogZnVsbFdpZHRoDQoJCX0pOw0KDQoJCWNvbnRleHQubGlzdFdyYXBwZXIuZXZvbHV0aW9uVHJhbnNmb3JtKHsNCgkJCW9wYWNpdHk6IDENCgkJfSwgew0KCQkJZHVyYXRpb246IDIwMA0KCQl9KTsNCg0KCQljb250ZXh0LnN1cHByZXNzUGFubmluZyA9IGZhbHNlOw0KCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnN1YnNjcmliZSgnbW9iaWxlLm5hdmlnYXRpb24ub3BlbmVkJywgZnVuY3Rpb24oKXsNCgkJCXNldFRpbWVvdXQoZnVuY3Rpb24oKXsNCgkJCQljb250ZXh0LnN1cHByZXNzUGFubmluZyA9IHRydWU7DQoJCQl9LCAxMCkNCgkJfSkNCgkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ21vYmlsZS5uYXZpZ2F0aW9uLmNsb3NlZCcsIGZ1bmN0aW9uKCl7DQoJCQljb250ZXh0LnN1cHByZXNzUGFubmluZyA9IGZhbHNlOw0KCQl9KQ0KCX0NCg0KCWZ1bmN0aW9uIG1vdmVUbyhjb250ZXh0LCBpbmRleCkgew0KCQlnbG9iYWwuY2xlYXJUaW1lb3V0KGNvbnRleHQubW92ZURlYm91bmNlKTsNCgkJY29udGV4dC5tb3ZlRGVib3VuY2UgPSBnbG9iYWwuc2V0VGltZW91dChmdW5jdGlvbigpew0KCQkJLy8gbm9ybWFsaXplIGluZGV4DQoJCQlpZihpbmRleCA+PSBjb250ZXh0Lmxpc3RJdGVtcy5sZW5ndGgpDQoJCQkJaW5kZXggPSBjb250ZXh0Lmxpc3RJdGVtcy5sZW5ndGggLSAxOw0KCQkJZWxzZSBpZihpbmRleCA8IDApDQoJCQkJaW5kZXggPSAwOw0KCQkJY29udGV4dC5jdXJyZW50SW5kZXggPSBpbmRleDsNCg0KCQkJc2V0VGltZW91dChmdW5jdGlvbigpew0KCQkJCWNvbnRleHQubGlzdC5ldm9sdXRpb25UcmFuc2Zvcm0oew0KCQkJCQlsZWZ0OiAtMSAqIGNvbnRleHQubGlzdEl0ZW1zW2luZGV4XS5vZmZzZXQNCgkJCQl9LCB7DQoJCQkJCWR1cmF0aW9uOiAyMDANCgkJCQl9KTsNCgkJCX0sIDEpDQoNCgkJCWNvbnRleHQuZmVhdHVyZUxpbmtzLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTsNCgkJCSQoY29udGV4dC5mZWF0dXJlTGlua3MuZ2V0KGluZGV4KSkuYWRkQ2xhc3MoJ2FjdGl2ZScpOw0KCQkJY29udGV4dC5wYW5uaW5nID0gZmFsc2U7DQoJCX0sIDI1KTsNCgl9DQoNCglmdW5jdGlvbiBtb3ZlTmV4dChjb250ZXh0KSB7DQoJCWlmKChjb250ZXh0LmN1cnJlbnRJbmRleCB8fCAwKSA+PSBjb250ZXh0Lmxpc3RJdGVtcy5sZW5ndGggLSAxKQ0KCQkJbW92ZVRvKGNvbnRleHQsIDApOw0KCQllbHNlDQoJCQltb3ZlVG8oY29udGV4dCwgKGNvbnRleHQuY3VycmVudEluZGV4IHx8IDApICsgMSk7DQoJfQ0KDQoJZnVuY3Rpb24gbW92ZVByZXZpb3VzKGNvbnRleHQpIHsNCgkJaWYoKGNvbnRleHQuY3VycmVudEluZGV4IHx8IDApIDw9IDApDQoJCQltb3ZlVG8oY29udGV4dCwgY29udGV4dC5saXN0SXRlbXMubGVuZ3RoIC0gMSk7DQoJCWVsc2UNCgkJCW1vdmVUbyhjb250ZXh0LCAoY29udGV4dC5jdXJyZW50SW5kZXggfHwgMCkgLSAxKTsNCgl9DQoNCglmdW5jdGlvbiBpbml0UGFnaW5nKGNvbnRleHQpIHsNCgkJLy8gZm9yd2FyZC9iYWNrDQoJCWNvbnRleHQubmV4dCA9ICQoY29udGV4dC5uZXh0SWQpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpew0KCQkJZS5wcmV2ZW50RGVmYXVsdCgpOw0KCQkJbW92ZU5leHQoY29udGV4dCk7DQoJCQlzdGFydFJlc2V0QXV0b1BhZ2UoY29udGV4dCk7DQoJCX0pOw0KCQljb250ZXh0LnByZXZpb3VzID0gJChjb250ZXh0LnByZXZpb3VzSWQpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpew0KCQkJZS5wcmV2ZW50RGVmYXVsdCgpOw0KCQkJbW92ZVByZXZpb3VzKGNvbnRleHQpOw0KCQkJc3RhcnRSZXNldEF1dG9QYWdlKGNvbnRleHQpOw0KCQl9KTsNCg0KCQkvLyBzaW5nbGUgaXRlbSBwYWdpbmcNCgkJY29udGV4dC53cmFwcGVyLm9uKCdjbGljaycsICcuZmVhdHVyZS1saW5rJywgZnVuY3Rpb24oZSl7DQoJCQllLnByZXZlbnREZWZhdWx0KCk7DQoJCQltb3ZlVG8oY29udGV4dCwgJCh0aGlzKS5kYXRhKCdmZWF0dXJlaW5kZXgnKSk7DQoJCX0pOw0KCX0NCg0KCWZ1bmN0aW9uIHN0YXJ0UmVzZXRBdXRvUGFnZShjb250ZXh0KSB7DQoJCWdsb2JhbC5jbGVhclRpbWVvdXQoY29udGV4dC5hdXRvSGFuZGxlKTsNCgkJaWYgKGNvbnRleHQuYXV0b21hdGljKSB7DQoJCQljb250ZXh0LmF1dG9IYW5kbGUgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7DQoJCQkJaWYoIWNvbnRleHQucGFubmluZykNCgkJCQkJbW92ZU5leHQoY29udGV4dCk7DQoNCgkJCQlzdGFydFJlc2V0QXV0b1BhZ2UoY29udGV4dCk7DQoJCQl9LCBjb250ZXh0LmR1cmF0aW9uKTsNCgkJfQ0KCX0NCg0KCWZ1bmN0aW9uIHN0b3BBdXRvUGFnZShjb250ZXh0KSB7DQoJCWdsb2JhbC5jbGVhclRpbWVvdXQoY29udGV4dC5hdXRvSGFuZGxlKTsNCgl9DQoNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5mZWF0dXJlZENvbnRlbnRMaXN0ID0gew0KCQlyZWdpc3RlcjogZnVuY3Rpb24ob3B0aW9ucykgew0KCQkJLy8gY29sbGVjdCBVSSBlbGVtZW50cw0KCQkJb3B0aW9ucy53cmFwcGVyID0gJChvcHRpb25zLndyYXBwZXIpOw0KCQkJb3B0aW9ucy5saXN0ID0gb3B0aW9ucy53cmFwcGVyLmZpbmQoJy5jb250ZW50LWxpc3QnKTsNCgkJCW9wdGlvbnMubGlzdFdyYXBwZXIgPSBvcHRpb25zLmxpc3QucGFyZW50KCcuY29udGVudC1saXN0LXdyYXBwZXInKTsNCgkJCW9wdGlvbnMuZmVhdHVyZUxpbmtzID0gb3B0aW9ucy53cmFwcGVyLmZpbmQoJy5mZWF0dXJlLWxpbmtzIGEnKTsNCgkJCW9wdGlvbnMubGFzdE1vdmUgPSBuZXcgRGF0ZSgpOw0KDQoJCQkvLyBpbml0DQoJCQlpbml0KG9wdGlvbnMsIGZhbHNlKTsNCgkJCWlmKCFvcHRpb25zLmxpc3RJdGVtcyB8fCBvcHRpb25zLmxpc3RJdGVtcy5sZW5ndGggPT0gMCkNCgkJCQlyZXR1cm47DQoJCQltb3ZlVG8ob3B0aW9ucywgMCk7DQoJCQkkKHdpbmRvdykub24oJ3Jlc2l6ZWQnLCBmdW5jdGlvbigpew0KCQkJCWluaXQob3B0aW9ucywgdHJ1ZSk7DQoJCQkJaWYob3B0aW9ucy5jdXJyZW50SW5kZXgpDQoJCQkJCW1vdmVUbyhvcHRpb25zLCBvcHRpb25zLmN1cnJlbnRJbmRleCk7DQoJCQl9KTsNCg0KCQkJaW5pdFBhZ2luZyhvcHRpb25zKTsNCgkJCXN0YXJ0UmVzZXRBdXRvUGFnZShvcHRpb25zKTsNCgkJfQ0KCX07DQoNCn0pKGpRdWVyeSwgd2luZG93KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:ForumList_Name}" version="7.0.0.1" description="" instanceIdentifier="59feef7f27aa473180bb52071008660b" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="forum-list">
    <contentScript>
		
#set($groupId = false)
#set($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#if (!$groupId)
	$core_v2_widget.Hide()
#end

#set($group = $core_v2_group.Get("%{Id=$groupId}"))
&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($group.Url)"&gt;$group.Name&lt;/a&gt;
		&lt;h1&gt;$core_v2_language.GetResource('forums')&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 40, 40, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
&lt;/div&gt;

## load and render forums
&lt;div class="post-list forums"&gt;
	#set($pageIndex = 0)
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.forumList.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))'
		});
	});
})
&lt;/script&gt;
		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="ForumList_Name">Forum List</resource>
		<resource name="no_forums">There are no forums in this group.</resource>
		<resource name="no_threads">No threads</resource>
		<resource name="thread_count">{0} thread</resource>
		<resource name="threads_count">{0} threads</resource>
		<resource name="forums">Forums</resource>
	  </language>
	</languageResources>
    <files>
      <file name="list.vm">I3NldCgkZm9ydW1zID0gJGNvcmVfdjJfZm9ydW0uTGlzdCgiJXtHcm91cElkPSRncm91cElkLFBhZ2VJbmRleD0kcGFnZUluZGV4LFBhZ2VTaXplPTIwLFNvcnRCeT0nTGFzdFBvc3QnLFNvcnRPcmRlcj0nRGVzY2VuZGluZyd9IikpDQojZm9yZWFjaCgkZm9ydW0gaW4gJGZvcnVtcykNCiNlYWNoDQoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIGZvcnVtIiBkYXRhLXRhcmdldHVybD0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkZm9ydW0uVXJsKSI+DQoJCTxkaXYgY2xhc3M9InBvc3Qgd2l0aG91dC1hdmF0YXIiPg0KCQkJPGRpdiBjbGFzcz0iZGV0YWlscyI+DQoJCQkJI2lmICgkZm9ydW0uTGF0ZXN0UG9zdERhdGUpDQoJCQkJCTxkaXYgY2xhc3M9ImRhdGUiPiRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdEFnb0RhdGUoJGZvcnVtLkxhdGVzdFBvc3REYXRlKTwvZGl2Pg0KCQkJCSNlbmQNCgkJCTwvZGl2Pg0KCQkJPGRpdiBjbGFzcz0iY29udGVudCI+DQoJCQkJPGEgaHJlZj0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkZm9ydW0uVXJsKSI+JGZvcnVtLk5hbWU8L2E+DQoJCQk8L2Rpdj4NCgkJCTxkaXYgY2xhc3M9ImFjdGlvbnMiPg0KCQkJCTx1bD4NCgkJCQkJPGxpPg0KCQkJCQkJPHNwYW4gY2xhc3M9ImRldGFpbCB0aHJlYWRzIj4NCgkJCQkJCQkjaWYgKCRmb3J1bS5UaHJlYWRDb3VudCA9PSAwKQ0KCQkJCQkJCQkkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbm9fdGhyZWFkcycpDQoJCQkJCQkJI2Vsc2VpZiAoJGZvcnVtLlRocmVhZENvdW50ID09IDEpDQoJCQkJCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdFN0cmluZygkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgndGhyZWFkX2NvdW50JyksICRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdE51bWJlcigkZm9ydW0uVGhyZWFkQ291bnQpKQ0KCQkJCQkJCSNlbHNlDQoJCQkJCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdFN0cmluZygkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgndGhyZWFkc19jb3VudCcpLCAkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXROdW1iZXIoJGZvcnVtLlRocmVhZENvdW50KSkNCgkJCQkJCQkjZW5kDQoJCQkJCQk8L3NwYW4+DQoJCQkJCTwvbGk+DQoJCQkJPC91bD4NCgkJCTwvZGl2Pg0KCQk8L2Rpdj4NCgk8L2Rpdj4NCiNub2RhdGENCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gZm9ydW0iPjxkaXYgY2xhc3M9Im1lc3NhZ2Ugbm9yZWNvcmRzIj4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbm9fZm9ydW1zJyk8L2Rpdj48L2Rpdj4NCiNhZnRlcmFsbA0KCSNzZXQgKCRoYXNNb3JlID0gZmFsc2UpDQoJI2lmICgkZm9ydW1zLlRvdGFsQ291bnQgPiAoKCRmb3J1bXMuUGFnZUluZGV4ICsgMSkgKiAkZm9ydW1zLlBhZ2VTaXplKSkNCgkJI3NldCgkaGFzTW9yZSA9IHRydWUpDQoJI2VuZA0KCTxkaXYgY2xhc3M9ImRhdGEiICNpZigkaGFzTW9yZSlkYXRhLWhhc21vcmU9InRydWUiI2VuZD48L2Rpdj4NCiNlbmQ=</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBmb3J1bXMNCiMjDQojc2V0ICgkcGFnZUluZGV4ID0gJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X3BhZ2VJbmRleCcpKQ0KI3NldCgkZ3JvdXBJZCA9IGZhbHNlKQ0KI3NldCgkZ3JvdXBJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJG1vYmlsZV92MV91cmxUb2tlbi5WYWx1ZSgnR3JvdXBJZCcpKSkNCiNpZiAoISRncm91cElkKQ0KCSRjb3JlX3YyX3dpZGdldC5IaWRlKCkNCiNlbmQNCiRjb3JlX3YyX3dpZGdldC5FeGVjdXRlRmlsZSgnbGlzdC52bScpDQo=</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2Nyb2xsYWJsZSh7DQoJCQkJcmVnaW9uOiAnY29udGVudCcsDQoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgew0KCQkJCQlpZiAoJChvcHRpb25zLndyYXBwZXIgKyAnIGRpdi5kYXRhOmxhc3QnKS5kYXRhKCdoYXNtb3JlJykpIHsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoew0KCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLA0KCQkJCQkJCWRhdGE6IHsNCgkJCQkJCQkJd19wYWdlSW5kZXg6IHBhZ2VJbmRleA0KCQkJCQkJCX0sDQoJCQkJCQkJc3VjY2VzczogZnVuY3Rpb24ocikgew0KCQkJCQkJCQlzdWNjZXNzKHIpOw0KCQkJCQkJCX0sDQoJCQkJCQkJZXJyb3I6IGZ1bmN0aW9uKCkgew0KCQkJCQkJCQllcnJvcigpOw0KCQkJCQkJCX0NCgkJCQkJCX0pOw0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJc3VjY2VzcygpOw0KCQkJCQl9DQoJCQkJfSwNCgkJCQljb21wbGV0ZTogZnVuY3Rpb24oY29udGVudCkgew0KCQkJCQljb250ZW50ID0gJChjb250ZW50KS5jc3MoeyBvcGFjaXR5OiAwIH0pOw0KCQkJCQkkKG9wdGlvbnMud3JhcHBlcikuZmluZCgnZGl2LnBvc3QtbGlzdCcpLmFwcGVuZChjb250ZW50KTsNCgkJCQkJY29udGVudC5ldm9sdXRpb25UcmFuc2Zvcm0oeyBvcGFjaXR5OiAxIH0sIHsgZHVyYXRpb246IDQwMCB9KTsNCgkJCQl9DQoJCQl9KTsNCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMuZm9ydW1MaXN0ID0gYXBpOw0KDQp9KShqUXVlcnkpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:ForumThread_Name}" version="7.0.0.1" description="" instanceIdentifier="70eb79f7675b42078f78355560839784" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="forumthread">
    <contentScript>
		
$!core_v2_utility.Wait(1000)

#set($threadId = false)
#set($threadId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('ForumThreadId')))
#if (!$threadId)
	$core_v2_widget.Hide()
#end

#set ($accessingUser = $core_v2_user.Accessing)
#set ($accessingUserIsRegistered = false)
#if ($core_v2_user.IsRegistered($accessingUser.Id))
	#set ($accessingUserIsRegistered = true)
#end

#set($thread = $core_v2_forumThread.Get($threadId))
#set($forum = $core_v2_forum.Get($thread.ForumId))

#set ($canEditThread = false)
#set ($canEditThread = $core_v2_nodePermission.Get("forums", $thread.ForumId, "Forum_ModifyPost", "%{ PostId = '${threadId}', PostType = 'threads'}").IsAllowed)

#set ($canDeleteThread = false)
#set ($canDeleteThread = $core_v2_nodePermission.Get("forums", $thread.ForumId, "Forum_DeletePost", "%{ PostId = '${threadId}', PostType = 'threads'}").IsAllowed)

#set($replyId = false)
#set($replyId = $core_v2_utility.ParseInt($core_v2_page.GetQueryStringValue('ForumReplyId')))

&lt;div class="post topic full#if($thread.ThreadType == 'QuestionAndAnswer' &amp;&amp; $thread.ThreadStatus == 'Answered') with-filter#end"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($forum.Group.Url)"&gt;&lt;span&gt;$forum.Group.Name&lt;/span&gt;&lt;/a&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($forum.Url)"&gt;&lt;span&gt;$forum.Name&lt;/span&gt;&lt;/a&gt;
	&lt;/div&gt;
	&lt;h1&gt;$thread.Subject&lt;/h1&gt;
	&lt;div class="details"&gt;
		&lt;div class="date"&gt;$core_v2_language.FormatAgoDate($thread.Date)&lt;/div&gt;
		&lt;div class="avatar"&gt;
			#if ($thread.Author.ProfileUrl)
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($thread.Author.ProfileUrl)" class="internal-link view-user-profile"&gt;
					$core_v2_ui.GetResizedImageHtml($thread.Author.AvatarUrl, 24, 24, "%{border='0', alt=$thread.Author.DisplayName, ResizeMethod='ZoomAndCrop',border='0'}")
				&lt;/a&gt;
			#else
				$core_v2_ui.GetResizedImageHtml($thread.Author.AvatarUrl, 24, 24, "%{border='0', alt=$thread.Author.DisplayName, ResizeMethod='ZoomAndCrop',border='0'}")
			#end
		&lt;/div&gt;
		&lt;div class="author"&gt;
			#if ($thread.Author.ProfileUrl)
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($thread.Author.ProfileUrl)" class="internal-link view-user-profile"&gt;
					$thread.Author.DisplayName
				&lt;/a&gt;
			#else
				$thread.Author.DisplayName
			#end
		&lt;/div&gt;
	&lt;/div&gt;
	&lt;div class="content"&gt;
		&lt;div class="user-generated-content"&gt;
			$mobile_v1_dataFormat.Detect($thread.Body('Web'))
		&lt;/div&gt;
		#if ($thread.File)
			&lt;p&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($thread.File.FileUrl)" class="internal-link download-attachment"&gt;$thread.File.FileName&lt;/a&gt;&lt;/p&gt;
		#end
		#if($thread.EmailFiles &amp;&amp; $thread.EmailFiles.Count &gt; 0)
			#foreach($emailFile in $thread.EmailFiles)
				&lt;p&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($emailFile.DownloadUrl)" class="internal-link download-attachment"&gt;$emailFile.FileName&lt;/a&gt;&lt;/p&gt;
			#end
		#end
	&lt;/div&gt;
	#set($showLikes = false)
	#if($accessingUserIsRegistered &amp;&amp; $core_v2_like.CanLike($thread.ContentId, $core_v2_forumThread.ContentTypeId))
		#set($showLikes = true)
	#end
	#set($canReply = false)
	#set($canReply = $core_v2_nodePermission.Get("forums", $forum.Id, "Forum_CreateReply", "%{ PostId = '${postId}', PostType = 'threads'}").IsAllowed)
	#set($maxLinkCount = 0)
	#if ($showLikes)
		#set($maxLinkCount = $maxLinkCount + 1)
	#end
	#if ($canReply)
		#set($maxLinkCount = $maxLinkCount + 1)
	#end
	&lt;div class="actions ui-links" data-minlinks="0" data-maxlinks="$maxLinkCount"&gt;
		&lt;ul&gt;
			#if ($accessingUserIsRegistered &amp;&amp; $core_v2_like.CanLike($thread.ContentId, $core_v2_forumThread.ContentTypeId))
				&lt;li class="action-like"&gt;
					#set($format = '{toggle} &lt;span class="count"&gt;&lt;span class="icon"&gt;&lt;/span&gt;{count}&lt;/span&gt;')
					$core_v2_ui.Like($thread.ContentId, $core_v2_forumThread.ContentTypeId, "%{ Format = '$format' }")
				&lt;/li&gt;
			#end

			#if ($canReply)
				&lt;li class="action-reply"&gt;
					&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('forumthread-addreply', $thread.Id))" class="comment"&gt;$core_v2_language.GetResource('reply')&lt;/a&gt;
				&lt;/li&gt;
			#end

			#if ($canEditThread)
				&lt;li&gt;
					&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('forumthread-edit', $thread.Id))"&gt;$core_v2_language.GetResource('edit')&lt;/a&gt;
				&lt;/li&gt;
			#end
			#if ($canDeleteThread)
				&lt;li&gt;
					&lt;a href="#" data-messagename="forumreply.delete-thread"&gt;$core_v2_language.GetResource('delete')&lt;/a&gt;
				&lt;/li&gt;
			#end

			#if ($accessingUserIsRegistered &amp;&amp; $core_v2_bookmark.CanBookmark($thread.ContentId, $core_v2_forumThread.ContentTypeId))
				&lt;li&gt;
					$core_v2_ui.Bookmark($thread.ContentId, $core_v2_forumThread.ContentTypeId)
				&lt;/li&gt;
			#end&gt;
			&lt;li class="action-moderate"&gt;$core_v2_ui.Moderate($thread.ContentId, $core_v2_forumThread.ContentTypeId)&lt;/li&gt;

			&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;&lt;/a&gt;&lt;/li&gt;
			&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
		&lt;/ul&gt;
	&lt;/div&gt;
&lt;/div&gt;

#set($filter = false)
#set($filter = $core_v2_page.GetQueryStringValue('w_filter'))
#if ($thread.ThreadType == 'QuestionAndAnswer' &amp;&amp; $thread.ThreadStatus == 'Answered')
	#if (!$filter)
		#if(!$replyId || $replyId &lt; 0)
			#set($filter = 'verified-answers')
		#else
			#set($filter = '')
		#end
	#end
	&lt;div class="ui-links filters content" data-minlinks="100" data-animate="true"&gt;
		&lt;ul&gt;
			&lt;li&gt;&lt;a href="#" data-filter="verified-answers"#if($filter == 'verified-answers') data-selected#end&gt;&lt;span&gt;&lt;/span&gt;$core_v2_language.GetResource('answers_only')&lt;/a&gt;&lt;/li&gt;
			&lt;li&gt;&lt;a href="#" data-filter=""#if($filter == '') data-selected#end&gt;$core_v2_language.GetResource('all_replies')&lt;/a&gt;&lt;/li&gt;
		&lt;/ul&gt;
	&lt;/div&gt;
#else
	#set($filter = '')
	&lt;div class="reply-count content"&gt;
		#if ($thread.ReplyCount == 1)
			#set ($countResource = 'ReplyCount_Singular')
		#else
			#set ($countResource = "ReplyCount_Plural")
		#end
		$core_v2_language.FormatString($core_v2_language.GetResource($countResource), $core_v2_language.FormatNumber($thread.ReplyCount))
	&lt;/div&gt;
#end

&lt;div class="post-list replies"&gt;
	#set($pageIndex = 0)
	#set($replies = $core_v2_forumReply.List($threadId, "%{ForumReplyQueryType=$filter,PageSize=5,PageIndex=$pageIndex,IncludeThreadStarter='False'}"))
	#set($lastPageIndex = $replies.TotalCount / 5)
	#if ($lastPageIndex * 5 &gt;= $replies.TotalCount)
		#set($lastPageIndex = $lastPageIndex - 1)
	#end
	#set($pageIndex = $lastPageIndex)
	#if ($replyId &gt; 0)
		#set($replyPageIndex = $core_v2_forumReply.GetForumReplyPageIndex($threadId, $replyId, "%{ForumReplyQueryType=$filter,PageSize=5,IncludeThreadStarter='False'}"))
		#set($pageIndex = $replyPageIndex)
	#end

	#if ($pageIndex &gt;= 1)
		#set($replies = false)
	#end

	$core_v2_widget.ExecuteFile("list.vm")

	#if ($pageIndex &lt; $lastPageIndex)
		#set($targetPageIndex = $pageIndex + 1)
		&lt;a href="#" data-pageindex="$targetPageIndex" data-lastpageindex="$lastPageIndex" class="view-more"&gt;$core_v2_language.GetResource('reply_load_more')&lt;/a&gt;
	#end
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.forumThread.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
			forumUrl: '$core_v2_encoding.JavascriptEncode($forum.Url)',
			filter: '$filter',
			forumId: '$forum.Id',
			threadId: '$thread.Id',
			replyId: #if($replyId) $replyId#else null#end,
			markAsAnswerText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('mark_as_answer'))',
			markAsNotAnswerText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('mark_as_not_answer'))',
			replyDeleteConfirmation: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('reply_delete_confirmation'))',
			threadDeleteConfirmation: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('thread_delete_confirmation'))'
		});
	});
})
&lt;/script&gt;
		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="ForumThread_Name">Forum Thread</resource>
		<resource name="no_forums">There are no forums in this group.</resource>
		<resource name="no_replies">No replies</resource>
		<resource name="no_answers">There are no answers</resource>
		<resource name="answers_only">Answers Only</resource>
		<resource name="all_replies">All Replies</resource>
		<resource name="mark_as_not_answer">Reject answer</resource>
		<resource name="mark_as_answer">Verify answer</resource>
		<resource name="accept_answer">Accept answer</resource>
		<resource name="reject_answer">Reject answer</resource>
		<resource name="answer">Answer</resource>
		<resource name="suggested_answer">Suggested Answer</resource>
		<resource name="reply">Reply</resource>
		<resource name="edit">Edit</resource>
		<resource name="delete">Delete</resource>
		<resource name="cancel">Cancel</resource>
		<resource name="reply_delete_confirmation">Are you sure you want to delete this reply?</resource>
		<resource name="thread_delete_confirmation">Are you sure you want to delete this thread?</resource>
		<resource name="reply_load_more">Load more replies...</resource>
		<resource name="InReplyTo">In reply to &lt;a href="{0}"&gt;{1}&lt;/a&gt;:</resource>
		<resource name="ReplyCount_Singular">{0} Reply</resource>
		<resource name="ReplyCount_Plural">{0} Replies</resource>
	  </language>
	</languageResources>
    <files>
      <file name="list.vm">I2lmICghJHJlcGxpZXMpDQoJI3NldCgkcmVwbGllcyA9ICRjb3JlX3YyX2ZvcnVtUmVwbHkuTGlzdCgkdGhyZWFkSWQsICIle0ZvcnVtUmVwbHlRdWVyeVR5cGU9JGZpbHRlcixQYWdlU2l6ZT01LFBhZ2VJbmRleD0kcGFnZUluZGV4LEluY2x1ZGVUaHJlYWRTdGFydGVyPSdGYWxzZSd9IikpDQojZW5kDQojaWYgKCRwYWdlSW5kZXggPiAwKQ0KCSNzZXQoJHRhcmdldFBhZ2VJbmRleCA9ICRwYWdlSW5kZXggLSAxKQ0KCTxhIGhyZWY9IiMiIGRhdGEtcGFnZWluZGV4PSIkdGFyZ2V0UGFnZUluZGV4IiBjbGFzcz0idmlldy1tb3JlIj4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgncmVwbHlfbG9hZF9tb3JlJyk8L2E+DQojZW5kDQojZm9yZWFjaCgkcmVwbHkgaW4gJHJlcGxpZXMpDQojZWFjaA0KCSNzZXQgKCRjYW5FZGl0UmVwbHkgPSBmYWxzZSkNCgkjc2V0ICgkY2FuRWRpdFJlcGx5ID0gJGNvcmVfdjJfbm9kZVBlcm1pc3Npb24uR2V0KCJmb3J1bXMiLCAkZm9ydW0uSWQsICJGb3J1bV9Nb2RpZnlQb3N0IiwgIiV7IFBvc3RJZCA9ICcke3JlcGx5LklkfScsIFBvc3RUeXBlID0gJ3JlcGxpZXMnfSIpLklzQWxsb3dlZCkNCg0KCSNzZXQgKCRjYW5EZWxldGVSZXBseSA9IGZhbHNlKQ0KCSNzZXQgKCRjYW5EZWxldGVSZXBseSA9ICRjb3JlX3YyX25vZGVQZXJtaXNzaW9uLkdldCgiZm9ydW1zIiwgJGZvcnVtLklkLCAiRm9ydW1fRGVsZXRlUG9zdCIsICIleyBQb3N0SWQgPSAnJHtyZXBseS5JZH0nLCBQb3N0VHlwZSA9ICdyZXBsaWVzJ30iKS5Jc0FsbG93ZWQpDQoNCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gZm9ydW1yZXBseSAjaWYoJHRocmVhZC5UaHJlYWRUeXBlID09ICdRdWVzdGlvbkFuZEFuc3dlcicpI2lmICgkcmVwbHkuSXNBbnN3ZXIpIGFuc3dlciNlbHNlaWYoJHJlcGx5LklzU3VnZ2VzdGVkQW5zd2VyKSBzdWdnZXN0ZWQtYW5zd2VyI2VuZCNlbmQiIGRhdGEtcmVwbHlpZD0iJHJlcGx5LklkIj4NCgkJPGRpdiBjbGFzcz0icG9zdCBmdWxsIj4NCgkJCTxkaXYgY2xhc3M9ImRldGFpbHMiPg0KCQkJCTxkaXYgY2xhc3M9ImRhdGUiPiRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdEFnb0RhdGUoJHJlcGx5LkRhdGUpPC9kaXY+DQoJCQkJPGRpdiBjbGFzcz0iYXZhdGFyIj4NCgkJCQkJI2lmICgkcmVwbHkuQXV0aG9yLlByb2ZpbGVVcmwpDQoJCQkJCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRyZXBseS5BdXRob3IuUHJvZmlsZVVybCkiIGNsYXNzPSJpbnRlcm5hbC1saW5rIHZpZXctdXNlci1wcm9maWxlIj4NCgkJCQkJCQkJCQkkY29yZV92Ml91aS5HZXRSZXNpemVkSW1hZ2VIdG1sKCRyZXBseS5BdXRob3IuQXZhdGFyVXJsLCAyNCwgMjQsICIle2JvcmRlcj0nMCcsIGFsdD0kcmVwbHkuQXV0aG9yLkRpc3BsYXlOYW1lLCBSZXNpemVNZXRob2Q9J1pvb21BbmRDcm9wJyxib3JkZXI9JzAnfSIpDQoJCQkJCQkJCQk8L2E+DQoJCQkJCQkJI2Vsc2UNCgkJCQkJCQkJCSRjb3JlX3YyX3VpLkdldFJlc2l6ZWRJbWFnZUh0bWwoJHJlcGx5LkF1dGhvci5BdmF0YXJVcmwsIDI0LCAyNCwgIiV7Ym9yZGVyPScwJywgYWx0PSRyZXBseS5BdXRob3IuRGlzcGxheU5hbWUsIFJlc2l6ZU1ldGhvZD0nWm9vbUFuZENyb3AnLGJvcmRlcj0nMCd9IikNCgkJCQkJCQkjZW5kDQoJCQkJPC9kaXY+DQoJCQkJPGRpdiBjbGFzcz0iYXV0aG9yIj4NCgkJCQkJI2lmICgkcmVwbHkuQXV0aG9yLlByb2ZpbGVVcmwpDQoJCQkJCQkJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJHJlcGx5LkF1dGhvci5Qcm9maWxlVXJsKSIgY2xhc3M9ImludGVybmFsLWxpbmsgdmlldy11c2VyLXByb2ZpbGUiPg0KCQkJCQkJCQkJJHJlcGx5LkF1dGhvci5EaXNwbGF5TmFtZQ0KCQkJCQkJCQk8L2E+DQoJCQkJCQkjZWxzZQ0KCQkJCQkJCQkkcmVwbHkuQXV0aG9yLkRpc3BsYXlOYW1lDQoJCQkJCQkjZW5kDQoJCQkJPC9kaXY+DQoJCQk8L2Rpdj4NCgkJCTxkaXYgY2xhc3M9ImNvbnRlbnQiPg0KCQkJCTxkaXYgY2xhc3M9InVzZXItZ2VuZXJhdGVkLWNvbnRlbnQiPg0KCQkJCQkjaWYgKCRyZXBseS5QYXJlbnRJZCAmJiAkcmVwbHkuUGFyZW50SWQgPiAwKQ0KCQkJCQkJI3NldCAoJHBhcmVudCA9IGZhbHNlKQ0KCQkJCQkJI3NldCAoJHBhcmVudCA9ICRjb3JlX3YyX2ZvcnVtUmVwbHkuR2V0KCRyZXBseS5QYXJlbnRJZCkpDQoJCQkJCQkjaWYgKCRwYXJlbnQpDQoJCQkJCQkJI2lmICgkcmVwbHkuSWQgPT0gJHJlcGx5LlBhcmVudElkKQ0KCQkJCQkJCQk8cCBjbGFzcz0iaW4tcmVwbHktdG8iPiRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdFN0cmluZygkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnSW5SZXBseVRvJyksICRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJHRocmVhZC5VcmwpLCAkdGhyZWFkLkF1dGhvci5EaXNwbGF5TmFtZSk8L3A+DQoJCQkJCQkJI2Vsc2UNCgkJCQkJCQkJPHAgY2xhc3M9ImluLXJlcGx5LXRvIj4kY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRTdHJpbmcoJGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ0luUmVwbHlUbycpLCAkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRwYXJlbnQuVXJsKSwgJHBhcmVudC5BdXRob3IuRGlzcGxheU5hbWUpPC9wPg0KCQkJCQkJCSNlbmQNCgkJCQkJCSNlbmQNCgkJCQkJI2VuZA0KCQkJCQkkbW9iaWxlX3YxX2RhdGFGb3JtYXQuRGV0ZWN0KCRyZXBseS5Cb2R5KCdXZWInKSkNCgkJCQk8L2Rpdj4NCgkJCQkjaWYgKCRyZXBseS5GaWxlKQ0KCQkJCQk8cD48YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRyZXBseS5GaWxlLkZpbGVVcmwpIiBjbGFzcz0iaW50ZXJuYWwtbGluayBkb3dubG9hZC1hdHRhY2htZW50Ij4kcmVwbHkuRmlsZS5GaWxlTmFtZTwvYT48L3A+DQoJCQkJI2VuZA0KCQkJCSNpZigkcmVwbHkuRW1haWxGaWxlcyAmJiAkcmVwbHkuRW1haWxGaWxlcy5Db3VudCA+IDApDQoJCQkJCSNmb3JlYWNoKCRlbWFpbEZpbGUgaW4gJHJlcGx5LkVtYWlsRmlsZXMpDQoJCQkJCQk8cD48YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRlbWFpbEZpbGUuRG93bmxvYWRVcmwpIiBjbGFzcz0iaW50ZXJuYWwtbGluayBkb3dubG9hZC1hdHRhY2htZW50Ij4kZW1haWxGaWxlLkZpbGVOYW1lPC9hPjwvcD4NCgkJCQkJI2VuZA0KCQkJCSNlbmQNCgkJCTwvZGl2Pg0KCQkJI3NldCgkc2hvd0xpa2VzID0gZmFsc2UpDQoJCQkjaWYoJGFjY2Vzc2luZ1VzZXJJc1JlZ2lzdGVyZWQgJiYgJGNvcmVfdjJfbGlrZS5DYW5MaWtlKCRyZXBseS5Db250ZW50SWQsICRjb3JlX3YyX2ZvcnVtUmVwbHkuQ29udGVudFR5cGVJZCkpDQoJCQkJI3NldCgkc2hvd0xpa2VzID0gdHJ1ZSkNCgkJCSNlbmQNCgkJCSNzZXQoJGNhblJlcGx5ID0gJGNvcmVfdjJfbm9kZVBlcm1pc3Npb24uR2V0KCJmb3J1bXMiLCAkZm9ydW0uSWQsICJGb3J1bV9DcmVhdGVSZXBseSIsICIleyBQb3N0SWQgPSAnJHtyZXBseS5JZH0nLCBQb3N0VHlwZSA9ICdyZXBsaWVzJ30iKS5Jc0FsbG93ZWQpDQoJCQkjc2V0KCRtYXhMaW5rQ291bnQgPSAwKQ0KCQkJI2lmICgkc2hvd0xpa2VzKQ0KCQkJCSNzZXQoJG1heExpbmtDb3VudCA9ICRtYXhMaW5rQ291bnQgKyAxKQ0KCQkJI2VuZA0KCQkJI2lmICgkY2FuUmVwbHkpDQoJCQkJI3NldCgkbWF4TGlua0NvdW50ID0gJG1heExpbmtDb3VudCArIDEpDQoJCQkjZW5kDQoJCQk8ZGl2IGNsYXNzPSJhY3Rpb25zIHVpLWxpbmtzIiBkYXRhLW1pbmxpbmtzPSIwIiBkYXRhLW1heGxpbmtzPSIkbWF4TGlua0NvdW50Ij4NCgkJCQk8dWw+DQoJCQkJCSNpZiAoJHNob3dMaWtlcykNCgkJCQkJCTxsaSBjbGFzcz0iYWN0aW9uLWxpa2UiPg0KCQkJCQkJICAgI3NldCgkZm9ybWF0ID0gJ3t0b2dnbGV9IDxzcGFuIGNsYXNzPSJjb3VudCI+PHNwYW4gY2xhc3M9Imljb24iPjwvc3Bhbj57Y291bnR9PC9zcGFuPicpDQoJCQkJCQkgICAkY29yZV92Ml91aS5MaWtlKCRyZXBseS5Db250ZW50SWQsICRjb3JlX3YyX2ZvcnVtUmVwbHkuQ29udGVudFR5cGVJZCwgIiV7IEZvcm1hdCA9ICRmb3JtYXQgfSIpDQoJCQkJCQk8L2xpPg0KCQkJCQkjZW5kDQoNCgkJCQkJI2lmKCRjYW5SZXBseSkNCgkJCQkJCTxsaSBjbGFzcz0iYWN0aW9uLXJlcGx5Ij4NCgkJCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRtb2JpbGVfdjFfdXJsLkZvcm1hdCgnZm9ydW1yZXBseS1hZGRyZXBseScsICRyZXBseS5JZCkpIiBjbGFzcz0iY29tbWVudCI+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ3JlcGx5Jyk8L2E+DQoJCQkJCQk8L2xpPg0KCQkJCQkjZW5kDQoNCgkJCQkJI2lmICgkdGhyZWFkLlRocmVhZFR5cGUgPT0gJ1F1ZXN0aW9uQW5kQW5zd2VyJykNCgkJCQkJCSNpZiAoJGNvcmVfdjJfbm9kZVBlcm1pc3Npb24uR2V0KCJmb3J1bXMiLCAkZm9ydW0uSWQsICJGb3J1bV9NYXJrQXNBbnN3ZXIiLCAiJXsgUG9zdElkID0gJyR7cmVwbHkuSWR9JywgUG9zdFR5cGUgPSAncmVwbGllcyd9IikuSXNBbGxvd2VkKQ0KCQkJCQkJCSNpZiAoJHJlcGx5LklzQW5zd2VyKQ0KCQkJCQkJCQk8bGk+PGEgaHJlZj0iIyIgZGF0YS1tZXNzYWdlbmFtZT0iZm9ydW1yZXBseS5hbnN3ZXItYWN0aW9uIiBjbGFzcz0iYW5zd2VyLWFjdGlvbiIgZGF0YS1hY3Rpb249InJlamVjdC1hbnN3ZXIiIGRhdGEtcmVwbHlpZD0iJHJlcGx5LklkIj4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbWFya19hc19ub3RfYW5zd2VyJyk8L2E+PC9saT4NCgkJCQkJCQkjZWxzZWlmICgkcmVwbHkuSXNTdWdnZXN0ZWRBbnN3ZXIpDQoJCQkJCQkJCTxsaT48YSBocmVmPSIjIiBkYXRhLW1lc3NhZ2VuYW1lPSJmb3J1bXJlcGx5LmFuc3dlci1hY3Rpb24iIGNsYXNzPSJhbnN3ZXItYWN0aW9uIiBkYXRhLWFjdGlvbj0iYWNjZXB0LWFuc3dlciIgZGF0YS1yZXBseWlkPSIkcmVwbHkuSWQiPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdhY2NlcHRfYW5zd2VyJyk8L2E+PC9saT4NCgkJCQkJCQkJPGxpPjxhIGhyZWY9IiMiIGRhdGEtbWVzc2FnZW5hbWU9ImZvcnVtcmVwbHkuYW5zd2VyLWFjdGlvbiIgY2xhc3M9ImFuc3dlci1hY3Rpb24gc2Vjb25kLWxpbmsiIGRhdGEtYWN0aW9uPSJyZWplY3QtYW5zd2VyIiBkYXRhLXJlcGx5aWQ9IiRyZXBseS5JZCI+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ3JlamVjdF9hbnN3ZXInKTwvYT48L2xpPg0KCQkJCQkJCSNlbHNlDQoJCQkJCQkJCTxsaT48YSBocmVmPSIjIiBkYXRhLW1lc3NhZ2VuYW1lPSJmb3J1bXJlcGx5LmFuc3dlci1hY3Rpb24iIGNsYXNzPSJhbnN3ZXItYWN0aW9uIiBkYXRhLWFjdGlvbj0iYWNjZXB0LWFuc3dlciIgZGF0YS1yZXBseWlkPSIkcmVwbHkuSWQiPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdtYXJrX2FzX2Fuc3dlcicpPC9hPjwvbGk+DQoJCQkJCQkJI2VuZA0KCQkJCQkJI2VuZA0KCQkJCQkjZW5kDQoNCgkJCQkJI2lmICgkY2FuRWRpdFJlcGx5KQ0KCQkJCQkJPGxpPg0KCQkJCQkJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJG1vYmlsZV92MV91cmwuRm9ybWF0KCdmb3J1bXJlcGx5LWVkaXQnLCAkcmVwbHkuSWQpKSI+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ2VkaXQnKTwvYT4NCgkJCQkJCTwvbGk+DQoJCQkJCSNlbmQNCgkJCQkJI2lmICgkY2FuRGVsZXRlUmVwbHkpDQoJCQkJCQk8bGk+DQoJCQkJCQkJPGEgaHJlZj0iIyIgZGF0YS1tZXNzYWdlbmFtZT0iZm9ydW1yZXBseS5kZWxldGUtcmVwbHkiIGNsYXNzPSJkZWxldGUtcmVwbHkiIGRhdGEtcmVwbHlpZD0iJHJlcGx5LklkIj4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnZGVsZXRlJyk8L2E+DQoJCQkJCQk8L2xpPg0KCQkJCQkjZW5kDQoNCgkJCQkJPGxpIGNsYXNzPSJhY3Rpb24tbW9kZXJhdGUiPiRjb3JlX3YyX3VpLk1vZGVyYXRlKCRyZXBseS5Db250ZW50SWQsICRjb3JlX3YyX2ZvcnVtUmVwbHkuQ29udGVudFR5cGVJZCk8L2xpPg0KDQoJCQkJCTxsaSBjbGFzcz0iYWN0aW9uLW1vcmUiPjxhIGhyZWY9IiMiIGRhdGEtbW9yZT48L2E+PC9saT4NCgkJCQkJPGxpPjxhIGhyZWY9IiMiIGRhdGEtY2FuY2VsPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdjYW5jZWwnKTwvYT48L2xpPg0KCQkJCTwvdWw+DQoJCQk8L2Rpdj4NCgkJPC9kaXY+DQoJPC9kaXY+DQojbm9kYXRhDQoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIGZvcnVtIj48ZGl2IGNsYXNzPSJtZXNzYWdlIG5vcmVjb3JkcyBmdWxsIj4NCgkJI2lmICgkZmlsdGVyID09ICd2ZXJpZmllZC1hbnN3ZXJzJykNCgkJCSRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdub19hbnN3ZXJzJykNCgkJI2Vsc2UNCgkJCSRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdub19yZXBsaWVzJykNCgkJI2VuZA0KCTwvZGl2PjwvZGl2Pg0KI2VuZA==</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBmb3J1bXMNCiMjDQoNCiNzZXQgKCRhY2Nlc3NpbmdVc2VyID0gJGNvcmVfdjJfdXNlci5BY2Nlc3NpbmcpDQojc2V0ICgkYWNjZXNzaW5nVXNlcklzUmVnaXN0ZXJlZCA9IGZhbHNlKQ0KI2lmICgkY29yZV92Ml91c2VyLklzUmVnaXN0ZXJlZCgkYWNjZXNzaW5nVXNlci5JZCkpDQoJI3NldCAoJGFjY2Vzc2luZ1VzZXJJc1JlZ2lzdGVyZWQgPSB0cnVlKQ0KI2VuZA0KDQojc2V0ICgkZmlsdGVyID0gZmFsc2UpDQojc2V0ICgkZmlsdGVyID0gJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X2ZpbHRlcicpKQ0KI3NldCAoJHBhZ2VJbmRleCA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19wYWdlSW5kZXgnKSkNCiNzZXQoJHRocmVhZElkID0gZmFsc2UpDQojc2V0KCR0aHJlYWRJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJG1vYmlsZV92MV91cmxUb2tlbi5WYWx1ZSgnRm9ydW1UaHJlYWRJZCcpKSkNCiNpZiAoISR0aHJlYWRJZCkNCgkkY29yZV92Ml93aWRnZXQuSGlkZSgpDQojZW5kDQoNCiNzZXQoJHRocmVhZCA9ICRjb3JlX3YyX2ZvcnVtVGhyZWFkLkdldCgkdGhyZWFkSWQpKQ0KI3NldCgkZm9ydW0gPSAkY29yZV92Ml9mb3J1bS5HZXQoJHRocmVhZC5Gb3J1bUlkKSkNCiNzZXQoJHJlcGxpZXMgPSBmYWxzZSkNCg0KJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCdsaXN0LnZtJyk=</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIG1vZGVsID0gew0KCQl1cGRhdGVBbnN3ZXJTdGF0ZTogZnVuY3Rpb24gKGZvcnVtSWQsIHRocmVhZElkLCByZXBseUlkLCBpc0Fuc3dlcikgew0KCQkJcmV0dXJuICQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7DQoJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvZm9ydW1zL3tGb3J1bUlkfS90aHJlYWRzL3tUaHJlYWRJZH0vcmVwbGllcy97UmVwbHlJZH0uanNvbj9JbmNsdWRlRmllbGRzPVJlcGx5LklzQW5zd2VyLFJlcGx5LklzU3VnZ2VzdGVkQW5zd2VyJywNCgkJCQlkYXRhOiB7DQoJCQkJCUZvcnVtSWQ6IGZvcnVtSWQsDQoJCQkJCVRocmVhZElkOiB0aHJlYWRJZCwNCgkJCQkJcmVwbHlJZDogcmVwbHlJZCwNCgkJCQkJSXNBbnN3ZXI6IGlzQW5zd2VyLA0KCQkJCQlJc1N1Z2dlc3RlZEFuc3dlcjogZmFsc2UNCgkJCQl9DQoJCQl9KSk7DQoJCX0sDQoJCWRlbGV0ZVJlcGx5OiBmdW5jdGlvbihmb3J1bUlkLCB0aHJlYWRJZCwgcmVwbHlJZCkgew0KCQkJcmV0dXJuICQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoJC50ZWxsaWdlbnQuZXZvbHV0aW9uLmRlbCh7DQoJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvZm9ydW1zL3tGb3J1bUlkfS90aHJlYWRzL3tUaHJlYWRJZH0vcmVwbGllcy97UmVwbHlJZH0uanNvbicsDQoJCQkJZGF0YTogew0KCQkJCQlGb3J1bUlkOiBmb3J1bUlkLA0KCQkJCQlUaHJlYWRJZDogdGhyZWFkSWQsDQoJCQkJCVJlcGx5SWQ6IHJlcGx5SWQsDQoJCQkJCURlbGV0ZUNoaWxkcmVuOiBmYWxzZSwNCgkJCQkJU2VuZEF1dGhvckRlbGV0ZU5vdGlmaWNhdGlvbjogZmFsc2UNCgkJCQl9DQoJCQl9KSk7DQoJCX0sDQoJCWRlbGV0ZVRocmVhZDogZnVuY3Rpb24oZm9ydW1JZCwgdGhyZWFkSWQpIHsNCgkJCXJldHVybiAkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNob3dMb2FkaW5nKCQudGVsbGlnZW50LmV2b2x1dGlvbi5kZWwoew0KCQkJCXVybDogJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ2FwaS5hc2h4L3YyL2ZvcnVtcy97Rm9ydW1JZH0vdGhyZWFkcy97VGhyZWFkSWR9Lmpzb24nLA0KCQkJCWRhdGE6IHsNCgkJCQkJRm9ydW1JZDogZm9ydW1JZCwNCgkJCQkJVGhyZWFkSWQ6IHRocmVhZElkLA0KCQkJCQlEZWxldGVDaGlsZHJlbjogdHJ1ZSwNCgkJCQkJU2VuZEF1dGhvckRlbGV0ZU5vdGlmaWNhdGlvbjogZmFsc2UNCgkJCQl9DQoJCQl9KSk7DQoJCX0NCgl9DQoNCglmdW5jdGlvbiBoYW5kbGVSZXBseURlbGV0aW9uRXZlbnRzKG9wdGlvbnMpIHsNCgkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ2ZvcnVtcmVwbHkuZGVsZXRlLXJlcGx5JywgZnVuY3Rpb24oZGF0YSl7DQoJCQl2YXIgYSA9ICQoZGF0YS50YXJnZXQpOw0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlU2hlZXQoKTsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuY29uZmlybShvcHRpb25zLnJlcGx5RGVsZXRlQ29uZmlybWF0aW9uLCBmdW5jdGlvbihjb25maXJtZWQpIHsNCgkJCQlpZiAoY29uZmlybWVkKSB7DQoJCQkJCW1vZGVsLmRlbGV0ZVJlcGx5KG9wdGlvbnMuZm9ydW1JZCwgb3B0aW9ucy50aHJlYWRJZCwgYS5kYXRhKCdyZXBseWlkJykpDQoJCQkJCQkuZG9uZShmdW5jdGlvbigpew0KCQkJCQkJCS8vIGhpZGUgYW5kIHJlbW92ZSB0aGUgZGVsZXRlZCByZXBseQ0KCQkJCQkJCXZhciByZXBseUl0ZW0gPSAkKG9wdGlvbnMud3JhcHBlciArICcgLnBvc3QtbGlzdC1pdGVtW2RhdGEtcmVwbHlpZD0iJyArIGEuZGF0YSgncmVwbHlpZCcpICsgJyJdJyk7DQoJCQkJCQkJcmVwbHlJdGVtLmV2b2x1dGlvblRyYW5zZm9ybSh7DQoJCQkJCQkJCW9wYWNpdHk6IDANCgkJCQkJCQl9LCB7DQoJCQkJCQkJCWR1cmF0aW9uOiAyMDAsDQoJCQkJCQkJCWNvbXBsZXRlOiBmdW5jdGlvbigpIHsNCgkJCQkJCQkJCXJlcGx5SXRlbS5yZW1vdmUoKTsNCgkJCQkJCQkJfQ0KCQkJCQkJCX0pOw0KCQkJCQkJfSk7DQoJCQkJfQ0KCQkJfSk7DQoJCX0pOw0KCX0NCg0KCWZ1bmN0aW9uIGhhbmRsZVRocmVhZERlbGV0aW9uRXZlbnRzKG9wdGlvbnMpIHsNCgkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ2ZvcnVtcmVwbHkuZGVsZXRlLXRocmVhZCcsIGZ1bmN0aW9uKGRhdGEpew0KCQkJdmFyIGEgPSAkKGRhdGEudGFyZ2V0KTsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuaGlkZVNoZWV0KCk7DQoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmNvbmZpcm0ob3B0aW9ucy50aHJlYWREZWxldGVDb25maXJtYXRpb24sIGZ1bmN0aW9uKGNvbmZpcm1lZCkgew0KCQkJCWlmIChjb25maXJtZWQpIHsNCgkJCQkJbW9kZWwuZGVsZXRlVGhyZWFkKG9wdGlvbnMuZm9ydW1JZCwgb3B0aW9ucy50aHJlYWRJZCkNCgkJCQkJCS5kb25lKGZ1bmN0aW9uKCl7DQoJCQkJCQkJLy8gbmF2aWdhdGUgYmFjayB0byB0aGUgZGVsZXRlZCB0aHJlYWQncyBmb3J1bSwgY2xlYXJpbmcgaXRzIGNhY2hlDQoJCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5sb2FkKG9wdGlvbnMuZm9ydW1VcmwsIHsgcmVmcmVzaDogdHJ1ZSB9KTsNCgkJCQkJCX0pOw0KCQkJCX0NCgkJCX0pOw0KCQl9KTsNCgl9DQoNCglmdW5jdGlvbiBoYW5kbGVBbnN3ZXJDaGFuZ2VFdmVudHMob3B0aW9ucykgew0KCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnN1YnNjcmliZSgnZm9ydW1yZXBseS5hbnN3ZXItYWN0aW9uJywgZnVuY3Rpb24oZGF0YSkgew0KCQkJdmFyIGEgPSAkKGRhdGEudGFyZ2V0KSwNCgkJCQlhY3Rpb24gPSBhLmRhdGEoJ2FjdGlvbicpOw0KDQoJCQltb2RlbC51cGRhdGVBbnN3ZXJTdGF0ZShvcHRpb25zLmZvcnVtSWQsIG9wdGlvbnMudGhyZWFkSWQsIGEuZGF0YSgncmVwbHlpZCcpLCBhY3Rpb24gPT0gJ2FjY2VwdC1hbnN3ZXInKQ0KCQkJCS5kb25lKGZ1bmN0aW9uKCl7DQoJCQkJCWlmIChvcHRpb25zLmZpbHRlciA9PSAndmVyaWZpZWQtYW5zd2VycycpIHsNCgkJCQkJCWlmICgkKG9wdGlvbnMud3JhcHBlciArICcgLnBvc3QtbGlzdC5yZXBsaWVzJykuZmluZCgnLnBvc3QtbGlzdC1pdGVtJykubGVuZ3RoID09IDEpIHsNCgkJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnJlZnJlc2goKTsNCgkJCQkJCX0gZWxzZSB7DQoJCQkJCQkJJChvcHRpb25zLndyYXBwZXIgKyAnIC5wb3N0LWxpc3QucmVwbGllcyAucG9zdC1saXN0LWl0ZW0uZm9ydW1yZXBseVtkYXRhLXJlcGx5aWQ9IicgKyBhLmRhdGEoJ3JlcGx5aWQnKSArICciXScpLnJlbW92ZSgpOw0KCQkJCQkJfQ0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlU2hlZXQoKTsNCgkJCQkJfSBlbHNlIHsNCgkJCQkJCXZhciBwID0gJChvcHRpb25zLndyYXBwZXIgKyAnIC5wb3N0LWxpc3QucmVwbGllcyAucG9zdC1saXN0LWl0ZW0uZm9ydW1yZXBseVtkYXRhLXJlcGx5aWQ9IicgKyBhLmRhdGEoJ3JlcGx5aWQnKSArICciXScpOw0KCQkJCQkJcC5yZW1vdmVDbGFzcygnc3VnZ2VzdGVkLWFuc3dlcicpOw0KCQkJCQkJaWYgKGFjdGlvbiA9PSAnYWNjZXB0LWFuc3dlcicpIHsNCgkJCQkJCQlwLmFkZENsYXNzKCdhbnN3ZXInKTsNCgkJCQkJCX0gZWxzZSB7DQoJCQkJCQkJcC5yZW1vdmVDbGFzcygnYW5zd2VyJyk7DQoJCQkJCQl9DQoNCgkJCQkJCWlmIChhY3Rpb24gPT0gJ2FjY2VwdC1hbnN3ZXInKSB7DQoJCQkJCQkJYS5wYXJlbnRzKCd1bCcpLmZpbmQoJ2EuYW5zd2VyLWFjdGlvbicpLmRhdGEoJ2FjdGlvbicsICdyZWplY3QtYW5zd2VyJykuaHRtbChvcHRpb25zLm1hcmtBc05vdEFuc3dlclRleHQpOw0KCQkJCQkJfSBlbHNlIHsNCgkJCQkJCQlhLnBhcmVudHMoJ3VsJykuZmluZCgnYS5hbnN3ZXItYWN0aW9uJykuZGF0YSgnYWN0aW9uJywgJ2FjY2VwdC1hbnN3ZXInKS5odG1sKG9wdGlvbnMubWFya0FzQW5zd2VyVGV4dCk7DQoJCQkJCQl9DQoNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuaGlkZVNoZWV0KCk7DQoNCgkJCQkJCXAuZmluZCgnLnVpLWxpbmtzJykudWlsaW5rcygncmVtb3ZlJywgJ2EuYW5zd2VyLWFjdGlvbi5zZWNvbmQtbGluaycpOw0KCQkJCQl9DQoJCQkJfSkNCgkJCQkuZmFpbChmdW5jdGlvbigpew0KCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmhpZGVTaGVldCgpOw0KCQkJCX0pOw0KCQl9KTsNCgl9DQoNCglmdW5jdGlvbiBpbml0UGFnaW5nKG9wdGlvbnMpIHsNCgkJJChvcHRpb25zLndyYXBwZXIpLm9uKCd0YXAnLCAnLnBvc3QtbGlzdC5yZXBsaWVzIGEudmlldy1tb3JlJywgZnVuY3Rpb24oZSkgew0KCQkJdmFyIGwgPSAkKHRoaXMpOw0KCQkJdmFyIHBpID0gcGFyc2VJbnQobC5kYXRhKCdwYWdlaW5kZXgnKSwgMTApOw0KCQkJaWYgKGlzTmFOKHBpKSkgew0KCQkJCXJldHVybjsNCgkJCX0NCgkJCXZhciBscGkgPSBwYXJzZUludChsLmRhdGEoJ2xhc3RwYWdlaW5kZXgnKSwgMTApOw0KDQoNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoJC50ZWxsaWdlbnQuZXZvbHV0aW9uLmdldCh7DQoJCQkJdXJsOiBvcHRpb25zLm1vcmVVcmwsDQoJCQkJZGF0YTogew0KCQkJCQl3X3BhZ2VJbmRleDogcGksDQoJCQkJCXdfZmlsdGVyOiBvcHRpb25zLmZpbHRlcg0KCQkJCX0sDQoJCQkJc3VjY2VzczogZnVuY3Rpb24ocikgew0KCQkJCQl2YXIgdG9wID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5jb250ZW50U2Nyb2xsVG9wKCk7DQoJCQkJCXZhciBsaXN0ID0gbC5wYXJlbnRzKCcucG9zdC1saXN0LnJlcGxpZXMnKTsNCgkJCQkJdmFyIGggPSBsaXN0Lm91dGVySGVpZ2h0KCk7DQoJCQkJCWwuYmVmb3JlKHIpOw0KCQkJCQlpZiAoaXNOYU4obHBpKSkgew0KCQkJCQkJbC5oaWRlKCk7DQoJCQkJCQl0b3AgPSB0b3AgKyBsaXN0Lm91dGVySGVpZ2h0KCkgLSBoOw0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5jb250ZW50U2Nyb2xsVG9wKHRvcCk7DQoJCQkJCX0gZWxzZSBpZiAocGkgPT0gbHBpKSB7DQoJCQkJCQlsLmhpZGUoKTsNCgkJCQkJCSQob3B0aW9ucy53cmFwcGVyICsgJyAudmlldy1tb3JlW2RhdGEtcGFnZWluZGV4PSInICsgKHBpIC0gMSkgKyAnIl0nKS5oaWRlKCk7DQoJCQkJCX0gZWxzZSB7DQoJCQkJCQlsLmRhdGEoJ3BhZ2VpbmRleCcsIHBpICsgMSk7DQoJCQkJCQkkKG9wdGlvbnMud3JhcHBlciArICcgLnZpZXctbW9yZVtkYXRhLXBhZ2VpbmRleD0iJyArIChwaSAtIDEpICsgJyJdJykuaGlkZSgpOw0KCQkJCQl9DQoJCQkJfQ0KCQkJfSkpOw0KDQoJCQlyZXR1cm4gZmFsc2U7DQoJCX0pOw0KCX0NCg0KCWZ1bmN0aW9uIGFwcGx5RmlsdGVycyhvcHRpb25zKSB7DQoJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuYWRkUmVmcmVzaFBhcmFtZXRlcignd19maWx0ZXInLCBvcHRpb25zLmZpbHRlcik7DQoNCgkJJChvcHRpb25zLndyYXBwZXIgKyAnIC5maWx0ZXJzIGEnKS5vbigndGFwJywgZnVuY3Rpb24oZSkgew0KCQkJdmFyIGZpbHRlciA9ICQodGhpcykuZGF0YSgnZmlsdGVyJyk7DQoJCQlpZiAoZmlsdGVyICE9IG9wdGlvbnMuZmlsdGVyKSB7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5hZGRSZWZyZXNoUGFyYW1ldGVyKCd3X2ZpbHRlcicsIGZpbHRlcik7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5yZWZyZXNoKCk7DQoJCQl9DQoJCQlyZXR1cm4gZmFsc2U7DQoJCX0pOw0KCX0NCg0KCXZhciBhcGkgPSB7DQoJCXJlZ2lzdGVyOiBmdW5jdGlvbihvcHRpb25zKSB7DQoJCQlhcHBseUZpbHRlcnMob3B0aW9ucyk7DQoJCQloYW5kbGVBbnN3ZXJDaGFuZ2VFdmVudHMob3B0aW9ucyk7DQoJCQloYW5kbGVSZXBseURlbGV0aW9uRXZlbnRzKG9wdGlvbnMpOw0KCQkJaGFuZGxlVGhyZWFkRGVsZXRpb25FdmVudHMob3B0aW9ucyk7DQoJCQlpbml0UGFnaW5nKG9wdGlvbnMpOw0KCQkJaWYgKG9wdGlvbnMucmVwbHlJZCkgew0KCQkJCXZhciByZXBseSA9ICQob3B0aW9ucy53cmFwcGVyICsgJyAucG9zdC1saXN0LWl0ZW0uZm9ydW1yZXBseVtkYXRhLXJlcGx5aWQ9IicgKyBvcHRpb25zLnJlcGx5SWQgKyAnIl0nKTsNCgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmNvbnRlbnRTY3JvbGxUb3AocmVwbHkub2Zmc2V0KCkudG9wKTsNCgkJCX0NCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMuZm9ydW1UaHJlYWQgPSBhcGk7DQoNCn0pKGpRdWVyeSk7</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:ForumThreadList_Name}" version="7.0.0.1" description="" instanceIdentifier="c6af9d06240940beae71ade1bf750570" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="forumthread-list">
    <contentScript>
		
#set($forumId = false)
#set($forumId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('ForumId')))
#if (!$forumId)
	$core_v2_widget.Hide()
#end

#set($forum = $core_v2_forum.Get($forumId))
&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($forum.Group.Url)"&gt;$forum.Group.Name&lt;/a&gt;
		&lt;h1&gt;$forum.Name&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($forum.Group.AvatarUrl, 40, 40, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
	&lt;div class="ui-links actions" data-maxlinks="0"&gt;
		&lt;ul&gt;
			#set ($bookmarkableContentId = $forum.ApplicationId)
			#set ($bookmarkableContentTypeId = $core_v2_forum.ContentTypeId)
			#if ($core_v2_bookmark.SupportsBookmarks($bookmarkableContentTypeId) &amp;&amp; $core_v2_bookmark.CanBookmark($bookmarkableContentId, $bookmarkableContentTypeId) &amp;&amp; $core_v2_bookmark.CanUnBookmark($bookmarkableContentId, $bookmarkableContentTypeId))
				&lt;li&gt;$core_v2_ui.Bookmark($bookmarkableContentId, $bookmarkableContentTypeId)&lt;/li&gt;
			#end
			&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;$core_v2_language.GetResource('more')&lt;/a&gt;&lt;/li&gt;
			&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
		&lt;/ul&gt;
	&lt;/div&gt;
&lt;/div&gt;

## load and render threads
&lt;div class="post-list forums"&gt;
	#set($pageIndex = 0)
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.forumThreadList.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
			answerUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('answer.vm'))',
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			postUrl: '$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('forum-addthread', $forumId))',
			canPost: #if($core_v2_nodePermission.Get("forums", $forumId, "Forum_CreatePost").IsAllowed) true#else false#end
		});
	});
})
&lt;/script&gt;
		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="ForumThreadList_Name">Forum Thread List</resource>
		<resource name="no_threads">There are no threads in this forum.</resource>
		<resource name="no_replies">No replies</resource>
		<resource name="reply_count">{0} reply</resource>
		<resource name="replies_count">{0} replies</resource>
		<resource name="answered">Answered</resource>
		<resource name="plus_more_answer">Plus {0} more answer...</resource>
		<resource name="plus_more_answers">Plus {0} more answers...</resource>
		<resource name="post">New</resource>
		<resource name="more">More</resource>
		<resource name="cancel">Cancel</resource>
	  </language>
	</languageResources>
    <files>
      <file name="answer.vm">I3NldCAoJHRocmVhZElkID0gZmFsc2UpDQojc2V0ICgkdGhyZWFkSWQgPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlSW50KCRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd190aHJlYWRpZCcpKSkNCg0KI2lmICghJHRocmVhZElkKQ0KCSRjb3JlX3YyX3dpZGdldC5IaWRlKCkNCiNlbmQNCg0KI3NldCgkYW5zd2VycyA9ICRjb3JlX3YyX2ZvcnVtUmVwbHkuTGlzdCgkdGhyZWFkSWQsICIle0ZvcnVtUmVwbHlRdWVyeVR5cGU9J3ZlcmlmaWVkLWFuc3dlcnMnLFNvcnRCeT0nUG9zdERhdGUnLFNvcnRPcmRlcj0nRGVzY2VuZGluZycsUGFnZVNpemU9MSxQYWdlSW5kZXg9MCxJbmNsdWRlVGhyZWFkU3RhcnRlcj0nRmFsc2UnfSIpKQ0KI2ZvcmVhY2goJGFuc3dlciBpbiAkYW5zd2VycykNCgk8ZGl2IGNsYXNzPSJjb250ZW50Ij4NCgkJPHA+JGNvcmVfdjJfbGFuZ3VhZ2UuVHJ1bmNhdGUoJGFuc3dlci5Cb2R5KCdXZWInKSwgMjUwLCAnLi4uJyk8L3A+DQoJPC9kaXY+DQoJI2lmICgkYW5zd2Vycy5Ub3RhbENvdW50ID4gMSkNCgkJI3NldCgkY291bnQgPSAkYW5zd2Vycy5Ub3RhbENvdW50IC0gMSkNCgkJPGRpdiBjbGFzcz0iYWN0aW9ucyI+DQoJCQk8dWw+DQoJCQkJPGxpPg0KCQkJCQk8c3BhbiBjbGFzcz0iZGV0YWlsIj4NCgkJCQkJCSNpZiAoJGNvdW50ID09IDEpDQoJCQkJCQkJJGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0U3RyaW5nKCRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdwbHVzX21vcmVfYW5zd2VyJyksICRjb3VudCkNCgkJCQkJCSNlbHNlDQoJCQkJCQkJJGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0U3RyaW5nKCRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdwbHVzX21vcmVfYW5zd2VycycpLCAkY291bnQpDQoJCQkJCQkjZW5kDQoJCQkJCTwvc3Bhbj4NCgkJCQk8L2xpPg0KCQkJPC91bD4NCgkJPC9kaXY+DQoJI2VuZA0KI2VuZA==</file>
      <file name="list.vm">I3NldCAoJGFjY2Vzc2luZ1VzZXIgPSAkY29yZV92Ml91c2VyLkFjY2Vzc2luZykNCiNzZXQgKCRhY2Nlc3NpbmdVc2VySXNSZWdpc3RlcmVkID0gZmFsc2UpDQojaWYgKCRjb3JlX3YyX3VzZXIuSXNSZWdpc3RlcmVkKCRhY2Nlc3NpbmdVc2VyLklkKSkNCgkjc2V0ICgkYWNjZXNzaW5nVXNlcklzUmVnaXN0ZXJlZCA9IHRydWUpDQojZW5kDQoNCiNzZXQoJHRocmVhZHMgPSAkY29yZV92Ml9mb3J1bVRocmVhZC5MaXN0KCIle0ZvcnVtSWQ9JGZvcnVtSWQsUGFnZUluZGV4PSRwYWdlSW5kZXgsUGFnZVNpemU9NyxTb3J0Qnk9J0xhc3RQb3N0JyxTb3J0T3JkZXI9J0Rlc2NlbmRpbmcnfSIpKQ0KI2ZvcmVhY2goJHRocmVhZCBpbiAkdGhyZWFkcykNCiNlYWNoDQoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIGZvcnVtdGhyZWFkICNpZiAoJHRocmVhZC5UaHJlYWRUeXBlID09ICdRdWVzdGlvbkFuZEFuc3dlcicpI2lmKCR0aHJlYWQuVGhyZWFkU3RhdHVzID09ICdBbnN3ZXJlZCcpIGFuc3dlciNlbHNlaWYoJHRocmVhZC5UaHJlYWRTdGF0dXMgPT0gJ0Fuc3dlcmVkTm90VmVyaWZpZWQnKSBzdWdnZXN0ZWQtYW5zd2VyI2VuZCNlbmQiIGRhdGEtdGFyZ2V0dXJsPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCR0aHJlYWQuVXJsKSI+DQoJCTxkaXYgY2xhc3M9InBvc3QiPg0KCQkJPGRpdiBjbGFzcz0iYXZhdGFyIj4NCgkJCQkjaWYgKCR0aHJlYWQuQXV0aG9yLlByb2ZpbGVVcmwpDQoJCQkJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJHRocmVhZC5BdXRob3IuUHJvZmlsZVVybCkiIGNsYXNzPSJpbnRlcm5hbC1saW5rIHZpZXctdXNlci1wcm9maWxlIj4NCgkJCQkJCSRjb3JlX3YyX3VpLkdldFJlc2l6ZWRJbWFnZUh0bWwoJHRocmVhZC5BdXRob3IuQXZhdGFyVXJsLCA0MCwgNDAsICIle2JvcmRlcj0nMCcsIGFsdD0kdGhyZWFkLkF1dGhvci5EaXNwbGF5TmFtZSwgUmVzaXplTWV0aG9kPSdab29tQW5kQ3JvcCcsYm9yZGVyPScwJ30iKQ0KCQkJCQk8L2E+DQoJCQkJI2Vsc2UNCgkJCQkJJGNvcmVfdjJfdWkuR2V0UmVzaXplZEltYWdlSHRtbCgkdGhyZWFkLkF1dGhvci5BdmF0YXJVcmwsIDQwLCA0MCwgIiV7Ym9yZGVyPScwJywgYWx0PSR0aHJlYWQuQXV0aG9yLkRpc3BsYXlOYW1lLCBSZXNpemVNZXRob2Q9J1pvb21BbmRDcm9wJyxib3JkZXI9JzAnfSIpDQoJCQkJI2VuZA0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJkZXRhaWxzIj4NCgkJCQk8ZGl2IGNsYXNzPSJkYXRlIj4jaWYgKCR0aHJlYWQuTGF0ZXN0UG9zdERhdGUpJHtjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdEFnb0RhdGUoJHRocmVhZC5MYXRlc3RQb3N0RGF0ZSl9I2Vsc2Uke2NvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0QWdvRGF0ZSgkdGhyZWFkLkRhdGUpfSNlbmQ8L2Rpdj4NCgkJCTwvZGl2Pg0KCQkJPGRpdiBjbGFzcz0iY29udGVudCI+DQoJCQkJPGEgaHJlZj0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkdGhyZWFkLlVybCkiPiR0aHJlYWQuU3ViamVjdDwvYT4NCgkJCTwvZGl2Pg0KCQkJPGRpdiBjbGFzcz0iYWN0aW9ucyB1aS1saW5rcyI+DQoJCQkJPHVsPg0KCQkJCQkjaWYgKCRhY2Nlc3NpbmdVc2VySXNSZWdpc3RlcmVkICYmICRjb3JlX3YyX2xpa2UuQ2FuTGlrZSgkdGhyZWFkLkNvbnRlbnRJZCwgJGNvcmVfdjJfZm9ydW1UaHJlYWQuQ29udGVudFR5cGVJZCkpDQoJCQkJCQk8bGkgY2xhc3M9ImFjdGlvbi1saWtlIj4NCgkJCQkJCQkjc2V0KCRmb3JtYXQgPSAne3RvZ2dsZX0gPHNwYW4gY2xhc3M9ImNvdW50Ij48c3BhbiBjbGFzcz0iaWNvbiI+PC9zcGFuPntjb3VudH08L3NwYW4+JykNCgkJCQkJCQkkY29yZV92Ml91aS5MaWtlKCR0aHJlYWQuQ29udGVudElkLCAkY29yZV92Ml9mb3J1bVRocmVhZC5Db250ZW50VHlwZUlkLCAiJXsgRm9ybWF0ID0gJGZvcm1hdCB9IikNCgkJCQkJCTwvbGk+DQoJCQkJCSNlbmQNCgkJCQkJPGxpPg0KCQkJCQkJI2lmICgkdGhyZWFkLlRocmVhZFR5cGUgPT0gJ1F1ZXN0aW9uQW5kQW5zd2VyJyAmJiAkdGhyZWFkLlRocmVhZFN0YXR1cyA9PSAnQW5zd2VyZWQnKQ0KCQkJCQkJCTxhIGhyZWY9IiMiIGNsYXNzPSJhbnN3ZXJlZCIgZGF0YS10aHJlYWRpZD0iJHRocmVhZC5JZCI+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ2Fuc3dlcmVkJyk8L2E+DQoJCQkJCQkjZWxzZQ0KCQkJCQkJCTxzcGFuIGNsYXNzPSJkZXRhaWwgY29tbWVudCI+DQoJCQkJCQkJCSNpZiAoJHRocmVhZC5SZXBseUNvdW50ID09IDApDQoJCQkJCQkJCQkkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbm9fcmVwbGllcycpDQoJCQkJCQkJCSNlbHNlaWYgKCR0aHJlYWQuUmVwbHlDb3VudCA9PSAxKQ0KCQkJCQkJCQkJJGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0U3RyaW5nKCRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdyZXBseV9jb3VudCcpLCAkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXROdW1iZXIoJHRocmVhZC5SZXBseUNvdW50KSkNCgkJCQkJCQkJI2Vsc2UNCgkJCQkJCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdFN0cmluZygkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgncmVwbGllc19jb3VudCcpLCAkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXROdW1iZXIoJHRocmVhZC5SZXBseUNvdW50KSkNCgkJCQkJCQkJI2VuZA0KCQkJCQkJCTwvc3Bhbj4NCgkJCQkJCSNlbmQNCgkJCQkJPC9saT4NCgkJCQk8L3VsPg0KCQkJPC9kaXY+DQoJCTwvZGl2Pg0KCTwvZGl2Pg0KI25vZGF0YQ0KCTxkaXYgY2xhc3M9InBvc3QtbGlzdC1pdGVtIGNvbnRlbnQtaXRlbSBmb3J1bSI+PGRpdiBjbGFzcz0ibWVzc2FnZSBub3JlY29yZHMiPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdub190aHJlYWRzJyk8L2Rpdj48L2Rpdj4NCiNhZnRlcmFsbA0KCSNzZXQgKCRoYXNNb3JlID0gZmFsc2UpDQoJI2lmICgkdGhyZWFkcy5Ub3RhbENvdW50ID4gKCgkdGhyZWFkcy5QYWdlSW5kZXggKyAxKSAqICR0aHJlYWRzLlBhZ2VTaXplKSkNCgkJI3NldCgkaGFzTW9yZSA9IHRydWUpDQoJI2VuZA0KCTxkaXYgY2xhc3M9ImRhdGEiICNpZigkaGFzTW9yZSlkYXRhLWhhc21vcmU9InRydWUiI2VuZD48L2Rpdj4NCiNlbmQ=</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBmb3J1bXMNCiMjDQojc2V0ICgkcGFnZUluZGV4ID0gJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X3BhZ2VJbmRleCcpKQ0KI3NldCgkZm9ydW1JZCA9IGZhbHNlKQ0KI3NldCgkZm9ydW1JZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJG1vYmlsZV92MV91cmxUb2tlbi5WYWx1ZSgnRm9ydW1JZCcpKSkNCiNpZiAoISRmb3J1bUlkKQ0KCSRjb3JlX3YyX3dpZGdldC5IaWRlKCkNCiNlbmQNCiRjb3JlX3YyX3dpZGdldC5FeGVjdXRlRmlsZSgnbGlzdC52bScpDQo=</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCSQob3B0aW9ucy53cmFwcGVyKS5vbigndGFwJywgJ2EuYW5zd2VyZWQnLCBmdW5jdGlvbihlKXsNCgkJCQl2YXIgdCA9ICQodGhpcyk7DQoJCQkJdmFyIHRocmVhZElkID0gdC5kYXRhKCd0aHJlYWRpZCcpOw0KDQoJCQkJdmFyIHAgPSB0LnBhcmVudHMoJy5wb3N0LWxpc3QtaXRlbScpOw0KCQkJCXZhciBhID0gcC5maW5kKCcucG9zdC5hbnN3ZXInKTsNCgkJCQlpZiAoYS5sZW5ndGggPiAwKSB7DQoJCQkJCWlmIChhLmNzcygnZGlzcGxheScpID09ICdub25lJykgew0KCQkJCQkJYS5zaG93KCk7DQoJCQkJCX0gZWxzZSB7DQoJCQkJCQlhLmhpZGUoKTsNCgkJCQkJfQ0KCQkJCX0gZWxzZSB7DQoJCQkJCWEgPSAkKCc8ZGl2IGNsYXNzPSJwb3N0IGFuc3dlciIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij48L2Rpdj4nKTsNCg0KCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsNCgkJCQkJCXVybDogb3B0aW9ucy5hbnN3ZXJVcmwsDQoJCQkJCQlkYXRhOiB7DQoJCQkJCQkJd190aHJlYWRpZDogdGhyZWFkSWQNCgkJCQkJCX0sDQoJCQkJCQlzdWNjZXNzOiBmdW5jdGlvbihyKSB7DQoJCQkJCQkJYS5odG1sKHIpOw0KCQkJCQkJCXAuYXBwZW5kKGEpOw0KCQkJCQkJCWEuc2hvdygpOw0KCQkJCQkJfQ0KCQkJCQl9KTsNCgkJCQl9DQoNCgkJCQlyZXR1cm4gZmFsc2U7DQoJCQl9KTsNCg0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zY3JvbGxhYmxlKHsNCgkJCQlyZWdpb246ICdjb250ZW50JywNCgkJCQlsb2FkOiBmdW5jdGlvbihwYWdlSW5kZXgsIHN1Y2Nlc3MsIGVycm9yKSB7DQoJCQkJCWlmICgkKG9wdGlvbnMud3JhcHBlciArICcgZGl2LmRhdGE6bGFzdCcpLmRhdGEoJ2hhc21vcmUnKSkgew0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLmdldCh7DQoJCQkJCQkJdXJsOiBvcHRpb25zLm1vcmVVcmwsDQoJCQkJCQkJZGF0YTogew0KCQkJCQkJCQl3X3BhZ2VJbmRleDogcGFnZUluZGV4DQoJCQkJCQkJfSwNCgkJCQkJCQlzdWNjZXNzOiBmdW5jdGlvbihyKSB7DQoJCQkJCQkJCXN1Y2Nlc3Mocik7DQoJCQkJCQkJfSwNCgkJCQkJCQllcnJvcjogZnVuY3Rpb24oKSB7DQoJCQkJCQkJCWVycm9yKCk7DQoJCQkJCQkJfQ0KCQkJCQkJfSk7DQoJCQkJCX0gZWxzZSB7DQoJCQkJCQlzdWNjZXNzKCk7DQoJCQkJCX0NCgkJCQl9LA0KCQkJCWNvbXBsZXRlOiBmdW5jdGlvbihjb250ZW50KSB7DQoJCQkJCWNvbnRlbnQgPSAkKGNvbnRlbnQpLmNzcyh7IG9wYWNpdHk6IDAgfSk7DQoJCQkJCSQob3B0aW9ucy53cmFwcGVyKS5maW5kKCdkaXYucG9zdC1saXN0JykuYXBwZW5kKGNvbnRlbnQpOw0KCQkJCQljb250ZW50LmV2b2x1dGlvblRyYW5zZm9ybSh7IG9wYWNpdHk6IDEgfSwgeyBkdXJhdGlvbjogNDAwIH0pOw0KCQkJCX0NCgkJCX0pOw0KDQoJCQlpZiAob3B0aW9ucy5jYW5Qb3N0KSB7DQoJCQkJdmFyIHBvc3RMaW5rID0gJCgnPGEgaHJlZj0iJyArIG9wdGlvbnMucG9zdFVybCArICciIGNsYXNzPSJhZGQiPicgKyBvcHRpb25zLnBvc3RMYWJlbCArICc8L2E+Jyk7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zZXRIZWFkZXJCdXR0b24ocG9zdExpbmspOw0KCQkJfQ0KCQl9DQoJfQ0KDQoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24gPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24gfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5mb3J1bVRocmVhZExpc3QgPSBhcGk7DQoNCn0pKGpRdWVyeSk7</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:GroupBanner_Name}" version="7.0.0.1" description="" instanceIdentifier="19db5de0a1654ea594b3a1540cf3d553" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="group-banner">
    <contentScript>

#set ($accessingUser = $core_v2_user.Accessing)

#set($groupId = false)
#set($group = false)
#set($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#if ($groupId)
	#set($group = $core_v2_group.Get("%{Id=$groupId}"))
#end
#if (!$group)
	$core_v2_widget.Hide()
#end

#set ($canReadGroup = $core_v2_nodePermission.Get("groups", $group.Id, "Group_ReadGroup").IsAllowed)

#set ($isRegistered = $core_v2_user.IsRegistered($accessingUser.Id))
#set ($groupUser = $core_v2_groupUserMember.Get($group.Id, "%{UserId = $accessingUser.Id}"))
#set ($membershipType = "None")
#set ($membershipType = $groupUser.MembershipType)

#set ($navigationItems = false)
#if ($canReadGroup)
	#set ($navigationItems = $core_v2_customNavigation.FromWidget($core_v2_utility.ParseGuid('ab92f9a89af24721bba1c464c1334be6'), 'navigation', "%{Url=$core_v2_page.Url, GroupId=$group.Id}"))
#end

#if ($group.ParentGroupId &lt; 1)
	## site-level data if root group
	#set ($siteInfo = $core_v2_infoResult.Get())
	#set ($groupName = $siteInfo.SiteName)
	#set ($groupAvatar = $core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 120, 120, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }"))
	#set ($groupDescription = $siteInfo.SiteDescription)
#else
	## otherwise, normal group
	#set ($groupName = $group.Name)
	#set ($groupAvatar = $core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 120, 120, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }"))
	#set ($groupDescription = $group.Description)
#end

&lt;div class="banner"&gt;
	&lt;div class="avatar"&gt;
		$!groupAvatar
	&lt;/div&gt;
	&lt;h1&gt;$!groupName&lt;/h1&gt;

	&lt;div class="ui-links actions" data-maxlinks="0"&gt;
		&lt;ul&gt;
			#if ($group &amp;&amp; $group.GroupType != 'Joinless')
				#set ($member = $core_v2_groupUserMember.Get($group.Id, "%{ UserId = $accessingUser.Id }"))
				#set ($canJoinGroup = $core_v2_nodePermission.Get("groups", $group.Id, "Group_JoinGroup").IsAllowed)
				#set ($canJoinGroupByRequest = $core_v2_nodePermission.Get("groups", $group.Id, "Group_JoinGroupByRequest").IsAllowed)

				#set ($groupLeaveResource = '')
				#if ($member.MembershipType == "PendingMember")
					#set ($groupLeaveResource = $core_v2_language.GetResource('Group_CancelledJoinRequest'))
				#else
					#set ($groupLeaveResource = $core_v2_language.GetResource('Group_Left'))
				#end

				&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
				&lt;script type="text/javascript"&gt;
					jQuery(function(j){
						jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
							j.telligent.evolution.widgets.groupBanner.register({
								groupId: $group.Id,
								userId: $accessingUser.Id,
								canJoinGroup: #if($canJoinGroup) true,#else false,#end
								canJoinGroupByRequest: #if($canJoinGroupByRequest) true,#else false,#end
								joinMessageLinkName: 'widget.${core_v2_widget.WrapperElementId}.join',
								requestJoinMessageLinkName: 'widget.${core_v2_widget.WrapperElementId}.requestjoin',
								cancelMessageLinkName: 'widget.${core_v2_widget.WrapperElementId}.canceljoin',
								requestJoinUrl: #if(!$canJoinGroup) "$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('group-requestmembership', $group.Id))",#else null,#end
								cancelConfirmMessage: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource("Hubs_Membership_LeaveConfirm"))',
								joinedText:'$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('Group_Joined'))',
								leftText:'$core_v2_encoding.JavascriptEncode($groupLeaveResource)'
							});
						});
					});
				&lt;/script&gt;

				#if (!$member.IsRoleMember &amp;&amp; ($member.MembershipType == "Owner" || $member.MembershipType == "Manager" || $member.MembershipType == "Member" || $member.MembershipType == "PendingMember"))
					#set ($canLeaveGroup = $member.MembershipType != "Owner" || $core_v2_groupUserMember.List($groupId, "%{MembershipType = 'Owner', PageSize = 1}").TotalCount &gt; 1)
					#if ($canLeaveGroup)
						&lt;li&gt;
							&lt;a href="#" class="internal-link leave-group" data-messagename="widget.${core_v2_widget.WrapperElementId}.canceljoin"&gt;
								#if ($membershipType == "PendingMember")
									$core_v2_language.GetResource("Hubs_CancelJoinRequest")
								#else
									$core_v2_language.GetResource("Hubs_LeaveGroup")
								#end
							&lt;/a&gt;
						&lt;/li&gt;
					#end
				#elseif ($canJoinGroupByRequest || $canJoinGroup)
					#if ($group.GroupType == "PublicOpen")
						&lt;li&gt;
							&lt;a href="#" class="internal-link join-group" data-messagename="widget.${core_v2_widget.WrapperElementId}.join"&gt;
								$core_v2_language.GetResource('Hubs_JoinGroup')
							&lt;/a&gt;
						&lt;/li&gt;
						#set($hasLinks = true)
					#elseif ($group.GroupType == "PrivateListed")
						&lt;li&gt;
							## If this banner rendering was directly following a leave, don't immediately pop up a re-join message
							#set ($justLeftGroup = false)
							#set ($justLeftGroup = $core_v2_page.GetQueryStringValue('w_justleft'))

							&lt;a href="#" class="internal-link join-group" data-messagename="widget.${core_v2_widget.WrapperElementId}.requestjoin"&gt;
								$core_v2_language.GetResource('Hubs_ApplyToJoin')
							&lt;/a&gt;

							#if (!$justLeftGroup)
								&lt;script type="text/javascript"&gt;
									jQuery(function(j){
										jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
											j.telligent.evolution.mobile.confirm('$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('private_group_request_access'))', function(v) {
												if (v) {
													j.telligent.evolution.messaging.publish('widget.${core_v2_widget.WrapperElementId}.requestjoin', {});
												}
											});
										});
									});
								&lt;/script&gt;
							#end
						&lt;/li&gt;
					#end
				#elseif (!$isRegistered)
					&lt;script type="text/javascript"&gt;
						jQuery(function(j){
							jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
								j.telligent.evolution.mobile.confirm('$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('private_group_login'))', function(v) {
									if (v) {
										j.telligent.evolution.mobile.load('$core_v2_encoding.JavascriptEncode($mobile_v1_authentication.Login())');
									}
								});
							});
						});
					&lt;/script&gt;
				#end
			#end

			#set ($bookmarkableContentId = $group.ContainerId)
			#set ($bookmarkableContentTypeId = $core_v2_group.ContentTypeId)
			#if ($core_v2_bookmark.SupportsBookmarks($bookmarkableContentTypeId) &amp;&amp; $core_v2_bookmark.CanBookmark($bookmarkableContentId, $bookmarkableContentTypeId) &amp;&amp; $core_v2_bookmark.CanUnBookmark($bookmarkableContentId, $bookmarkableContentTypeId))
				&lt;li&gt;$core_v2_ui.Bookmark($bookmarkableContentId, $bookmarkableContentTypeId)&lt;/li&gt;
			#end
			&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;$core_v2_language.GetResource('more')&lt;/a&gt;&lt;/li&gt;
			&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
		&lt;/ul&gt;
	&lt;/div&gt;

	#if ($navigationItems)
		#foreach ($navigationItem in $navigationItems)
			#beforeall
			&lt;div class="ui-links applications" data-minlinks="100" data-animate="true"&gt;
				&lt;ul&gt;
			#each
				#if ($mobile_v1_url.IsRedirected($navigationItem.Url) &amp;&amp; $navigationItem.CssClass != 'internal-link view-group')
					&lt;li&gt;
						&lt;a href="$core_v2_encoding.HtmlAttributeEncode($navigationItem.Url)"&gt;$navigationItem.Label&lt;/a&gt;
					&lt;/li&gt;
				#end
			#afterall
					&lt;li class="application-more"&gt;&lt;a href="#" data-more&gt;$core_v2_language.GetResource('more')&lt;/a&gt;&lt;/li&gt;
					&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
				&lt;/ul&gt;
			&lt;/div&gt;
		#end
	#end
&lt;/div&gt;

	</contentScript>
    <languageResources>
		<language key="en-us">
			<resource name="GroupBanner_Name">Group Banner</resource>
			<resource name="Hubs_LeaveGroup">Leave</resource>
			<resource name="Hubs_CancelJoinRequest">Cancel join request</resource>
			<resource name="Hubs_JoinGroup">Join</resource>
			<resource name="Hubs_ApplyToJoin">Request membership</resource>
			<resource name="Group_Joined">You have joined this group.</resource>
			<resource name="Group_Left">You have left this group.</resource>
			<resource name="Group_CancelledJoinRequest">You have canceled your join request.</resource>
			<resource name="Hubs_Membership_LeaveConfirm">Are you sure you want to leave this group?</resource>
			<resource name="more">More</resource>
			<resource name="cancel">Cancel</resource>
			<resource name="private_group_login">Would you like to login to access this private group?</resource>
			<resource name="private_group_request_access">Would you like to request access to this private group?</resource>
		</language>
	</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCXZhciBqb2luT3B0aW9ucyA9IHsNCgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi9ncm91cHMve0dyb3VwSWR9L21lbWJlcnMvdXNlcnMuanNvbicsDQoJCQkJZGF0YTogew0KCQkJCQlHcm91cElkOiBvcHRpb25zLmdyb3VwSWQsDQoJCQkJCVVzZXJJZDogb3B0aW9ucy51c2VySWQNCgkJCQl9LA0KCQkJCXN1Y2Nlc3M6IGZ1bmN0aW9uKCkgew0KCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubm90aWZpY2F0aW9ucy5zaG93KG9wdGlvbnMuam9pbmVkVGV4dCwgeyB0eXBlOiAnc3VjY2VzcycgfSk7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUucmVmcmVzaCgpOw0KCQkJCX0NCgkJCX07DQoNCgkJCS8vIGFjdGl2YXRlIGdyb3VwIGpvaW5pbmcgYnV0dG9ucw0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUob3B0aW9ucy5qb2luTWVzc2FnZUxpbmtOYW1lLCBmdW5jdGlvbigpIHsNCgkJCQlqb2luT3B0aW9ucy5kYXRhLkdyb3VwTWVtYmVyc2hpcFR5cGUgPSAnTWVtYmVyJzsNCgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNob3dMb2FkaW5nKCQudGVsbGlnZW50LmV2b2x1dGlvbi5wb3N0KGpvaW5PcHRpb25zKSk7DQoJCQkJcmV0dXJuIGZhbHNlOw0KCQkJfSk7DQoNCgkJCS8vIHJlcXVlc3Qgam9pbg0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUob3B0aW9ucy5yZXF1ZXN0Sm9pbk1lc3NhZ2VMaW5rTmFtZSwgZnVuY3Rpb24oKSB7DQoJCQkJaWYgKG9wdGlvbnMuY2FuSm9pbkdyb3VwKSB7DQoJCQkJCWpvaW5PcHRpb25zLmRhdGEuR3JvdXBNZW1iZXJzaGlwVHlwZSA9ICdQZW5kaW5nTWVtYmVyJzsNCgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygkLnRlbGxpZ2VudC5ldm9sdXRpb24ucG9zdChqb2luT3B0aW9ucykpOw0KCQkJCX0gZWxzZSB7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUubG9hZChvcHRpb25zLnJlcXVlc3RKb2luVXJsKTsNCgkJCQl9DQoJCQkJcmV0dXJuIGZhbHNlOw0KCQkJfSk7DQoNCgkJCS8vIGFjdGl2YXRlIG1lbWJlcnNoaXAgY2FuY2VsbGF0aW9uIGxpbmtzDQoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnN1YnNjcmliZShvcHRpb25zLmNhbmNlbE1lc3NhZ2VMaW5rTmFtZSwgZnVuY3Rpb24oKSB7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5jb25maXJtKG9wdGlvbnMuY2FuY2VsQ29uZmlybU1lc3NhZ2UsIGZ1bmN0aW9uKHIpIHsNCgkJCQkJaWYgKHIpIHsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoJC50ZWxsaWdlbnQuZXZvbHV0aW9uLmRlbCh7DQoJCQkJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvZ3JvdXBzL3tHcm91cElkfS9tZW1iZXJzL3VzZXJzL3tVc2VySWR9Lmpzb24nLA0KCQkJCQkJCWRhdGE6IHsNCgkJCQkJCQkJR3JvdXBJZDogb3B0aW9ucy5ncm91cElkLA0KCQkJCQkJCQlVc2VySWQ6IG9wdGlvbnMudXNlcklkDQoJCQkJCQkJfSwNCgkJCQkJCQlzdWNjZXNzOiBmdW5jdGlvbigpew0KCQkJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubm90aWZpY2F0aW9ucy5zaG93KG9wdGlvbnMubGVmdFRleHQsIHsgdHlwZTogJ3N1Y2Nlc3MnIH0pOw0KCQkJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmFkZFJlZnJlc2hQYXJhbWV0ZXIoJ3dfanVzdGxlZnQnLCB0cnVlKTsNCgkJCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5yZWZyZXNoKCk7DQoJCQkJCQkJfQ0KCQkJCQkJfSkpOw0KCQkJCQl9DQoJCQkJfSk7DQoJCQkJcmV0dXJuIGZhbHNlOw0KCQkJfSk7DQoJCX0NCgl9DQoNCgkkLnRlbGxpZ2VudCA9ICQudGVsbGlnZW50IHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyA9ICQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzLmdyb3VwQmFubmVyID0gYXBpOw0KDQp9KShqUXVlcnkpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:GroupList_Name}" version="7.0.0.1" description="" instanceIdentifier="60ac1bed4b9844b893a5c8d4497261c8" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="group-list">
    <contentScript>
		


#set ($pageIndex = 0)
#set ($pageSize = $core_v2_widget.GetIntValue('pageSize', 5))
#set ($queryType = $core_v2_widget.GetStringValue('queryType','currentUser'))

#if ($queryType == "subGroups")
	#set ($parentGroupId = false)
	#set ($parentGroupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
	#if (!$parentGroupId)
		$core_v2_widget.Hide()
	#end
	#set ($parentGroup = false)
	#set ($parentGroup = $core_v2_group.Get("%{Id=$parentGroupId}"))
	#if (!$parentGroup)
		$core_v2_widget.Hide()
	#end

	#set($bannerUrl = $parentGroup.Url)
	#set($bannerText = $parentGroup.Name)
	#set($bannerAvatarUrl = $parentGroup.AvatarUrl)
	#set($headerText = $core_v2_language.GetResource('GroupList_Groups'))

#elseif ($queryType == "currentUser")
	#set ($userId = false)
	#set ($userId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('UserId')))
	#if (!$userId)
		$core_v2_widget.Hide()
	#end
	#set ($user = false)
	#set ($user = $core_v2_user.Get("%{ Id = $userId }"))
	#if (!$user)
		$core_v2_widget.Hide()
	#end

	#set($bannerUrl = $user.ProfileUrl)
	#set($bannerText = $user.DisplayName)
	#set($bannerAvatarUrl = $user.AvatarUrl)
	#set($headerText = $core_v2_language.FormatString($core_v2_language.GetResource('GroupList_UserGroups'), $user.DisplayName))

#elseif ($queryType == "accessingUser")
	#set($user = $core_v2_user.Accessing)

	#set($bannerUrl = $user.ProfileUrl)
	#set($bannerText = $user.DisplayName)
	#set($bannerAvatarUrl = $user.AvatarUrl)
	#set($headerText = $core_v2_language.FormatString($core_v2_language.GetResource('GroupList_UserGroups'), $user.DisplayName))
#else
	$core_v2_widget.Hide()
#end

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($bannerUrl)"&gt;$bannerText&lt;/a&gt;
		&lt;h1&gt;$headerText&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($bannerAvatarUrl, 40, 40, "%{ alt = $bannerText, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
&lt;/div&gt;

&lt;div class="post-list groups"&gt;
	$core_v2_widget.ExecuteFile('list.vm')
&lt;/div&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;

&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.groupList.register({
		moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
		wrapper: '#$core_v2_widget.WrapperElementId',
		pageSize: $pageSize
		});
	});
})
&lt;/script&gt;
		
	</contentScript>
    <headerScript>
		</headerScript>
    <configuration>
		

&lt;propertyGroup id="options" resourceName="GroupList_Options"&gt;
	&lt;property id="queryType" resourceName="GroupList_QueryType" dataType="string" defaultValue="currentUser"&gt;
		&lt;propertyValue value="subGroups" resourceName="GroupList_QueryType_SubGroups" /&gt;
		&lt;propertyValue value="currentUser" resourceName="GroupList_QueryType_CurrentUser" /&gt;
		&lt;propertyValue value="accessingUser" resourceName="GroupList_QueryType_AccessingUser" /&gt;
	&lt;/property&gt;
	&lt;property id="pageSize" resourceName="GroupList_PageSize" dataType="int" defaultValue="5" /&gt;
&lt;/propertyGroup&gt;
		
	</configuration>
    <languageResources>
<language key="en-us">
	<resource name="GroupList_Name">Group List</resource>
	<resource name="GroupList_Options">Options</resource>
	<resource name="GroupList_QueryType">Show</resource>
	<resource name="GroupList_QueryType_SubGroups">Current contextual group's sub-groups</resource>
	<resource name="GroupList_QueryType_CurrentUser">Current contextual user's groups</resource>
	<resource name="GroupList_QueryType_AccessingUser">Accessing user's groups</resource>
	<resource name="GroupList_PageSize">Number of results to display</resource>
	<resource name="GroupList_Groups">Groups</resource>
	<resource name="GroupList_UserGroups">Groups</resource>
	<resource name="GroupList_No_Groups">There were no groups to display.</resource>
	<resource name="GroupList_No_Members">No members</resource>
	<resource name="GroupList_Member">{0} member</resource>
	<resource name="GroupList_Members">{0} members</resource>
</language>
		</languageResources>
    <files>
      <file name="list.vm">I3NldCgkZ3JvdXBzID0gZmFsc2UpDQojaWYoJHF1ZXJ5VHlwZT09J3N1Ykdyb3VwcycpDQoJI3NldCgkZ3JvdXBzID0gJGNvcmVfdjJfZ3JvdXAuTGlzdCgiJXtQYXJlbnRHcm91cElkPSRwYXJlbnRHcm91cC5JZCxQYWdlU2l6ZT0kcGFnZVNpemUsUGFnZUluZGV4PSRwYWdlSW5kZXgsU29ydEJ5PSdOYW1lJyxTb3J0T3JkZXI9J0FzY2VuZGluZycsR3JvdXBUeXBlcz0nYWxsJ30iKSkNCiNlbHNlaWYoJHF1ZXJ5VHlwZT09J2N1cnJlbnRVc2VyJykNCgkjc2V0KCRncm91cHMgPSAkY29yZV92Ml9ncm91cC5MaXN0KCIle1VzZXJJZD0kdXNlci5JZCxQYWdlU2l6ZT0kcGFnZVNpemUsUGFnZUluZGV4PSRwYWdlSW5kZXgsU29ydEJ5PSdMYXN0VXBkYXRlJyxTb3J0T3JkZXI9J0FzY2VuZGluZyd9IikpDQojZWxzZQ0KCSNzZXQgKCRpbmNsdWRlUGVuZGluZ01lbWJlcnNoaXBzID0gdHJ1ZSkNCgkjc2V0KCRncm91cHMgPSAkY29yZV92Ml9ncm91cC5MaXN0KCIle1VzZXJJZD0kdXNlci5JZCxQYWdlU2l6ZT0kcGFnZVNpemUsUGFnZUluZGV4PSRwYWdlSW5kZXgsU29ydEJ5PSdMYXN0VXBkYXRlJyxTb3J0T3JkZXI9J0FzY2VuZGluZycsSW5jbHVkZVBlbmRpbmdNZW1iZXJzaGlwcz0kaW5jbHVkZVBlbmRpbmdNZW1iZXJzaGlwc30iKSkNCiNlbmQNCg0KDQojZm9yZWFjaCgkZ3JvdXAgaW4gJGdyb3VwcykNCiNlYWNoDQoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIGdyb3VwIiBkYXRhLXRhcmdldHVybD0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkZ3JvdXAuVXJsKSI+DQoJCTxkaXYgY2xhc3M9InBvc3QiPg0KCQkJPGRpdiBjbGFzcz0iYXZhdGFyIj4NCgkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRncm91cC5VcmwpIiBjbGFzcz0iaW50ZXJuYWwtbGluayB2aWV3LWdyb3VwIj4NCgkJCQkJJGNvcmVfdjJfdWkuR2V0UmVzaXplZEltYWdlSHRtbCgkZ3JvdXAuQXZhdGFyVXJsLCA0MCwgNDAsICIle2JvcmRlcj0nMCcsIGFsdD0kZ3JvdXAuTmFtZSwgUmVzaXplTWV0aG9kPSdab29tQW5kQ3JvcCcsYm9yZGVyPScwJ30iKQ0KCQkJCTwvYT4NCg0KCQkJPC9kaXY+DQoNCgkJCTxkaXYgY2xhc3M9ImNvbnRlbnQiPg0KCQkJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJGdyb3VwLlVybCkiPiRncm91cC5OYW1lPC9hPg0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJhY3Rpb25zIHVpLWxpbmtzIj4NCgkJCQk8dWw+DQoJCQkJCSNzZXQgKCRjYW5WaWV3TWVtYmVyc2hpcHMgPSAkY29yZV92Ml9ub2RlUGVybWlzc2lvbi5HZXQoImdyb3VwcyIsICRncm91cC5JZCwgIkdyb3VwX1ZpZXdNZW1iZXJzaGlwIikuSXNBbGxvd2VkKQ0KCQkJCQkjaWYgKCRjYW5WaWV3TWVtYmVyc2hpcHMpDQoJCQkJCQk8bGkgY2xhc3M9ImFjdGlvbi1tZW1iZXJzIj4NCgkJCQkJCQk8YSBjbGFzcz0iaW50ZXJuYWwtbGluayBtZW1iZXJzIiBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRtb2JpbGVfdjFfdXJsLkZvcm1hdCgnZ3JvdXAtbWVtYmVycycsICRncm91cC5JZCkpIj4NCgkJCQkJCQkJI2lmICgkZ3JvdXAuVG90YWxNZW1iZXJzID09IDEpDQoJCQkJCQkJCQkkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRTdHJpbmcoJGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ0dyb3VwTGlzdF9NZW1iZXInKSwgJGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0TnVtYmVyKCRncm91cC5Ub3RhbE1lbWJlcnMpKQ0KCQkJCQkJCQkjZWxzZWlmICgkZ3JvdXAuVG90YWxNZW1iZXJzID4gMSkNCgkJCQkJCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdFN0cmluZygkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnR3JvdXBMaXN0X01lbWJlcnMnKSwgJGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0TnVtYmVyKCRncm91cC5Ub3RhbE1lbWJlcnMpKQ0KCQkJCQkJCQkjZWxzZQ0KCQkJCQkJCQkJJGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ0dyb3VwTGlzdF9Ob19NZW1iZXJzJykNCgkJCQkJCQkJI2VuZA0KCQkJCQkJCTwvYT4NCgkJCQkJCTwvbGk+DQoJCQkJCSNlbmQNCgkJCQk8L3VsPg0KCQkJPC9kaXY+DQoJCTwvZGl2Pg0KCTwvZGl2Pg0KDQojbm9kYXRhDQoJPGRpdiBpZD0iJHtjb3JlX3YyX3dpZGdldC5XcmFwcGVyRWxlbWVudElkfV9tZXNzYWdlX25vcmVjb3JkcyI+PGRpdiBjbGFzcz0ibWVzc2FnZSBub3JlY29yZHMiPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdHcm91cExpc3RfTm9fR3JvdXBzJyk8L2Rpdj48L2Rpdj4NCiNhZnRlcmFsbA0KCSNzZXQgKCRoYXNNb3JlID0gZmFsc2UpDQoJI2lmICgkZ3JvdXBzLlRvdGFsQ291bnQgPiAoKCRncm91cHMuUGFnZUluZGV4ICsgMSkgKiAkZ3JvdXBzLlBhZ2VTaXplKSkNCgkJI3NldCgkaGFzTW9yZSA9IHRydWUpDQoJI2VuZA0KCTxkaXYgY2xhc3M9ImRhdGEiICNpZigkaGFzTW9yZSlkYXRhLWhhc21vcmU9InRydWUiI2VuZD48L2Rpdj4NCiNlbmQNCg==</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBncm91cHMNCiMjDQojc2V0ICgkcGFnZUluZGV4ID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUludCgkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ1BhZ2VJbmRleCcpKSkNCiNzZXQgKCRwYWdlU2l6ZSA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCdQYWdlU2l6ZScpKSkNCg0KI3NldCAoJHF1ZXJ5VHlwZSA9ICRjb3JlX3YyX3dpZGdldC5HZXRTdHJpbmdWYWx1ZSgncXVlcnlUeXBlJywnY3VycmVudFVzZXInKSkNCiNpZiAoJHF1ZXJ5VHlwZSA9PSAic3ViR3JvdXBzIikNCgkjc2V0ICgkcGFyZW50R3JvdXBJZCA9IGZhbHNlKQ0KCSNzZXQgKCRwYXJlbnRHcm91cElkID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUludCgkbW9iaWxlX3YxX3VybFRva2VuLlZhbHVlKCdHcm91cElkJykpKQ0KCSNpZiAoISRwYXJlbnRHcm91cElkKQ0KCQkkY29yZV92Ml93aWRnZXQuSGlkZSgpDQoJI2VuZCAgICAJDQoJI3NldCAoJHBhcmVudEdyb3VwID0gZmFsc2UpDQoJI3NldCAoJHBhcmVudEdyb3VwID0gJGNvcmVfdjJfZ3JvdXAuR2V0KCIle0lkPSRwYXJlbnRHcm91cElkfSIpKQ0KCSNpZiAoISRwYXJlbnRHcm91cCkNCgkJJGNvcmVfdjJfd2lkZ2V0LkhpZGUoKQ0KCSNlbmQNCiNlbHNlaWYgKCRxdWVyeVR5cGUgPT0gImN1cnJlbnRVc2VyIikNCgkjc2V0ICgkdXNlcklkID0gZmFsc2UpDQoJI3NldCAoJHVzZXJJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJG1vYmlsZV92MV91cmxUb2tlbi5WYWx1ZSgnVXNlcklkJykpKQ0KCSNpZiAoISR1c2VySWQpDQoJCSRjb3JlX3YyX3dpZGdldC5IaWRlKCkNCgkjZW5kDQoJI3NldCAoJHVzZXIgPSBmYWxzZSkNCgkjc2V0ICgkdXNlciA9ICRjb3JlX3YyX3VzZXIuR2V0KCIleyBJZCA9ICR1c2VySWQgfSIpKQ0KCSNpZiAoISR1c2VyKQ0KCQkkY29yZV92Ml93aWRnZXQuSGlkZSgpDQoJI2VuZA0KI2Vsc2VpZiAoJHF1ZXJ5VHlwZSA9PSAiYWNjZXNzaW5nVXNlciIpDQoJI3NldCgkdXNlciA9ICRjb3JlX3YyX3VzZXIuQWNjZXNzaW5nKQkNCiNlbHNlDQoJJGNvcmVfdjJfd2lkZ2V0LkhpZGUoKQkNCiNlbmQNCg0KJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCdsaXN0LnZtJyk=</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2Nyb2xsYWJsZSh7DQoJCQkJcmVnaW9uOiAnY29udGVudCcsDQoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgew0KCQkJCQlpZiAoJChvcHRpb25zLndyYXBwZXIgKyAnIGRpdi5kYXRhOmxhc3QnKS5kYXRhKCdoYXNtb3JlJykpIHsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoew0KCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLA0KCQkJCQkJCWRhdGE6IHsNCgkJCQkJCQkJUGFnZVNpemU6IG9wdGlvbnMucGFnZVNpemUsDQoJCQkJCQkJCVBhZ2VJbmRleDogcGFnZUluZGV4LA0KCQkJCQkJCX0sDQoJCQkJCQkJc3VjY2VzczogZnVuY3Rpb24ocikgew0KCQkJCQkJCQlzdWNjZXNzKHIpOw0KCQkJCQkJCX0sDQoJCQkJCQkJZXJyb3I6IGZ1bmN0aW9uKCkgew0KCQkJCQkJCQllcnJvcigpOw0KCQkJCQkJCX0NCgkJCQkJCX0pOw0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJc3VjY2VzcygpOw0KCQkJCQl9DQoJCQkJfSwNCgkJCQljb21wbGV0ZTogZnVuY3Rpb24oY29udGVudCkgew0KCQkJCQljb250ZW50ID0gJChjb250ZW50KS5jc3MoeyBvcGFjaXR5OiAwIH0pOw0KCQkJCQkkKG9wdGlvbnMud3JhcHBlcikuZmluZCgnZGl2LnBvc3QtbGlzdCcpLmFwcGVuZChjb250ZW50KTsNCgkJCQkJY29udGVudC5ldm9sdXRpb25UcmFuc2Zvcm0oeyBvcGFjaXR5OiAxIH0sIHsgZHVyYXRpb246IDQwMCB9KTsNCgkJCQl9DQoJCQl9KTsNCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMuZ3JvdXBMaXN0ID0gYXBpOw0KDQp9KShqUXVlcnkpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:GroupMembers_Name}" version="7.0.0.1" description="" instanceIdentifier="1b64e4816d424c98b1321eff0f4bce59" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="group-members">
    <contentScript>
		
#set ($pageName = $mobile_v1_url.Current)
#set($groupId = false)
#set($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#if (!$groupId)
	$core_v2_widget.Hide()
#end

#set($group = $core_v2_group.Get("%{Id=$groupId}"))
&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($group.Url)"&gt;$group.Name&lt;/a&gt;
		&lt;h1&gt;$core_v2_language.GetResource('group-members')&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 40, 40, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
&lt;/div&gt;

## load and render group members
&lt;div class="post-list members"&gt;
	#set($pageIndex = 0)
    $core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
    jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
        jQuery.telligent.evolution.widgets.groupMembers.register({
            wrapper: '#$core_v2_widget.WrapperElementId',
            moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))'
        });
    });
})
&lt;/script&gt;
		

		</contentScript>
    <headerScript>
        </headerScript>
    <languageResources>
		  <language key="en-us">
		  	<resource name="GroupMembers_Name">Group Members</resource>
			<resource name="group-members">Group Members</resource>
			<resource name="no-members">No Members</resource>
		  </language>
		</languageResources>
    <files>
      <file name="list.vm">I3NldCgkbWVtYmVycyA9ICRjb3JlX3YyX2dyb3VwVXNlck1lbWJlci5MaXN0KCIle0dyb3VwSWQgPSAkZ3JvdXBJZCxQYWdlSW5kZXg9JHBhZ2VJbmRleCxQYWdlU2l6ZT01fSIpKQ0KI2ZvcmVhY2goJG1lbWJlciBpbiAkbWVtYmVycykNCg0KCTxkaXYgY2xhc3M9InBvc3QtbGlzdC1pdGVtIGNvbnRlbnQtaXRlbSBtZW1iZXIiIGRhdGEtdGFyZ2V0dXJsPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRtZW1iZXIuVXNlci5Qcm9maWxlVXJsKSI+DQoJCTxkaXYgY2xhc3M9InBvc3QiPg0KCQkJPGRpdiBjbGFzcz0iYXZhdGFyIj4NCgkJCQkjaWYgKCRtZW1iZXIuVXNlci5Qcm9maWxlVXJsKQ0KCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRtZW1iZXIuVXNlci5Qcm9maWxlVXJsKSIgY2xhc3M9ImludGVybmFsLWxpbmsgdmlldy11c2VyLXByb2ZpbGUiPg0KCQkJCQkJJGNvcmVfdjJfdWkuR2V0UmVzaXplZEltYWdlSHRtbCgkbWVtYmVyLlVzZXIuQXZhdGFyVXJsLCA0MCwgNDAsICIle2JvcmRlcj0nMCcsIGFsdD0kbWVtYmVyLlVzZXIuRGlzcGxheU5hbWUsIFJlc2l6ZU1ldGhvZD0nWm9vbUFuZENyb3AnLGJvcmRlcj0nMCd9IikNCgkJCQkJPC9hPg0KCQkJCSNlbHNlDQoJCQkJCSRjb3JlX3YyX3VpLkdldFJlc2l6ZWRJbWFnZUh0bWwoJG1lbWJlci5Vc2VyLkF2YXRhclVybCwgNDAsIDQwLCAiJXtib3JkZXI9JzAnLCBhbHQ9JG1lbWJlci5Vc2VyLkRpc3BsYXlOYW1lLCBSZXNpemVNZXRob2Q9J1pvb21BbmRDcm9wJyxib3JkZXI9JzAnfSIpDQoJCQkJI2VuZA0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJkZXRhaWxzIj4NCgkJCQ0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJjb250ZW50Ij4NCgkJCQkjaWYgKCRtZW1iZXIuVXNlci5Qcm9maWxlVXJsKQ0KCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRtZW1iZXIuVXNlci5Qcm9maWxlVXJsKSIgY2xhc3M9ImludGVybmFsLWxpbmsgdmlldy11c2VyLXByb2ZpbGUiPg0KCQkJCQkJJG1lbWJlci5Vc2VyLkRpc3BsYXlOYW1lDQoJCQkJCTwvYT4NCgkJCQkjZWxzZQ0KCQkJCQkkbWVtYmVyLlVzZXIuRGlzcGxheU5hbWUNCgkJCQkjZW5kDQoJCQk8L2Rpdj4NCgkJPC9kaXY+DQoJPC9kaXY+DQojbm9kYXRhDQoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIG1lbWJlcnMiPjxkaXYgY2xhc3M9Im1lc3NhZ2Ugbm9yZWNvcmRzIj4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbm9fd2lraXMnKTwvZGl2PjwvZGl2Pg0KI2FmdGVyYWxsDQoJI3NldCAoJGhhc01vcmUgPSBmYWxzZSkNCgkjaWYgKCRtZW1iZXJzLlRvdGFsQ291bnQgPiAoKCRtZW1iZXJzLlBhZ2VJbmRleCArIDEpICogJG1lbWJlcnMuUGFnZVNpemUpKQ0KCQkjc2V0KCRoYXNNb3JlID0gdHJ1ZSkNCgkjZW5kDQoJPGRpdiBjbGFzcz0iZGF0YSIgI2lmKCRoYXNNb3JlKWRhdGEtaGFzbW9yZT0idHJ1ZSIjZW5kPjwvZGl2Pg0KI2VuZA==</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBncm91cCBtZW1iZXJzDQojIw0KI3NldCAoJHBhZ2VJbmRleCA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19wYWdlSW5kZXgnKSkNCiNzZXQoJGdyb3VwSWQgPSBmYWxzZSkNCiNzZXQoJGdyb3VwSWQgPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlSW50KCRtb2JpbGVfdjFfdXJsVG9rZW4uVmFsdWUoJ0dyb3VwSWQnKSkpDQojaWYgKCEkZ3JvdXBJZCkNCgkkY29yZV92Ml93aWRnZXQuSGlkZSgpDQojZW5kDQokY29yZV92Ml93aWRnZXQuRXhlY3V0ZUZpbGUoJ2xpc3Qudm0nKQ0K</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2Nyb2xsYWJsZSh7DQoJCQkJcmVnaW9uOiAnY29udGVudCcsDQoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgew0KCQkJCQlpZiAoJChvcHRpb25zLndyYXBwZXIgKyAnIGRpdi5kYXRhOmxhc3QnKS5kYXRhKCdoYXNtb3JlJykpIHsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoew0KCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLA0KCQkJCQkJCWRhdGE6IHsNCgkJCQkJCQkJd19wYWdlSW5kZXg6IHBhZ2VJbmRleA0KCQkJCQkJCX0sDQoJCQkJCQkJc3VjY2VzczogZnVuY3Rpb24ocikgew0KCQkJCQkJCQlzdWNjZXNzKHIpOw0KCQkJCQkJCX0sDQoJCQkJCQkJZXJyb3I6IGZ1bmN0aW9uKCkgew0KCQkJCQkJCQllcnJvcigpOw0KCQkJCQkJCX0NCgkJCQkJCX0pOw0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJc3VjY2VzcygpOw0KCQkJCQl9DQoJCQkJfSwNCgkJCQljb21wbGV0ZTogZnVuY3Rpb24oY29udGVudCkgew0KCQkJCQljb250ZW50ID0gJChjb250ZW50KS5jc3MoeyBvcGFjaXR5OiAwIH0pOw0KCQkJCQkkKG9wdGlvbnMud3JhcHBlcikuZmluZCgnZGl2LnBvc3QtbGlzdCcpLmFwcGVuZChjb250ZW50KTsNCgkJCQkJY29udGVudC5ldm9sdXRpb25UcmFuc2Zvcm0oeyBvcGFjaXR5OiAxIH0sIHsgZHVyYXRpb246IDQwMCB9KTsNCgkJCQl9DQoJCQl9KTsNCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMuZ3JvdXBNZW1iZXJzID0gYXBpOw0KDQp9KShqUXVlcnkpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:GroupMembershipRequest_Name}" version="7.0.0.1" description="" instanceIdentifier="fee03ac5964c4e4b832ed8fa466850ff" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="group-membership-request">
    <contentScript>
		
#set($groupId = false)
#set($group = false)
#set($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#if ($groupId)
	#set($group = $core_v2_group.Get("%{Id=$groupId}"))
#end
#if (!$group)
	$core_v2_widget.Hide()
#end

#if (!$core_v2_nodePermission.Get("groups", $group.Id, "Group_JoinGroupByRequest").IsAllowed)
	$core_v2_widget.Hide()
#end

#set($bodyId = $core_v2_widget.UniqueId('body'))

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($group.Url)"&gt;$group.Name&lt;/a&gt;
		&lt;h1&gt;$core_v2_language.GetResource('request_membership')&lt;/h1&gt;
	&lt;/div&gt;
&lt;/div&gt;
&lt;fieldset&gt;
	&lt;div class="form-field editor"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;$core_v2_language.FormatString($core_v2_language.GetResource('request'), $group.Name)&lt;/label&gt;
		&lt;textarea id="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;&lt;/textarea&gt;
	&lt;/div&gt;
&lt;/fieldset&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.groupMembershipRequest.register({
			bodyId: '#$core_v2_encoding.JavascriptEncode($bodyId)',
			sendLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('send'))',
			groupId: $group.Id,
			userId: $core_v2_user.Accessing.Id
		});

		jQuery.telligent.evolution.mobile.refreshable(false);
		jQuery.telligent.evolution.mobile.excludeFromHistory();
	});
})
&lt;/script&gt;
		

		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
			<resource name="GroupMembershipRequest_Name">Group Membership Request</resource>
			<resource name="request">Request access to {0}</resource>
			<resource name="send">Send</resource>
			<resource name="request_membership">Request membership</resource>
		  </language>
		</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCwgdW5kZWYpew0KCXZhciBhcGkgPSB7DQoJCXJlZ2lzdGVyOiBmdW5jdGlvbihvcHRpb25zKSB7DQoJCQlvcHRpb25zLmJvZHkgPSAkKG9wdGlvbnMuYm9keUlkKTsNCg0KCQkJdmFyIHNlbmRMaW5rID0gJCgnPGEgaHJlZj0iIyIgY2xhc3M9InN1Ym1pdCI+JyArIG9wdGlvbnMuc2VuZExhYmVsICsgJzwvYT4nKTsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2V0SGVhZGVyQnV0dG9uKHNlbmRMaW5rKTsNCg0KCQkJc2VuZExpbmsub24oJ3RhcCcsIGZ1bmN0aW9uKCl7DQoJCQkJaWYgKG9wdGlvbnMuYm9keS52YWwoKS5sZW5ndGggPiAwKSB7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoKTsNCgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnBvc3Qoew0KCQkJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvZ3JvdXBzL3tHcm91cElkfS9tZW1iZXJzL3VzZXJzLmpzb24nLA0KCQkJCQkJZGF0YTogew0KCQkJCQkJCUdyb3VwSWQ6IG9wdGlvbnMuZ3JvdXBJZCwNCgkJCQkJCQlVc2VySWQ6IG9wdGlvbnMudXNlcklkLA0KCQkJCQkJCUdyb3VwTWVtYmVyc2hpcFR5cGU6ICdQZW5kaW5nTWVtYmVyJywNCgkJCQkJCQlNZXNzYWdlOiBvcHRpb25zLmJvZHkudmFsKCkNCgkJCQkJCX0NCgkJCQkJfSkudGhlbihmdW5jdGlvbigpew0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5iYWNrKHRydWUpOw0KCQkJCQl9KQ0KCQkJCQkuZmFpbChmdW5jdGlvbigpew0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlTG9hZGluZygpOw0KCQkJCQl9KTsNCgkJCQl9DQoJCQkJcmV0dXJuIGZhbHNlOw0KCQkJfSk7DQoJCX0NCgl9DQoNCgkkLnRlbGxpZ2VudCA9ICQudGVsbGlnZW50IHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyA9ICQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzLmdyb3VwTWVtYmVyc2hpcFJlcXVlc3QgPSBhcGk7DQoNCn0pKGpRdWVyeSwgd2luZG93KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:LikerList_Name}" version="7.0.0.1" description="" instanceIdentifier="e0331369e7ad479c8c21b5bc625ca681" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="liker-list">
    <contentScript>
		
#set($contentTypeId = false)
#if ($core_v2_page.GetQueryStringValue('ContentTypeId').length &gt; 0)
	#set($contentTypeId = $core_v2_utility.ParseGuid($core_v2_page.GetQueryStringValue('ContentTypeId')))
#end
#set($contentId = false)
#if ($core_v2_page.GetQueryStringValue('ContentId').length &gt; 0)
	#set($contentId = $core_v2_utility.ParseGuid($core_v2_page.GetQueryStringValue('ContentId')))
#end
#set($typeId = false)
#if ($core_v2_page.GetQueryStringValue('TypeId').length &gt; 0)
	#set($typeId = $core_v2_utility.ParseGuid($core_v2_page.GetQueryStringValue('TypeId')))
#end

#if (!$contentTypeId || !$contentId)
	$core_v2_widget.Hide()
#end

#set($content = false)
#set($content = $core_v2_content.Get($contentId, $contentTypeId))
#if ($content)
	&lt;div class="banner condensed"&gt;
		&lt;div class="context"&gt;
			#if ($content.Application)
				#if ($content.Application.Container &amp;&amp; $content.Application.Container.Id != $content.Application.Id)
					&lt;a href="$core_v2_encoding.HtmlAttributeEncode($content.Application.Container.Url)"&gt;$!content.Application.Container.HtmlName('Web')&lt;/a&gt;
				#end
				#if ($content.Application.Id != $content.Id)
					&lt;a href="$core_v2_encoding.HtmlAttributeEncode($content.Application.Url)"&gt;$!content.Application.HtmlName('Web')&lt;/a&gt;
				#end
			#end
			&lt;a href="$core_v2_encoding.HtmlAttributeEncode($content.Url)"&gt;$!content.HtmlName('Web')&lt;/a&gt;
			&lt;h1&gt;$core_v2_language.GetResource('likers')&lt;/h1&gt;
		&lt;/div&gt;
	&lt;/div&gt;

#end

## load and render likers
&lt;div class="post-list likers"&gt;
	#set($pageIndex = 0)
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.likerList.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
			contentId: '$contentId',
			contentTypeId: '$contentTypeId',
			typeId: #if ($typeId) '$typeId' #else '' #end
		});
	});
})
&lt;/script&gt;
		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
	  	<resource name="LikerList_Name">Like List</resource>
		<resource name="no_likers">No Likers</resource>
		<resource name="likers">Likers</resource>
	  </language>
	</languageResources>
    <files>
      <file name="list.vm">IyMgI3NldCgkbGlrZXJzID0gJGNvcmVfdjJfbGlrZS5MaXN0KCIleyBDb250ZW50SWQgPSAkY29udGVudElkLCBDb250ZW50VHlwZUlkID0gJGNvbnRlbnRUeXBlSWQsIFNvcnRCeSA9ICdEYXRlJywgU29ydE9yZGVyID0gJ0Rlc2NlbmRpbmcnLCBUeXBlSWQgPSAkdHlwZUlkIH0iKSkNCiNzZXQoJGxpa2VycyA9ICRjb3JlX3YyX2xpa2UuTGlzdCgiJXsgQ29udGVudElkID0gJGNvbnRlbnRJZCwgQ29udGVudFR5cGVJZCA9ICRjb250ZW50VHlwZUlkLCBTb3J0QnkgPSAnRGF0ZScsIFNvcnRPcmRlciA9ICdEZXNjZW5kaW5nJyB9IikpDQojZm9yZWFjaCgkbGlrZXIgaW4gJGxpa2VycykNCiNlYWNoDQoJI3NldCAoJHVzZXIgPSAkbGlrZXIuVXNlcikNCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gbGlrZXIiDQoJCWRhdGEtdGFyZ2V0dXJsPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCR1c2VyLlByb2ZpbGVVcmwpIj4NCgkJPGRpdiBjbGFzcz0icG9zdCI+DQoJCQk8ZGl2IGNsYXNzPSJhdmF0YXIiPg0KCQkJCSRjb3JlX3YyX3VpLkdldFJlc2l6ZWRJbWFnZUh0bWwoJHVzZXIuQXZhdGFyVXJsLCA0MCwgNDAsICIle2JvcmRlcj0nMCcsIGFsdD0kdXNlci5EaXNwbGF5TmFtZSwgUmVzaXplTWV0aG9kPSdab29tQW5kQ3JvcCcsYm9yZGVyPScwJ30iKQ0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJjb250ZW50Ij4NCgkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCR1c2VyLlByb2ZpbGVVcmwpIj4kdXNlci5EaXNwbGF5TmFtZTwvYT4NCgkJCTwvZGl2Pg0KCQk8L2Rpdj4NCgk8L2Rpdj4NCiNub2RhdGENCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gbGlrZXIiPjxkaXYgY2xhc3M9Im1lc3NhZ2Ugbm9yZWNvcmRzIj4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbm9fbGlrZXJzJyk8L2Rpdj48L2Rpdj4NCiNhZnRlcmFsbA0KCSNzZXQgKCRoYXNNb3JlID0gZmFsc2UpDQoJI2lmICgkbGlrZXJzLlRvdGFsQ291bnQgPiAoKCRsaWtlcnMuUGFnZUluZGV4ICsgMSkgKiAkbGlrZXJzLlBhZ2VTaXplKSkNCgkJI3NldCgkaGFzTW9yZSA9IHRydWUpDQoJI2VuZA0KCTxkaXYgY2xhc3M9ImRhdGEiICNpZigkaGFzTW9yZSlkYXRhLWhhc21vcmU9InRydWUiI2VuZD48L2Rpdj4NCiNlbmQ=</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBsaWtlcnMNCiMjDQoNCiNzZXQgKCRwYWdlSW5kZXggPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfcGFnZUluZGV4JykpDQoNCiNzZXQoJGNvbnRlbnRUeXBlSWQgPSBmYWxzZSkNCiNpZiAoJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X2NvbnRlbnRUeXBlSWQnKS5sZW5ndGggPiAwKQ0KCSNzZXQoJGNvbnRlbnRUeXBlSWQgPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlR3VpZCgkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ0NvbnRlbnRUeXBlSWQnKSkpDQojZW5kDQoNCiNzZXQoJGNvbnRlbnRJZCA9IGZhbHNlKQ0KI2lmICgkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfY29udGVudElkJykubGVuZ3RoID4gMCkNCgkjc2V0KCRjb250ZW50SWQgPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlR3VpZCgkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ0NvbnRlbnRJZCcpKSkNCiNlbmQNCg0KI3NldCgkdHlwZUlkID0gZmFsc2UpDQojaWYgKCRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd190eXBlSWQnKS5sZW5ndGggPiAwKQ0KCSNzZXQoJHR5cGVJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VHdWlkKCRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnVHlwZUlkJykpKQ0KI2VuZA0KDQojaWYgKCEkY29udGVudFR5cGVJZCB8fCAhJGNvbnRlbnRJZCkNCgkkY29yZV92Ml93aWRnZXQuSGlkZSgpDQojZW5kDQokY29yZV92Ml93aWRnZXQuRXhlY3V0ZUZpbGUoJ2xpc3Qudm0nKQ0K</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2Nyb2xsYWJsZSh7DQoJCQkJcmVnaW9uOiAnY29udGVudCcsDQoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgew0KCQkJCQlpZiAoJChvcHRpb25zLndyYXBwZXIgKyAnIGRpdi5kYXRhOmxhc3QnKS5kYXRhKCdoYXNtb3JlJykpIHsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoew0KCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLA0KCQkJCQkJCWRhdGE6IHsNCgkJCQkJCQkJd19wYWdlSW5kZXg6IHBhZ2VJbmRleCwNCgkJCQkJCQkJd19jb250ZW50SWQ6IG9wdGlvbnMuY29udGVudElkLA0KCQkJCQkJCQl3X2NvbnRlbnRUeXBlSWQ6IG9wdGlvbnMuY29udGVudFR5cGVJZCwNCgkJCQkJCQkJd190eXBlSWQ6IG9wdGlvbnMudHlwZUlkDQoJCQkJCQkJfSwNCgkJCQkJCQlzdWNjZXNzOiBmdW5jdGlvbihyKSB7DQoJCQkJCQkJCXN1Y2Nlc3Mocik7DQoJCQkJCQkJfSwNCgkJCQkJCQllcnJvcjogZnVuY3Rpb24oKSB7DQoJCQkJCQkJCWVycm9yKCk7DQoJCQkJCQkJfQ0KCQkJCQkJfSk7DQoJCQkJCX0gZWxzZSB7DQoJCQkJCQlzdWNjZXNzKCk7DQoJCQkJCX0NCgkJCQl9LA0KCQkJCWNvbXBsZXRlOiBmdW5jdGlvbihjb250ZW50KSB7DQoJCQkJCWNvbnRlbnQgPSAkKGNvbnRlbnQpLmNzcyh7IG9wYWNpdHk6IDAgfSk7DQoJCQkJCSQob3B0aW9ucy53cmFwcGVyKS5maW5kKCdkaXYucG9zdC1saXN0JykuYXBwZW5kKGNvbnRlbnQpOw0KCQkJCQljb250ZW50LmV2b2x1dGlvblRyYW5zZm9ybSh7IG9wYWNpdHk6IDEgfSwgeyBkdXJhdGlvbjogNDAwIH0pOw0KCQkJCX0NCgkJCX0pOw0KCQl9DQoJfQ0KDQoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24gPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24gfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5saWtlckxpc3QgPSBhcGk7DQoNCn0pKGpRdWVyeSk7</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:Login_Name}" version="7.0.0.1" description="" instanceIdentifier="ce856d3882c4417ea991d42844187c8e" isCacheable="true" varyCacheByUser="false" showHeaderByDefault="false" cssClass="login">
    <contentScript>
		

#set ($siteName = '')
#set ($siteInfo = $core_v2_infoResult.Get())
#set ($siteName = $core_v2_language.Truncate($siteInfo.SiteName, 35, '...'))
#set ($siteNameId = $core_v2_widget.UniqueId('siteNameId'))
#set ($loginLinkId = $core_v2_widget.UniqueId('loginLinkId'))

&lt;h1 id="$core_v2_encoding.HtmlAttributeEncode($siteNameId)"&gt;$siteName&lt;/h1&gt;
&lt;a id="$core_v2_encoding.HtmlAttributeEncode($loginLinkId)" class="internal-link login" href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_authentication.Login())"&gt;$core_v2_language.GetResource('login')&lt;/a&gt;

&lt;script&gt;
var wrapperId = "#${core_v2_encoding.JavascriptEncode($core_v2_widget.WrapperElementId)}";
var siteNameId = "#${core_v2_encoding.JavascriptEncode($siteNameId)}";
var loginLinkId = "#${core_v2_encoding.JavascriptEncode($loginLinkId)}";
jQuery(function(j){
	jQuery.telligent.evolution.mobile.setClass('login');
	jQuery.telligent.evolution.mobile.refreshable(false);
	jQuery.telligent.evolution.mobile.navigable(false);
	j.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		j(siteNameId)
			.evolutionTransform({ top: 50 })
			.evolutionTransform({ opacity: 1, top: 0 }, {
				duration: 250,
				easing: 'ease-out',
				complete: function() {
					j(loginLinkId).evolutionTransform({ opacity: 1 }, {
						duration: 250,
						easing: 'ease-out'
					});
				}
			});
		j(wrapperId).on('pointermove', function(e){
			e.preventDefault();
		});
	});
});
&lt;/script&gt;

		
		</contentScript>
    <headerScript>
	</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="Login_Name">Login</resource>
		<resource name="login">Login</resource>
	  </language>
	</languageResources>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:MediaGallery_Name}" version="7.0.0.1" description="" instanceIdentifier="eb11e4073f3d4cc19b6327ecd54614d6" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="media-gallery">
    <contentScript>
		
#set($galleryId = false)
#set($galleryId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GalleryId')))
#if (!$galleryId)
	$core_v2_widget.Hide()
#end

#set ($accessingUser = $core_v2_user.Accessing)
#set ($accessingUserIsRegistered = false)
#if ($core_v2_user.IsRegistered($accessingUser.Id))
	#set ($accessingUserIsRegistered = true)
#end

#set($gallery = $core_v2_gallery.Get("%{Id=$galleryId}"))
#set($group = $gallery.Group)
&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($gallery.Group.Url)"&gt;$gallery.Group.Name&lt;/a&gt;
		&lt;h1&gt;$gallery.Name&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 40, 40, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
	&lt;div class="ui-links actions" data-maxlinks="0"&gt;
		&lt;ul&gt;
			#set ($bookmarkableContentId = $gallery.ApplicationId)
			#set ($bookmarkableContentTypeId = $core_v2_gallery.ContentTypeId)
			#if ($core_v2_bookmark.SupportsBookmarks($bookmarkableContentTypeId) &amp;&amp; $core_v2_bookmark.CanBookmark($bookmarkableContentId, $bookmarkableContentTypeId) &amp;&amp; $core_v2_bookmark.CanUnBookmark($bookmarkableContentId, $bookmarkableContentTypeId))
				&lt;li&gt;$core_v2_ui.Bookmark($bookmarkableContentId, $bookmarkableContentTypeId)&lt;/li&gt;
			#end
			&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;$core_v2_language.GetResource('more')&lt;/a&gt;&lt;/li&gt;
			&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
		&lt;/ul&gt;
	&lt;/div&gt;
&lt;/div&gt;

## load and render media galleries
&lt;div class="post-list galleries"&gt;
	#set($pageIndex = 0)
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.mediaGallery.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
			GalleryId: $galleryId,
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			postUrl: '$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('gallery-addmedia', $galleryId))',
			canPost: #if($core_v2_nodePermission.Get("mediagalleries", $galleryId, "MediaGallery_CreatePost").IsAllowed) true#else false#end
		});
	});
})
&lt;/script&gt;
		

		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
			<resource name="MediaGallery_Name">Media Gallery</resource>
			<resource name="media_gallery">Media Galleries</resource>
			<resource name="no_gallery">There are no files in this gallery.</resource>
			<resource name="post">New</resource>
			<resource name="cancel">Cancel</resource>
			<resource name="more">More</resource>
		  </language>
		</languageResources>
    <files>
      <file name="list.vm">I3NldCgkbWVkaWFzID0gJGNvcmVfdjJfbWVkaWEuTGlzdCgiJXtHYWxsZXJ5SWQ9JGdhbGxlcnlJZCxHcm91cElkPSRncm91cC5JZCxQYWdlSW5kZXg9JHBhZ2VJbmRleCxQYWdlU2l6ZT01LFNvcnRCeT0nUG9zdERhdGUnLFNvcnRPcmRlcj0nRGVzY2VuZGluZyd9IikpDQojZm9yZWFjaCgkbWVkaWEgaW4gJG1lZGlhcykNCiNlYWNoDQoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIG1lZGlhIiBkYXRhLXRhcmdldHVybD0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkbW9iaWxlX3YxX3VybC5Gb3JtYXQoJ21lZGlhJywgJG1lZGlhLklkKSkiPg0KCQk8ZGl2IGNsYXNzPSJwb3N0IHdpdGgtdGh1bWJuYWlsIj4NCgkJCTxkaXYgY2xhc3M9InRodW1ibmFpbCI+DQoJCQkJJCFjb3JlX3YyX3VpLkdldFByZXZpZXdIdG1sKCRtZWRpYS5GaWxlLkZpbGVVcmwsICIle1dpZHRoPTYwLEhlaWdodD02MH0iKQ0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJkZXRhaWxzIj4NCgkJCQk8ZGl2IGNsYXNzPSJkYXRlIj4kY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRBZ29EYXRlKCRtZWRpYS5EYXRlKTwvZGl2Pg0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJjb250ZW50Ij4NCgkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRtb2JpbGVfdjFfdXJsLkZvcm1hdCgnbWVkaWEnLCAkbWVkaWEuSWQpKSI+JG1lZGlhLlRpdGxlPC9hPg0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJhY3Rpb25zIj4NCgkJCQk8dWw+DQoJCQkJCSMjIExpa2UNCgkJCQkJI2lmICgkYWNjZXNzaW5nVXNlcklzUmVnaXN0ZXJlZCAmJiAkY29yZV92Ml9saWtlLkNhbkxpa2UoJG1lZGlhLkNvbnRlbnRJZCwgJGNvcmVfdjJfbWVkaWEuQ29udGVudFR5cGVJZCkpDQoJCQkJCQk8bGkgY2xhc3M9ImFjdGlvbi1saWtlIj4NCgkJCQkJCQkjc2V0KCRmb3JtYXQgPSAne3RvZ2dsZX0gPHNwYW4gY2xhc3M9ImNvdW50Ij48c3BhbiBjbGFzcz0iaWNvbiI+PC9zcGFuPntjb3VudH08L3NwYW4+JykNCgkJCQkJCQkkY29yZV92Ml91aS5MaWtlKCRtZWRpYS5Db250ZW50SWQsICRjb3JlX3YyX21lZGlhLkNvbnRlbnRUeXBlSWQsICIleyBGb3JtYXQgPSAkZm9ybWF0IH0iKQ0KCQkJCQkJPC9saT4NCgkJCQkJI2VuZA0KCQkJCQk8bGk+DQoJCQkJCQk8c3BhbiBjbGFzcz0iZGV0YWlsIHRocmVhZHMiPg0KDQoJCQkJCQkJIyMgQ29tbWVudHMNCgkJCQkJCQkjaWYoJG1lZGlhLkNvbW1lbnRDb3VudCA9PSAwKQ0KCQkJCQkJCQlObyBjb21tZW50cw0KCQkJCQkJCSNlbHNlaWYoJG1lZGlhLkNvbW1lbnRDb3VudCA9PTEpDQoJCQkJCQkJCSRtZWRpYS5Db21tZW50Q291bnQgY29tbWVudA0KCQkJCQkJCSNlbHNlaWYoJG1lZGlhLkNvbW1lbnRDb3VudCA+IDEpDQoJCQkJCQkJCSRtZWRpYS5Db21tZW50Q291bnQgY29tbWVudHMNCgkJCQkJCQkjZW5kDQoJCQkJCQk8L3NwYW4+DQoJCQkJCTwvbGk+DQoJCQkJPC91bD4NCgkJCTwvZGl2Pg0KCQk8L2Rpdj4NCgk8L2Rpdj4NCiNub2RhdGENCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gbWVkaWFzIj48ZGl2IGNsYXNzPSJtZXNzYWdlIG5vcmVjb3JkcyI+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ25vX2dhbGxlcnknKTwvZGl2PjwvZGl2Pg0KI2FmdGVyYWxsDQoJI3NldCAoJGhhc01vcmUgPSBmYWxzZSkNCgkjaWYgKCRtZWRpYXMuVG90YWxDb3VudCA+ICgoJG1lZGlhcy5QYWdlSW5kZXggKyAxKSAqICRtZWRpYXMuUGFnZVNpemUpKQ0KCQkjc2V0KCRoYXNNb3JlID0gdHJ1ZSkNCgkjZW5kDQoJPGRpdiBjbGFzcz0iZGF0YSIgI2lmKCRoYXNNb3JlKWRhdGEtaGFzbW9yZT0idHJ1ZSIjZW5kPjwvZGl2Pg0KI2VuZA==</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBtZWRpYSBnYWxsZXJpZXMNCiMjDQojc2V0ICgkcGFnZUluZGV4ID0gJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X3BhZ2VJbmRleCcpKQ0KI3NldCgkZ3JvdXBJZCA9IGZhbHNlKQ0KI3NldCgkZ3JvdXBJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJG1vYmlsZV92MV91cmxUb2tlbi5WYWx1ZSgnR3JvdXBJZCcpKSkNCiNpZiAoISRncm91cElkKQ0KCSRjb3JlX3YyX3dpZGdldC5IaWRlKCkNCiNlbmQNCiNzZXQoJGdhbGxlcnlJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJG1vYmlsZV92MV91cmxUb2tlbi5WYWx1ZSgnR2FsbGVyeUlkJykpKQ0KI2lmICghJGdhbGxlcnlJZCkNCgkkY29yZV92Ml93aWRnZXQuSGlkZSgpDQojZW5kDQokY29yZV92Ml93aWRnZXQuRXhlY3V0ZUZpbGUoJ2xpc3Qudm0nKQ0K</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2Nyb2xsYWJsZSh7DQoJCQkJcmVnaW9uOiAnY29udGVudCcsDQoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgew0KCQkJCQlpZiAoJChvcHRpb25zLndyYXBwZXIgKyAnIGRpdi5kYXRhOmxhc3QnKS5kYXRhKCdoYXNtb3JlJykpIHsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoew0KCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLA0KCQkJCQkJCWRhdGE6IHsNCgkJCQkJCQkJd19wYWdlSW5kZXg6IHBhZ2VJbmRleA0KCQkJCQkJCX0sDQoJCQkJCQkJc3VjY2VzczogZnVuY3Rpb24ocikgew0KCQkJCQkJCQlzdWNjZXNzKHIpOw0KCQkJCQkJCX0sDQoJCQkJCQkJZXJyb3I6IGZ1bmN0aW9uKCkgew0KCQkJCQkJCQllcnJvcigpOw0KCQkJCQkJCX0NCgkJCQkJCX0pOw0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJc3VjY2VzcygpOw0KCQkJCQl9DQoJCQkJfSwNCgkJCQljb21wbGV0ZTogZnVuY3Rpb24oY29udGVudCkgew0KCQkJCQljb250ZW50ID0gJChjb250ZW50KS5jc3MoeyBvcGFjaXR5OiAwIH0pOw0KCQkJCQkkKG9wdGlvbnMud3JhcHBlcikuZmluZCgnZGl2LnBvc3QtbGlzdCcpLmFwcGVuZChjb250ZW50KTsNCgkJCQkJY29udGVudC5ldm9sdXRpb25UcmFuc2Zvcm0oeyBvcGFjaXR5OiAxIH0sIHsgZHVyYXRpb246IDQwMCB9KTsNCgkJCQl9DQoJCQl9KTsNCg0KCQkJaWYgKG9wdGlvbnMuY2FuUG9zdCkgew0KCQkJCXZhciBwb3N0TGluayA9ICQoJzxhIGhyZWY9IicgKyBvcHRpb25zLnBvc3RVcmwgKyAnIiBjbGFzcz0iYWRkIj4nICsgb3B0aW9ucy5wb3N0TGFiZWwgKyAnPC9hPicpOw0KCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2V0SGVhZGVyQnV0dG9uKHBvc3RMaW5rKTsNCgkJCX0NCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMubWVkaWFHYWxsZXJ5ID0gYXBpOw0KDQp9KShqUXVlcnkpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:MediaUploadEdit_Name}" version="7.0.0.1" description="" instanceIdentifier="0f8fca892498461cbb1609064576c23f" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="media-gallery-add-edit">
    <contentScript>
		
#set ($pageName = $mobile_v1_url.Current)
#set ($mode = false)
#set ($contentTypeId = $core_v2_media.ContentTypeId)

#set($galleryId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GalleryId')))
#if ($galleryId &lt; 0)
	#set($mediaId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('MediaId')))
	#if ($mediaId &lt; 0)
		$core_v2_widget.Hide()
	#end
#end

#set($editMedia = false)
#set($gallery = false)
#if($pageName == 'gallery-addmedia')
	#set ($mode = 'add')
	#set ($gallery = $core_v2_gallery.Get("%{Id = $galleryId}"))
#elseif ($pageName == 'media-edit')
	#set ($mode = 'edit')
	#set ($editMedia = $core_v2_media.Get($mediaId))
	#set ($gallery = $core_v2_gallery.Get("%{Id = $editMedia.MediaGalleryId}"))
#else
	$core_v2_widget.Hide()
#end

#if (!$gallery)
	$core_v2_widget.Hide()
#end

#set($canUpload = $core_v2_nodePermission.Get('mediagalleries',$gallery.Id,'MediaGallery_AttachFileLocal').IsAllowed)
#set($canLink = $core_v2_nodePermission.Get('mediagalleries',$gallery.Id,'MediaGallery_AttachFileRemote').IsAllowed)
#if (!$canUpload &amp;&amp; !$canLink)
	$core_v2_widget.Hide()
#end

##start of upload stuff

#set ($accessingUser = $core_v2_user.Accessing)
#set ($accessingUserIsRegistered = false)
#if ($core_v2_user.IsRegistered($accessingUser.Id))
	#set ($accessingUserIsRegistered = true)
#end

#set($userId = $accessingUser.Id)
#set($contextId = $core_v2_uploadedFile.CreateContextId())

#set($attachmentFileName = false)
#set($attachmentUrl = false)
#set($attachmentIsRemote = false)
#if ($editMedia)
	#set($attachmentFileName = $editMedia.File.FileName)
	#set($attachmentUrl = $editMedia.File.FileUrl)
	#set($attachmentIsRemote = $editMedia.File.IsRemoteAttachment)
#end


##Uploaded CSS Id's
#set($titleId = $core_v2_widget.UniqueId('Title'))
#set($fileTitleId = $core_v2_widget.UniqueId('fileTitle'))
#set($saveFileId = $core_v2_widget.UniqueId('saveFile'))
#set($bodyId = $core_v2_widget.UniqueId('Body'))
#set ($subscribeId = $core_v2_widget.UniqueId('Subscribe'))

#set($group = $gallery.Group)
&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($gallery.Group.Url)"&gt;$gallery.Group.Name&lt;/a&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($gallery.Url)"&gt;$gallery.Name&lt;/a&gt;
		#if ($editMedia)
			&lt;h1&gt;$editMedia.Title&lt;/h1&gt;
		#else
			&lt;h1&gt;$core_v2_language.GetResource('NewPost')&lt;/h1&gt;
		#end
	&lt;/div&gt;
&lt;/div&gt;

&lt;fieldset&gt;
	## Title
	&lt;div class="form-field text"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($titleId)"&gt;$core_v2_language.GetResource('title')&lt;/label&gt;
		&lt;input type="text" maxlength="256" id="$core_v2_encoding.HtmlAttributeEncode($titleId)" value="#if($mode=='edit')$editMedia.Title#end" /&gt;
	&lt;/div&gt;

	##File Uploads
	&lt;div class="form-field" id="$core_v2_widget.UniqueId('attachment')" data-upload="$canUpload" data-link="$canLink"&gt;
		#if ($canUpload &amp;&amp; $canLink)
			&lt;label for="$core_v2_widget.UniqueId('attachment_input')" class="field-item-name"&gt;$core_v2_language.GetResource('MediaGalleryPostAdmin_FileOrUrl')&lt;/label&gt;
		#elseif ($canUpload)
			&lt;label for="$core_v2_widget.UniqueId('attachment_input')" class="field-item-name"&gt;$core_v2_language.GetResource('Attachment_File')&lt;/label&gt;
		#elseif ($canLink)
			&lt;label for="$core_v2_widget.UniqueId('attachment_input')" class="field-item-name"&gt;$core_v2_language.GetResource('Attachment_Url')&lt;/label&gt;
		#end
		&lt;span class="file"&gt;
			&lt;input type="text" columns="90" id="$core_v2_widget.UniqueId('attachment_input')" #if($attachmentUrl &amp;&amp; $attachmentIsRemote)value="$core_v2_encoding.HtmlAttributeEncode($attachmentUrl)"#elseif($attachmentFileName)value="$core_v2_encoding.HtmlAttributeEncode($attachmentFileName)"#end /&gt;
		&lt;/span&gt;
		&lt;div class="preview"&gt;
		&lt;/div&gt;
		#if ($canUpload)
			&lt;span class="upload"&gt;
				&lt;a href="#" class="upload add" id="$core_v2_widget.UniqueId('upload')"&gt;$core_v2_language.GetResource('UploadFile')&lt;/a&gt;
				&lt;a href="#" class="remove" style="margin-left: 1em;"&gt;$core_v2_language.GetResource('RemoveFile')&lt;/a&gt;
			&lt;/span&gt;
		#end
	&lt;/div&gt;

	## TinyMCE
	&lt;div class="form-field editor"&gt;
		#set($body = '')
		#if($editMedia)
			#set($body = $editMedia.Body('raw'))
		#end

		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;$core_v2_language.GetResource('body')&lt;/label&gt;
		$core_v2_editor.Render('PostBody', "%{Width='100%', Height='60px', Value=$body, ContentTypeId=$contentTypeId}")
	&lt;/div&gt;

	## Email Replies
	#if ($core_v2_user.IsRegistered($core_v2_user.Accessing.Id))
		&lt;div class="form-field checkbox inline-label"&gt;
			&lt;label for="$core_v2_encoding.HtmlAttributeEncode($subscribeId)"&gt;$core_v2_language.GetResource('subscribe')&lt;/label&gt;
			&lt;input id="$core_v2_encoding.HtmlAttributeEncode($subscribeId)" type="checkbox" #if($editMedia &amp;&amp; $core_v2_media.IsSubscribed($editMedia.Id)) checked="checked"#end/&gt;
		&lt;/div&gt;
	#end
&lt;/fieldset&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.mediaGalleryAddEdit.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			mode: '$mode',
			file: {
				fileName: '#if($attachmentFileName)$core_v2_encoding.JavascriptEncode($attachmentFileName)#end',
				url: '#if($attachmentUrl)$core_v2_encoding.JavascriptEncode($attachmentUrl)#end',
				isRemote:#if($attachmentIsRemote) true#else false#end,
				isNew: false
			},
			attachmentId: '$core_v2_widget.UniqueId('attachment')',
			attachmentProgressText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UploadProgress'))',
			attachmentChangeText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('ChangeFile'))',
			attachmentAddText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UploadFile'))',
			previewAttachmentUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('previewAttachment.vm'))',
			uploadContextId: '$core_v2_encoding.JavascriptEncode($contextId)',
			uploadFileUrl : '$core_v2_encoding.JavascriptEncode($core_v2_uploadedFile.GetUploadUrl($contextId))',
			fileId: '$!editMedia.Id',
			mediaGalleryId: '$gallery.Id',
			titleInput: '#$core_v2_encoding.JavascriptEncode($titleId)',
			getBodyContent: function() { return $core_v2_editor.GetContentScript('PostBody') },
			subscribeInput: '#$core_v2_encoding.JavascriptEncode($subscribeId)',
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			editLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('edit'))',
			lookUpUrl : "$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('lookUp.vm'))",
			selectFileLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('file_upload'))'
		});

		jQuery.telligent.evolution.mobile.refreshable(false);
		jQuery.telligent.evolution.mobile.excludeFromHistory();
	});
})
&lt;/script&gt;
		

		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
			<resource name="MediaUploadEdit_Name">Media Gallery Upload Edit</resource>
			<resource name="title">Title</resource>
			<resource name="post">Post</resource>
			<resource name="edit">Edit</resource>
			<resource name="subscribe">Notify me about comments</resource>
			<resource name="MediaGalleryPostAdmin_FileOrUrl">File or website</resource>
			<resource name="Attachment_File">File</resource>
			<resource name="Attachment_Url">URL</resource>
			<resource name="UploadFile">Upload file</resource>
			<resource name="UploadProgress">Uploading ({0}%)...</resource>
			<resource name="ChangeFile">Change file</resource>
			<resource name="RemoveFile">Remove file</resource>
			<resource name="NewPost">Upload a file</resource>
		  </language>
		</languageResources>
    <files>
      <file name="lookUp.vm">JGNvcmVfdjJfcGFnZS5TZXRDb250ZW50VHlwZSgnYXBwbGljYXRpb24vanNvbicpDQojc2V0KCRmaWxlID0gJGNvcmVfdjJfcGFnZS5HZXRGb3JtVmFsdWUoJ2ZpbGVUeXBlJykpDQojc2V0KCRmaWxlVHlwZSA9ICRjb3JlX3YyX3VpLkdldE1pbWVUeXBlKCRmaWxlKSkNCnsidHlwZSI6IiRmaWxlVHlwZSJ9</file>
      <file name="previewAttachment.vm">IyMgTG9hZHMgQXR0YWNobWVudCBQcmV2aWV3DQoNCiNzZXQoJHVybCA9IGZhbHNlKQ0KI3NldCAoJHVybCA9ICRjb3JlX3YyX3BhZ2UuR2V0Rm9ybVZhbHVlKCd3X3VybCcpKQ0KI2lmICghJHVybCkNCgkjc2V0ICgkZmlsZU5hbWUgPSBmYWxzZSkNCgkjc2V0ICgkZmlsZU5hbWUgPSAkY29yZV92Ml9wYWdlLkdldEZvcm1WYWx1ZSgnd19maWxlbmFtZScpKQ0KCSNzZXQgKCR1cGxvYWRDb250ZXh0SWQgPSBmYWxzZSkNCgkjc2V0ICgkdXBsb2FkQ29udGV4dElkID0gJGNvcmVfdjJfcGFnZS5HZXRGb3JtVmFsdWUoJ3dfdXBsb2FkQ29udGV4dElkJykpDQoJI2lmICgkZmlsZU5hbWUgJiYgJHVwbG9hZENvbnRleHRJZCkNCgkJI3NldCAoJGZpbGUgPSBmYWxzZSkNCgkJI3NldCAoJGZpbGUgPSAkY29yZV92Ml91cGxvYWRlZEZpbGUuR2V0KCR1cGxvYWRDb250ZXh0SWQsICRmaWxlTmFtZSkpDQoJCSNpZiAoJGZpbGUpDQoJCSAgICNzZXQgKCR1cmwgPSAkZmlsZS5VcmwpDQoJCSNlbmQNCgkjZW5kDQojZW5kDQoNCiNpZiAoJHVybCkNCgkkIWNvcmVfdjJfdWkuR2V0UHJldmlld0h0bWwoJHVybCwgIiV7V2lkdGg9MzIwLCBIZWlnaHQ9MjQwLCBPdXRwdXRJc1BlcnNpc3RlZD0nRmFsc2UnfSIpDQojZW5k</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCwgdW5kZWYpew0KDQoJdmFyIF9jcmVhdGVGaWxlID0gZnVuY3Rpb24ob3B0aW9ucykgew0KDQoJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoKTsNCg0KCQl2YXIgZGF0YSA9IHt9Ow0KCQlpZiAob3B0aW9ucy5maWxlICYmIG9wdGlvbnMuZmlsZS5pc05ldykgew0KCQkJaWYgKG9wdGlvbnMuZmlsZS5pc1JlbW90ZSkgew0KCQkJCWRhdGEuRmlsZU5hbWUgPSBvcHRpb25zLmZpbGUudXJsOw0KCQkJCWRhdGEuRmlsZVVybCA9IG9wdGlvbnMuZmlsZS51cmw7DQoJCQl9IGVsc2Ugew0KCQkJCWRhdGEuRmlsZU5hbWUgPSBvcHRpb25zLmZpbGUuZmlsZU5hbWU7DQoJCQkJZGF0YS5GaWxlVXBsb2FkQ29udGV4dCA9IG9wdGlvbnMudXBsb2FkQ29udGV4dElkOw0KCQkJfQ0KCQl9DQoNCgkJaWYob3B0aW9ucy5tb2RlID09ICdhZGQnKSB7DQoJCQlkYXRhLk5hbWUgPSBvcHRpb25zLnRpdGxlOw0KCQkJZGF0YS5EZXNjcmlwdGlvbiA9IG9wdGlvbnMuZGVzY3JpcHRpb247DQoJCQlkYXRhLm1lZGlhZ2FsbGVyeWlkID0gb3B0aW9ucy5tZWRpYUdhbGxlcnlJZDsNCgkJCWRhdGEuQ29udGVudFR5cGUgPSBvcHRpb25zLmZpbGVUeXBlOw0KDQoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ucG9zdCh7DQoJCQkJdXJsOiBqUXVlcnkudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi9tZWRpYS97bWVkaWFnYWxsZXJ5aWR9L2ZpbGVzLmpzb24nLA0KCQkJCWRhdGE6IGRhdGEsDQoJCQkJc3VjY2VzczogZnVuY3Rpb24ocmVzcG9uc2UpIHsNCgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7DQoJCQkJCQl1cmw6IGpRdWVyeS50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ2FwaS5hc2h4L3YyL21lZGlhL3ttZWRpYWdhbGxlcnlpZH0vZmlsZXMve2ZpbGVpZH0vc3Vic2NyaXB0aW9ucy5qc29uJywNCgkJCQkJCWRhdGE6IHsNCgkJCQkJCQltZWRpYWdhbGxlcnlpZDogcmVzcG9uc2UuTWVkaWEuTWVkaWFHYWxsZXJ5SWQsDQoJCQkJCQkJZmlsZWlkOiByZXNwb25zZS5NZWRpYS5JZCwNCgkJCQkJCQlJc1N1YnNjcmliZWQ6IG9wdGlvbnMuc3Vic2NyaWJlDQoJCQkJCQl9LA0KCQkJCQkJc3VjY2VzczogZnVuY3Rpb24oYW5zd2VyKSB7DQoNCgkJCQkJCX0NCgkJCQkJfSk7DQoJCQkJCXZhciBsaW5rID0gJy9tZWRpYWZpbGVzLycgKyByZXNwb25zZS5NZWRpYS5JZDsNCgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5sb2FkKGxpbmssIHsgcmVmcmVzaDogdHJ1ZSB9KTsNCgkJCQl9DQoJCQl9KQ0KCQkJLmZhaWwoZnVuY3Rpb24oKSB7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlTG9hZGluZygpOw0KCQkJfSk7DQoJCX0gZWxzZSBpZiAob3B0aW9ucy5tb2RlID09ICdlZGl0Jykgew0KCQkJZGF0YS5tZWRpYWdhbGxlcnlpZCA9IG9wdGlvbnMubWVkaWFHYWxsZXJ5SWQ7DQoJCQlkYXRhLmZpbGVpZCA9IG9wdGlvbnMuZmlsZUlkOw0KCQkJZGF0YS5OYW1lID0gb3B0aW9ucy50aXRsZTsNCgkJCWRhdGEuRGVzY3JpcHRpb24gPSBvcHRpb25zLmRlc2NyaXB0aW9uOw0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7DQoJCQkJdXJsOiBqUXVlcnkudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi9tZWRpYS97bWVkaWFnYWxsZXJ5aWR9L2ZpbGVzL3tmaWxlaWR9Lmpzb24nLA0KCQkJCWRhdGE6IGRhdGEsDQoJCQkJc3VjY2VzczogZnVuY3Rpb24ocmVzcG9uc2UpIHsNCgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7DQoJCQkJCQl1cmw6IGpRdWVyeS50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ2FwaS5hc2h4L3YyL21lZGlhL3ttZWRpYWdhbGxlcnlpZH0vZmlsZXMve2ZpbGVpZH0vc3Vic2NyaXB0aW9ucy5qc29uJywNCgkJCQkJCWRhdGE6IHsNCgkJCQkJCQltZWRpYWdhbGxlcnlpZDogcmVzcG9uc2UuTWVkaWEuTWVkaWFHYWxsZXJ5SWQsDQoJCQkJCQkJZmlsZWlkOiByZXNwb25zZS5NZWRpYS5JZCwNCgkJCQkJCQlJc1N1YnNjcmliZWQ6IG9wdGlvbnMuc3Vic2NyaWJlDQoJCQkJCQl9LA0KCQkJCQkJc3VjY2VzczogZnVuY3Rpb24oYW5zd2VyKSB7DQoNCgkJCQkJCX0NCgkJCQkJfSk7DQoJCQkJCXZhciBsaW5rID0gJy9tZWRpYWZpbGVzLycgKyByZXNwb25zZS5NZWRpYS5JZDsNCgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5sb2FkKGxpbmssIHsgcmVmcmVzaDogdHJ1ZSB9KTsNCgkJCQl9DQoJCQl9KQ0KCQkJLmZhaWwoZnVuY3Rpb24oKSB7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlTG9hZGluZygpOw0KCQkJfSk7DQoJCX0NCgl9LA0KDQoJX2xvb2tVcCA9IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnBvc3Qoew0KCQkJdXJsOiBvcHRpb25zLmxvb2tVcFVybCwNCgkJCWRhdGE6IHsNCgkJCQlmaWxlVHlwZTogb3B0aW9ucy5maWxlLmZpbGVOYW1lDQoJCQl9LA0KCQkJc3VjY2VzczogZnVuY3Rpb24ocmVzcG9uc2UpIHsNCgkJCQlvcHRpb25zLmZpbGVUeXBlID0gcmVzcG9uc2UudHlwZTsNCgkJCX0NCgkJfSk7DQoJfQ0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCV9sb29rVXAob3B0aW9ucyk7DQoNCgkJCW9wdGlvbnMuYXR0YWNobWVudCA9ICQoJyMnICsgb3B0aW9ucy5hdHRhY2htZW50SWQpOw0KICAgICAgICAJb3B0aW9ucy5hdHRhY2htZW50VXBsb2FkID0gb3B0aW9ucy5hdHRhY2htZW50LmZpbmQoJ2EudXBsb2FkJyk7DQogICAgICAgIAlvcHRpb25zLmF0dGFjaG1lbnRSZW1vdmUgPSBvcHRpb25zLmF0dGFjaG1lbnQuZmluZCgnYS5yZW1vdmUnKTsNCiAgICAgICAgCW9wdGlvbnMuYXR0YWNobWVudE5hbWUgPSBvcHRpb25zLmF0dGFjaG1lbnQuZmluZCgnaW5wdXQnKTsNCiAgICAgICAgCW9wdGlvbnMuYXR0YWNobWVudFByZXZpZXcgPSBvcHRpb25zLmF0dGFjaG1lbnQuZmluZCgnLnByZXZpZXcnKTsNCg0KICAgICAgICAJZnVuY3Rpb24gbG9hZFByZXZpZXcoKSB7DQogICAgICAgICAgICAJaWYgKG9wdGlvbnMuZmlsZSAmJiAob3B0aW9ucy5maWxlLmZpbGVOYW1lIHx8IG9wdGlvbnMuZmlsZS51cmwpKSB7DQogICAgICAgICAgICAJCWNsZWFyVGltZW91dChvcHRpb25zLmF0dGFjaG1lbnRQcmV2aWV3VGltZW91dCk7DQoJCQkgICAgICAgIG9wdGlvbnMuYXR0YWNobWVudFByZXZpZXdUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpew0KCQkJICAgICAgICAgICAgdmFyIGRhdGEgPSB7DQoJCQkgICAgICAgICAgICAJd191cGxvYWRDb250ZXh0SWQ6IG9wdGlvbnMudXBsb2FkQ29udGV4dElkDQoJCQkgICAgICAgICAgICB9Ow0KCQkJICAgICAgICAgICAgaWYob3B0aW9ucy5maWxlLnVybCkgew0KCQkJICAgICAgICAgICAgICAgIGRhdGEud191cmwgPSBvcHRpb25zLmZpbGUudXJsOw0KCQkJICAgICAgICAgICAgfQ0KCQkJICAgICAgICAgICAgaWYgKG9wdGlvbnMuZmlsZS5maWxlTmFtZSkgew0KCQkJICAgICAgICAgICAgCWRhdGEud19maWxlbmFtZSA9IG9wdGlvbnMuZmlsZS5maWxlTmFtZTsNCgkJCSAgICAgICAgICAgIH0NCgkJCSAgICAgICAgICAgICQudGVsbGlnZW50LmV2b2x1dGlvbi5wb3N0KHsNCgkJCSAgICAgICAgICAgICAgICB1cmw6IG9wdGlvbnMucHJldmlld0F0dGFjaG1lbnRVcmwsDQoJCQkgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwNCgkJCSAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXNwb25zZSkgew0KCQkJICAgICAgICAgICAgICAgICAgICByZXNwb25zZSA9ICQudHJpbShyZXNwb25zZSk7DQoJCQkJCQkJCWlmKHJlc3BvbnNlICYmIHJlc3BvbnNlLmxlbmd0aCA+IDAgJiYgcmVzcG9uc2UgIT09IG9wdGlvbnMuYXR0YWNobWVudFByZXZpZXdDb250ZW50KSB7DQoJCQkJCQkJCQlvcHRpb25zLmF0dGFjaG1lbnRQcmV2aWV3Q29udGVudCA9IHJlc3BvbnNlOw0KCQkJCQkJCQkJb3B0aW9ucy5hdHRhY2htZW50UHJldmlldy5odG1sKG9wdGlvbnMuYXR0YWNobWVudFByZXZpZXdDb250ZW50KS5yZW1vdmVDbGFzcygnZW1wdHknKTsNCgkJCQkJCQkJfQ0KCQkJICAgICAgICAgICAgICAgIH0NCgkJCSAgICAgICAgICAgIH0pOw0KCQkJICAgICAgICB9LCAxNTApOw0KICAgICAgICAgICAgCX0gZWxzZSB7DQogICAgICAgICAgICAJCW9wdGlvbnMuYXR0YWNobWVudFByZXZpZXdDb250ZW50ID0gJyc7DQogICAgICAgICAgICAJCW9wdGlvbnMuYXR0YWNobWVudFByZXZpZXcuaHRtbCgnJykuYWRkQ2xhc3MoJ2VtcHR5Jyk7DQogICAgICAgICAgICAJfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgIAlvcHRpb25zLmF0dGFjaG1lbnRSZW1vdmUuaGlkZSgpOw0KICAgICAgICAJaWYgKG9wdGlvbnMuZmlsZSAmJiBvcHRpb25zLmZpbGUudXJsICYmIG9wdGlvbnMuZmlsZS5pc1JlbW90ZSkgew0KICAgICAgICAJCW9wdGlvbnMuYXR0YWNobWVudFJlbW92ZS5oaWRlKCk7DQogICAgICAgIAl9IGVsc2UgaWYgKG9wdGlvbnMuZmlsZSAmJiBvcHRpb25zLmZpbGUuZmlsZU5hbWUgJiYgIW9wdGlvbnMuZmlsZS5pc1JlbW90ZSkgew0KICAgICAgICAJCW9wdGlvbnMuYXR0YWNobWVudE5hbWUuYXR0cigncmVhZG9ubHknLCAncmVhZG9ubHknKTsNCiAgICAgICAgCQlvcHRpb25zLmF0dGFjaG1lbnRVcGxvYWQuaHRtbChvcHRpb25zLmF0dGFjaG1lbnRDaGFuZ2VUZXh0KS5yZW1vdmVDbGFzcygnYWRkJykuYWRkQ2xhc3MoJ2NoYW5nZScpOw0KICAgICAgICAJCW9wdGlvbnMuYXR0YWNobWVudFJlbW92ZS5zaG93KCk7DQogICAgICAgIAl9IGVsc2UgaWYgKG9wdGlvbnMuYXR0YWNobWVudC5kYXRhKCdsaW5rJykgIT0gJ1RydWUnKSB7DQogICAgICAgIAkJb3B0aW9ucy5hdHRhY2htZW50TmFtZS5hdHRyKCdyZWFkb25seScsICdyZWFkb25seScpOw0KICAgICAgICAJfQ0KDQogICAgICAgIAlsb2FkUHJldmlldygpOw0KDQogICAgICAgIAlvcHRpb25zLmF0dGFjaG1lbnROYW1lLm9uKCdrZXl1cCBjaGFuZ2UnLCBmdW5jdGlvbigpIHsNCiAgICAgICAgCQlpZiAoIW9wdGlvbnMuYXR0YWNobWVudE5hbWUuYXR0cigncmVhZG9ubHknKSkgew0KCSAgICAgICAgCQlvcHRpb25zLmZpbGUgPSB7DQoJICAgICAgICAJCQl1cmw6ICQodGhpcykudmFsKCksDQoJICAgICAgICAJCQlpc1JlbW90ZTogdHJ1ZSwNCgkgICAgICAgIAkJCWlzTmV3OiB0cnVlDQoJICAgICAgICAJCX0NCgkgICAgICAgIAkJbG9hZFByZXZpZXcoKTsNCgkgICAgICAgIAl9DQogICAgICAgIAl9KTsNCg0KICAgICAgICAJb3B0aW9ucy5hdHRhY2htZW50UmVtb3ZlLmNsaWNrKGZ1bmN0aW9uKCkgew0KICAgICAgICAJCW9wdGlvbnMuZmlsZSA9IG51bGw7DQogICAgICAgIAkJb3B0aW9ucy5hdHRhY2htZW50TmFtZS52YWwoJycpOw0KICAgICAgICAJCW9wdGlvbnMuYXR0YWNobWVudFVwbG9hZC5odG1sKG9wdGlvbnMuYXR0YWNobWVudEFkZFRleHQpLnJlbW92ZUNsYXNzKCdjaGFuZ2UnKS5hZGRDbGFzcygnYWRkJykNCiAgICAgICAgCQlpZiAob3B0aW9ucy5hdHRhY2htZW50LmRhdGEoJ2xpbmsnKSA9PSAnVHJ1ZScpIHsNCgkgICAgICAgIAkJb3B0aW9ucy5hdHRhY2htZW50TmFtZS5yZW1vdmVBdHRyKCdyZWFkb25seScpOw0KCSAgICAgICAgCX0NCgkgICAgICAgIAlvcHRpb25zLmF0dGFjaG1lbnRSZW1vdmUuaGlkZSgpOw0KCSAgICAgICAgCWxvYWRQcmV2aWV3KCk7DQoJICAgICAgICAJcmV0dXJuIGZhbHNlOw0KICAgICAgICAJfSk7DQoNCgkJCW9wdGlvbnMuYXR0YWNobWVudFVwbG9hZC5nbG93VXBsb2FkKHsNCgkJCQlmaWxlRmlsdGVyOiBudWxsLA0KCQkJCXVwbG9hZFVybDogb3B0aW9ucy51cGxvYWRGaWxlVXJsLA0KCQkJCXJlbmRlck1vZGU6ICdsaW5rJw0KCQkJfSkNCgkJCS5iaW5kKCdnbG93VXBsb2FkQmVndW4nLCBmdW5jdGlvbihlKSB7DQoJICAgICAgICAgICAgb3B0aW9ucy51cGxvYWRpbmcgPSB0cnVlOw0KCSAgICAgICAgICAgIG9wdGlvbnMuYXR0YWNobWVudFVwbG9hZC5odG1sKG9wdGlvbnMuYXR0YWNobWVudFByb2dyZXNzVGV4dC5yZXBsYWNlKCd7MH0nLCAwKSk7DQoJICAgICAgICB9KQ0KCSAgICAgICAgLmJpbmQoJ2dsb3dVcGxvYWRDb21wbGV0ZScsIGZ1bmN0aW9uKGUsIGZpbGUpIHsNCgkgICAgICAgIAlpZiAoZmlsZSAmJiBmaWxlLm5hbWUubGVuZ3RoID4gMCkgew0KCQkJCQlvcHRpb25zLmZpbGUgPSB7DQoJCQkJCQlmaWxlTmFtZTogZmlsZS5uYW1lLA0KCQkJCQkJaXNSZW1vdGU6IGZhbHNlLA0KCQkJCQkJaXNOZXc6IHRydWUNCgkJCQkJfQ0KCQkJCQlfbG9va1VwKG9wdGlvbnMpOw0KDQoJCQkJCW9wdGlvbnMuYXR0YWNobWVudE5hbWUudmFsKG9wdGlvbnMuZmlsZS5maWxlTmFtZSkuYXR0cigncmVhZG9ubHknLCAncmVhZG9ubHknKTsNCgkJICAgICAgICAgICAgbG9hZFByZXZpZXcoKTsNCgkJICAgICAgICAgICAgb3B0aW9ucy51cGxvYWRpbmcgPSBmYWxzZTsNCgkJICAgICAgICAgICAgb3B0aW9ucy5hdHRhY2htZW50VXBsb2FkLmh0bWwob3B0aW9ucy5hdHRhY2htZW50Q2hhbmdlVGV4dCkucmVtb3ZlQ2xhc3MoJ2FkZCcpLmFkZENsYXNzKCdjaGFuZ2UnKTsNCgkJICAgICAgICAgICAgb3B0aW9ucy5hdHRhY2htZW50UmVtb3ZlLnNob3coKTsNCgkJICAgIAl9DQoJICAgICAgICB9KQ0KCSAgICAgICAgLmJpbmQoJ2dsb3dVcGxvYWRGaWxlUHJvZ3Jlc3MnLCBmdW5jdGlvbihlLCBkZXRhaWxzKSB7DQoJICAgICAgICAJb3B0aW9ucy5hdHRhY2htZW50VXBsb2FkLmh0bWwob3B0aW9ucy5hdHRhY2htZW50UHJvZ3Jlc3NUZXh0LnJlcGxhY2UoJ3swfScsIGRldGFpbHMucGVyY2VudCkpOw0KCSAgICAgICAgfSk7DQoNCgkJCXBvc3RMaW5rID0gJCgnPGEgaHJlZj0iIyIgY2xhc3M9InN1Ym1pdCI+JyArIChvcHRpb25zLm1vZGUgPT0gJ2FkZCcgPyBvcHRpb25zLnBvc3RMYWJlbCA6IG9wdGlvbnMuZWRpdExhYmVsKSArICc8L2E+Jyk7DQoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNldEhlYWRlckJ1dHRvbihwb3N0TGluayk7DQoNCgkJCXBvc3RMaW5rLm9uKCd0YXAnLCBmdW5jdGlvbigpew0KCQkJCXZhciB0aXRsZUlucHV0ID0gJChvcHRpb25zLnRpdGxlSW5wdXQpLA0KCQkJCWJvZHlJbnB1dCA9IG9wdGlvbnMuZ2V0Qm9keUNvbnRlbnQoKSwNCgkJCQlzdWJzY3JpYmVJbnB1dCA9ICQob3B0aW9ucy5zdWJzY3JpYmVJbnB1dCk7DQoNCgkJCQlvcHRpb25zLnRpdGxlID0gIHRpdGxlSW5wdXQudmFsKCk7DQoJCQkJb3B0aW9ucy5kZXNjcmlwdGlvbiA9IGJvZHlJbnB1dDsNCgkJCQlvcHRpb25zLnN1YnNjcmliZSA9IHN1YnNjcmliZUlucHV0LmlzKCc6Y2hlY2tlZCcpOw0KDQoJCQkJX2NyZWF0ZUZpbGUob3B0aW9ucyk7DQoJCQl9KTsNCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMubWVkaWFHYWxsZXJ5QWRkRWRpdCA9IGFwaTsNCg0KfSkoalF1ZXJ5LCB3aW5kb3cpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:MediaGalleryList_Name}" version="7.0.0.1" description="" instanceIdentifier="dd90b05c6d334331b0046de16705e717" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="group-gallery">
    <contentScript>
		
#set($groupId = false)
#set($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#if (!$groupId)
	$core_v2_widget.Hide()
#end

#set($group = $core_v2_group.Get("%{Id=$groupId}"))
&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($group.Url)"&gt;$group.Name&lt;/a&gt;
		&lt;h1&gt;$core_v2_language.GetResource('media_gallery')&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 40, 40, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
&lt;/div&gt;
## load and render media galleries
&lt;div class="post-list galleries"&gt;
	#set($pageIndex = 0)
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.mediaGalleryList.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))'
		});
	});
})
&lt;/script&gt;

		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
			<resource name="MediaGalleryList_Name">Media Gallery List</resource>
			<resource name="media_gallery">Media Galleries</resource>
			<resource name="no_gallery">No Gallery</resource>
		  </language>
		</languageResources>
    <files>
      <file name="list.vm">I3NldCgkZ2FsbGVyaWVzID0gJGNvcmVfdjJfZ2FsbGVyeS5MaXN0KCIle0dyb3VwSWQ9JGdyb3VwSWQsUGFnZUluZGV4PSRwYWdlSW5kZXgsUGFnZVNpemU9NX0iKSkNCiNpZigkZ2FsbGVyaWVzLlRvdGFsc0NvdW50ID09IDEpDQoJI3NldCgkb25lV2lraSA9ICRjb3JlX3YyX2dhbGxlcnkuR2V0KCIle0dyb3VwSWQgPSAkZ3JvdXBJZH0iKSkNCgkjIyRtb2JpbGVfdjFfdXJsLkZvcm1hdCgnd2lraScsJG9uZVdpa2kuSWQpDQojZW5kDQojZm9yZWFjaCgkZ2FsbGVyeSBpbiAkZ2FsbGVyaWVzKQ0KI2VhY2gNCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gZ2FsbGVyeSIgZGF0YS10YXJnZXR1cmw9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJG1vYmlsZV92MV91cmwuRm9ybWF0KCdnYWxsZXJ5JywgJGdhbGxlcnkuSWQpKSI+DQoJCTxkaXYgY2xhc3M9InBvc3Qgd2l0aG91dC1hdmF0YXIiPg0KCQkJPGRpdiBjbGFzcz0iZGV0YWlscyI+DQoJCQkJI2lmKCRnYWxsZXJ5LkxhdGVzdFBvc3REYXRlKTxkaXYgY2xhc3M9ImRhdGUiPiRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdEFnb0RhdGUoJGdhbGxlcnkuTGF0ZXN0UG9zdERhdGUpPC9kaXY+I2VuZA0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJjb250ZW50Ij4NCgkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRtb2JpbGVfdjFfdXJsLkZvcm1hdCgnZ2FsbGVyeScsICRnYWxsZXJ5LklkKSkiPiRnYWxsZXJ5Lk5hbWU8L2E+DQoJCQkJPGRpdj4kIWdhbGxlcnkuRGVzY3JpcHRpb248L2Rpdj4NCgkJCTwvZGl2Pg0KCQk8L2Rpdj4NCgk8L2Rpdj4NCiNub2RhdGENCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gZ2FsbGVyeSI+PGRpdiBjbGFzcz0ibWVzc2FnZSBub3JlY29yZHMiPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdub19nYWxsZXJ5Jyk8L2Rpdj48L2Rpdj4NCiNhZnRlcmFsbA0KCSNzZXQgKCRoYXNNb3JlID0gZmFsc2UpDQoJI2lmICgkZ2FsbGVyaWVzLlRvdGFsQ291bnQgPiAoKCRnYWxsZXJpZXMuUGFnZUluZGV4ICsgMSkgKiAkZ2FsbGVyaWVzLlBhZ2VTaXplKSkNCgkJI3NldCgkaGFzTW9yZSA9IHRydWUpDQoJI2VuZA0KCTxkaXYgY2xhc3M9ImRhdGEiICNpZigkaGFzTW9yZSlkYXRhLWhhc21vcmU9InRydWUiI2VuZD48L2Rpdj4NCiNlbmQNCg==</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSB3aWtpcw0KIyMNCiNzZXQgKCRwYWdlSW5kZXggPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfcGFnZUluZGV4JykpDQojc2V0KCRncm91cElkID0gZmFsc2UpDQojc2V0KCRncm91cElkID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUludCgkbW9iaWxlX3YxX3VybFRva2VuLlZhbHVlKCdHcm91cElkJykpKQ0KI2lmICghJGdyb3VwSWQpDQoJJGNvcmVfdjJfd2lkZ2V0LkhpZGUoKQ0KI2VuZA0KJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCdsaXN0LnZtJykNCg==</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2Nyb2xsYWJsZSh7DQoJCQkJcmVnaW9uOiAnY29udGVudCcsDQoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgew0KCQkJCQlpZiAoJChvcHRpb25zLndyYXBwZXIgKyAnIGRpdi5kYXRhOmxhc3QnKS5kYXRhKCdoYXNtb3JlJykpIHsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoew0KCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLA0KCQkJCQkJCWRhdGE6IHsNCgkJCQkJCQkJd19wYWdlSW5kZXg6IHBhZ2VJbmRleA0KCQkJCQkJCX0sDQoJCQkJCQkJc3VjY2VzczogZnVuY3Rpb24ocikgew0KCQkJCQkJCQlzdWNjZXNzKHIpOw0KCQkJCQkJCX0sDQoJCQkJCQkJZXJyb3I6IGZ1bmN0aW9uKCkgew0KCQkJCQkJCQllcnJvcigpOw0KCQkJCQkJCX0NCgkJCQkJCX0pOw0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJc3VjY2VzcygpOw0KCQkJCQl9DQoJCQkJfSwNCgkJCQljb21wbGV0ZTogZnVuY3Rpb24oY29udGVudCkgew0KCQkJCQljb250ZW50ID0gJChjb250ZW50KS5jc3MoeyBvcGFjaXR5OiAwIH0pOw0KCQkJCQkkKG9wdGlvbnMud3JhcHBlcikuZmluZCgnZGl2LnBvc3QtbGlzdCcpLmFwcGVuZChjb250ZW50KTsNCgkJCQkJY29udGVudC5ldm9sdXRpb25UcmFuc2Zvcm0oeyBvcGFjaXR5OiAxIH0sIHsgZHVyYXRpb246IDQwMCB9KTsNCgkJCQl9DQoJCQl9KTsNCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMubWVkaWFHYWxsZXJ5TGlzdCA9IGFwaTsNCg0KfSkoalF1ZXJ5KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:MediaGalleryPost_Name}" version="7.0.0.1" description="" instanceIdentifier="fad2d5f95f56467e885c112cbc6d47f2" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="media-gallery-post">
    <contentScript>
		
#set($mediaId = false)
#set($mediaId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('MediaId')))
#if (!$mediaId)
	$core_v2_widget.Hide()
#end

#set ($accessingUser = $core_v2_user.Accessing)
#set ($accessingUserIsRegistered = false)
#if ($core_v2_user.IsRegistered($accessingUser.Id))
	#set ($accessingUserIsRegistered = true)
#end

#set($media = $core_v2_media.Get($mediaId))
#set ($mediaType = $core_v2_ui.GetMediaType($media.File.FileUrl))
#set($gallery = $core_v2_gallery.Get("%{Id=$media.MediaGalleryId}"))

&lt;div class="post topic full"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($gallery.Group.Url)"&gt;$gallery.Group.Name&lt;/a&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($gallery.Url)"&gt;$gallery.Name&lt;/a&gt;
	&lt;/div&gt;
	&lt;h1&gt;$media.Title&lt;/h1&gt;
	&lt;div class="details"&gt;
		&lt;div class="avatar"&gt;
			#if ($media.Author.ProfileUrl)
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($media.Author.ProfileUrl)" class="internal-link view-user-profile"&gt;
					$core_v2_ui.GetResizedImageHtml($media.Author.AvatarUrl, 24, 24, "%{border='0', alt=$media.Author.DisplayName, ResizeMethod='ZoomAndCrop',border='0'}")
				&lt;/a&gt;
			#else
				$core_v2_ui.GetResizedImageHtml($media.Author.AvatarUrl, 24, 24, "%{border='0', alt=$media.Author.DisplayName, ResizeMethod='ZoomAndCrop',border='0'}")
			#end
		&lt;/div&gt;
		&lt;div class="date"&gt;$core_v2_language.FormatAgoDate($media.Date)&lt;/div&gt;
		&lt;div class="author"&gt;
			#if ($media.Author.ProfileUrl)
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($media.Author.ProfileUrl)" class="internal-link view-user-profile"&gt;
					$media.Author.DisplayName
				&lt;/a&gt;
			#else
				$media.Author.DisplayName
			#end
		&lt;/div&gt;
	&lt;/div&gt;
	&lt;div class="content"&gt;
		&lt;div&gt;
			$!core_v2_ui.GetViewHtml($media.File.FileUrl, "%{AdjustToContainer='True'}")
		&lt;/div&gt;
		&lt;div class="user-generated-content"&gt;
			$!mobile_v1_dataFormat.Detect($!media.Body())
		&lt;/div&gt;
	&lt;/div&gt;
	#set($showLikes = false)
	#if($accessingUserIsRegistered &amp;&amp; $core_v2_like.CanLike($media.ContentId, $core_v2_media.ContentTypeId))
		#set($showLikes = true)
	#end

	&lt;div class="actions ui-links" data-maxlinks="#if($showLikes)2#else 1#end"&gt;
		#if ($showLikes)
			&lt;li class="action-like"&gt;
				#set($format = '{toggle} &lt;span class="count"&gt;&lt;span class="icon"&gt;&lt;/span&gt;{count}&lt;/span&gt;')
				$core_v2_ui.Like($media.ContentId, $core_v2_media.ContentTypeId, "%{ Format = $format }")
			&lt;/li&gt;
		#end

		&lt;li&gt;
			&lt;a href="#" onclick="window.open('$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Redirect($core_v2_mediaUrls.DownloadMedia($media.Id, false), "%{Target='Host'}"))', '_system'); return false;" class="internal-link download"&gt;
				#if ($media.File.IsRemoteAttachment)
					$core_v2_language.GetResource("MediaGalleries_Button_View")
				#else
					$core_v2_language.GetResource("MediaGalleries_Button_Download")
				#end
			&lt;/a&gt;
		&lt;/li&gt;

		#if ($accessingUserIsRegistered)
			&lt;li&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('media-edit',$mediaId))"&gt;$core_v2_language.GetResource('edit')&lt;/a&gt;&lt;/li&gt;
		#end
		#if ($accessingUserIsRegistered &amp;&amp; $core_v2_bookmark.CanBookmark($media.ContentId, $core_v2_media.ContentTypeId))
			&lt;li class="action-bookmark"&gt;
				$core_v2_ui.Bookmark($media.ContentId, $core_v2_media.ContentTypeId)
			&lt;/li&gt;
		#end
		&lt;li class="action-moderate"&gt;$core_v2_ui.Moderate($media.ContentId, $core_v2_media.ContentTypeId)&lt;/li&gt;

		&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
	&lt;/div&gt;
&lt;/div&gt;


$mobile_v1_ui.Comments($media.ContentId, $core_v2_media.ContentTypeId, "%{ CanFlagAsAbusive = $accessingUserIsRegistered, AccessingUserId = $accessingUser.Id }")
		

		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
			<resource name="MediaGalleryPost_Name">Media Gallery Post</resource>
			<resource name="media_gallery">Media Galleries</resource>
			<resource name="no_gallery">No Gallery</resource>
			<resource name="edit">Edit</resource>
			<resource name="cancel">Cancel</resource>
			<resource name="MediaGalleries_Button_Download">Download</resource>
			<resource name="MediaGalleries_Button_View">View</resource>
		  </language>
		</languageResources>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:Navigation_Name}" version="7.0.0.1" description="" instanceIdentifier="c50b1c0e777545559ed8e49d31cb89e4" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="navigation">
    <contentScript>
			
#set($user = $core_v2_user.Accessing)
#set($unreadNotificationCount = 0)
#set($unreadConversationCount = 0)
#set($isUserRegistered = $core_v2_user.IsRegistered($user.Id))
&lt;div class="search"&gt;
	&lt;input type="search" placeholder="$core_v2_encoding.HtmlAttributeEncode($core_v2_language.GetResource('search_for'))" /&gt;
	&lt;a href="#" class="clear-search"&gt;&amp;nbsp;&lt;/a&gt;
&lt;/div&gt;

#set($filter = false)
#set($filter = $core_v2_page.GetQueryStringValue('w_filter'))
#if (!$filter)
	#set($filter = '')
#end
#set($query = false)
#set($query = $core_v2_page.GetQueryStringValue('w_query'))
&lt;div class="search-filters active"&gt;
	&lt;div class="ui-links filters" data-minlinks="100" data-animate="true"&gt;
		&lt;ul&gt;
			&lt;li&gt;&lt;a href="#"#if($filter == '') data-selected#end data-filter=""&gt;$core_v2_language.GetResource('filter_content')&lt;/a&gt;&lt;/li&gt;
			&lt;li&gt;&lt;a href="#"#if($filter =='groups') data-selected#end data-filter="groups"&gt;$core_v2_language.GetResource('filter_groups')&lt;/a&gt;&lt;/li&gt;
			&lt;li&gt;&lt;a href="#"#if($filter == 'users') data-selected#end data-filter="users"&gt;$core_v2_language.GetResource('filter_users')&lt;/a&gt;&lt;/li&gt;
		&lt;/ul&gt;
	&lt;/div&gt;
&lt;/div&gt;
&lt;div class="navigation-list search-results"&gt;&lt;/div&gt;
&lt;div class="navigation-list navigation"&gt;

#if ($isUserRegistered)
	&lt;div class="navigation-item with-avatar"&gt;
		#if ($user.ProfileUrl)
			&lt;a href="$core_v2_encoding.HtmlAttributeEncode($user.ProfileUrl)"&gt;
				&lt;span class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($user.AvatarUrl, 32, 32, "%{border='0', alt=$user.DisplayName, ResizeMethod='ZoomAndCrop'}")&lt;/span&gt;
				$user.DisplayName
			&lt;/a&gt;
		#else
			&lt;span class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($user.AvatarUrl, 32, 32, "%{border='0', alt=$user.DisplayName, ResizeMethod='ZoomAndCrop'}")&lt;/span&gt;
			$user.DisplayName
		#end
	&lt;/div&gt;
	&lt;div class="navigation-item header"&gt;
	&lt;/div&gt;
#else
	&lt;div class="navigation-item with-avatar login"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_authentication.Login())"&gt;$core_v2_language.GetResource('log_in')&lt;/a&gt;
	&lt;/div&gt;
#end

&lt;div class="navigation-item home with-avatar"&gt;
	&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('home'))"&gt;$core_v2_language.GetResource('home')&lt;/a&gt;
&lt;/div&gt;

#if ($isUserRegistered)
	&lt;div class="navigation-item friends with-avatar"&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('user-friends', $user.Id))"&gt;$core_v2_language.GetResource('friends')&lt;/a&gt;&lt;/div&gt;
	&lt;div class="navigation-item groups with-avatar"&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('user-groups', $user.Id))"&gt;$core_v2_language.GetResource('groups')&lt;/a&gt;&lt;/div&gt;
	&lt;div class="navigation-item bookmarks with-avatar"&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('user-bookmarks', $user.Id))"&gt;$core_v2_language.GetResource('bookmarks')&lt;/a&gt;&lt;/div&gt;

	#set ($bookmarks = $core_v2_bookmark.List("%{ PageIndex = $pageIndex, PageSize = 10, SortBy = 'Title', SortOrder = 'Ascending', ContentTypeIds = $core_v2_group.ContentTypeId.ToString() }"))
	#foreach ($bookmark in $bookmarks)
	#beforeall
		&lt;div class="navigation-item header with-label"&gt;
			$core_v2_language.GetResource('bookmarked_groups')
		&lt;/div&gt;
	#each
		#set ($content = false)
		#set ($content = $bookmark.Content)
		#if ($content)
			## determine an image to use. Preferring content over application over container
			#set ($imageUrl = false)
			#set ($imageUrl = $content.AvatarUrl)
			#if (!$imageUrl &amp;&amp; $content.Application)
				#set ($imageUrl = $content.Application.AvatarUrl)
				#if (!$imageUrl &amp;&amp; $content.Application.Container)
					#set ($imageUrl = $content.Application.Container.AvatarUrl)
				#end
			#end
			&lt;div class="navigation-item with-avatar"&gt;
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($content.Url)"&gt;
					#if ($imageUrl)
						&lt;span class="avatar"&gt;
							$core_v2_ui.GetResizedImageHtml($imageUrl, 32, 32, "%{border='0', alt=$content.HtmlName('Web'), ResizeMethod='ZoomAndCrop',border='0'}")
						&lt;/span&gt;
					#end

					#set ($name = $core_v2_language.Truncate($content.HtmlName('Web'), 50, '…'))
					#if ($name.length == 0)
						#set ($name = $core_v2_language.Truncate($content.HtmlDescription('Web'), 50, '…'))
					#end
					$name
				&lt;/a&gt;
			&lt;/div&gt;
		#end
	#afterall
		#if ($bookmarks.TotalCount &gt; $bookmarks.PageSize)
			&lt;div class="navigation-item"&gt;
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('user-bookmarks', $user.Id))"&gt;$core_v2_language.GetResource('more_bookmarks')&lt;/a&gt;
			&lt;/div&gt;
		#end

		&lt;div class="navigation-item header"&gt;
		&lt;/div&gt;
	#end

	&lt;div class="navigation-item with-avatar logout"&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_authentication.Logout())"&gt;$core_v2_language.GetResource('log_out')&lt;/a&gt;&lt;/div&gt;
#else
	#set ($groups = $core_v2_group.List("%{ PageIndex = $pageIndex, PageSize = 10, SortBy = 'SortOrder', SortOrder = 'Ascending', ParentGroupId = $core_v2_group.Root.Id, IncludeAllSubGroups = 'False' }"))
	#foreach ($group in $groups)
	#beforeall
		&lt;div class="navigation-item header with-label"&gt;
			$core_v2_language.GetResource('groups')
		&lt;/div&gt;
	#each
		&lt;div class="navigation-item with-avatar"&gt;
			&lt;a href="$core_v2_encoding.HtmlAttributeEncode($group.Url)"&gt;
				#if ($group.AvatarUrl)
					&lt;span class="avatar"&gt;
						$core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 32, 32, "%{border='0', alt=$group.Name, ResizeMethod='ZoomAndCrop',border='0'}")
					&lt;/span&gt;
				#end

				$core_v2_language.Truncate($group.Name, 50, '…')
			&lt;/a&gt;
		&lt;/div&gt;
	#afterall
		&lt;div class="navigation-item header"&gt;
		&lt;/div&gt;
	#end
#end

#set ($termsOfService = false)
#set ($termsOfService = $core_v2_urls.TermsOfService())
#if ($termsOfService)
	&lt;div class="navigation-item"&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($termsOfService)"&gt;$core_v2_language.GetResource('terms_of_service')&lt;/a&gt;&lt;/div&gt;
#end

&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.navigation.rendered', 'navigation', function(){
		jQuery.telligent.evolution.widgets.navigation.register({
			includeConversationsAndNotifications: #if ($isUserRegistered) true #else false #end,
			wrapper: '#$core_v2_widget.WrapperElementId',
			conversationNotificationTypeId: '$core_v2_conversationMessage.NotificationTypeId.ToString()',
			searchUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('search.vm'))',
			searchQuery: '#if($query)$core_v2_encoding.JavascriptEncode($query)#end',
			searchFilter: '#if($filter)$core_v2_encoding.JavascriptEncode($filter)#end',
			conversationsUrl: '$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('conversations'))',
			notificationsUrl: '$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('notifications'))',
			getUnreadCountsUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('getUnreadCounts.vm'))'
		});
	});
})
&lt;/script&gt;

		
		</contentScript>
    <languageResources>
	  <language key="en-us">
		<resource name="Navigation_Name">Navigation</resource>
		<resource name="log_in">Log In</resource>
		<resource name="home">Home</resource>
		<resource name="notifications">Notifications</resource>
		<resource name="conversations">Conversations</resource>
		<resource name="friends">Friends</resource>
		<resource name="bookmarks">Bookmarks</resource>
		<resource name="log_out">Log Out</resource>
		<resource name="terms_of_service">Terms Of Service</resource>
		<resource name="bookmarked_groups">Bookmarked Groups</resource>
		<resource name="groups">Groups</resource>
		<resource name="search_for">Search for...</resource>
		<resource name="more_bookmarks">More...</resource>
		<resource name="no_matches">No matches were found.</resource>
		<resource name="filter_content">Content</resource>
		<resource name="filter_groups">Groups</resource>
		<resource name="filter_users">People</resource>
		<resource name="groups">Groups</resource>
	  </language>
	</languageResources>
    <files>
      <file name="getUnreadCounts.vm">DQokY29yZV92Ml9wYWdlLlNldENvbnRlbnRUeXBlKCdhcHBsaWNhdGlvbi9qc29uJykNCg0KI3NldCgkdXNlciA9ICRjb3JlX3YyX3VzZXIuQWNjZXNzaW5nKQ0KI3NldCgkdW5yZWFkTm90aWZpY2F0aW9uQ291bnQgPSAwKQ0KI3NldCgkdW5yZWFkQ29udmVyc2F0aW9uQ291bnQgPSAwKQ0KI2lmKCRjb3JlX3YyX3VzZXIuSXNSZWdpc3RlcmVkKCR1c2VyLklkKSkNCgkjc2V0ICgkb3B0aW9ucyA9ICIleyBQYWdlSW5kZXggPSAkcGFnZUluZGV4LCBQYWdlU2l6ZSA9ICRwYWdlU2l6ZSwgSXNSZWFkPSdGYWxzZScgfSIpDQoJI3NldCAoJGNvbnZlcnNhdGlvbk1lc3NhZ2VOb3RpZmljYXRpb25GaWx0ZXJOYW1lID0gIl9GaWx0ZXJzXyR7Y29yZV92Ml9jb252ZXJzYXRpb25NZXNzYWdlLk5vdGlmaWNhdGlvblR5cGVJZH0iKQ0KCSRvcHRpb25zLkFkZCgkY29udmVyc2F0aW9uTWVzc2FnZU5vdGlmaWNhdGlvbkZpbHRlck5hbWUsICdFeGNsdWRlJykNCgkjc2V0KCR1bnJlYWROb3RpZmljYXRpb25Db3VudCA9ICRjb3JlX3YyX25vdGlmaWNhdGlvbi5MaXN0KCRvcHRpb25zKS5Ub3RhbENvdW50KQ0KDQoJI3NldCgkdW5yZWFkQ29udmVyc2F0aW9uQ291bnQgPSAkY29yZV92Ml9jb252ZXJzYXRpb24uVW5yZWFkQ291bnQoKSkNCiNlbmQNCg0KeyJVbnJlYWROb3RpZmljYXRpb25Db3VudCI6JHVucmVhZE5vdGlmaWNhdGlvbkNvdW50LCJVbnJlYWRDb252ZXJzYXRpb25Db3VudCI6JHVucmVhZENvbnZlcnNhdGlvbkNvdW50fQ==</file>
      <file name="search.vm">I3NldCAoJHBhZ2VJbmRleCA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19wYWdlSW5kZXgnKSkNCiNzZXQgKCRxdWVyeSA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19xdWVyeScpKQ0KI3NldCAoJGZpbHRlciA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19maWx0ZXInKSkNCg0KI3NldCgkb3B0aW9ucyA9ICIle1BhZ2VJbmRleCA9ICRwYWdlSW5kZXgsIFBhZ2VTaXplID0gMTAsIFF1ZXJ5ID0gJHF1ZXJ5fSIpDQojaWYgKCRmaWx0ZXIgPT0gJ2dyb3VwcycpDQoJJG9wdGlvbnMuQWRkKCdGaWx0ZXJzJywgImNvbnRlbnR0eXBlaWQ6OiRjb3JlX3YyX2dyb3VwLkNvbnRlbnRUeXBlSWQiKQ0KI2Vsc2VpZiAoJGZpbHRlciA9PSAndXNlcnMnKQ0KCSRvcHRpb25zLkFkZCgnRmlsdGVycycsICJjb250ZW50dHlwZWlkOjokY29yZV92Ml91c2VyLkNvbnRlbnRUeXBlSWQiKQ0KI2Vsc2UNCgkjc2V0KCRmaWx0ZXJzID0gJycpDQoJI2ZvcmVhY2goJGNvbnRlbnRUeXBlIGluICRjb3JlX3YyX2NvbnRlbnRUeXBlLkxpc3QoKSkNCgkJI3NldCgkYXBwbGljYXRpb25UeXBlID0gZmFsc2UpDQoJCSNzZXQoJGFwcGxpY2F0aW9uVHlwZSA9ICRjb3JlX3YyX2FwcGxpY2F0aW9uVHlwZS5HZXQoJGNvbnRlbnRUeXBlLklkKSkNCgkJI3NldCgkY29udGFpbmVyVHlwZSA9IGZhbHNlKQ0KCQkjc2V0KCRjb250YWluZXJUeXBlID0gJGNvcmVfdjJfY29udGFpbmVyVHlwZS5HZXQoJGNvbnRlbnRUeXBlLklkKSkNCgkJI2lmICgoISRhcHBsaWNhdGlvblR5cGUgfHwgJGFwcGxpY2F0aW9uVHlwZS5FcnJvcnMuQ291bnQgPiAwKSAmJiAoISRjb250YWluZXJUeXBlIHx8ICRjb250YWluZXJUeXBlLkVycm9ycy5Db3VudCA+IDApKQ0KCQkJI2lmICgkZmlsdGVycy5MZW5ndGggPT0gMCkNCgkJCQkjc2V0KCRmaWx0ZXJzID0gImNvbnRlbnR0eXBlaWQ6Oigke2NvbnRlbnRUeXBlLklkfSIpDQoJCQkjZWxzZQ0KCQkJCSNzZXQoJGZpbHRlcnMgPSAiJHtmaWx0ZXJzfSBPUiAke2NvbnRlbnRUeXBlLklkfSIpDQoJCSNlbmQNCgkJI2VuZA0KCSNlbmQNCgkjaWYoJGZpbHRlcnMuTGVuZ3RoID4gMCkNCgkJJG9wdGlvbnMuQWRkKCdGaWx0ZXJzJywgIiR7ZmlsdGVyc30pIikNCgkjZW5kDQojZW5kDQoNCiNzZXQoJHJlc3VsdHMgPSAkY29yZV92Ml9zZWFyY2hSZXN1bHQuTGlzdCgkb3B0aW9ucykpDQojZm9yZWFjaCgkcmVzdWx0IGluICRyZXN1bHRzKQ0KI2VhY2gNCgkjc2V0KCRhdmF0YXJVcmwgPSBmYWxzZSkNCgkjaWYoJHJlc3VsdC5Db250ZW50KQ0KCQkjc2V0KCRhdmF0YXJVcmwgPSAkcmVzdWx0LkNvbnRlbnQuQXZhdGFyVXJsKQ0KCQkjaWYgKCEkYXZhdGFyVXJsKQ0KCQkJI3NldCgkYXZhdGFyVXJsID0gJHJlc3VsdC5Db250ZW50LkFwcGxpY2F0aW9uLkF2YXRhclVybCkNCgkJCSNpZiAoISRhdmF0YXJVcmwpDQoJCQkJI3NldCgkYXZhdGFyVXJsID0gJHJlc3VsdC5Db250ZW50LkFwcGxpY2F0aW9uLkNvbnRhaW5lci5BdmF0YXJVcmwpDQoJCQkjZW5kDQoJCSNlbmQNCgkjZW5kDQoNCgk8ZGl2IGNsYXNzPSJuYXZpZ2F0aW9uLWl0ZW0jaWYoJGF2YXRhclVybCkgd2l0aC1hdmF0YXIjZW5kIj4NCgkJPGEgaHJlZj0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkcmVzdWx0LlVybCkiPg0KCQkJI2lmICgkYXZhdGFyVXJsKQ0KCQkJCTxzcGFuIGNsYXNzPSJhdmF0YXIiPg0KCQkJCQkkY29yZV92Ml91aS5HZXRSZXNpemVkSW1hZ2VIdG1sKCRhdmF0YXJVcmwsIDMyLCAzMiwgIiV7Ym9yZGVyPScwJywgYWx0PSRyZXN1bHQuVGl0bGUsIFJlc2l6ZU1ldGhvZD0nWm9vbUFuZENyb3AnLGJvcmRlcj0nMCd9IikNCgkJCQk8L3NwYW4+DQoJCQkjZW5kDQoNCgkJCSRjb3JlX3YyX2xhbmd1YWdlLlRydW5jYXRlKCRyZXN1bHQuVGl0bGUsIDUwLCAnhScpDQoNCgkJCSNpZiAoJGNvcmVfdjJfZW5jb2RpbmcuSHRtbERlY29kZSgkY29yZV92Ml9sYW5ndWFnZS5UcnVuY2F0ZSgkcmVzdWx0LlRpdGxlLCA1MCwgJycpKSAhPSAkY29yZV92Ml9lbmNvZGluZy5IdG1sRGVjb2RlKCRjb3JlX3YyX2xhbmd1YWdlLlRydW5jYXRlKCRyZXN1bHQuQm9keSwgNTAsICcnKSkpDQoJCQkJPHNwYW4gY2xhc3M9ImRlc2NyaXB0aW9uIj4kY29yZV92Ml9sYW5ndWFnZS5UcnVuY2F0ZSgkcmVzdWx0LkJvZHksIDE1MCwgJ4UnKTwvc3Bhbj4NCgkJCSNlbmQNCgkJPC9hPg0KCTwvZGl2Pg0KI25vZGF0YQ0KCTxkaXYgY2xhc3M9Im1lc3NhZ2Ugbm9yZWNvcmRzIj4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbm9fbWF0Y2hlcycpPC9kaXY+DQoJPGRpdiBjbGFzcz0iZGF0YSI+PC9kaXY+DQojYWZ0ZXJhbGwNCgkjc2V0ICgkaGFzTW9yZSA9IGZhbHNlKQ0KCSNpZiAoJHJlc3VsdHMuVG90YWxDb3VudCA+ICgoJHJlc3VsdHMuUGFnZUluZGV4ICsgMSkgKiAkcmVzdWx0cy5QYWdlU2l6ZSkpDQoJCSNzZXQoJGhhc01vcmUgPSB0cnVlKQ0KCSNlbmQNCgk8ZGl2IGNsYXNzPSJkYXRhIiAjaWYoJGhhc01vcmUpZGF0YS1oYXNtb3JlPSJ0cnVlIiNlbmQ+PC9kaXY+DQojZW5k</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCl7DQoNCgl2YXIgYXBpID0gew0KCQlyZWdpc3RlcjogZnVuY3Rpb24ob3B0aW9ucykgew0KCQkJdmFyIHNlYXJjaFRpbWVvdXQgPSBudWxsLA0KCQkJCXVucmVhZE5vdGlmaWNhdGlvbkNvdW50ID0gb3B0aW9ucy51bnJlYWROb3RpZmljYXRpb25Db3VudCwNCgkJCQl1bnJlYWRDb252ZXJzYXRpb25Db3VudCA9IG9wdGlvbnMudW5yZWFkQ29udmVyc2F0aW9uQ291bnQsDQoJCQkJbGFzdEFjdGl2aXR5ID0gMCwNCgkJCQlsYXN0Tm90aWZpY2F0aW9uQ2hlY2sgPSAwLA0KCQkJCW5vdGlmaWNhdGlvblBpbmdEdXJhdGlvbiA9IDYwICogMTAwMCwNCgkJCQloZWFkZXIgPSBudWxsLA0KCQkJCXNlYXJjaElucHV0ID0gJChvcHRpb25zLndyYXBwZXIgKyAnIGlucHV0W3R5cGU9InNlYXJjaCJdJyksDQoJCQkJc2VhcmNoUmVzdWx0cyA9ICQob3B0aW9ucy53cmFwcGVyKS5maW5kKCdkaXYuc2VhcmNoLXJlc3VsdHMnKSwNCgkJCQlzZWFyY2hGaWx0ZXJzID0gJChvcHRpb25zLndyYXBwZXIpLmZpbmQoJ2Rpdi5zZWFyY2gtZmlsdGVycycpLA0KCQkJCXNlYXJjaE5hdmlnYXRpb24gPSAkKG9wdGlvbnMud3JhcHBlcikuZmluZCgnZGl2Lm5hdmlnYXRpb24nKSwNCgkJCQlpbml0aWFsaXplSGVhZGVyID0gZnVuY3Rpb24oKSB7DQoJCQkJCWhlYWRlciA9ICQoJzxzcGFuIGNsYXNzPSJoZWFkZXItbm90aWZpY2F0aW9ucyI+PGEgaHJlZj0iJyArIG9wdGlvbnMubm90aWZpY2F0aW9uc1VybCArICciIGNsYXNzPSJub3RpZmljYXRpb25zIj48c3BhbiBjbGFzcz0iaWNvbiBiZWxsIj48L3NwYW4+PHNwYW4gY2xhc3M9ImNvdW50IiBkYXRhLWNvdW50PSIwIj48L3NwYW4+PC9hPjxhIGhyZWY9IicgKyBvcHRpb25zLmNvbnZlcnNhdGlvbnNVcmwgKyAnIiBjbGFzcz0iY29udmVyc2F0aW9ucyI+PHNwYW4gY2xhc3M9Imljb24gY2hhdCI+PC9zcGFuPjxzcGFuIGNsYXNzPSJjb3VudCIgZGF0YS1jb3VudD0iMCI+PC9zcGFuPjwvYT48L3NwYW4+Jyk7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2V0SGVhZGVyQ29udGVudChoZWFkZXIpOw0KCQkJCQlyZXRyaWV2ZVVucmVhZENvdW50cygpOw0KCQkJCX0sDQoJCQkJdXBkYXRlVW5yZWFkQ291bnRzID0gZnVuY3Rpb24oKSB7DQoJCQkJCWhlYWRlci5maW5kKCcubm90aWZpY2F0aW9ucyAuY291bnQnKS5odG1sKHVucmVhZE5vdGlmaWNhdGlvbkNvdW50ID09IDAgPyAnJyA6ICh1bnJlYWROb3RpZmljYXRpb25Db3VudCA+IDkgPyAnOSsnIDogdW5yZWFkTm90aWZpY2F0aW9uQ291bnQpKS5hdHRyKCdkYXRhLWNvdW50JywgdW5yZWFkTm90aWZpY2F0aW9uQ291bnQpOw0KCQkJCQloZWFkZXIuZmluZCgnLmNvbnZlcnNhdGlvbnMgLmNvdW50JykuaHRtbCh1bnJlYWRDb252ZXJzYXRpb25Db3VudCA9PSAwID8gJycgOiAodW5yZWFkQ29udmVyc2F0aW9uQ291bnQgPiA5ID8gJzkrJyA6IHVucmVhZENvbnZlcnNhdGlvbkNvdW50KSkuYXR0cignZGF0YS1jb3VudCcsIHVucmVhZENvbnZlcnNhdGlvbkNvdW50KTsNCgkJCQl9LA0KCQkJCW5vdGlmaWNhdGlvbkNvdW50VXBkYXRlUGluZyA9IGZ1bmN0aW9uKCkgew0KCQkJCQl2YXIgY3VycmVudFRpbWUgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpDQoJCQkJCWlmIChjdXJyZW50VGltZSAtIGxhc3RBY3Rpdml0eSA8IChub3RpZmljYXRpb25QaW5nRHVyYXRpb24gKiA1KSAmJiBjdXJyZW50VGltZSAtIGxhc3ROb3RpZmljYXRpb25DaGVjayA+IG5vdGlmaWNhdGlvblBpbmdEdXJhdGlvbikgew0KCQkJCQkJcmV0cmlldmVVbnJlYWRDb3VudHMoKTsNCgkJCQkJfQ0KCQkJCX0sDQoJCQkJcmVzZXROb3RpZmljYXRpb25DaGVja1RpbWVvdXQgPSBmdW5jdGlvbigpIHsNCgkJCQkJbGFzdE5vdGlmaWNhdGlvbkNoZWNrID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKTsNCgkJCQl9LA0KCQkJCXJldHJpZXZlVW5yZWFkQ291bnRzID0gZnVuY3Rpb24oKSB7DQoJCQkJCXJlc2V0Tm90aWZpY2F0aW9uQ2hlY2tUaW1lb3V0KCk7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoew0KCQkJCQkJdXJsOiBvcHRpb25zLmdldFVucmVhZENvdW50c1VybCwNCgkJCQkJCWNhY2hlOiBmYWxzZSwNCgkJCQkJCXN1Y2Nlc3M6IGZ1bmN0aW9uKHIpIHsNCgkJCQkJCQl1bnJlYWROb3RpZmljYXRpb25Db3VudCA9IHIuVW5yZWFkTm90aWZpY2F0aW9uQ291bnQ7DQoJCQkJCQkJdW5yZWFkQ29udmVyc2F0aW9uQ291bnQgPSByLlVucmVhZENvbnZlcnNhdGlvbkNvdW50Ow0KCQkJCQkJCXVwZGF0ZVVucmVhZENvdW50cygpOw0KCQkJCQkJfQ0KCQkJCQl9KTsNCgkJCQl9LA0KCQkJCXNob3dTZWFyY2ggPSBmdW5jdGlvbigpIHsNCgkJCQkJc2VhcmNoUmVzdWx0cy5lbXB0eSgpLnNob3coKTsNCgkJCQkJc2VhcmNoRmlsdGVycy5zaG93KCk7DQoJCQkJCXNlYXJjaE5hdmlnYXRpb24uaGlkZSgpOw0KCQkJCX0sDQoJCQkJc2hvd05hdmlnYXRpb24gPSBmdW5jdGlvbigpIHsNCgkJCQkJc2VhcmNoUmVzdWx0cy5oaWRlKCk7DQoJCQkJCXNlYXJjaEZpbHRlcnMuaGlkZSgpOw0KCQkJCQlzZWFyY2hOYXZpZ2F0aW9uLnNob3coKTsNCgkJCQl9LA0KCQkJCXNlYXJjaCA9IGZ1bmN0aW9uKCkgew0KCQkJCQlzaG93U2VhcmNoKCk7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2Nyb2xsYWJsZSh7DQoJCQkJCQlyZWdpb246ICduYXZpZ2F0aW9uJywNCgkJCQkJCWluaXRpYWxQYWdlSW5kZXg6IC0xLA0KCQkJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgew0KCQkJCQkJCXZhciBkID0gJChvcHRpb25zLndyYXBwZXIgKyAnIGRpdi5zZWFyY2gtcmVzdWx0cyBkaXYuZGF0YTpsYXN0JykNCgkJCQkJCQlpZiAoZC5sZW5ndGggPT0gMCB8fCBkLmRhdGEoJ2hhc21vcmUnKSkgew0KCQkJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsNCgkJCQkJCQkJCXVybDogb3B0aW9ucy5zZWFyY2hVcmwsDQoJCQkJCQkJCQlkYXRhOiB7DQoJCQkJCQkJCQkJd19wYWdlSW5kZXg6IHBhZ2VJbmRleCwNCgkJCQkJCQkJCQl3X3F1ZXJ5OiBvcHRpb25zLnNlYXJjaFF1ZXJ5LA0KCQkJCQkJCQkJCXdfZmlsdGVyOiBvcHRpb25zLnNlYXJjaEZpbHRlcg0KCQkJCQkJCQkJfSwNCgkJCQkJCQkJCXN1Y2Nlc3M6IGZ1bmN0aW9uKHIpIHsNCgkJCQkJCQkJCQlzdWNjZXNzKHIpOw0KCQkJCQkJCQkJfSwNCgkJCQkJCQkJCWVycm9yOiBmdW5jdGlvbigpIHsNCgkJCQkJCQkJCQllcnJvcigpOw0KCQkJCQkJCQkJfQ0KCQkJCQkJCQl9KTsNCgkJCQkJCQl9IGVsc2Ugew0KCQkJCQkJCQlzdWNjZXNzKCk7DQoJCQkJCQkJfQ0KCQkJCQkJfSwNCgkJCQkJCWNvbXBsZXRlOiBmdW5jdGlvbihjb250ZW50KSB7DQoJCQkJCQkJY29udGVudCA9ICQoY29udGVudCkuY3NzKHsgb3BhY2l0eTogMCB9KTsNCgkJCQkJCQlzZWFyY2hSZXN1bHRzLmFwcGVuZChjb250ZW50KTsNCgkJCQkJCQljb250ZW50LmV2b2x1dGlvblRyYW5zZm9ybSh7IG9wYWNpdHk6IDEgfSwgeyBkdXJhdGlvbjogNDAwIH0pOw0KCQkJCQkJfQ0KCQkJCQl9KTsNCgkJCQl9Ow0KDQoJCQkkKG9wdGlvbnMud3JhcHBlciArICcgLmZpbHRlcnMgYScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHsNCgkJCQllLnByZXZlbnREZWZhdWx0KCk7DQoJCQkJdmFyIGZpbHRlciA9ICQodGhpcykuZGF0YSgnZmlsdGVyJyk7DQoJCQkJaWYgKGZpbHRlciAhPSBvcHRpb25zLmZpbHRlcikgew0KCQkJCQlvcHRpb25zLnNlYXJjaEZpbHRlciA9IGZpbHRlcjsNCgkJCQkJJChvcHRpb25zLndyYXBwZXIgKyAnIC5maWx0ZXJzIGEnKS5yZW1vdmVBdHRyKCdkYXRhLXNlbGVjdGVkJyk7DQoJCQkJCSQodGhpcykuYXR0cignZGF0YS1zZWxlY3RlZCcsIHRydWUpOw0KCQkJCQlzZWFyY2goKTsNCgkJCQl9DQoJCQkJcmV0dXJuIGZhbHNlOw0KCQkJfSk7DQoNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tZXNzYWdpbmcuc3Vic2NyaWJlKCdtb2JpbGUuY29udGVudC5yZW5kZXJlZCcsICduYXZpZ2F0aW9uJywgZnVuY3Rpb24oZCkgew0KCQkJCWxhc3RBY3Rpdml0eSA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7DQoJCQl9KTsNCg0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ25vdGlmaWNhdGlvbi5yZWFkJywgJ25hdmlnYXRpb24nLCBmdW5jdGlvbihkKSB7DQoJCQkJaWYgKGQgJiYgZC51bnJlYWRDb3VudCkgew0KCQkJCQl2YXIgaXNDb252ZXJzYXRpb24gPSAoZC50eXBlSWQgPT09IHVuZGVmaW5lZCB8fCBkLnR5cGVJZCA9PSBvcHRpb25zLmNvbnZlcnNhdGlvbk5vdGlmaWNhdGlvblR5cGVJZCk7DQoNCgkJCQkJaWYgKGQudW5yZWFkQ291bnQuc3Vic3RyKDAsIDIpID09ICctPScgJiYgIWlzTmFOKHBhcnNlSW50KGQudW5yZWFkQ291bnQuc3Vic3RyKDIpLCAxMCkpKSB7DQoJCQkJCQlpZiAoaXNDb252ZXJzYXRpb24pIHsNCgkJCQkJCQl1bnJlYWRDb252ZXJzYXRpb25Db3VudCAtPSBwYXJzZUludChkLnVucmVhZENvdW50LnN1YnN0cigyKSwgMTApOw0KCQkJCQkJCWlmICh1bnJlYWRDb252ZXJzYXRpb25Db3VudCA8IDApIHsNCgkJCQkJCQkJdW5yZWFkQ29udmVyc2F0aW9uQ291bnQgPSAwOw0KCQkJCQkJCX0NCgkJCQkJCX0gZWxzZSB7DQoJCQkJCQkJdW5yZWFkTm90aWZpY2F0aW9uQ291bnQgLT0gcGFyc2VJbnQoZC51bnJlYWRDb3VudC5zdWJzdHIoMiksIDEwKTsNCgkJCQkJCQlpZiAodW5yZWFkTm90aWZpY2F0aW9uQ291bnQgPCAwKSB7DQoJCQkJCQkJCXVucmVhZE5vdGlmaWNhdGlvbkNvdW50ID0gMDsNCgkJCQkJCQl9DQoJCQkJCQl9DQoJCQkJCQl1cGRhdGVVbnJlYWRDb3VudHMoKTsNCgkJCQkJfSBlbHNlIGlmIChkLnVucmVhZENvdW50LnN1YnN0cigwLCAyKSA9PSAnKz0nICYmICFpc05hTihwYXJzZUludChkLnVucmVhZENvdW50LnN1YnN0cigyKSwgMTApKSkgew0KCQkJCQkJaWYgKGlzQ29udmVyc2F0aW9uKSB7DQoJCQkJCQkJdW5yZWFkQ29udmVyc2F0aW9uQ291bnQgKz0gcGFyc2VJbnQoZC51bnJlYWRDb3VudC5zdWJzdHIoMiksIDEwKTsNCgkJCQkJCX0gZWxzZSB7DQoJCQkJCQkJdW5yZWFkTm90aWZpY2F0aW9uQ291bnQgKz0gcGFyc2VJbnQoZC51bnJlYWRDb3VudC5zdWJzdHIoMiksIDEwKTsNCgkJCQkJCX0NCgkJCQkJCXVwZGF0ZVVucmVhZENvdW50cygpOw0KCQkJCQl9IGVsc2UgaWYgKCFpc05hTihwYXJzZUludChkLnVucmVhZENvdW50LCAxMCkpICYmIHBhcnNlSW50KGQudW5yZWFkQ291bnQsIDEwKSAhPSAodW5yZWFkQ29udmVyc2F0aW9uQ291bnQgKyB1bnJlYWROb3RpZmljYXRpb25Db3VudCkpIHsNCgkJCQkJCXJldHJpZXZlVW5yZWFkQ291bnRzKCk7DQoJCQkJCX0NCgkJCQl9DQoJCQl9KTsNCg0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ25vdGlmaWNhdGlvbi5yYWlzZWQnLCAnbmF2aWdhdGlvbicsIGZ1bmN0aW9uKGQpIHsNCgkJCQlpZiAoZCAmJiBkLnVucmVhZENvdW50ICYmICFpc05hTihwYXJzZUludChkLnVucmVhZENvdW50LCAxMCkpICYmIHBhcnNlSW50KGQudW5yZWFkQ291bnQsIDEwKSAhPSAodW5yZWFkQ29udmVyc2F0aW9uQ291bnQgKyB1bnJlYWROb3RpZmljYXRpb25Db3VudCkpIHsNCgkJCQkJcmV0cmlldmVVbnJlYWRDb3VudHMoKTsNCgkJCQl9IGVsc2Ugew0KCQkJCQlyZXNldE5vdGlmaWNhdGlvbkNoZWNrVGltZW91dCgpOw0KCQkJCX0NCgkJCX0pOw0KDQoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnN1YnNjcmliZSgnbW9iaWxlLmNvbnRlbnQubG9hZGluZycsIGZ1bmN0aW9uKGUpew0KCQkJCXNlYXJjaElucHV0LmJsdXIoKTsNCgkJCX0pOw0KDQoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnN1YnNjcmliZSgndWkuYm9va21hcmsnLCAnbmF2aWdhdGlvbicsIGZ1bmN0aW9uKGRhdGEpIHsNCgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnJlZnJlc2hOYXZpZ2F0aW9uKCk7DQoJCQl9KTsNCg0KCQkJc2VhcmNoSW5wdXQNCgkJCQkuYXR0cignYXV0b2NvbXBsZXRlJywgJ29mZicpDQoJCQkJLmtleXVwKGZ1bmN0aW9uKGUpIHsNCgkJCQkJZ2xvYmFsLmNsZWFyVGltZW91dChzZWFyY2hUaW1lb3V0KTsNCgkJCQkJdmFyIHF1ZXJ5ID0gJCh0aGlzKS52YWwoKTsNCgkJCQkJaWYgKHF1ZXJ5Lmxlbmd0aCA+IDApIHsNCgkJCQkJCSQob3B0aW9ucy53cmFwcGVyICsgJyAuc2VhcmNoJykuYWRkQ2xhc3MoJ3dpdGgtdmFsdWUnKTsNCgkJCQkJCXNlYXJjaFRpbWVvdXQgPSBnbG9iYWwuc2V0VGltZW91dChmdW5jdGlvbigpIHsNCgkJCQkJCQlvcHRpb25zLnNlYXJjaFF1ZXJ5ID0gcXVlcnk7DQoJCQkJCQkJc2VhcmNoKCk7DQoJCQkJCQl9LCA0OTkpOw0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJJChvcHRpb25zLndyYXBwZXIgKyAnIC5zZWFyY2gnKS5yZW1vdmVDbGFzcygnd2l0aC12YWx1ZScpOw0KCQkJCQkJc2hvd05hdmlnYXRpb24oKTsNCgkJCQkJfQ0KCQkJCX0pOw0KDQoJCQkkKG9wdGlvbnMud3JhcHBlciArICcgLmNsZWFyLXNlYXJjaCcpDQoJCQkJLm9uKCdwb2ludGVyc3RhcnQnLCBmdW5jdGlvbihlKSB7DQoJCQkJCWUucHJldmVudERlZmF1bHQoKTsNCgkJCQkJc2VhcmNoSW5wdXQudmFsKCcnKS5mb2N1cygpOw0KCQkJCQkkKG9wdGlvbnMud3JhcHBlciArICcgLnNlYXJjaCcpLnJlbW92ZUNsYXNzKCd3aXRoLXZhbHVlJyk7DQoJCQkJCWdsb2JhbC5jbGVhclRpbWVvdXQoc2VhcmNoVGltZW91dCk7DQoJCQkJCXNob3dOYXZpZ2F0aW9uKCk7DQoJCQkJCXJldHVybiBmYWxzZTsNCgkJCQl9KTsNCg0KCQkJaWYgKG9wdGlvbnMuc2VhcmNoUXVlcnkubGVuZ3RoID4gMCkgew0KCQkJCXNlYXJjaElucHV0LnZhbChvcHRpb25zLnNlYXJjaFF1ZXJ5KTsNCgkJCQlzZWFyY2gob3B0aW9ucy5zZWFyY2hRdWVyeSk7DQoJCQl9IGVsc2Ugew0KCQkJCXNob3dOYXZpZ2F0aW9uKCk7DQoJCQl9DQoNCgkJCXNlYXJjaElucHV0Lm9uKHsNCgkJCQlmb2N1czogZnVuY3Rpb24oZSkgew0KCQkJCQkkKG9wdGlvbnMud3JhcHBlciArICcgLnNlYXJjaCcpLmFkZENsYXNzKCdhY3RpdmUnKTsNCgkJCQl9LA0KCQkJCWJsdXI6IGZ1bmN0aW9uKGUpIHsNCgkJCQkJJChvcHRpb25zLndyYXBwZXIgKyAnIC5zZWFyY2gnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7DQoJCQkJfQ0KCQkJfSkNCg0KCQkJaWYob3B0aW9ucy5pbmNsdWRlQ29udmVyc2F0aW9uc0FuZE5vdGlmaWNhdGlvbnMpIHsNCgkJCQlpbml0aWFsaXplSGVhZGVyKCk7DQoJCQkJZ2xvYmFsLnNldEludGVydmFsKGZ1bmN0aW9uKCkgew0KCQkJCQlub3RpZmljYXRpb25Db3VudFVwZGF0ZVBpbmcoKTsNCgkJCQl9LCA0OTkpOw0KCQkJfQ0KCQl9DQoJfQ0KDQoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24gPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24gfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5uYXZpZ2F0aW9uID0gYXBpOw0KDQp9KShqUXVlcnksIHdpbmRvdyk7</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:NotificationList_Name}" version="7.0.0.1" description="" instanceIdentifier="39aa3e84a898400d84f1fd7b8a2c033f" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="notification-list">
    <contentScript>
		

#if (!$core_v2_user.IsRegistered($core_v2_user.Accessing.Id))
	$core_v2_widget.Hide()
#end

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;h1&gt;$core_v2_language.GetResource('notifications')&lt;/h1&gt;
	&lt;/div&gt;
&lt;/div&gt;

## load and render notifications
&lt;div class="post-list notifications"&gt;
	#set($pageIndex = 0)
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.notificationList.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
			conversationNotificationTypeId: '$core_v2_conversationMessage.NotificationTypeId.ToString()'
		});
	});
})
&lt;/script&gt;
		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="NotificationList_Name">Notification List</resource>
		<resource name="notifications">Notifications</resource>
		<resource name="no_notifications">No notifications. Go get busy in the community!</resource>
		<resource name="notifications">Notifications</resource>
	  </language>
	</languageResources>
    <files>
      <file name="list.vm">I3NldCAoJG9wdGlvbnMgPSAiJXsgUGFnZUluZGV4ID0gJHBhZ2VJbmRleCwgUGFnZVNpemUgPSA3IH0iKQ0KJG9wdGlvbnMuQWRkKCJfRmlsdGVyc18ke2NvcmVfdjJfY29udmVyc2F0aW9uTWVzc2FnZS5Ob3RpZmljYXRpb25UeXBlSWR9IiwgJ0V4Y2x1ZGUnKQ0KI3NldCgkbm90aWZpY2F0aW9ucyA9ICRjb3JlX3YyX25vdGlmaWNhdGlvbi5MaXN0KCRvcHRpb25zKSkNCiNmb3JlYWNoKCRub3RpZmljYXRpb24gaW4gJG5vdGlmaWNhdGlvbnMpDQojZWFjaA0KCSNzZXQgKCRsYXN0QWN0b3IgPSBmYWxzZSkNCgkjc2V0ICgkYWN0b3JzID0gJG5vdGlmaWNhdGlvbi5BY3RvcnMpDQoJI3NldCAoJGxhc3RJbmRleCA9ICRhY3RvcnMuQ291bnQgLSAxKQ0KCSNzZXQgKCRsYXN0QWN0b3IgPSAkYWN0b3JzLmdldF9pdGVtKCRsYXN0SW5kZXgpLlVzZXIpDQoJI3NldCAoJG5vdGlmaWNhdGlvblR5cGUgPSAkY29yZV92Ml9ub3RpZmljYXRpb25UeXBlLkdldCgkbm90aWZpY2F0aW9uLk5vdGlmaWNhdGlvblR5cGVJZCkpDQoNCgkjaWYgKCRub3RpZmljYXRpb25UeXBlLk5vdGlmaWNhdGlvblR5cGVJZCA9PSAkY29yZV92Ml9yYXRlZEl0ZW0uTm90aWZpY2F0aW9uVHlwZUlkKQ0KCQkjc2V0ICgkbGFzdEFjdG9yID0gZmFsc2UpDQoJI2VuZA0KDQoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIG5vdGlmaWNhdGlvbiNpZighJG5vdGlmaWNhdGlvbi5Jc1JlYWQpIHVucmVhZCNlbmQiDQoJCWRhdGEtbm90aWZpY2F0aW9uaWQ9IiRub3RpZmljYXRpb24uTm90aWZpY2F0aW9uSWQiDQoJCWRhdGEtbm90aWZpY2F0aW9udHlwZWlkPSIkbm90aWZpY2F0aW9uLk5vdGlmaWNhdGlvblR5cGVJZCINCgkJZGF0YS10YXJnZXR1cmw9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJG5vdGlmaWNhdGlvbi5UYXJnZXRVcmwpIj4NCgkJPGRpdiBjbGFzcz0icG9zdCI+DQoJCQkjaWYgKCRsYXN0QWN0b3IpDQoJCQkJPGRpdiBjbGFzcz0iYXZhdGFyIj4NCgkJCQkJI2lmICgkbGFzdEFjdG9yLlByb2ZpbGVVcmwpDQoJCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRsYXN0QWN0b3IuUHJvZmlsZVVybCkiIGNsYXNzPSJpbnRlcm5hbC1saW5rIHZpZXctdXNlci1wcm9maWxlIj4NCgkJCQkJCQkkY29yZV92Ml91aS5HZXRSZXNpemVkSW1hZ2VIdG1sKCRsYXN0QWN0b3IuQXZhdGFyVXJsLCA0MCwgNDAsICIle2JvcmRlcj0nMCcsIGFsdD0kbGFzdEFjdG9yLkRpc3BsYXlOYW1lLCBSZXNpemVNZXRob2Q9J1pvb21BbmRDcm9wJyxib3JkZXI9JzAnfSIpDQoJCQkJCQk8L2E+DQoJCQkJCSNlbHNlDQoJCQkJCQkkY29yZV92Ml91aS5HZXRSZXNpemVkSW1hZ2VIdG1sKCRsYXN0QWN0b3IuQXZhdGFyVXJsLCA0MCwgNDAsICIle2JvcmRlcj0nMCcsIGFsdD0kbGFzdEFjdG9yLkRpc3BsYXlOYW1lLCBSZXNpemVNZXRob2Q9J1pvb21BbmRDcm9wJyxib3JkZXI9JzAnfSIpDQoJCQkJCSNlbmQNCgkJCQk8L2Rpdj4NCgkJCSNlbmQNCgkJCTxkaXYgY2xhc3M9ImRhdGUiPiRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdEFnb0RhdGUoJG5vdGlmaWNhdGlvbi5MYXN0VXBkYXRlZERhdGUpPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJjb250ZW50Ij4NCgkJCQkkbm90aWZpY2F0aW9uLk1lc3NhZ2UoJ0h0bWwnKQ0KCQkJPC9kaXY+DQoJCTwvZGl2Pg0KCTwvZGl2Pg0KI25vZGF0YQ0KCTxkaXYgY2xhc3M9InBvc3QtbGlzdC1pdGVtIGNvbnRlbnQtaXRlbSBub3RpZmljYXRpb24iPjxkaXYgY2xhc3M9Im1lc3NhZ2Ugbm9yZWNvcmRzIj4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbm9fbm90aWZpY2F0aW9ucycpPC9kaXY+PC9kaXY+DQojYWZ0ZXJhbGwNCgkjc2V0ICgkaGFzTW9yZSA9IGZhbHNlKQ0KCSNpZiAoJG5vdGlmaWNhdGlvbnMuVG90YWxDb3VudCA+ICgoJG5vdGlmaWNhdGlvbnMuUGFnZUluZGV4ICsgMSkgKiAkbm90aWZpY2F0aW9ucy5QYWdlU2l6ZSkpDQoJCSNzZXQoJGhhc01vcmUgPSB0cnVlKQ0KCSNlbmQNCgk8ZGl2IGNsYXNzPSJkYXRhIiAjaWYoJGhhc01vcmUpZGF0YS1oYXNtb3JlPSJ0cnVlIiNlbmQ+PC9kaXY+DQojZW5k</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBub3RpZmljYXRpb25zDQojIw0KI3NldCAoJHBhZ2VJbmRleCA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19wYWdlSW5kZXgnKSkNCiRjb3JlX3YyX3dpZGdldC5FeGVjdXRlRmlsZSgnbGlzdC52bScpDQo=</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCSQob3B0aW9ucy53cmFwcGVyKS5vbigndGFwJywgJ2Rpdi5ub3RpZmljYXRpb24nLCBmdW5jdGlvbihlKXsNCgkJCQl2YXIgbiA9ICQodGhpcyk7DQoJCQkJaWYgKG4uaGFzQ2xhc3MoJ3VucmVhZCcpKSB7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5wdXQoew0KCQkJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvbm90aWZpY2F0aW9uL3tOb3RpZmljYXRpb25JZH0uanNvbicsDQoJCQkJCQlkYXRhOiB7DQoJCQkJCQkJTm90aWZpY2F0aW9uSWQ6IG4uZGF0YSgnbm90aWZpY2F0aW9uaWQnKSwNCgkJCQkJCQlNYXJrQXNSZWFkOiAnVHJ1ZScNCgkJCQkJCX0sDQoJCQkJCQlzdWNjZXNzOiBmdW5jdGlvbihyKSB7DQoJCQkJCQkJbi5yZW1vdmVDbGFzcygndW5yZWFkJyk7DQoJCQkJCQkJalF1ZXJ5LnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnB1Ymxpc2goJ25vdGlmaWNhdGlvbi5yZWFkJywgew0KCQkJCQkJCQl0eXBlSWQ6IG4uZGF0YSgnbm90aWZpY2F0aW9udHlwZWlkJyksDQoJCQkJCQkJCXVucmVhZENvdW50OiAnLT0xJw0KCQkJCQkJCX0pOw0KCQkJCQkJfQ0KCQkJCQl9KTsNCgkJCQkJLy8gZm9yY2UgYSByZWxvYWQgb2YgdGhpcyBwYWdlIG9uIG5leHQgdmlldyB0byBpbmRpY2F0ZSByZWFkIHN0YXRlDQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuY2xlYXJDb250ZW50KCk7DQoJCQkJfQ0KCQkJfSk7DQoNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2Nyb2xsYWJsZSh7DQoJCQkJcmVnaW9uOiAnY29udGVudCcsDQoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgew0KCQkJCQlpZiAoJChvcHRpb25zLndyYXBwZXIgKyAnIGRpdi5kYXRhOmxhc3QnKS5kYXRhKCdoYXNtb3JlJykpIHsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoew0KCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLA0KCQkJCQkJCWRhdGE6IHsNCgkJCQkJCQkJd19wYWdlSW5kZXg6IHBhZ2VJbmRleA0KCQkJCQkJCX0sDQoJCQkJCQkJc3VjY2VzczogZnVuY3Rpb24ocikgew0KCQkJCQkJCQlzdWNjZXNzKHIpOw0KCQkJCQkJCX0sDQoJCQkJCQkJZXJyb3I6IGZ1bmN0aW9uKCkgew0KCQkJCQkJCQllcnJvcigpOw0KCQkJCQkJCX0NCgkJCQkJCX0pOw0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJc3VjY2VzcygpOw0KCQkJCQl9DQoJCQkJfSwNCgkJCQljb21wbGV0ZTogZnVuY3Rpb24oY29udGVudCkgew0KCQkJCQljb250ZW50ID0gJChjb250ZW50KS5jc3MoeyBvcGFjaXR5OiAwIH0pOw0KCQkJCQkkKG9wdGlvbnMud3JhcHBlcikuZmluZCgnZGl2Lm5vdGlmaWNhdGlvbnMnKS5hcHBlbmQoY29udGVudCk7DQoJCQkJCWNvbnRlbnQuZXZvbHV0aW9uVHJhbnNmb3JtKHsgb3BhY2l0eTogMSB9LCB7IGR1cmF0aW9uOiA0MDAgfSk7DQoJCQkJfQ0KCQkJfSk7DQoNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tZXNzYWdpbmcuc3Vic2NyaWJlKCdub3RpZmljYXRpb24ucmFpc2VkJywgZnVuY3Rpb24oZCkgew0KCQkJCWlmIChkLnR5cGVJZCAhPSBvcHRpb25zLmNvbnZlcnNhdGlvbk5vdGlmaWNhdGlvblR5cGVJZCkgew0KCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnJlZnJlc2goKTsNCgkJCQl9DQoJCQl9KTsNCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMubm90aWZpY2F0aW9uTGlzdCA9IGFwaTsNCg0KfSkoalF1ZXJ5KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:TagCloud_Name}" version="7.0.0.1" description="" instanceIdentifier="0b4c87a9fc284dcb9a159138e5309bd0" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="tag-cloud">
    <contentScript>
		

#set ($groupId = false)
#set ($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#if (!$groupId)
	$core_v2_widget.Hide()
#end
#set ($group = false)
#set ($group = $core_v2_group.Get("%{Id=$groupId}"))
#if (!$group)
	$core_v2_widget.Hide()
#end

#set ($maximumTags = $core_v2_widget.GetIntValue('maximumTags', 25))
#set ($minimumPostsPerTag = $core_v2_widget.GetIntValue('minimumPostsPerTag', 1))
#set ($currentTags = false)
#set ($currentTags = $mobile_v1_urlToken.Value('TagName'))
#set ($cssClasses = $core_v2_utility.MakeList('level-6','level-5','level-4','level-3','level-2','level-1'))


## build base tag query
#set ($query = "%{PageSize=100,PageIndex=0,SortBy='ContentCount',SortOrder='Descending', ContainerIds = $group.ContainerId}")

#if($currentTags)
	$query.Add('Tags', $currentTags)
#end

## load tags
#set ($tags = false)
#set ($tags = $core_v2_tags.List($query))
#set ($sortedTags = $core_v2_tags.Sort($tags, "%{ MinimumItemsPerTag = $minimumPostsPerTag, MaximumNumberOfTags = $maximumTags, CssClasses = $cssClasses }"))

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($group.Url)"&gt;$group.Name&lt;/a&gt;
		#if($currentTags)
			&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('group-tags',$groupId))"&gt;$core_v2_language.GetResource('TagCloud_Title')&lt;/a&gt;
		#end
		&lt;h1&gt;
			#if(!$currentTags)
				$core_v2_language.GetResource('TagCloud_Title')
			#else
				$core_v2_language.FormatString($core_v2_language.GetResource('TagCloud_Results_For'), $core_v2_encoding.HtmlEncode($currentTags))
			#end
		&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 40, 40, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
&lt;/div&gt;

&lt;div&gt;
	#foreach ($tag in $sortedTags)
	#beforeall
		&lt;ul class="tag-list"&gt;
	#each
		&lt;li class="tag-item ${tag.CssClass}"&gt;
			&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('group-tag', $group.Id, $tag.Name))"&gt;&lt;span&gt;&lt;/span&gt;$tag.Name&lt;/a&gt;
		&lt;/li&gt;
	#afterall
		&lt;/ul&gt;
	#nodata
		#if($currentTags)
			&lt;div class="tag-list"&gt;&lt;div class="message norecords"&gt;$core_v2_language.GetResource('TagCloud_NoSubTagsDefined')&lt;/div&gt;&lt;/div&gt;
		#else
			&lt;div class="tag-list"&gt;&lt;div class="message norecords"&gt;$core_v2_language.GetResource('TagCloud_NoTagsDefined')&lt;/div&gt;&lt;/div&gt;
		#end
	#end
&lt;/div&gt;

</contentScript>
    <configuration>
 
	&lt;propertyGroup id="options"&gt;
		&lt;property id="maximumTags" dataType="int" defaultValue="25"/&gt;
		&lt;property id="minimumPostsPerTag" dataType="int" defaultValue="1"/&gt;
	&lt;/propertyGroup&gt;

	</configuration>
    <languageResources>
<language key="en-us">
	<resource name="TagCloud_Name">Tag Cloud</resource>
	<resource name="TagCloud_Title">Tags</resource>
	<resource name="TagCloud_Results_For">{0}</resource>
	<resource name="TagCloud_NoTagsDefined">No tags have been created or used yet.</resource>
	<resource name="TagCloud_NoSubTagsDefined">Sorry, but there are no more tags available to filter with.</resource>
</language>
		</languageResources>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:TaggedContentList_Name}" version="7.0.0.1" description="" instanceIdentifier="26dca1e1a198492395e5a6b6f8a3d0ba" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="tagged-content-list">
    <contentScript>
		

#set ($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#set ($pageSize = $core_v2_widget.GetIntValue('pageSize', 5))
#set ($pageIndex = 0)

#set($group = false)
#set($group = $core_v2_group.Get("%{Id=$groupId}"))
#if (!$group)
	$core_v2_widget.Hide()
#end

&lt;div class="post-list tagged-content"&gt;
	$core_v2_widget.ExecuteFile('list.vm')
&lt;/div&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;

&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.taggedContentList.register({
		moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
				wrapper: '#$core_v2_widget.WrapperElementId',
		pageSize: $pageSize,
			showSubGroups: '$showSubGroups'
		});
	});
})
&lt;/script&gt;
		
</contentScript>
    <configuration>
	
	&lt;propertyGroup id="options"&gt;
		&lt;property id="pageSize" dataType="int" defaultValue="5" /&gt;
	&lt;/propertyGroup&gt;
	
</configuration>
    <languageResources>
	<language key="en-us">
		<resource name="TaggedContentList_Name">Tagged Content List</resource>
		<resource name="TaggedContentList_No_Items">There are no posts with the requested tag.</resource>
	</language>
</languageResources>
    <files>
      <file name="list.vm">I3NldCAoJGN1cnJlbnRUYWdzID0gZmFsc2UpDQojc2V0ICgkY3VycmVudFRhZ3MgPSAkbW9iaWxlX3YxX3VybFRva2VuLlZhbHVlKCdUYWdOYW1lJykpDQojaWYoISRjdXJyZW50VGFncykNCgkkY29yZV92Ml93aWRnZXQuSGlkZSgpDQojZW5kDQoNCiNzZXQgKCRxdWVyeSA9ICIleyBQYWdlU2l6ZSA9ICRwYWdlU2l6ZSwgUGFnZUluZGV4ID0gJHBhZ2VJbmRleCwgVGFncyA9ICRjdXJyZW50VGFncywgQ29udGFpbmVySWRzID0gJGdyb3VwLkNvbnRhaW5lcklkIH0iKQ0KI3NldCgkdGFnZ2VkQ29udGVudCA9ICRjb3JlX3YyX3RhZ2dlZENvbnRlbnQuTGlzdCgkcXVlcnkpKQ0KI2ZvcmVhY2goJGNvbnRlbnQgaW4gJHRhZ2dlZENvbnRlbnQpDQoJI3NldCgkYXZhdGFyVXJsID0gZmFsc2UpDQoJI2lmKCRjb250ZW50LkNvbnRlbnQpDQoJCSNzZXQoJGF2YXRhclVybCA9ICRjb250ZW50LkNvbnRlbnQuQXZhdGFyVXJsKQ0KCQkjaWYgKCEkYXZhdGFyVXJsICYmICRjb250ZW50LkNvbnRlbnQuQ3JlYXRlZEJ5VXNlcklkKQ0KCQkJI3NldCAoJHVzZXIgPSAkY29yZV92Ml91c2VyLkdldCgiJXtJZD0kY29udGVudC5Db250ZW50LkNyZWF0ZWRCeVVzZXJJZH0iKSkNCgkJCSNzZXQoJGF2YXRhclVybCA9ICR1c2VyLkF2YXRhclVybCkNCgkJI2VuZA0KCSNlbmQNCg0KCTxkaXYgY2xhc3M9InBvc3QtbGlzdC1pdGVtIGNvbnRlbnQtaXRlbSIgZGF0YS10YXJnZXR1cmw9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJGNvbnRlbnQuQ29udGVudC5VcmwpIj4NCgkJPGRpdiBjbGFzcz0icG9zdCI+DQoJCQk8ZGl2IGNsYXNzPSJhdmF0YXIiPg0KCQkJCSNpZigkYXZhdGFyVXJsKQ0KCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRjb250ZW50LkNvbnRlbnQuVXJsKSIgY2xhc3M9ImludGVybmFsLWxpbmsgdmlldy11c2VyLXByb2ZpbGUiPg0KCQkJCQkJJGNvcmVfdjJfdWkuR2V0UmVzaXplZEltYWdlSHRtbCgkYXZhdGFyVXJsLCA0MCwgNDAsICIle2JvcmRlcj0nMCcsIFJlc2l6ZU1ldGhvZD0nWm9vbUFuZENyb3AnLGJvcmRlcj0nMCd9IikNCgkJCQkJPC9hPg0KCQkJCSNlbmQNCgkJCTwvZGl2Pg0KCQkJPGRpdiBjbGFzcz0iY29udGVudCI+DQoJCQkJPGEgaHJlZj0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkY29udGVudC5Db250ZW50LlVybCkiPiRjb250ZW50LkNvbnRlbnQuSHRtbE5hbWUoJ1dlYicpPC9hPg0KCQkJPC9kaXY+DQoJCTwvZGl2Pg0KCTwvZGl2Pg0KI25vZGF0YQ0KCTxkaXYgY2xhc3M9InBvc3QtbGlzdC1pdGVtIGNvbnRlbnQtaXRlbSI+PGRpdiBjbGFzcz0ibWVzc2FnZSBub3JlY29yZHMiPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdUYWdnZWRDb250ZW50TGlzdF9Ob19JdGVtcycpPC9kaXY+PC9kaXY+DQojYWZ0ZXJhbGwNCgkjc2V0ICgkaGFzTW9yZSA9IGZhbHNlKQ0KCSNpZiAoJHRhZ2dlZENvbnRlbnQuVG90YWxDb3VudCA+ICgoJHRhZ2dlZENvbnRlbnQuUGFnZUluZGV4ICsgMSkgKiAkdGFnZ2VkQ29udGVudC5QYWdlU2l6ZSkpDQoJCSNzZXQoJGhhc01vcmUgPSB0cnVlKQ0KCSNlbmQNCgk8ZGl2IGNsYXNzPSJkYXRhIiAjaWYoJGhhc01vcmUpZGF0YS1oYXNtb3JlPSJ0cnVlIiNlbmQ+PC9kaXY+DQojZW5kDQo=</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSB0YWdnZWQgY29udGVudA0KIyMNCiNzZXQgKCRwYWdlSW5kZXggPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfcGFnZUluZGV4JykpDQojc2V0ICgkcGFnZVNpemUgPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfcGFnZVNpemUnKSkNCiNzZXQgKCRncm91cElkID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUludCgkbW9iaWxlX3YxX3VybFRva2VuLlZhbHVlKCdHcm91cElkJykpKQ0KI3NldCgkZ3JvdXAgPSBmYWxzZSkNCiNzZXQoJGdyb3VwID0gJGNvcmVfdjJfZ3JvdXAuR2V0KCIle0lkPSRncm91cElkfSIpKQ0KI2lmICghJGdyb3VwKQ0KCSRjb3JlX3YyX3dpZGdldC5IaWRlKCkNCiNlbmQNCiRjb3JlX3YyX3dpZGdldC5FeGVjdXRlRmlsZSgnbGlzdC52bScpDQo=</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2Nyb2xsYWJsZSh7DQoJCQkJcmVnaW9uOiAnY29udGVudCcsDQoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgew0KCQkJCQlpZiAoJChvcHRpb25zLndyYXBwZXIgKyAnIGRpdi5kYXRhOmxhc3QnKS5kYXRhKCdoYXNtb3JlJykpIHsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoew0KCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLA0KCQkJCQkJCWRhdGE6IHsNCgkJCQkJCQkJd19wYWdlU2l6ZTogb3B0aW9ucy5wYWdlU2l6ZSwNCgkJCQkJCQkJd19wYWdlSW5kZXg6IHBhZ2VJbmRleA0KCQkJCQkJCX0sDQoJCQkJCQkJc3VjY2VzczogZnVuY3Rpb24ocikgew0KCQkJCQkJCQlzdWNjZXNzKHIpOw0KCQkJCQkJCX0sDQoJCQkJCQkJZXJyb3I6IGZ1bmN0aW9uKCkgew0KCQkJCQkJCQllcnJvcigpOw0KCQkJCQkJCX0NCgkJCQkJCX0pOw0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJc3VjY2VzcygpOw0KCQkJCQl9DQoJCQkJfSwNCgkJCQljb21wbGV0ZTogZnVuY3Rpb24oY29udGVudCkgew0KCQkJCQljb250ZW50ID0gJChjb250ZW50KS5jc3MoeyBvcGFjaXR5OiAwIH0pOw0KCQkJCQkkKG9wdGlvbnMud3JhcHBlcikuZmluZCgnZGl2LnBvc3QtbGlzdCcpLmFwcGVuZChjb250ZW50KTsNCgkJCQkJY29udGVudC5ldm9sdXRpb25UcmFuc2Zvcm0oeyBvcGFjaXR5OiAxIH0sIHsgZHVyYXRpb246IDQwMCB9KTsNCgkJCQl9DQoJCQl9KTsNCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMudGFnZ2VkQ29udGVudExpc3QgPSBhcGk7DQoNCn0pKGpRdWVyeSk7</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:UserBanner_Name}" version="7.0.0.1" description="" instanceIdentifier="134293c01a044077869d09f20b300983" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="user-banner">
    <contentScript>


#set ($userId = false)
#set ($userId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('UserId')))
#if (!$userId)
	$core_v2_widget.Hide()
#end
#set ($user = false)
#set ($user = $core_v2_user.Get("%{ Id = $userId }"))
#if (!$user)
	$core_v2_widget.Hide()
#end

&lt;div class="banner"&gt;
	&lt;div class="avatar"&gt;
		$!core_v2_ui.GetResizedImageHtml($user.AvatarUrl, 120, 120, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }")
	&lt;/div&gt;
	&lt;h1&gt;$!user.DisplayName&lt;/h1&gt;

	&lt;div class="ui-links actions" data-maxlinks="0"&gt;
		&lt;ul&gt;
			#set ($accessingUser = $core_v2_user.Accessing)
			#if ($accessingUser)
				#if($user.Id != $accessingUser.Id)

					#set ($friendship = $core_v2_friendship.Get("%{ UserId = $accessingUser.Id, FriendId = $user.Id }"))

					## Currently friends or requesting
					#if ($friendship &amp;&amp; ($friendship.FriendshipState == 'Approved' || ($friendship.FriendshipState == 'Pending' &amp;&amp; $friendship.Requestor.Id == $accessingUser.Id)))
						#set ($cancelFriendshipLabel = $core_v2_language.GetResource('Unfriend'))
						#set ($cancelType = 'unfriend')
						#if ($friendship.FriendshipState == 'Pending')
							#set ($cancelType = 'cancel')
							#set ($cancelFriendshipLabel = $core_v2_language.GetResource('CancelRequest'))
						#end
						&lt;li&gt;
							&lt;a href="#" class="internal-link cancel-friendship" data-messagename="widget.${core_v2_widget.WrapperElementId}.cancel-friendship" data-requestorid="$accessingUser.Id" data-requesteeid="$user.Id" data-canceltype="$cancelType" &gt;$cancelFriendshipLabel&lt;/a&gt;
						&lt;/li&gt;

					## Requestee - accept/reject pending friendship
					#elseif($friendship &amp;&amp; $friendship.FriendshipState == 'Pending' &amp;&amp; $friendship.Recipient.Id == $accessingUser.Id)
						&lt;li&gt;
							&lt;a href="#" class="internal-link accept-friendship" data-messagename="widget.${core_v2_widget.WrapperElementId}.accept-friendship" data-requestorid="$user.Id" data-requesteeid="$accessingUser.Id"&gt;$core_v2_language.GetResource('AcceptRequest')&lt;/a&gt;
						&lt;/li&gt;
						&lt;li&gt;
							&lt;a href="#" class="internal-link reject-friendship" data-messagename="widget.${core_v2_widget.WrapperElementId}.reject-friendship" data-requestorid="$user.Id" data-requesteeid="$accessingUser.Id"&gt;$core_v2_language.GetResource('RejectRequest')&lt;/a&gt;
						&lt;/li&gt;

					## Not friends, allow requesting
					#else
						## Determine if a custom friend request messgae is needed.
						## This can be known by whether there would otherwise be a desktop modal URL available to provide one
						#set ($friendRequestUrl = false)
						#set ($friendRequestUrl = $core_v2_urls.RequestFriendship($user.Id))
						#if ($friendRequestUrl)
							## set friend request URL to use a specific mobile page
							#set ($friendRequestUrl = $mobile_v1_url.Format('user-requestfriendship', $user.Id))
						#end

						#set ($defaultRequestMessage = '')
						#set ($defaultRequestMessage = $core_v2_configuration.DefaultFriendshipRequestMessage)
						#set ($defaultRequestMessage = $core_v2_ui.FormatHtmlAsText($defaultRequestMessage))

						&lt;li&gt;
							&lt;a href="#"
								class="internal-link request-friendship"
								data-messagename="widget.${core_v2_widget.WrapperElementId}.request-friendship"
								data-requestorid="$accessingUser.Id"
								data-requesteeid="$user.Id"
								data-requesturl=#if($friendRequestUrl) "$core_v2_encoding.HtmlAttributeEncode($friendRequestUrl)" #else "" #end
								data-requestmessage="$core_v2_encoding.HtmlAttributeEncode($defaultRequestMessage)"&gt;
								$core_v2_language.GetResource('RequestFriendship')
							&lt;/a&gt;
						&lt;/li&gt;
					#end

					#set ($follows = 'false')
					#set ($followLink = $core_v2_language.GetResource('Follow'))
					#if ($core_v2_following.Get($accessingUser.Id, "%{ FollowingId = $userId }"))
						#set ($follows = 'true')
						#set ($followLink = $core_v2_language.GetResource('Unfollow'))
					#end
					&lt;li&gt;
						&lt;a href="#" data-messagename="widget.${core_v2_widget.WrapperElementId}.user-follow" data-followerId="$accessingUser.Id" data-followingId="$userId" data-follows="$follows"&gt;$followLink&lt;/a&gt;
					&lt;/li&gt;

					#if ($core_v2_urls.AddConversation($userId))
						&lt;li&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('conversation-add-touser', $userId))"&gt;$core_v2_language.GetResource('SendMessage')&lt;/a&gt;&lt;/li&gt;
					#end
				#end
				&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;$core_v2_language.GetResource('more')&lt;/a&gt;&lt;/li&gt;
				&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;

			#end
		&lt;/ul&gt;
	&lt;/div&gt;

	#set ($navigationItems = $core_v2_customNavigation.FromWidget($core_v2_utility.ParseGuid('19e9689493a4449eb063e61762da2ea4'), 'navigation', "%{Url=$core_v2_page.Url, UserId=$user.Id}"))
	#foreach ($navigationItem in $navigationItems)
		#beforeall
		&lt;div class="ui-links applications" data-minlinks="100" data-animate="true"&gt;
			&lt;ul&gt;
		#each
			#if ($mobile_v1_url.IsRedirected($navigationItem.Url) &amp;&amp; $navigationItem.CssClass != 'internal-link view-user-profile')
				&lt;li&gt;
					&lt;a href="$core_v2_encoding.HtmlAttributeEncode($navigationItem.Url)"&gt;$navigationItem.Label&lt;/a&gt;
				&lt;/li&gt;
			#end
		#afterall
				&lt;li class="application-more"&gt;&lt;a href="#" data-more&gt;$core_v2_language.GetResource('more')&lt;/a&gt;&lt;/li&gt;
				&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
			&lt;/ul&gt;
		&lt;/div&gt;
	#end
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.userBanner.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			followText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('Follow'))',
			unfollowText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('Unfollow'))',
			followedText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('Followed'))',
			unfollowedText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('Unfollowed'))',

			messageFollow: 'widget.${core_v2_widget.WrapperElementId}.user-follow',
			messageRequestFriendship: 'widget.${core_v2_widget.WrapperElementId}.request-friendship',
			messageCancelFriendship: 'widget.${core_v2_widget.WrapperElementId}.cancel-friendship',
			messageAcceptFriendship: 'widget.${core_v2_widget.WrapperElementId}.accept-friendship',
			messageRejectFriendship: 'widget.${core_v2_widget.WrapperElementId}.reject-friendship',

			unfriendConfirmation: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UnfriendConfirmation'))',
			cancelConfirmation: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('CancelRequestConfirmation'))',
			unfriendComplete: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UnfriendComplete'))',
			cancelComplete: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('CancelRequestComplete'))',
			acceptComplete: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('AcceptComplete'))',
			rejectComplete: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('RejectComplete'))',
			requestComplete: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('RequestComplete'))'
		});
	});
});
&lt;/script&gt;


	</contentScript>
    <languageResources>
		<language key="en-us">
			<resource name="UserBanner_Name">User Banner</resource>
			<resource name="SendMessage">Send a Message</resource>
			<resource name="Follow">Start Following</resource>
			<resource name="Unfollow">Stop Following</resource>
			<resource name="Followed">Following started</resource>
			<resource name="Unfollowed">Following stopped</resource>
			<resource name="RequestFriendship">Request friendship</resource>
			<resource name="Unfriend">Unfriend</resource>
			<resource name="CancelRequest">Cancel friendship request</resource>
			<resource name="AcceptRequest">Accept friend request</resource>
			<resource name="RejectRequest">Reject friend request</resource>
			<resource name="cancel">Cancel</resource>
			<resource name="more">More</resource>
			<resource name="UnfriendConfirmation">Are you sure you want to unfriend this person?</resource>
			<resource name="CancelRequestConfirmation">Are you sure you want to cancel this friendship request?</resource>
			<resource name="UnfriendComplete">Unfriended</resource>
			<resource name="CancelRequestComplete">Request canceled</resource>
			<resource name="AcceptComplete">Friendship accepted</resource>
			<resource name="RejectComplete">Friendship rejected</resource>
			<resource name="RequestComplete">Friendship requested</resource>
		</language>
	</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIG1vZGVsID0gew0KCQlzdGFydEZvbGxvd2luZzogZnVuY3Rpb24gKGZvbGxvd2VySWQsIGZvbGxvd2luZ0lkKSB7DQoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygkLnRlbGxpZ2VudC5ldm9sdXRpb24ucG9zdCh7DQoJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvdXNlcnMve0ZvbGxvd2VySWR9L2ZvbGxvd2luZy5qc29uJywNCgkJCQlkYXRhOiB7DQoJCQkJCUZvbGxvd2VySWQ6IGZvbGxvd2VySWQsDQoJCQkJCUZvbGxvd2luZ0lkOiBmb2xsb3dpbmdJZA0KCQkJCX0NCgkJCX0pKTsNCgkJfSwNCg0KCQlzdG9wRm9sbG93aW5nOiBmdW5jdGlvbiAoZm9sbG93ZXJJZCwgZm9sbG93aW5nSWQpIHsNCgkJCXJldHVybiAkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNob3dMb2FkaW5nKCQudGVsbGlnZW50LmV2b2x1dGlvbi5kZWwoew0KCQkJCXVybDogJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ2FwaS5hc2h4L3YyL3VzZXJzL3tGb2xsb3dlcklkfS9mb2xsb3dpbmcve0ZvbGxvd2luZ0lkfS5qc29uJywNCgkJCQlkYXRhOiB7DQoJCQkJCUZvbGxvd2VySWQ6IGZvbGxvd2VySWQsDQoJCQkJCUZvbGxvd2luZ0lkOiBmb2xsb3dpbmdJZA0KCQkJCX0NCgkJCX0pKTsNCgkJfSwNCg0KCQlyZXF1ZXN0RnJpZW5kc2hpcDogZnVuY3Rpb24ocmVxdWVzdG9ySWQsIHJlcXVlc3RlZUlkLCByZXF1ZXN0TWVzc2FnZSkgew0KCQkJcmV0dXJuICQudGVsbGlnZW50LmV2b2x1dGlvbi5wb3N0KHsNCgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi91c2Vycy97UmVxdWVzdG9ySWR9L2ZyaWVuZHMuanNvbicsDQoJCQkJZGF0YTogew0KCQkJCQlSZXF1ZXN0b3JJZDogcmVxdWVzdG9ySWQsDQoJCQkJCVJlcXVlc3RlZUlkOiByZXF1ZXN0ZWVJZCwNCgkJCQkJUmVxdWVzdE1lc3NhZ2U6IChyZXF1ZXN0TWVzc2FnZSB8fCAnJykNCgkJCQl9DQoJCQl9KTsNCgkJfSwNCg0KCQljYW5jZWxGcmllbmRzaGlwOiBmdW5jdGlvbihyZXF1ZXN0b3JJZCwgcmVxdWVzdGVlSWQpIHsNCgkJCXJldHVybiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uZGVsKHsNCgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi91c2Vycy97UmVxdWVzdG9ySWR9L2ZyaWVuZHMve1JlcXVlc3RlZUlkfS5qc29uJywNCgkJCQlkYXRhOiB7DQoJCQkJCVJlcXVlc3RvcklkOiByZXF1ZXN0b3JJZCwNCgkJCQkJUmVxdWVzdGVlSWQ6IHJlcXVlc3RlZUlkDQoJCQkJfQ0KCQkJfSk7DQoJCX0sDQoNCgkJYWNjZXB0RnJpZW5kc2hpcDogZnVuY3Rpb24ocmVxdWVzdG9ySWQsIHJlcXVlc3RlZUlkKSB7DQoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7DQoJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvdXNlcnMve1JlcXVlc3RvcklkfS9mcmllbmRzL3tSZXF1ZXN0ZWVJZH0uanNvbicsDQoJCQkJZGF0YTogew0KCQkJCQlSZXF1ZXN0b3JJZDogcmVxdWVzdG9ySWQsDQoJCQkJCVJlcXVlc3RlZUlkOiByZXF1ZXN0ZWVJZCwNCgkJCQkJRnJpZW5kc2hpcFN0YXRlOiAnQXBwcm92ZWQnDQoJCQkJfQ0KCQkJfSk7DQoJCX0sDQoNCgkJcmVqZWN0RnJpZW5kc2hpcDogZnVuY3Rpb24ocmVxdWVzdG9ySWQsIHJlcXVlc3RlZUlkKSB7DQoJCQlyZXR1cm4gdGhpcy5jYW5jZWxGcmllbmRzaGlwKHJlcXVlc3RvcklkLCByZXF1ZXN0ZWVJZCk7DQoJCX0NCgl9DQoNCglmdW5jdGlvbiBoYW5kbGVBY3Rpb25zKGNvbnRleHQpIHsNCgkJdmFyIG9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmU7DQoNCgkJLy8gZm9sbG93L3VuZm9sbG93DQoJCW9uKGNvbnRleHQubWVzc2FnZUZvbGxvdywgZnVuY3Rpb24gKGRhdGEpIHsNCgkJCXZhciB0YXJnZXQgPSAkKGRhdGEudGFyZ2V0KTsNCgkJCWlmICghdGFyZ2V0Lmhhc0NsYXNzKCJwcm9jZXNzaW5nIikpIHsNCgkJCQl0YXJnZXQuYWRkQ2xhc3MoInByb2Nlc3NpbmciKS50ZXh0KCcuLi4nKTsNCgkJCQl2YXIgZm9sbG93cyA9IHRhcmdldC5kYXRhKCdmb2xsb3dzJyk7DQoJCQkJdmFyIGFjdGlvbiA9IGZvbGxvd3MgPyBtb2RlbC5zdG9wRm9sbG93aW5nIDogbW9kZWwuc3RhcnRGb2xsb3dpbmc7DQoJCQkJYWN0aW9uKHRhcmdldC5kYXRhKCdmb2xsb3dlcmlkJyksIHRhcmdldC5kYXRhKCdmb2xsb3dpbmdpZCcpKQ0KCQkJCQkuZG9uZShmdW5jdGlvbiAoKSB7DQoJCQkJCQlmb2xsb3dzID0gIWZvbGxvd3M7DQoJCQkJCQl0YXJnZXQuZGF0YSgnZm9sbG93cycsIGZvbGxvd3MpOw0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5kaXNwbGF5TWVzc2FnZSgNCgkJCQkJCQkhZm9sbG93cyA/IGNvbnRleHQudW5mb2xsb3dlZFRleHQgOiBjb250ZXh0LmZvbGxvd2VkVGV4dCwgew0KCQkJCQkJCQlkaXNhcHBlYXJBZnRlcjogNTAwMCwNCgkJCQkJCQkJY3NzQ2xhc3M6ICdpbmZvJw0KCQkJCQkJCX0pOw0KCQkJCQl9KQ0KCQkJCQkuYWx3YXlzKGZ1bmN0aW9uICgpIHsNCgkJCQkJCXRhcmdldC5yZW1vdmVDbGFzcygicHJvY2Vzc2luZyIpDQoJCQkJCQkJICAudGV4dChmb2xsb3dzID8gY29udGV4dC51bmZvbGxvd1RleHQgOiBjb250ZXh0LmZvbGxvd1RleHQgKTsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuaGlkZVNoZWV0KCk7DQoJCQkJCX0pOw0KCQkJfQ0KCQl9KTsNCg0KCQkvLyByZXF1ZXN0IGZyaWVuZHNoaXANCgkJb24oY29udGV4dC5tZXNzYWdlUmVxdWVzdEZyaWVuZHNoaXAsIGZ1bmN0aW9uKGRhdGEpIHsNCgkJCXZhciB0YXJnZXQgPSAkKGRhdGEudGFyZ2V0KTsNCgkJCXZhciByZXF1ZXN0VXJsID0gdGFyZ2V0LmRhdGEoJ3JlcXVlc3R1cmwnKTsNCgkJCS8vIGlmIHRoaXMgcmVxdWlyZXMgYSBjdXN0b20gcmVxdWVzdCwgc2hvdyB0aGF0IHBhZ2UNCgkJCWlmKHJlcXVlc3RVcmwpIHsNCgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmxvYWQocmVxdWVzdFVybCk7DQoJCQl9IGVsc2Ugew0KCQkJCW1vZGVsLnJlcXVlc3RGcmllbmRzaGlwKHRhcmdldC5kYXRhKCdyZXF1ZXN0b3JpZCcpLCB0YXJnZXQuZGF0YSgncmVxdWVzdGVlaWQnKSwgdGFyZ2V0LmRhdGEoJ3JlcXVlc3RtZXNzYWdlJykpDQoJCQkJCS5kb25lKGZ1bmN0aW9uKCkgew0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5kaXNwbGF5TWVzc2FnZShjb250ZXh0LnJlcXVlc3RDb21wbGV0ZSwgew0KCQkJCQkJCWRpc2FwcGVhckFmdGVyOiA1MDAwLA0KCQkJCQkJCWNzc0NsYXNzOiAnaW5mbycNCgkJCQkJCX0pOw0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5yZWZyZXNoKCk7DQoJCQkJCX0pDQoJCQkJCS5hbHdheXMoZnVuY3Rpb24oKXsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuaGlkZVNoZWV0KCk7DQoJCQkJCX0pOw0KCQkJfQ0KCQl9KTsNCg0KCQkvLyB1bmZyaWVuZCBvciBjYW5jZWwgcmVxdWVzdA0KCQlvbihjb250ZXh0Lm1lc3NhZ2VDYW5jZWxGcmllbmRzaGlwLCBmdW5jdGlvbihkYXRhKSB7DQoJCQl2YXIgdGFyZ2V0ID0gJChkYXRhLnRhcmdldCk7DQoJCQlpZihjb25maXJtKHRhcmdldC5kYXRhKCdjYW5jZWx0eXBlJykgPT09ICd1bmZyaWVuZCcgPyBjb250ZXh0LnVuZnJpZW5kQ29uZmlybWF0aW9uIDogY29udGV4dC5jYW5jZWxDb25maXJtYXRpb24pKSB7DQoJCQkJbW9kZWwuY2FuY2VsRnJpZW5kc2hpcCh0YXJnZXQuZGF0YSgncmVxdWVzdG9yaWQnKSwgdGFyZ2V0LmRhdGEoJ3JlcXVlc3RlZWlkJykpDQoJCQkJCS5kb25lKGZ1bmN0aW9uKCkgew0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5kaXNwbGF5TWVzc2FnZSgodGFyZ2V0LmRhdGEoJ2NhbmNlbHR5cGUnKSA9PT0gJ3VuZnJpZW5kJyA/IGNvbnRleHQudW5mcmllbmRDb21wbGV0ZSA6IGNvbnRleHQuY2FuY2VsQ29tcGxldGUpLCB7DQoJCQkJCQkJZGlzYXBwZWFyQWZ0ZXI6IDUwMDAsDQoJCQkJCQkJY3NzQ2xhc3M6ICdpbmZvJw0KCQkJCQkJfSk7DQoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnJlZnJlc2goKTsNCgkJCQkJfSkNCgkJCQkJLmFsd2F5cyhmdW5jdGlvbigpew0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlU2hlZXQoKTsNCgkJCQkJfSk7DQoJCQl9DQoJCX0pOw0KDQoJCS8vIGFjY2VwdCByZXF1ZXN0DQoJCW9uKGNvbnRleHQubWVzc2FnZUFjY2VwdEZyaWVuZHNoaXAsIGZ1bmN0aW9uKGRhdGEpIHsNCgkJCXZhciB0YXJnZXQgPSAkKGRhdGEudGFyZ2V0KTsNCgkJCW1vZGVsLmFjY2VwdEZyaWVuZHNoaXAodGFyZ2V0LmRhdGEoJ3JlcXVlc3RvcmlkJyksIHRhcmdldC5kYXRhKCdyZXF1ZXN0ZWVpZCcpKQ0KCQkJCS5kb25lKGZ1bmN0aW9uKCkgew0KCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmRpc3BsYXlNZXNzYWdlKGNvbnRleHQuYWNjZXB0Q29tcGxldGUsIHsNCgkJCQkJCWRpc2FwcGVhckFmdGVyOiA1MDAwLA0KCQkJCQkJY3NzQ2xhc3M6ICdpbmZvJw0KCQkJCQl9KTsNCgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5yZWZyZXNoKCk7DQoJCQkJfSkNCgkJCQkuYWx3YXlzKGZ1bmN0aW9uKCl7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuaGlkZVNoZWV0KCk7DQoJCQkJfSk7DQoJCX0pOw0KDQoJCS8vIHJlamVjdCByZXF1ZXN0DQoJCW9uKGNvbnRleHQubWVzc2FnZVJlamVjdEZyaWVuZHNoaXAsIGZ1bmN0aW9uKGRhdGEpIHsNCgkJCXZhciB0YXJnZXQgPSAkKGRhdGEudGFyZ2V0KTsNCgkJCW1vZGVsLnJlamVjdEZyaWVuZHNoaXAodGFyZ2V0LmRhdGEoJ3JlcXVlc3RvcmlkJyksIHRhcmdldC5kYXRhKCdyZXF1ZXN0ZWVpZCcpKQ0KCQkJCS5kb25lKGZ1bmN0aW9uKCkgew0KCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmRpc3BsYXlNZXNzYWdlKGNvbnRleHQucmVqZWN0Q29tcGxldGUsIHsNCgkJCQkJCWRpc2FwcGVhckFmdGVyOiA1MDAwLA0KCQkJCQkJY3NzQ2xhc3M6ICdpbmZvJw0KCQkJCQl9KTsNCgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5yZWZyZXNoKCk7DQoJCQkJfSkNCgkJCQkuYWx3YXlzKGZ1bmN0aW9uKCl7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuaGlkZVNoZWV0KCk7DQoJCQkJfSk7DQoJCX0pOw0KCX0NCg0KCXZhciBhcGkgPSB7DQoJCXJlZ2lzdGVyOiBmdW5jdGlvbihvcHRpb25zKSB7DQoJCQloYW5kbGVBY3Rpb25zKG9wdGlvbnMpOw0KCQl9DQoJfQ0KDQoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24gPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24gfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy51c2VyQmFubmVyID0gYXBpOw0KDQp9KShqUXVlcnkpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:UserBio_Name}" version="7.0.0.1" description="" instanceIdentifier="5f626adb9e784d19898bd6c488fb7ac9" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="user-bio">
    <contentScript>
			

			#set ($userId = false)
			#set ($userId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('UserId')))
			#if (!$userId)
			$core_v2_widget.Hide()
			#end
			#set ($user = false)
			#set ($user = $core_v2_user.Get("%{ Id = $userId }"))
			#if (!$user)
			$core_v2_widget.Hide()
			#end

			&lt;div class="profile"&gt;
				&lt;div class="profile-field-list"&gt;
					&lt;div class="profile-field"&gt;
						&lt;div class="label"&gt;$!core_v2_language.FormatString($core_v2_language.GetResource('UserProfile_Bio'), $user.DisplayName)&lt;/div&gt;
						#set($bio = false)
						#set($bio = $user.Bio())
						#if ($bio &amp;&amp; $core_v2_utility.Trim($bio) != "")
						&lt;div class="value user-generated-content"&gt;$mobile_v1_dataFormat.Detect($bio)&lt;/div&gt;
						#else
						&lt;div class="value"&gt;$core_v2_language.FormatString($core_v2_language.GetResource('UserProfile_Bio_NotEntered'), $user.DisplayName)&lt;/div&gt;
						#end
					&lt;/div&gt;
				&lt;/div&gt;
			&lt;/div&gt;
			
		</contentScript>
    <languageResources>
			<language key="en-us">
				<resource name="UserBio_Name">User Biography</resource>
				<resource name="UserProfile_Bio">About {0}</resource>
				<resource name="UserProfile_Bio_NotEntered">{0} has not entered a biography.</resource>
			</language>
		</languageResources>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:UserBookmarks_Name}" version="7.0.0.1" description="" instanceIdentifier="c3b4a8778b3c4d988e25c8fe886da9e0" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="user-bookmarks">
    <contentScript>


#set ($userId = false)
#set ($userId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('UserId')))
#if (!$userId)
	$core_v2_widget.Hide()
#end
#set ($user = false)
#set ($user = $core_v2_user.Get("%{ Id = $userId }"))
#if (!$user)
	$core_v2_widget.Hide()
#end

## hide widget if the contextual user hasn't enabled favorite sharing
#if (!$user.EnableFavoriteSharing &amp;&amp; $user.Id != $core_v2_user.Accessing.Id)
	$core_v2_widget.Hide()
#end

#set($pageSize = $core_v2_widget.GetIntValue('pageSize', 5))
#set($pageIndex = 0)

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($user.ProfileUrl)"&gt;$user.DisplayName&lt;/a&gt;
		&lt;h1&gt;$!core_v2_language.FormatString($core_v2_language.GetResource('Core_UserBookmarks_Title'), $user.DisplayName)&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$!core_v2_ui.GetResizedImageHtml($user.AvatarUrl, 40, 40, "%{ alt = $user.DisplayName, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
&lt;/div&gt;

#set($filter = false)
#set($filter = $core_v2_page.GetQueryStringValue('w_filter'))
#if (!$filter)
	#set($filter = 'content')
#end
&lt;div class="ui-links filters" data-minlinks="50" data-animate="true"&gt;
	&lt;ul class="activity-filters"&gt;
		&lt;li&gt;&lt;a href="#" data-filter="content" #if($filter == 'content') data-selected #end&gt;$core_v2_language.GetResource('Core_UserBookmarks_ContentLink')&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;&lt;a href="#" data-filter="applications" #if($filter == 'applications') data-selected #end&gt;$core_v2_language.GetResource('Core_UserBookmarks_ApplicationsLink')&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;&lt;a href="#" data-filter="groups" #if($filter == 'groups') data-selected #end&gt;$core_v2_language.GetResource('Core_UserBookmarks_GroupsLink')&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;&lt;a href="#" data-filter="people" #if($filter == 'people') data-selected #end&gt;$core_v2_language.GetResource('Core_UserBookmarks_PeopleLink')&lt;/a&gt;&lt;/li&gt;
	&lt;/ul&gt;
&lt;/div&gt;

## load and render bookmarks
&lt;div class="post-list bookmarks $filter"&gt;
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.userBookmarks.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
		filter: '$filter',
		moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
		pageSize: $pageSize
		});
	});
});
&lt;/script&gt;


</contentScript>
    <configuration>
	
		
	
</configuration>
    <languageResources>
	<language key="en-us">
		<resource name="UserBookmarks_Name">Bookmarks</resource>
		<resource name="Core_UserBookmarks_ContentLink">Content</resource>
		<resource name="Core_UserBookmarks_ApplicationsLink">Applications</resource>
		<resource name="Core_UserBookmarks_GroupsLink">Groups</resource>
		<resource name="Core_UserBookmarks_PeopleLink">People</resource>
		<resource name="Core_UserBookmarks_Title">Bookmarks</resource>
		<resource name="Core_UserBookmarks_No_Bookmarks">{0} has no bookmarks of this type. </resource>
	</language>
</languageResources>
    <files>
      <file name="list.vm">I3NldCAoJGNvbnRlbnRUeXBlcyA9ICcnKQ0KI2lmICgkZmlsdGVyID09ICdjb250ZW50JykNCgkjc2V0ICgkY29udGVudFR5cGVzID0gIiRjb3JlX3YyX2ZvcnVtVGhyZWFkLkNvbnRlbnRUeXBlSWQsJGNvcmVfdjJfd2lraVBhZ2UuQ29udGVudFR5cGVJZCwkY29yZV92Ml9ibG9nUG9zdC5Db250ZW50VHlwZUlkLCRjb3JlX3YyX21lZGlhLkNvbnRlbnRUeXBlSWQiKQ0KI2Vsc2VpZiAoJGZpbHRlciA9PSAnYXBwbGljYXRpb25zJykNCgkjc2V0ICgkY29udGVudFR5cGVzID0gIiRjb3JlX3YyX2ZvcnVtLkFwcGxpY2F0aW9uVHlwZUlkLCRjb3JlX3YyX3dpa2kuQXBwbGljYXRpb25UeXBlSWQsJGNvcmVfdjJfYmxvZy5BcHBsaWNhdGlvblR5cGVJZCwkY29yZV92Ml9nYWxsZXJ5LkFwcGxpY2F0aW9uVHlwZUlkIikNCiNlbHNlaWYgKCRmaWx0ZXIgPT0gJ2dyb3VwcycpDQoJI3NldCAoJGNvbnRlbnRUeXBlcyA9ICIkY29yZV92Ml9ncm91cC5Db250YWluZXJUeXBlSWQiKQ0KI2Vsc2VpZiAoJGZpbHRlciA9PSAncGVvcGxlJykNCgkjc2V0ICgkY29udGVudFR5cGVzID0gIiRjb3JlX3YyX3VzZXIuQ29udGVudFR5cGVJZCIpDQojZW5kDQoNCiNzZXQgKCRib29rbWFya3MgPSAkY29yZV92Ml9ib29rbWFyay5MaXN0KCIleyBVc2VySWQgPSAkdXNlcklkLCBQYWdlU2l6ZSA9ICRwYWdlU2l6ZSwgUGFnZUluZGV4ID0gJHBhZ2VJbmRleCwgQ29udGVudFR5cGVJZHMgPSAkY29udGVudFR5cGVzfSIpKQ0KDQojZm9yZWFjaCAoJGJvb2ttYXJrIGluICRib29rbWFya3MpDQojZWFjaA0KCSNzZXQoJGF2YXRhclVybCA9IGZhbHNlKQ0KCSNpZigkYm9va21hcmsuQ29udGVudCkNCgkJI3NldCgkYXZhdGFyVXJsID0gJGJvb2ttYXJrLkNvbnRlbnQuQXZhdGFyVXJsKQ0KCQkjaWYgKCEkYXZhdGFyVXJsKQ0KCQkJI3NldCgkYXZhdGFyVXJsID0gJGJvb2ttYXJrLkNvbnRlbnQuQXBwbGljYXRpb24uQXZhdGFyVXJsKQ0KCQkJI2lmICghJGF2YXRhclVybCkNCgkJCQkjc2V0KCRhdmF0YXJVcmwgPSAkYm9va21hcmsuQ29udGVudC5BcHBsaWNhdGlvbi5Db250YWluZXIuQXZhdGFyVXJsKQ0KCQkJI2VuZA0KCQkjZW5kDQoJI2VuZA0KDQoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIGJvb2ttYXJrIiBkYXRhLXRhcmdldHVybD0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkYm9va21hcmsuQ29udGVudC5VcmwpIj4NCgkJPGRpdiBjbGFzcz0icG9zdCI+DQoJCQk8ZGl2IGNsYXNzPSJhdmF0YXIiPg0KCQkJCSNpZigkYXZhdGFyVXJsKQ0KCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRib29rbWFyay5Db250ZW50LlVybCkiIGNsYXNzPSJpbnRlcm5hbC1saW5rIHZpZXctdXNlci1wcm9maWxlIj4NCgkJCQkJCSRjb3JlX3YyX3VpLkdldFJlc2l6ZWRJbWFnZUh0bWwoJGF2YXRhclVybCwgNDAsIDQwLCAiJXtib3JkZXI9JzAnLCBhbHQ9JGFsdCwgUmVzaXplTWV0aG9kPSdab29tQW5kQ3JvcCcsYm9yZGVyPScwJ30iKQ0KCQkJCQk8L2E+DQoJCQkJI2VuZA0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJjb250ZW50Ij4NCgkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRib29rbWFyay5Db250ZW50LlVybCkiPiRib29rbWFyay5Db250ZW50Lkh0bWxOYW1lKCJXZWIiKTwvYT4NCgkJCTwvZGl2Pg0KCQk8L2Rpdj4NCgk8L2Rpdj4NCiNub2RhdGENCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gYm9va21hcmtzIj48ZGl2IGNsYXNzPSJtZXNzYWdlIG5vcmVjb3JkcyI+JGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0U3RyaW5nKCRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdDb3JlX1VzZXJCb29rbWFya3NfTm9fQm9va21hcmtzJyksICR1c2VyLkRpc3BsYXlOYW1lKTwvZGl2PjwvZGl2Pg0KI2FmdGVyYWxsDQoJI3NldCAoJGhhc01vcmUgPSBmYWxzZSkNCgkjaWYgKCRib29rbWFya3MuVG90YWxDb3VudCA+ICgoJGJvb2ttYXJrcy5QYWdlSW5kZXggKyAxKSAqICRib29rbWFya3MuUGFnZVNpemUpKQ0KCQkjc2V0KCRoYXNNb3JlID0gdHJ1ZSkNCgkjZW5kDQoJPGRpdiBjbGFzcz0iZGF0YSIgI2lmKCRoYXNNb3JlKWRhdGEtaGFzbW9yZT0idHJ1ZSIjZW5kPjwvZGl2Pg0KI2VuZA0K</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBib29rbWFya3MNCiMjDQoNCiNzZXQgKCRwYWdlSW5kZXggPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfcGFnZUluZGV4JykpDQojc2V0ICgkcGFnZVNpemUgPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfcGFnZVNpemUnKSkNCg0KI3NldCAoJHVzZXJJZCA9IGZhbHNlKQ0KI3NldCAoJHVzZXJJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJG1vYmlsZV92MV91cmxUb2tlbi5WYWx1ZSgnVXNlcklkJykpKQ0KI2lmICghJHVzZXJJZCkNCgkkY29yZV92Ml93aWRnZXQuSGlkZSgpDQojZW5kDQoNCiNzZXQoJGZpbHRlciA9IGZhbHNlKQ0KI3NldCgkZmlsdGVyID0gJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X2ZpbHRlcicpKQ0KI2lmICghJGZpbHRlcikNCgkjc2V0KCRmaWx0ZXIgPSAnY29udGVudCcpDQojZW5kDQoNCiRjb3JlX3YyX3dpZGdldC5FeGVjdXRlRmlsZSgnbGlzdC52bScpDQo=</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCg0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5hZGRSZWZyZXNoUGFyYW1ldGVyKCd3X2ZpbHRlcicsIG9wdGlvbnMuZmlsdGVyKTsNCg0KCQkJJChvcHRpb25zLndyYXBwZXIgKyAnIC5maWx0ZXJzIGEnKS5vbigndGFwJywgZnVuY3Rpb24oZSkgew0KCQkJCXZhciBmaWx0ZXIgPSAkKHRoaXMpLmRhdGEoJ2ZpbHRlcicpOw0KCQkJCWlmIChmaWx0ZXIgIT0gb3B0aW9ucy5maWx0ZXIpIHsNCgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5hZGRSZWZyZXNoUGFyYW1ldGVyKCd3X2ZpbHRlcicsIGZpbHRlcik7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUucmVmcmVzaCgpOw0KCQkJCX0NCgkJCQlyZXR1cm4gZmFsc2U7DQoJCQl9KTsNCg0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zY3JvbGxhYmxlKHsNCgkJCQlyZWdpb246ICdjb250ZW50JywNCgkJCQlsb2FkOiBmdW5jdGlvbihwYWdlSW5kZXgsIHN1Y2Nlc3MsIGVycm9yKSB7DQoJCQkJCWlmICgkKCcuYm9va21hcmtzLicgKyBvcHRpb25zLmZpbHRlciArICcgZGl2LmRhdGE6bGFzdCcpLmRhdGEoJ2hhc21vcmUnKSkgew0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLmdldCh7DQoJCQkJCQkJdXJsOiBvcHRpb25zLm1vcmVVcmwsDQoJCQkJCQkJZGF0YTogew0KCQkJCQkJCQl3X3BhZ2VJbmRleDogcGFnZUluZGV4LA0KCQkJCQkJCQl3X3BhZ2VTaXplOiBvcHRpb25zLnBhZ2VTaXplDQoJCQkJCQkJfSwNCgkJCQkJCQlzdWNjZXNzOiBmdW5jdGlvbihyKSB7DQoJCQkJCQkJCXN1Y2Nlc3Mocik7DQoJCQkJCQkJfSwNCgkJCQkJCQllcnJvcjogZnVuY3Rpb24oKSB7DQoJCQkJCQkJCWVycm9yKCk7DQoJCQkJCQkJfQ0KCQkJCQkJfSk7DQoJCQkJCX0gZWxzZSB7DQoJCQkJCQlzdWNjZXNzKCk7DQoJCQkJCX0NCgkJCQl9LA0KCQkJCWNvbXBsZXRlOiBmdW5jdGlvbihjb250ZW50KSB7DQoJCQkJCWNvbnRlbnQgPSAkKGNvbnRlbnQpLmNzcyh7IG9wYWNpdHk6IDAgfSk7DQoJCQkJCSQoJ2Rpdi5wb3N0LWxpc3QuYm9va21hcmtzLicgKyBvcHRpb25zLmZpbHRlcikuYXBwZW5kKGNvbnRlbnQpOw0KCQkJCQljb250ZW50LmV2b2x1dGlvblRyYW5zZm9ybSh7IG9wYWNpdHk6IDEgfSwgeyBkdXJhdGlvbjogNDAwIH0pOw0KCQkJCX0NCgkJCX0pOw0KDQoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnN1YnNjcmliZSgidWkuYm9va21hcmsiLCBmdW5jdGlvbihkYXRhKSB7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5yZWZyZXNoKCk7DQoJCQl9KTsNCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMudXNlckJvb2ttYXJrcyA9IGFwaTsNCg0KfSkoalF1ZXJ5KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:UserFriendshipRequest_Name}" version="7.0.0.1" description="" instanceIdentifier="5c71ade7256f4ce58fe1f8add7f879ac" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="user-friendship-request">
    <contentScript>
		
#set($userId = false)
#set($user = false)
#set($userId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('userId')))
#if ($userId)
	#set ($user = $core_v2_user.Get("%{ Id = $userId }"))
#end
#if (!$user)
	$core_v2_widget.Hide()
#end

#set($bodyId = $core_v2_widget.UniqueId('body'))
#set ($defaultRequestMessage = '')
#set ($defaultRequestMessage = $core_v2_configuration.DefaultFriendshipRequestMessage)
#set ($defaultRequestMessage = $core_v2_ui.FormatHtmlAsText($defaultRequestMessage))

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($user.ProfileUrl)"&gt;$user.DisplayName&lt;/a&gt;
		&lt;h1&gt;$core_v2_language.GetResource('request_friendship')&lt;/h1&gt;
	&lt;/div&gt;
&lt;/div&gt;
&lt;fieldset&gt;
	&lt;div class="form-field editor"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;
			$core_v2_language.FormatString($core_v2_language.GetResource('request'), $user.DisplayName)
		&lt;/label&gt;
		&lt;textarea id="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;$defaultRequestMessage&lt;/textarea&gt;
	&lt;/div&gt;
&lt;/fieldset&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.userFriendshipRequest.register({
			bodyId: '#$core_v2_encoding.JavascriptEncode($bodyId)',
			sendLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('send_request'))',
			requestSent: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('request_sent'))',
			requesteeId: $user.Id,
			requestorId: $core_v2_user.Accessing.Id
		});

		jQuery.telligent.evolution.mobile.refreshable(false);
		jQuery.telligent.evolution.mobile.excludeFromHistory();
	});
})
&lt;/script&gt;
		

		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
		  	<resource name="UserFriendshipRequest_Name">Friendship Request</resource>
			<resource name="request">Send a friendship request to {0}</resource>
			<resource name="send_request">Send</resource>
			<resource name="request_friendship">Request friendship</resource>
			<resource name="request_sent">Friendship requested</resource>
		  </language>
		</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCwgdW5kZWYpew0KDQoJZnVuY3Rpb24gcmVxdWVzdEZyaWVuZHNoaXAocmVxdWVzdG9ySWQsIHJlcXVlc3RlZUlkLCByZXF1ZXN0TWVzc2FnZSkgew0KCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnBvc3Qoew0KCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvdXNlcnMve1JlcXVlc3RvcklkfS9mcmllbmRzLmpzb24nLA0KCQkJZGF0YTogew0KCQkJCVJlcXVlc3RvcklkOiByZXF1ZXN0b3JJZCwNCgkJCQlSZXF1ZXN0ZWVJZDogcmVxdWVzdGVlSWQsDQoJCQkJUmVxdWVzdE1lc3NhZ2U6IChyZXF1ZXN0TWVzc2FnZSB8fCAnJykNCgkJCX0NCgkJfSk7DQoJfQ0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCW9wdGlvbnMuYm9keSA9ICQob3B0aW9ucy5ib2R5SWQpOw0KDQoJCQl2YXIgc2VuZExpbmsgPSAkKCc8YSBocmVmPSIjIiBjbGFzcz0ic3VibWl0Ij4nICsgb3B0aW9ucy5zZW5kTGFiZWwgKyAnPC9hPicpOw0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zZXRIZWFkZXJCdXR0b24oc2VuZExpbmspOw0KDQoJCQlzZW5kTGluay5vbigndGFwJywgZnVuY3Rpb24oKXsNCgkJCQlpZiAob3B0aW9ucy5ib2R5LnZhbCgpLmxlbmd0aCA+IDApIHsNCgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygpOw0KCQkJCQlyZXF1ZXN0RnJpZW5kc2hpcChvcHRpb25zLnJlcXVlc3RvcklkLCBvcHRpb25zLnJlcXVlc3RlZUlkLCBvcHRpb25zLmJvZHkudmFsKCkpDQoJCQkJCQkudGhlbihmdW5jdGlvbigpew0KCQkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuZGlzcGxheU1lc3NhZ2Uob3B0aW9ucy5yZXF1ZXN0U2VudCwgew0KCQkJCQkJCQlkaXNhcHBlYXJBZnRlcjogNTAwMCwNCgkJCQkJCQkJY3NzQ2xhc3M6ICdpbmZvJw0KCQkJCQkJCX0pOw0KCQkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuYmFjayh0cnVlKTsNCgkJCQkJCX0pDQoJCQkJCQkuZmFpbChmdW5jdGlvbigpew0KCQkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuaGlkZUxvYWRpbmcoKTsNCgkJCQkJCX0pOw0KCQkJCX0NCgkJCQlyZXR1cm4gZmFsc2U7DQoJCQl9KTsNCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMudXNlckZyaWVuZHNoaXBSZXF1ZXN0ID0gYXBpOw0KDQp9KShqUXVlcnksIHdpbmRvdyk7DQo=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:UserFriendships_Name}" version="7.0.0.1" description="" instanceIdentifier="edd96f71e18449ad8c8539f577e8b9fa" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="user-friendships">
    <contentScript>


#set ($userId = false)
#set ($userId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('UserId')))
#if (!$userId)
	$core_v2_widget.Hide()
#end
#set ($user = false)
#set ($user = $core_v2_user.Get("%{ Id = $userId }"))
#if (!$user)
	$core_v2_widget.Hide()
#end

#set($pageSize = $core_v2_widget.GetIntValue('pageSize', 5))
#set($pageIndex = 0)

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($user.ProfileUrl)"&gt;$user.DisplayName&lt;/a&gt;
		&lt;h1&gt;$!core_v2_language.FormatString($core_v2_language.GetResource('UserFriendships_Title'), $user.DisplayName)&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$!core_v2_ui.GetResizedImageHtml($user.AvatarUrl, 40, 40, "%{ alt = $user.DisplayName, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
&lt;/div&gt;
#set ($isUserAccessing = false)
#if ($user.Id == $core_v2_user.Accessing.Id)
	#set ($isUserAccessing = true)
#end
#set($filter = 'friends')
#if ($isUserAccessing)
	#set($filter = $core_v2_page.GetQueryStringValue('w_filter'))
	&lt;div class="ui-links filters" data-minlinks="50" data-animate="true"&gt;
		&lt;ul class="activity-filters"&gt;
			&lt;li&gt;&lt;a href="#" data-filter="friends" #if($filter == 'friends') data-selected #end&gt;$core_v2_language.GetResource('UserFriendships_FriendsLink')&lt;/a&gt;&lt;/li&gt;

			#set ($reviewFriendshipCount = $core_v2_friendship.List("%{ FriendshipState = 'Pending', RecipientId = $user.Id, PageIndex = 0, PageSize = 1 }").TotalCount)
			&lt;li&gt;
				&lt;a href="#" data-filter="review" #if($filter == 'review') data-selected #end&gt;
					$core_v2_language.GetResource('UserFriendships_ReviewLink')
					#if($reviewFriendshipCount &gt; 0)
						&lt;strong&gt;(${reviewFriendshipCount})&lt;/strong&gt;
					#end
				&lt;/a&gt;
			&lt;/li&gt;

			#set ($pendingFriendshipCount = $core_v2_friendship.List("%{ FriendshipState = 'Pending', RequestorId = $user.Id, PageIndex = 0, PageSize = 1 }").TotalCount)
			&lt;li&gt;
				&lt;a href="#" data-filter="pending" #if($filter == 'pending') data-selected #end&gt;
					$core_v2_language.GetResource('UserFriendships_PendingLink')
					#if($pendingFriendshipCount &gt; 0)
						&lt;strong&gt;(${pendingFriendshipCount})&lt;/strong&gt;
					#end
				&lt;/a&gt;
			&lt;/li&gt;
		&lt;/ul&gt;
	&lt;/div&gt;
#end

## load and render friendships
&lt;div class="post-list friendships $filter"&gt;
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.userFriendships.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
		filter: '$filter',
		moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
		pageSize: $pageSize,
		friendshipDeleteFriendConfirmation: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UserFriendships_FriendDelete_Confirm'))',
		friendshipRequestCancelConfirmation: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UserFriendships_CancelFriendship_Confirm'))',
		followText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UserFriendships_Follow'))',
		unfollowText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UserFriendships_Unfollow'))',
		followedText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UserFriendships_Followed'))',
		unfollowedText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UserFriendships_Unfollowed'))'
		});
	});
});
&lt;/script&gt;


</contentScript>
    <configuration>
	
		
	
</configuration>
    <languageResources>
	<language key="en-us">
		<resource name="UserFriendships_Name">Friendship List</resource>
		<resource name="UserFriendships_FriendsLink">Friends</resource>
		<resource name="UserFriendships_ReviewLink">Requests to Review</resource>
		<resource name="UserFriendships_PendingLink">Your Requests</resource>
		<resource name="UserFriendships_Title">Friends</resource>
		<resource name="UserFriendships_No_Friends">No users have been added to {0}'s friends list.</resource>
		<resource name="UserFriendships_No_Review">You do not have any friendship requests to review.</resource>
		<resource name="UserFriendships_No_Pending">You do not have any pending requests.</resource>
		<resource name="UserFriendships_Approve_Request">Approve</resource>
		<resource name="UserFriendships_Reject_Request">Reject</resource>
		<resource name="UserFriendships_Cancel_Request">Cancel</resource>
		<resource name="UserFriendships_SendMessage">Send a Message</resource>
		<resource name="UserFriendships_Follow">Start Following</resource>
		<resource name="UserFriendships_Unfollow">Stop Following</resource>
		<resource name="UserFriendships_Followed">Following started</resource>
		<resource name="UserFriendships_Unfollowed">Following stopped</resource>
		<resource name="UserFriendships_Cancel">Cancel</resource>
		<resource name="UserFriendships_FriendDelete_Confirm">Are you sure you want to delete this friendship?</resource>
		<resource name="UserFriendships_CancelFriendship_Confirm">Are you sure you want to cancel this friendship request?</resource>
	</language>
</languageResources>
    <files>
      <file name="list.vm">I3NldCAoJHF1ZXJ5ID0gIiV7UGFnZUluZGV4ID0gJHBhZ2VJbmRleCwgUGFnZVNpemUgPSAkcGFnZVNpemUsIFNvcnRCeSA9ICdMYXN0TW9kaWZpZWREYXRlJywgU29ydE9yZGVyID0gJ0Rlc2NlbmRpbmcnIH0iKQ0KDQoNCiNpZiAoJGZpbHRlciA9PSAncmV2aWV3JykNCgkkcXVlcnkuQWRkKCdGcmllbmRzaGlwU3RhdGUnLCAnUGVuZGluZycpDQoJJHF1ZXJ5LkFkZCgnUmVjaXBpZW50SWQnLCAkdXNlcklkKQ0KI2Vsc2VpZiAoJGZpbHRlciA9PSAncGVuZGluZycpDQoJJHF1ZXJ5LkFkZCgnRnJpZW5kc2hpcFN0YXRlJywgJ1BlbmRpbmcnKQ0KCSRxdWVyeS5BZGQoJ1JlcXVlc3RvcklkJywgJHVzZXJJZCkNCiNlbHNlDQoJJHF1ZXJ5LkFkZCgnRnJpZW5kc2hpcFN0YXRlJywgJ0FwcHJvdmVkJykNCgkkcXVlcnkuQWRkKCdSZXF1ZXN0b3JJZCcsICR1c2VySWQpDQojZW5kDQoNCiNzZXQgKCRmcmllbmRzaGlwcyA9ICRjb3JlX3YyX2ZyaWVuZHNoaXAuTGlzdCgkcXVlcnkpKQ0KDQojZm9yZWFjaCAoJGZyaWVuZHNoaXAgaW4gJGZyaWVuZHNoaXBzKQ0KI2VhY2gNCg0KCSNzZXQgKCRmcmllbmQgPSBmYWxzZSkNCgkjaWYgKCRmcmllbmRzaGlwLlJlY2lwaWVudCAmJiAkZnJpZW5kc2hpcC5SZWNpcGllbnQuSWQgPT0gJHVzZXJJZCkNCgkJI3NldCAoJGZyaWVuZCA9ICRmcmllbmRzaGlwLlJlcXVlc3RvcikNCgkjZWxzZQ0KCQkjc2V0ICgkZnJpZW5kID0gJGZyaWVuZHNoaXAuUmVjaXBpZW50KQ0KCSNlbmQNCg0KCSNpZiAoJGZyaWVuZCkNCgkJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIGZyaWVuZHNoaXAiIGRhdGEtdGFyZ2V0dXJsPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRmcmllbmQuVXJsKSI+DQoJCQk8ZGl2IGNsYXNzPSJwb3N0Ij4NCgkJCQk8ZGl2IGNsYXNzPSJhdmF0YXIiPg0KCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRmcmllbmQuVXJsKSIgY2xhc3M9ImludGVybmFsLWxpbmsgdmlldy11c2VyLXByb2ZpbGUiPg0KCQkJCQkJJGNvcmVfdjJfdWkuR2V0UmVzaXplZEltYWdlSHRtbCgkZnJpZW5kLkF2YXRhclVybCwgNDAsIDQwLCAiJXtib3JkZXI9JzAnLCBhbHQ9JGFsdCwgUmVzaXplTWV0aG9kPSdab29tQW5kQ3JvcCcsYm9yZGVyPScwJ30iKQ0KCQkJCQk8L2E+DQoJCQkJPC9kaXY+DQoJCQkJPGRpdiBjbGFzcz0iY29udGVudCI+DQoJCQkJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJGZyaWVuZC5VcmwpIiBjbGFzcz0iaW50ZXJuYWwtbGluayB2aWV3LXVzZXItcHJvZmlsZSI+JCFmcmllbmQuRGlzcGxheU5hbWU8L2E+DQoJCQkJPC9kaXY+DQoJCQkJI2lmKCRpc1VzZXJBY2Nlc3NpbmcgJiYgKCRmaWx0ZXIgPT0gJ3JldmlldycgfHwgJGZpbHRlciA9PSAncGVuZGluZycpKQ0KCQkJCQk8ZGl2IGNsYXNzPSJhY3Rpb25zIHVpLWxpbmtzIiBkYXRhLW1pbmxpbmtzPSIwIiBkYXRhLW1heGxpbmtzPSIyIj4NCgkJCQkJCTx1bD4NCgkJCQkJCQkjaWYgKCRmaWx0ZXIgPT0gJ3JldmlldycpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KCQkJCQkJCQk8bGkgY2xhc3M9ImFjdGlvbi1hcHByb3ZlLXJlcXVlc3QiPjxhIGhyZWY9IiMiIGRhdGEtbWVzc2FnZW5hbWU9ImZyaWVuZHNoaXAuYXBwcm92ZS1yZXF1ZXN0IiBkYXRhLXVzZXJJZD0iJHVzZXJJZCIgZGF0YS1mcmllbmRJZD0iJGZyaWVuZC5JZCIgPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdVc2VyRnJpZW5kc2hpcHNfQXBwcm92ZV9SZXF1ZXN0Jyk8L2E+PC9saT4NCgkJCQkJCQkJPGxpIGNsYXNzPSJhY3Rpb24tcmVqZWN0LXJlcXVlc3QiPjxhIGhyZWY9IiMiIGRhdGEtbWVzc2FnZW5hbWU9ImZyaWVuZHNoaXAucmVqZWN0LXJlcXVlc3QiIGRhdGEtdXNlcklkPSIkdXNlcklkIiBkYXRhLWZyaWVuZElkPSIkZnJpZW5kLklkIiA+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ1VzZXJGcmllbmRzaGlwc19SZWplY3RfUmVxdWVzdCcpPC9hPjwvbGk+DQoJCQkJCQkJI2Vsc2VpZiAoJGZpbHRlciA9PSAncGVuZGluZycpDQoJCQkJCQkJCTxsaSBjbGFzcz0iYWN0aW9uLWNhbmNlbC1yZXF1ZXN0Ij48YSBocmVmPSIjIiBkYXRhLW1lc3NhZ2VuYW1lPSJmcmllbmRzaGlwLmNhbmNlbC1yZXF1ZXN0IiBkYXRhLXVzZXJJZD0iJHVzZXJJZCIgZGF0YS1mcmllbmRJZD0iJGZyaWVuZC5JZCIgPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdVc2VyRnJpZW5kc2hpcHNfQ2FuY2VsX1JlcXVlc3QnKTwvYT48L2xpPg0KCQkJCQkJCSNlbmQNCgkJCQkJCQk8bGkgY2xhc3M9ImFjdGlvbi1tb3JlIj48YSBocmVmPSIjIiBjbGFzcz0ibW9yZSIgZGF0YS1tb3JlPjwvYT48L2xpPg0KCQkJCQkJCTxsaT48YSBocmVmPSIjIiBkYXRhLWNhbmNlbD4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnVXNlckZyaWVuZHNoaXBzX0NhbmNlbCcpPC9hPjwvbGk+DQoJCQkJCQk8L3VsPg0KCQkJCQk8L2Rpdj4NCgkJCQkjZW5kDQoJCQk8L2Rpdj4NCgkJPC9kaXY+DQoJI2VuZA0KI25vZGF0YQ0KCTxkaXYgY2xhc3M9InBvc3QtbGlzdC1pdGVtIGNvbnRlbnQtaXRlbSBmcmllbmRzaGlwcyI+DQoJCTxkaXYgY2xhc3M9Im1lc3NhZ2Ugbm9yZWNvcmRzIj4NCgkJCSNpZiAoJGZpbHRlciA9PSAncmV2aWV3JykNCgkJCQkkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRTdHJpbmcoJGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ1VzZXJGcmllbmRzaGlwc19Ob19SZXZpZXcnKSwgJGZyaWVuZC5EaXNwbGF5TmFtZSkNCgkJCSNlbHNlaWYgKCRmaWx0ZXIgPT0gJ3BlbmRpbmcnKQ0KCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdFN0cmluZygkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnVXNlckZyaWVuZHNoaXBzX05vX1BlbmRpbmcnKSwgJGZyaWVuZC5EaXNwbGF5TmFtZSkNCgkJCSNlbHNlDQoJCQkJJGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0U3RyaW5nKCRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdVc2VyRnJpZW5kc2hpcHNfTm9fRnJpZW5kcycpLCAkZnJpZW5kLkRpc3BsYXlOYW1lKQ0KCQkJI2VuZA0KCQk8L2Rpdj4NCgk8L2Rpdj4NCiNhZnRlcmFsbA0KCSNzZXQgKCRoYXNNb3JlID0gZmFsc2UpDQoJI2lmICgkZnJpZW5kc2hpcHMuVG90YWxDb3VudCA+ICgoJGZyaWVuZHNoaXBzLlBhZ2VJbmRleCArIDEpICogJGZyaWVuZHNoaXBzLlBhZ2VTaXplKSkNCgkJI3NldCgkaGFzTW9yZSA9IHRydWUpDQoJI2VuZA0KCTxkaXYgY2xhc3M9ImRhdGEiICNpZigkaGFzTW9yZSlkYXRhLWhhc21vcmU9InRydWUiI2VuZD48L2Rpdj4NCiNlbmQ=</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBmcmllbmRzaGlwcw0KIyMNCg0KI3NldCAoJHBhZ2VJbmRleCA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19wYWdlSW5kZXgnKSkNCiNzZXQgKCRwYWdlU2l6ZSA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19wYWdlU2l6ZScpKQ0KDQojc2V0ICgkdXNlcklkID0gZmFsc2UpDQojc2V0ICgkdXNlcklkID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUludCgkbW9iaWxlX3YxX3VybFRva2VuLlZhbHVlKCdVc2VySWQnKSkpDQojaWYgKCEkdXNlcklkKQ0KCSRjb3JlX3YyX3dpZGdldC5IaWRlKCkNCiNlbmQNCg0KI3NldCgkZmlsdGVyID0gJ2ZyaWVuZHMnKQ0KI3NldCAoJGlzVXNlckFjY2Vzc2luZyA9IGZhbHNlKQ0KI2lmICgkdXNlcklkID09ICRjb3JlX3YyX3VzZXIuQWNjZXNzaW5nLklkKQ0KCSNzZXQgKCRpc1VzZXJBY2Nlc3NpbmcgPSB0cnVlKQ0KI2VuZA0KDQojaWYgKCRpc1VzZXJBY2Nlc3NpbmcpDQoJI3NldCgkZmlsdGVyID0gJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X2ZpbHRlcicpKQ0KI2VuZA0KDQokY29yZV92Ml93aWRnZXQuRXhlY3V0ZUZpbGUoJ2xpc3Qudm0nKQ0K</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIG1vZGVsID0gew0KCQlyZW1vdmVGcmllbmRzaGlwOiBmdW5jdGlvbiAocmVxdWVzdG9ySWQsIHJlcXVlc3RlZUlkKSB7DQoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygkLnRlbGxpZ2VudC5ldm9sdXRpb24uZGVsKHsNCgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi91c2Vycy97UmVxdWVzdG9ySWR9L2ZyaWVuZHMve1JlcXVlc3RlZUlkfS5qc29uJywNCgkJCQlkYXRhOiB7DQoJCQkJCVJlcXVlc3RvcklkOiByZXF1ZXN0b3JJZCwNCgkJCQkJUmVxdWVzdGVlSWQ6IHJlcXVlc3RlZUlkDQoJCQkJfQ0KCQkJfSkpOw0KCQl9LA0KDQoJCXVwZGF0ZUZyaWVuZHNoaXA6IGZ1bmN0aW9uIChyZXF1ZXN0b3JJZCwgcmVxdWVzdGVlSWQsIGZyaWVuZHNoaXBTdGF0ZSkgew0KCQkJcmV0dXJuICQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7DQoJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvdXNlcnMve1JlcXVlc3RvcklkfS9mcmllbmRzL3tSZXF1ZXN0ZWVJZH0uanNvbicsDQoJCQkJZGF0YTogew0KCQkJCQlSZXF1ZXN0b3JJZDogcmVxdWVzdG9ySWQsDQoJCQkJCVJlcXVlc3RlZUlkOiByZXF1ZXN0ZWVJZCwNCgkJCQkJRnJpZW5kc2hpcFN0YXRlOiBmcmllbmRzaGlwU3RhdGUNCgkJCQl9DQoJCQl9KSk7DQoJCX0sDQoNCgkJc3RhcnRGb2xsb3dpbmc6IGZ1bmN0aW9uIChmb2xsb3dlcklkLCBmb2xsb3dpbmdJZCkgew0KCQkJcmV0dXJuICQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnBvc3Qoew0KCQkJCXVybDogJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ2FwaS5hc2h4L3YyL3VzZXJzL3tGb2xsb3dlcklkfS9mb2xsb3dpbmcuanNvbicsDQoJCQkJZGF0YTogew0KCQkJCQlGb2xsb3dlcklkOiBmb2xsb3dlcklkLA0KCQkJCQlGb2xsb3dpbmdJZDogZm9sbG93aW5nSWQNCgkJCQl9DQoJCQl9KSk7DQoJCX0sDQoNCgkJc3RvcEZvbGxvd2luZzogZnVuY3Rpb24gKGZvbGxvd2VySWQsIGZvbGxvd2luZ0lkKSB7DQoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygkLnRlbGxpZ2VudC5ldm9sdXRpb24uZGVsKHsNCgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi91c2Vycy97Rm9sbG93ZXJJZH0vZm9sbG93aW5nL3tGb2xsb3dpbmdJZH0uanNvbicsDQoJCQkJZGF0YTogew0KCQkJCQlGb2xsb3dlcklkOiBmb2xsb3dlcklkLA0KCQkJCQlGb2xsb3dpbmdJZDogZm9sbG93aW5nSWQNCgkJCQl9DQoJCQl9KSk7DQoJCX0NCgl9DQoNCgl2YXIgYXBpID0gew0KDQoJCWhhbmRsZUFjdGlvbnM6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCg0KCQkJLy9yZW1vdmUgZnJpZW5kDQoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnN1YnNjcmliZSgnZnJpZW5kc2hpcC5yZW1vdmUtZnJpZW5kJywgZnVuY3Rpb24gKGRhdGEpIHsNCgkJCQl2YXIgdGFyZ2V0ID0gJChkYXRhLnRhcmdldCk7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlU2hlZXQoKTsNCgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmNvbmZpcm0ob3B0aW9ucy5mcmllbmRzaGlwRGVsZXRlRnJpZW5kQ29uZmlybWF0aW9uLCBmdW5jdGlvbiAoY29uZmlybWVkKSB7DQoJCQkJCWlmIChjb25maXJtZWQpIHsNCgkJCQkJCW1vZGVsLnJlbW92ZUZyaWVuZHNoaXAodGFyZ2V0LmRhdGEoJ3VzZXJpZCcpLCB0YXJnZXQuZGF0YSgnZnJpZW5kaWQnKSkNCgkJCQkJCQkuZG9uZShmdW5jdGlvbiAoKSB7DQoJCQkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUucmVmcmVzaCgpOw0KCQkJCQkJCX0pOw0KCQkJCQl9DQoJCQkJfSk7DQoJCQl9KTsNCg0KCQkJLy9jYW5jZWwgcmVxdWVzdA0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ2ZyaWVuZHNoaXAuY2FuY2VsLXJlcXVlc3QnLCBmdW5jdGlvbiAoZGF0YSkgew0KCQkJCXZhciB0YXJnZXQgPSAkKGRhdGEudGFyZ2V0KTsNCgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmhpZGVTaGVldCgpOw0KCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuY29uZmlybShvcHRpb25zLmZyaWVuZHNoaXBSZXF1ZXN0Q2FuY2VsQ29uZmlybWF0aW9uLCBmdW5jdGlvbiAoY29uZmlybWVkKSB7DQoJCQkJCWlmIChjb25maXJtZWQpIHsNCgkJCQkJCW1vZGVsLnJlbW92ZUZyaWVuZHNoaXAodGFyZ2V0LmRhdGEoJ3VzZXJpZCcpLCB0YXJnZXQuZGF0YSgnZnJpZW5kaWQnKSkNCgkJCQkJCQkuZG9uZShmdW5jdGlvbiAoKSB7DQoJCQkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUucmVmcmVzaCgpOw0KCQkJCQkJCX0pOw0KCQkJCQl9DQoJCQkJfSk7DQoJCQl9KTsNCg0KCQkJLy9yZWplY3QgcmVxdWVzdA0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ2ZyaWVuZHNoaXAucmVqZWN0LXJlcXVlc3QnLCBmdW5jdGlvbiAoZGF0YSkgew0KCQkJCXZhciB0YXJnZXQgPSAkKGRhdGEudGFyZ2V0KTsNCgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmhpZGVTaGVldCgpOw0KCQkJCW1vZGVsLnJlbW92ZUZyaWVuZHNoaXAodGFyZ2V0LmRhdGEoJ2ZyaWVuZGlkJyksIHRhcmdldC5kYXRhKCd1c2VyaWQnKSkNCgkJCQkJLmRvbmUoZnVuY3Rpb24gKCkgew0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5yZWZyZXNoKCk7DQoJCQkJCX0pOw0KCQkJfSk7DQoNCgkJCS8vYXBwcm92ZSByZXF1ZXN0DQoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnN1YnNjcmliZSgnZnJpZW5kc2hpcC5hcHByb3ZlLXJlcXVlc3QnLCBmdW5jdGlvbiAoZGF0YSkgew0KCQkJCXZhciB0YXJnZXQgPSAkKGRhdGEudGFyZ2V0KTsNCgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmhpZGVTaGVldCgpOw0KCQkJCW1vZGVsLnVwZGF0ZUZyaWVuZHNoaXAodGFyZ2V0LmRhdGEoJ2ZyaWVuZGlkJyksIHRhcmdldC5kYXRhKCd1c2VyaWQnKSwgJ0FwcHJvdmVkJykNCgkJCQkJLmRvbmUoZnVuY3Rpb24gKCkgew0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5yZWZyZXNoKCk7DQoJCQkJCX0pOw0KCQkJfSk7DQoNCgkJCS8vIHN0YXJ0IC8gc3RvcCBmb2xsb3dpbmcNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tZXNzYWdpbmcuc3Vic2NyaWJlKCdmcmllbmRzaGlwLmZvbGxvdycsIGZ1bmN0aW9uIChkYXRhKSB7DQoJCQkJdmFyIHRhcmdldCA9ICQoZGF0YS50YXJnZXQpOw0KCQkJCWlmICghdGFyZ2V0Lmhhc0NsYXNzKCJwcm9jZXNzaW5nIikpIHsNCgkJCQkJdGFyZ2V0LmFkZENsYXNzKCJwcm9jZXNzaW5nIikNCgkJCQkJCSAgLnRleHQoJy4uLicpOw0KCQkJCQl2YXIgZm9sbG93cyA9IHRhcmdldC5kYXRhKCdmb2xsb3dzJyk7DQoJCQkJCXZhciBhY3Rpb24gPSBmb2xsb3dzID8gbW9kZWwuc3RvcEZvbGxvd2luZyA6IG1vZGVsLnN0YXJ0Rm9sbG93aW5nOw0KCQkJCQlhY3Rpb24odGFyZ2V0LmRhdGEoJ2ZvbGxvd2VyaWQnKSwgdGFyZ2V0LmRhdGEoJ2ZvbGxvd2luZ2lkJykpDQoJCQkJCQkuZG9uZShmdW5jdGlvbiAoKSB7DQoJCQkJCQkJZm9sbG93cyA9ICFmb2xsb3dzOw0KCQkJCQkJCXRhcmdldC5kYXRhKCdmb2xsb3dzJywgZm9sbG93cyk7DQoJCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5kaXNwbGF5TWVzc2FnZSgNCgkJCQkJCQkJIWZvbGxvd3MgPyBvcHRpb25zLnVuZm9sbG93ZWRUZXh0IDogb3B0aW9ucy5mb2xsb3dlZFRleHQsIHsNCgkJCQkJCQkJCWRpc2FwcGVhckFmdGVyOiA1MDAwLA0KCQkJCQkJCQkJY3NzQ2xhc3M6ICdpbmZvJw0KCQkJCQkJCQl9KTsNCgkJCQkJCX0pDQoJCQkJCQkuYWx3YXlzKGZ1bmN0aW9uICgpIHsNCgkJCQkJCQl0YXJnZXQucmVtb3ZlQ2xhc3MoInByb2Nlc3NpbmciKQ0KCQkJCQkJCQkgIC50ZXh0KGZvbGxvd3MgPyBvcHRpb25zLnVuZm9sbG93VGV4dCA6IG9wdGlvbnMuZm9sbG93VGV4dCApOw0KCQkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuaGlkZVNoZWV0KCk7DQoJCQkJCQl9KTsNCgkJCQl9DQoJCQl9KTsNCgkJfSwNCg0KCQlpbml0U2Nyb2xsaW5nOiBmdW5jdGlvbihvcHRpb25zKSB7DQoNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2Nyb2xsYWJsZSh7DQoJCQkJcmVnaW9uOiAnY29udGVudCcsDQoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgew0KCQkJCQlpZiAoJCgnLmZyaWVuZHNoaXBzLicgKyBvcHRpb25zLmZpbHRlciArICcgZGl2LmRhdGE6bGFzdCcpLmRhdGEoJ2hhc21vcmUnKSkgew0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLmdldCh7DQoJCQkJCQkJdXJsOiBvcHRpb25zLm1vcmVVcmwsDQoJCQkJCQkJZGF0YTogew0KCQkJCQkJCQl3X3BhZ2VJbmRleDogcGFnZUluZGV4LA0KCQkJCQkJCQl3X3BhZ2VTaXplOiBvcHRpb25zLnBhZ2VTaXplDQoJCQkJCQkJfSwNCgkJCQkJCQlzdWNjZXNzOiBmdW5jdGlvbihyKSB7DQoJCQkJCQkJCXN1Y2Nlc3Mocik7DQoJCQkJCQkJfSwNCgkJCQkJCQllcnJvcjogZnVuY3Rpb24oKSB7DQoJCQkJCQkJCWVycm9yKCk7DQoJCQkJCQkJfQ0KCQkJCQkJfSk7DQoJCQkJCX0gZWxzZSB7DQoJCQkJCQlzdWNjZXNzKCk7DQoJCQkJCX0NCgkJCQl9LA0KCQkJCWNvbXBsZXRlOiBmdW5jdGlvbihjb250ZW50KSB7DQoJCQkJCWNvbnRlbnQgPSAkKGNvbnRlbnQpLmNzcyh7IG9wYWNpdHk6IDAgfSk7DQoJCQkJCSQoJ2Rpdi5wb3N0LWxpc3QuZnJpZW5kc2hpcHMuJyArIG9wdGlvbnMuZmlsdGVyKS5hcHBlbmQoY29udGVudCk7DQoJCQkJCWNvbnRlbnQuZXZvbHV0aW9uVHJhbnNmb3JtKHsgb3BhY2l0eTogMSB9LCB7IGR1cmF0aW9uOiA0MDAgfSk7DQoJCQkJfQ0KCQkJfSk7DQoNCgkJfSwNCg0KCQlhcHBseUZpbHRlcnM6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCg0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5hZGRSZWZyZXNoUGFyYW1ldGVyKCd3X2ZpbHRlcicsIG9wdGlvbnMuZmlsdGVyKTsNCg0KCQkJJChvcHRpb25zLndyYXBwZXIgKyAnIC5maWx0ZXJzIGEnKS5vbigndGFwJywgZnVuY3Rpb24oZSkgew0KCQkJCXZhciBmaWx0ZXIgPSAkKHRoaXMpLmRhdGEoJ2ZpbHRlcicpOw0KCQkJCWlmIChmaWx0ZXIgIT0gb3B0aW9ucy5maWx0ZXIpIHsNCgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5hZGRSZWZyZXNoUGFyYW1ldGVyKCd3X2ZpbHRlcicsIGZpbHRlcik7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUucmVmcmVzaCgpOw0KCQkJCX0NCgkJCQlyZXR1cm4gZmFsc2U7DQoJCQl9KTsNCg0KCQl9LA0KDQoJCXJlZ2lzdGVyOiBmdW5jdGlvbihvcHRpb25zKSB7DQoJCQlhcGkuaGFuZGxlQWN0aW9ucyhvcHRpb25zKTsNCgkJCWFwaS5pbml0U2Nyb2xsaW5nKG9wdGlvbnMpOw0KCQkJYXBpLmFwcGx5RmlsdGVycyhvcHRpb25zKTsNCg0KCQl9DQoJfQ0KDQoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24gPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24gfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy51c2VyRnJpZW5kc2hpcHMgPSBhcGk7DQoNCn0pKGpRdWVyeSk7</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:UserProfile_Name}" version="7.0.0.1" description="" instanceIdentifier="6dd9ec44407f4d5fb9f85292c2004ee0" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="user-profile">
    <contentScript>


#set ($userId = false)
#set ($userId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('UserId')))
#if (!$userId)
	$core_v2_widget.Hide()
#end
#set ($user = false)
#set ($user = $core_v2_user.Get("%{ Id = $userId }"))
#if (!$user)
	$core_v2_widget.Hide()
#end

#set($profileGroup = false)
#set($profileGroupId = $core_v2_widget.GetIntValue('profileFieldGroupId', -1))
#if ($profileGroupId &gt; 0)
	#set($profileGroup = $core_v2_userProfileFieldGroup.Get($profileGroupId))
#else
	#foreach ($pg in $core_v2_userProfileFieldGroup.List())
		#if ($pg.Title.ToLower() == 'mobile')
			#set($profileGroup = $pg)
		#end
	#end
#end

#if (!$profileGroup)
	$core_v2_widget.Hide()
#end

#set($data = $core_v2_page.ParseQueryString(''))
#foreach($profileField in $user.ProfileFields)
	$data.Add($profileField.Label, $core_v2_encoding.HtmlDecode($profileField.Value))
#end

#set($dq = '"')
#set($propertyHeaderFormat = "&lt;div class=${dq}profile-field${dq}&gt;&lt;div class=${dq}label${dq}&gt;{PropertyName}&lt;/div&gt;&lt;div class=${dq}value${dq}&gt;")
#set($propertyFooterFormat = '&lt;/div&gt;&lt;/div&gt;')

&lt;div class="profile"&gt;
	&lt;div class='profile-field-list'&gt;
		#set($form = false)

		#set($form = $core_v2_dynamicForm.RenderForm($core_v2_widget.UniqueId('form'), $core_v2_userProfileFieldGroup.DynamicFormXml($profileGroup.Id, "%{ReadOnly='true'}"), $data, "%{GroupFooterHtmlFormat='',GroupHeaderHtmlFormat='',PropertyFooterHtmlFormat=$propertyFooterFormat,PropertyHeaderHtmlFormat=$propertyHeaderFormat,HidePropertiesWithoutValues='true'}"))
		#if (!$form || $form.Length == 0)
			$core_v2_widget.Hide()
		#else
			$mobile_v1_dataFormat.Detect($form)
		#end

	&lt;/div&gt;
&lt;/div&gt;


</contentScript>
    <configuration>
	
	&lt;propertyGroup id="options" resourceName="Options"&gt;
		&lt;property id="profileFieldGroupId" dataType="int" /&gt;
	&lt;/propertyGroup&gt;
	
</configuration>
    <languageResources>
	<language key="en-us">
		<resource name="UserProfile_Name">User Profile</resource>
	</language>
</languageResources>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:Wiki_Name}" version="7.0.0.1" description="" instanceIdentifier="b763444371d5475e8f7a9a5fa4d184b6" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="wiki">
    <contentScript>
		
#set($wikiId = false)
#set($wikiId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('WikiId')))
#if (!$wikiId)
	$core_v2_widget.Hide()
#end

#set ($accessingUser = $core_v2_user.Accessing)
#set ($accessingUserIsRegistered = false)
#if ($core_v2_user.IsRegistered($accessingUser.Id))
	#set ($accessingUserIsRegistered = true)
#end

#set($wiki = $core_v2_wiki.Get("%{Id=$wikiId}"))
#set($defaultPage = $core_v2_wikiPage.Get("%{PageKey='DefaultWikiPage',WikiId=$wikiId}"))
&lt;div class="post full topic"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($wiki.Group.Url)"&gt;$wiki.Group.Name&lt;/a&gt;
	&lt;/div&gt;
	&lt;h1&gt;$defaultPage.Title&lt;/h1&gt;
	&lt;div class="details"&gt;
		&lt;div class="date"&gt;$core_v2_language.FormatAgoDate($defaultPage.Date)&lt;/div&gt;
	&lt;/div&gt;
	&lt;div class="content user-generated-content"&gt;
		$mobile_v1_dataFormat.Detect($defaultPage.Body())
	&lt;/div&gt;

	#set($showLikes = false)
	#if($accessingUserIsRegistered &amp;&amp; $core_v2_like.CanLike($defaultPage.ContentId, $core_v2_wikiPage.ContentTypeId))
		#set($showLikes = true)
	#end

	&lt;div class="actions ui-links" data-maxlinks="#if($showLikes)1#else 0#end"&gt;
		#if ($showLikes)
			&lt;li class="action-like"&gt;
				#set($format = '{toggle} &lt;span class="count"&gt;&lt;span class="icon"&gt;&lt;/span&gt;{count}&lt;/span&gt;')
				$core_v2_ui.Like($defaultPage.ContentId, $core_v2_wikiPage.ContentTypeId, "%{ Format = $format }")
			&lt;/li&gt;
		#end

		&lt;li&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('wikipage-edit',$defaultPage.Id))"&gt;Edit&lt;/a&gt;&lt;/li&gt;

		#if ($accessingUserIsRegistered &amp;&amp; $core_v2_bookmark.CanBookmark($defaultPage.ContentId, $core_v2_wikiPage.ContentTypeId))
			&lt;li class="action-bookmark"&gt;
				$core_v2_ui.Bookmark($defaultPage.ContentId, $core_v2_wikiPage.ContentTypeId)
			&lt;/li&gt;
		#end

		&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
	&lt;/div&gt;
&lt;/div&gt;


## load and render wiki
&lt;div class="post-list wikis"&gt;
	#set($wikipages = $core_v2_wikiToc.List($wikiId))
	#foreach($wikipage in $wikipages)
		&lt;div class="post-list-item" data-targeturl="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('wikipage',$wikipage.Id))"&gt;
			&lt;div class="post full without-avatar"&gt;
				&lt;div class="content"&gt;
					&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('wikipage',$wikipage.Id))"&gt;$wikipage.Title&lt;/a&gt;
				&lt;/div&gt;
			&lt;/div&gt;
		&lt;/div&gt;
	#end
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.wiki.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			postUrl: '$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('wiki-addwikipage', $wikiId))',
			canPost: #if($core_v2_nodePermission.Get("wikis", $wikiId, "Wiki_CreatePage").IsAllowed) true#else false#end
		});
	});
})
&lt;/script&gt;
		

		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
		  	<resource name="Wiki_Name">Wiki</resource>
			<resource name="edit">Edit</resource>
			<resource name="delete">Delete</resource>
			<resource name="cancel">Cancel</resource>
			<resource name="post">New</resource>
		  </language>
		</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoNCgl2YXIgYXBpID0gew0KCQlyZWdpc3RlcjogZnVuY3Rpb24ob3B0aW9ucykgew0KCQkJaWYgKG9wdGlvbnMuY2FuUG9zdCkgew0KCQkJCXZhciBwb3N0TGluayA9ICQoJzxhIGhyZWY9IicgKyBvcHRpb25zLnBvc3RVcmwgKyAnIiBjbGFzcz0iYWRkIj4nICsgb3B0aW9ucy5wb3N0TGFiZWwgKyAnPC9hPicpOw0KCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2V0SGVhZGVyQnV0dG9uKHBvc3RMaW5rKTsNCgkJCX0NCgkJfQ0KCX0NCgkkLnRlbGxpZ2VudCA9ICQudGVsbGlnZW50IHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyA9ICQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzLndpa2kgPSBhcGk7DQoNCn0pKGpRdWVyeSk7</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:WikiList_Name}" version="7.0.0.1" description="" instanceIdentifier="a98046dcf707414f83425eabe5b3c393" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="group-wikis">
    <contentScript>
		
#set($groupId = false)
#set($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#if (!$groupId)
	$core_v2_widget.Hide()
#end

#set($group = $core_v2_group.Get("%{Id=$groupId}"))
&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($group.Url)"&gt;$group.Name&lt;/a&gt;
		&lt;h1&gt;$core_v2_language.GetResource('wikis')&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 40, 40, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
&lt;/div&gt;
## load and render wikis
&lt;div class="post-list wikis"&gt;
	#set($pageIndex = 0)
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.wikiList.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))'
		});
	});
})
&lt;/script&gt;
		

		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="WikiList_Name">Wiki List</resource>
		<resource name="wikis">Wikis</resource>
		<resource name="no_wikis">No Wikis</resource>
		<resource name="edit">Edit</resource>
		<resource name="delete">Delete</resource>
		<resource name="Cancel">Cancel</resource>
	  </language>
	</languageResources>
    <files>
      <file name="list.vm">I3NldCgkd2lraXMgPSAkY29yZV92Ml93aWtpLkxpc3QoIiV7R3JvdXBJZD0kZ3JvdXBJZCxQYWdlSW5kZXg9JHBhZ2VJbmRleCxQYWdlU2l6ZT01fSIpKQ0KI2lmKCR3aWtpcy5Ub3RhbENvdW50ID09IDEpDQoJI3NldCgkb25lV2lraSA9ICRjb3JlX3YyX3dpa2kuR2V0KCIle0dyb3VwSWQgPSAkZ3JvdXBJZH0iKSkNCgkkbW9iaWxlX3YxX3VybC5Gb3JtYXQoJ3dpa2knLCRvbmVXaWtpLklkKQ0KI2VuZA0KI2ZvcmVhY2goJHdpa2kgaW4gJHdpa2lzKQ0KI2VhY2gNCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gd2lraSIgZGF0YS10YXJnZXR1cmw9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJG1vYmlsZV92MV91cmwuRm9ybWF0KCd3aWtpJywgJHdpa2kuSWQpKSI+DQoJCTxkaXYgY2xhc3M9InBvc3Qgd2l0aG91dC1hdmF0YXIiPg0KCQkJPGRpdiBjbGFzcz0iZGV0YWlscyI+DQoJCQkJI2lmICgkd2lraS5MYXN0TW9kaWZpZWRVdGNEYXRlKQ0KCQkJCQk8ZGl2IGNsYXNzPSJkYXRlIj4kY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRBZ29EYXRlKCR3aWtpLkxhc3RNb2RpZmllZFV0Y0RhdGUpPC9kaXY+DQoJCQkJI2VuZA0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJjb250ZW50Ij4NCgkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRtb2JpbGVfdjFfdXJsLkZvcm1hdCgnd2lraScsICR3aWtpLklkKSkiPiR3aWtpLk5hbWU8L2E+DQoJCQkJPGRpdj4kIXdpa2kuRGVzY3JpcHRpb248L2Rpdj4NCgkJCTwvZGl2Pg0KCQk8L2Rpdj4NCgk8L2Rpdj4NCiNub2RhdGENCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gd2lraXMiPjxkaXYgY2xhc3M9Im1lc3NhZ2Ugbm9yZWNvcmRzIj4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbm9fd2lraXMnKTwvZGl2PjwvZGl2Pg0KI2FmdGVyYWxsDQoJI3NldCAoJGhhc01vcmUgPSBmYWxzZSkNCgkjaWYgKCR3aWtpcy5Ub3RhbENvdW50ID4gKCgkd2lraXMuUGFnZUluZGV4ICsgMSkgKiAkd2lraXMuUGFnZVNpemUpKQ0KCQkjc2V0KCRoYXNNb3JlID0gdHJ1ZSkNCgkjZW5kDQoJPGRpdiBjbGFzcz0iZGF0YSIgI2lmKCRoYXNNb3JlKWRhdGEtaGFzbW9yZT0idHJ1ZSIjZW5kPjwvZGl2Pg0KI2VuZA==</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSB3aWtpcw0KIyMNCiNzZXQgKCRwYWdlSW5kZXggPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfcGFnZUluZGV4JykpDQojc2V0KCRncm91cElkID0gZmFsc2UpDQojc2V0KCRncm91cElkID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUludCgkbW9iaWxlX3YxX3VybFRva2VuLlZhbHVlKCdHcm91cElkJykpKQ0KI2lmICghJGdyb3VwSWQpDQoJJGNvcmVfdjJfd2lkZ2V0LkhpZGUoKQ0KI2VuZA0KJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCdsaXN0LnZtJykNCg==</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2Nyb2xsYWJsZSh7DQoJCQkJcmVnaW9uOiAnY29udGVudCcsDQoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgew0KCQkJCQlpZiAoJChvcHRpb25zLndyYXBwZXIgKyAnIGRpdi5kYXRhOmxhc3QnKS5kYXRhKCdoYXNtb3JlJykpIHsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoew0KCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLA0KCQkJCQkJCWRhdGE6IHsNCgkJCQkJCQkJd19wYWdlSW5kZXg6IHBhZ2VJbmRleA0KCQkJCQkJCX0sDQoJCQkJCQkJc3VjY2VzczogZnVuY3Rpb24ocikgew0KCQkJCQkJCQlzdWNjZXNzKHIpOw0KCQkJCQkJCX0sDQoJCQkJCQkJZXJyb3I6IGZ1bmN0aW9uKCkgew0KCQkJCQkJCQllcnJvcigpOw0KCQkJCQkJCX0NCgkJCQkJCX0pOw0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJc3VjY2VzcygpOw0KCQkJCQl9DQoJCQkJfSwNCgkJCQljb21wbGV0ZTogZnVuY3Rpb24oY29udGVudCkgew0KCQkJCQljb250ZW50ID0gJChjb250ZW50KS5jc3MoeyBvcGFjaXR5OiAwIH0pOw0KCQkJCQkkKG9wdGlvbnMud3JhcHBlcikuZmluZCgnZGl2LnBvc3QtbGlzdCcpLmFwcGVuZChjb250ZW50KTsNCgkJCQkJY29udGVudC5ldm9sdXRpb25UcmFuc2Zvcm0oeyBvcGFjaXR5OiAxIH0sIHsgZHVyYXRpb246IDQwMCB9KTsNCgkJCQl9DQoJCQl9KTsNCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMud2lraUxpc3QgPSBhcGk7DQoNCn0pKGpRdWVyeSk7</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:WikiPage_Name}" version="7.0.0.1" description="" instanceIdentifier="70bdfebf5e85427c8718871941e88347" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="wikipage">
    <contentScript>
		
#set($wikiPageId = false)
#set($wikiPageId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('WikiPageId')))
#if (!$wikiPageId)
	$core_v2_widget.Hide()
#end
#set($wikiPage = $core_v2_wikiPage.Get("%{Id = $wikiPageId}"))

#set ($accessingUser = $core_v2_user.Accessing)
#set ($accessingUserIsRegistered = false)
#if ($core_v2_user.IsRegistered($accessingUser.Id))
	#set ($accessingUserIsRegistered = true)
#end

&lt;div class="post topic full"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($wikiPage.Application.Container.Url)"&gt;$wikiPage.Application.Container.HtmlName('Web')&lt;/a&gt;
		#set($parentPage = false)
		#set($parentPage = $core_v2_wikiPage.Get("%{Id = $wikiPage.ParentPageId}"))
		#if (!$parentPage)
			#set($parentPage = $core_v2_wikiPage.Get("%{PageKey='DefaultWikiPage',WikiId=$wikiPage.WikiId}"))
			#if ($parentPage)
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('wiki', $wikiPage.WikiId))"&gt;$parentPage.Title&lt;/a&gt;
			#end
		#else
			&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('wikipage', $parentPage.Id))"&gt;$parentPage.Title&lt;/a&gt;
		#end
	&lt;/div&gt;
	&lt;h1&gt;$wikiPage.Title&lt;/h1&gt;
	&lt;div class="details"&gt;
		&lt;div class="date"&gt;$core_v2_language.FormatAgoDate($wikiPage.Date)&lt;/div&gt;
	&lt;/div&gt;
	&lt;div class="content user-generated-content"&gt;
		$mobile_v1_dataFormat.Detect($wikiPage.Body())
	&lt;/div&gt;

	#set($showLikes = false)
	#if($accessingUserIsRegistered &amp;&amp; $core_v2_like.CanLike($wikiPage.ContentId, $core_v2_wikiPage.ContentTypeId))
		#set($showLikes = true)
	#end

	&lt;div class="actions ui-links" data-maxlinks="#if($showLikes)1#else 0#end"&gt;
		#if ($showLikes)
			&lt;li class="action-like"&gt;
				#set($format = '{toggle} &lt;span class="count"&gt;&lt;span class="icon"&gt;&lt;/span&gt;{count}&lt;/span&gt;')
				$core_v2_ui.Like($wikiPage.ContentId, $core_v2_wikiPage.ContentTypeId, "%{ Format = $format }")
			&lt;/li&gt;
		#end

		#if ($accessingUserIsRegistered)
			&lt;li&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('wikipage-edit',$wikiPageId))"&gt;$core_v2_language.GetResource('edit')&lt;/a&gt;&lt;/li&gt;
		#end
		#if ($accessingUserIsRegistered &amp;&amp; $core_v2_bookmark.CanBookmark($wikiPage.ContentId, $core_v2_wikiPage.ContentTypeId))
			&lt;li class="action-bookmark"&gt;
				$core_v2_ui.Bookmark($wikiPage.ContentId, $core_v2_wikiPage.ContentTypeId)
			&lt;/li&gt;
		#end
		&lt;li class="action-moderate"&gt;$core_v2_ui.Moderate($wikiPage.ContentId, $core_v2_wikiPage.ContentTypeId)&lt;/li&gt;

		&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
	&lt;/div&gt;
&lt;/div&gt;


#if($wikiPage.ChildPageCount &gt; 0)
	&lt;div class="post-list"&gt;
	#set($childWikis = $core_v2_utility.FlattenHierarchy($core_v2_wikiToc.List($wikiPage.WikiId, $wikiPage.Id), 'Children', "%{ExpandToLevel=1}"))
	#foreach($childWiki in $childWikis)
		#set($childWikiPage = $core_v2_wikiPage.Get("%{Id = $childWiki.Item.Id}"))
		&lt;div class="post-list-item" data-targeturl="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('wikipage', $childWikiPage.Id))"&gt;
			&lt;div class="post full without-avatar"&gt;
				&lt;div class="content"&gt;
					&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('wikipage', $childWikiPage.Id))"&gt;$childWikiPage.Title&lt;/a&gt;
				&lt;/div&gt;
			&lt;/div&gt;
		&lt;/div&gt;
	#end
	&lt;/div&gt;
#end
		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
		  	<resource name="WikiPage_Name">Wiki Page</resource>
			<resource name="edit">Edit</resource>
			<resource name="delete">Delete</resource>
			<resource name="cancel">Cancel</resource>
		  </language>
		</languageResources>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:WikiPageAddEdit_Name}" version="7.0.0.1" description="" instanceIdentifier="c216859125284e928e76fa8e045bc9e4" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="wiki-page-add-edit">
    <contentScript>
		
#set ($pageName = $mobile_v1_url.Current)
#set ($mode = false)
#set ($contentTypeId = $core_v2_wikiPage.ContentTypeId)

#set($wikiPageId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('WikiPageId')))
#if($wikiPageId &lt; 0)
	#set($wikiId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('WikiId')))
	#if($wikiId &lt; 0)
		#$core_v2_widget.Hide()
	#end
#end


#if($pageName == 'wiki-addwikipage')
	#set ($mode = 'add')
#elseif ($pageName == 'wikipage-edit')
	#set ($mode = 'edit')
	#set ($editWikiPage = $core_v2_wikiPage.Get("%{Id = $wikiPageId}"))
	#set($wikiId = $editWikiPage.WikiId)
	#if($editWikiPage.ParentPageId &gt; 0)
		#set($parentWikiPage = $core_v2_wikiPage.Get("%{Id = $editWikiPage.ParentPageId}"))
	#end
#else
	#$core_v2_widget.Hide()
#end

#set($wiki = $core_v2_wiki.Get("%{Id = $wikiId}"))

#set ($titleId = $core_v2_widget.UniqueId('Title'))
#set ($parentId = $core_v2_widget.UniqueId('ParentPage'))
#set ($bodyId = $core_v2_widget.UniqueId('Body'))
#set ($subscribeId = $core_v2_widget.UniqueId('Subscribe'))

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($wiki.Group.Url)"&gt;$wiki.Group.Name&lt;/a&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($wiki.Url)"&gt;$wiki.Name&lt;/a&gt;
		&lt;h1&gt;
			#if ($editWikiPage)
				$editWikiPage.Title
			#else
				$core_v2_language.GetResource('new_page')
			#end
		&lt;/h1&gt;
	&lt;/div&gt;
&lt;/div&gt;
&lt;fieldset&gt;

	## Title
	&lt;div class="form-field text"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($titleId)"&gt;$core_v2_language.GetResource('title')&lt;/label&gt;
		&lt;input type="text" maxlength="256" id="$core_v2_encoding.HtmlAttributeEncode($titleId)" value="#if($mode=='edit')$editWikiPage.Title#end" /&gt;
	&lt;/div&gt;

	## Parent
	#if(!$editWikiPage.IsDefaultPage)
		&lt;div class="form-field text lookup"&gt;
			&lt;label for="$core_v2_encoding.HtmlAttributeEncode($parentId)"&gt;$core_v2_language.GetResource('parentPage')&lt;/label&gt;
			&lt;input type="text" maxlength="256" id="$core_v2_encoding.HtmlAttributeEncode($parentId)" #if($parentWikiPage.Id) value="$parentWikiPage.Id" #end/&gt;
		&lt;/div&gt;
	#end

	## TinyMCE
	&lt;div class="form-field editor"&gt;
		&lt;label for="$core_v2_widget.UniqueId('body')" class="field-item-header hidden"&gt;$core_v2_language.GetResource('Body')&lt;/label&gt;
		&lt;span class="field-item-input"&gt;$core_v2_editor.Render('body',"%{Width='100%', Height='250px', Value='$!editWikiPage.Body()', ContentTypeId=$core_v2_wikiPage.ContentTypeId}")&lt;/span&gt;
	&lt;/div&gt;

	## Email Replies
	#if ($core_v2_user.IsRegistered($core_v2_user.Accessing.Id))
		&lt;div class="form-field checkbox inline-label"&gt;
			&lt;label for="$core_v2_encoding.HtmlAttributeEncode($subscribeId)"&gt;$core_v2_language.GetResource('subscribe')&lt;/label&gt;
			&lt;input id="$core_v2_encoding.HtmlAttributeEncode($subscribeId)" type="checkbox" #if($mode == 'edit' &amp;&amp; $core_v2_wikiPage.IsSubscribed($editWikiPage.Id)) checked="checked" #elseif($mode =='add') checked="checked" #end/&gt;
		&lt;/div&gt;
	#end
&lt;/fieldset&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.wikiPageAddEdit.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			wikiId: $wikiId,
			wikiPageId: #if ($editWikiPage) $editWikiPage.Id #else null #end,
			mode: '$core_v2_encoding.JavascriptEncode($mode)',
			lookupPagesUrl:'$core_v2_widget.GetExecutedFileUrl('LookupPages.vm')',
			getBodyContent: function() { return $core_v2_editor.GetContentScript('body') },
			noPageMatchesText:'$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('WikiPage_NoMatches'))',
			titleInput: '#$core_v2_encoding.JavascriptEncode($titleId)',
			parentInput: '#$core_v2_encoding.JavascriptEncode($parentId)',
			bodyInput: '#$core_v2_encoding.JavascriptEncode($bodyId)',
			subscribeInput: '#$core_v2_encoding.JavascriptEncode($subscribeId)',
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			editLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('edit'))',
			userCanMovePage: #if($userCanMovePage) true#else false#end,
			#if($parentWikiPage)
				parentPageTitle:'$core_v2_encoding.JavascriptEncode($core_v2_language.Truncate($parentWikiPage.Title, 60, "..."))',
			#end
		});

		jQuery.telligent.evolution.mobile.refreshable(false);
		jQuery.telligent.evolution.mobile.excludeFromHistory();
	});
})
&lt;/script&gt;
		

		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
			<resource name="WikiPageAddEdit_Name">Add Edit Wiki Page</resource>
			<resource name="post">Post</resource>
			<resource name="edit">Edit</resource>
			<resource name="title">Title</resource>
			<resource name="parentPage">Parent page</resource>
			<resource name="parentPlace">Parent page...</resource>
			<resource name="body">Body</resource>
			<resource name="bodyPlace">Body...</resource>
			<resource name="subscribe">Notify me about updates</resource>
			<resource name="WikiPage_NoMatches">No matches can be found</resource>
			<resource name="new_page">New page</resource>
		  </language>
		</languageResources>
    <files>
      <file name="LookupPages.vm">JGNvcmVfdjJfcGFnZS5TZXRDb250ZW50VHlwZSgnYXBwbGljYXRpb24vanNvbicpDQoNCiNzZXQoJHdpa2lJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X3dpa2lJZCcpKSkNCiNzZXQoJHNlYXJjaFRleHQgPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfc2VhcmNoVGV4dCcpLlRvTG93ZXIoKSkNCiNzZXQoJHRvdGFsTWF0Y2hlcyA9IDApDQp7InBhZ2VzIjpbDQoJI2ZvcmVhY2goJHBhZ2UgaW4gJGNvcmVfdjJfdXRpbGl0eS5GbGF0dGVuSGllcmFyY2h5KCRjb3JlX3YyX3dpa2lUb2MuTGlzdCgkd2lraUlkKSwgJ0NoaWxkcmVuJykpDQoJCSNpZigkdG90YWxNYXRjaGVzIDwgMjApCQ0KCQkJI3NldCgkY2hpbGRXaWtpUGFnZSA9ICRjb3JlX3YyX3dpa2lQYWdlLkdldCgiJXtJZCA9ICRwYWdlLkl0ZW0uSWR9IikpDQoJCQkjaWYoISRjaGlsZFdpa2lQYWdlLklzRGVmYXVsdFBhZ2UpDQoJCQkJI2lmKCRwYWdlLkl0ZW0uVGl0bGUuVG9Mb3dlcigpLkNvbnRhaW5zKCRzZWFyY2hUZXh0KSkNCgkJCQkJI3NldCgkdHJ1bmsgPSAkY29yZV92Ml9sYW5ndWFnZS5UcnVuY2F0ZSgkcGFnZS5JdGVtLlRpdGxlLCA1NSwgIi4uLiIpKQ0KCQkJCQl7InBhZ2VJZCI6JHBhZ2UuSXRlbS5JZCwidGl0bGUiOiIkY29yZV92Ml9lbmNvZGluZy5KYXZhc2NyaXB0RW5jb2RlKCR0cnVuaykifSwNCgkJCQkJI3NldCgkdG90YWxNYXRjaGVzID0gJHRvdGFsTWF0Y2hlcyArIDEpDQoJCQkJI2VuZA0KCQkJI2VuZA0KCQkjZW5kDQoJI2VuZA0KbnVsbF19</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpIHsNCg0KCXZhciBtb2RlbCA9IHsNCgkJYWRkVGhyZWFkOiBmdW5jdGlvbihvcHRpb25zKSB7DQoJCQl2YXIgZGF0YSA9IHsNCgkJCQlXaWtpSWQ6IG9wdGlvbnMud2lraUlkLA0KCQkJCUJvZHk6IG9wdGlvbnMuYm9keSwNCgkJCQlUaXRsZTogb3B0aW9ucy5zdWJqZWN0DQoJCQl9Ow0KCQkJaWYgKG9wdGlvbnMucGFyZW50KSB7DQoJCQkJZGF0YS5QYXJlbnRQYWdlSWQgPSBvcHRpb25zLnBhcmVudC52YWwoKSA/IG9wdGlvbnMucGFyZW50LnZhbCgpIDogLTE7DQoJCQl9DQoNCgkJCXJldHVybiAkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNob3dMb2FkaW5nKCQudGVsbGlnZW50LmV2b2x1dGlvbi5wb3N0KHsNCgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi93aWtpcy97V2lraUlkfS9wYWdlcy5qc29uJywNCgkJCQlkYXRhOiBkYXRhDQoJCQl9KSk7DQoJCX0sDQoJCWVkaXRUaHJlYWQ6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCXZhciBkYXRhID0gew0KCQkJCVdpa2lJZDogb3B0aW9ucy53aWtpSWQsDQoJCQkJSWQ6IG9wdGlvbnMud2lraVBhZ2VJZCwNCgkJCQlCb2R5OiBvcHRpb25zLmJvZHksDQoJCQkJVGl0bGU6IG9wdGlvbnMuc3ViamVjdA0KCQkJfTsNCgkJCWlmIChvcHRpb25zLnBhcmVudCkgew0KCQkJCWRhdGEuUGFyZW50UGFnZUlkID0gb3B0aW9ucy5wYXJlbnQudmFsKCkgPyBvcHRpb25zLnBhcmVudC52YWwoKSA6IC0xOw0KCQkJfQ0KDQoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygkLnRlbGxpZ2VudC5ldm9sdXRpb24ucHV0KHsNCgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi93aWtpcy97V2lraUlkfS9wYWdlcy97SWR9Lmpzb24nLA0KCQkJCWRhdGE6IGRhdGENCgkJCX0pKTsNCgkJfQ0KCX0NCg0KCXZhciBiaW5kRWxlbWVudHMgPSBmdW5jdGlvbihvcHRpb25zKSB7DQoJCW9wdGlvbnMucGFyZW50SW5wdXQgPSAkKG9wdGlvbnMucGFyZW50SW5wdXQpOw0KCQlpZiAob3B0aW9ucy5wYXJlbnRJbnB1dCAmJiBvcHRpb25zLmxvb2t1cFBhZ2VzVXJsICYmIG9wdGlvbnMubm9QYWdlTWF0Y2hlc1RleHQpIHsNCgkJCXZhciB0aW1lb3V0ID0gbnVsbDsNCgkJCW9wdGlvbnMucGFyZW50SW5wdXQuZ2xvd0xvb2tVcFRleHRCb3goew0KCQkJCSdtYXhWYWx1ZXMnOjEsDQoJCQkJJ2VtcHR5SHRtbCc6JycsDQoJCQkJJ29uR2V0TG9va1Vwcyc6ZnVuY3Rpb24odGIsIHNlYXJjaFRleHQpIHsNCgkJCQkJdmFyIGRpc2FibGVkID0gdGIuZ2xvd0xvb2tVcFRleHRCb3goJ2Rpc2FibGVkJyk7DQoJCQkJCXdpbmRvdy5jbGVhclRpbWVvdXQodGltZW91dCk7DQoJCQkJCWlmKHNlYXJjaFRleHQgJiYgc2VhcmNoVGV4dC5sZW5ndGggPiAyKSB7DQoJCQkJCQl0Yi5nbG93TG9va1VwVGV4dEJveCgndXBkYXRlU3VnZ2VzdGlvbnMnLCBbdGIuZ2xvd0xvb2tVcFRleHRCb3goJ2NyZWF0ZUxvb2tVcCcsJycsJzxkaXYgc3R5bGU9InRleHQtYWxpZ246IGNlbnRlcjsiPjxpbWcgc3JjPSInICsgJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ3V0aWxpdHkvc3Bpbm5lci5naWYiIC8+PC9kaXY+JywnPGRpdiBzdHlsZT0idGV4dC1hbGlnbjogY2VudGVyOyI+PGltZyBzcmM9IicgKyAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAndXRpbGl0eS9zcGlubmVyLmdpZiIgYWx0PSLigKYiIC8+PC9kaXY+JywgZmFsc2UpXSk7DQoJCQkJCQl0aW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7DQoJCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsNCgkJCQkJCQkJdXJsOiBvcHRpb25zLmxvb2t1cFBhZ2VzVXJsLA0KCQkJCQkJCQlkYXRhOiB7DQoJCQkJCQkJCQl3X3dpa2lJZDogb3B0aW9ucy53aWtpSWQsDQoJCQkJCQkJCQl3X3NlYXJjaFRleHQ6IHNlYXJjaFRleHQNCgkJCQkJCQkJfSwgc3VjY2VzczogZnVuY3Rpb24ocmVzcG9uc2UpIHsNCgkJCQkJCQkJCWlmIChyZXNwb25zZSAmJiByZXNwb25zZS5wYWdlcy5sZW5ndGggPiAxKQ0KCQkJCQkJCQkJew0KCQkJCQkJCQkJCXZhciBzdWdnZXN0aW9ucyA9IFtdOw0KCQkJCQkJCQkJCWZvciAodmFyIGkgPSAwOyBpIDwgcmVzcG9uc2UucGFnZXMubGVuZ3RoIC0gMTsgaSsrKQ0KCQkJCQkJCQkJCQlzdWdnZXN0aW9uc1tzdWdnZXN0aW9ucy5sZW5ndGhdID0gdGIuZ2xvd0xvb2tVcFRleHRCb3goJ2NyZWF0ZUxvb2tVcCcscmVzcG9uc2UucGFnZXNbaV0ucGFnZUlkLHJlc3BvbnNlLnBhZ2VzW2ldLnRpdGxlLHJlc3BvbnNlLnBhZ2VzW2ldLnRpdGxlLHRydWUpOw0KCQkJCQkJCQkJCXRiLmdsb3dMb29rVXBUZXh0Qm94KCd1cGRhdGVTdWdnZXN0aW9ucycsIHN1Z2dlc3Rpb25zKTsNCgkJCQkJCQkJCX0NCgkJCQkJCQkJCWVsc2UNCgkJCQkJCQkJCQl0Yi5nbG93TG9va1VwVGV4dEJveCgndXBkYXRlU3VnZ2VzdGlvbnMnLCBbdGIuZ2xvd0xvb2tVcFRleHRCb3goJ2NyZWF0ZUxvb2tVcCcsJycsb3B0aW9ucy5ub1BhZ2VNYXRjaGVzVGV4dCxvcHRpb25zLm5vUGFnZU1hdGNoZXNUZXh0LGZhbHNlKV0pOw0KCQkJCQkJCQl9DQoJCQkJCQkJfSkpOw0KCQkJCQkJfSwgNzQ5KTsNCgkJCQkJfQ0KCQkJCX0sDQoJCQkJJ3NlbGVjdGVkTG9va1Vwc0h0bWwnOiAob3B0aW9ucy5wYXJlbnRQYWdlVGl0bGUgPyBbb3B0aW9ucy5wYXJlbnRQYWdlVGl0bGVdIDogW10pDQoJCQl9KTsNCgkJfQ0KCX0NCgl2YXIgYXBpID0gew0KCQlyZWdpc3RlcjogZnVuY3Rpb24ob3B0aW9ucykgew0KDQoJCQl2YXIgdGl0bGVJbnB1dCA9ICQob3B0aW9ucy50aXRsZUlucHV0KSwNCgkJCQlzdWJzY3JpYmVJbnB1dCA9ICQob3B0aW9ucy5zdWJzY3JpYmVJbnB1dCksDQoJCQkJd2lraUlkSW5wdXQgPSBvcHRpb25zLndpa2lJZCwNCgkJCQlwb3N0TGluayA9ICQoJzxhIGhyZWY9IiMiIGNsYXNzPSJzdWJtaXQiPicgKyAob3B0aW9ucy5tb2RlID09ICdhZGQnID8gb3B0aW9ucy5wb3N0TGFiZWwgOiBvcHRpb25zLmVkaXRMYWJlbCkgKyAnPC9hPicpOw0KDQoJCQlwb3N0TGluay5vbigndGFwJywgZnVuY3Rpb24oKXsNCgkJCQl2YXIgYm9keSA9ICQudHJpbShvcHRpb25zLmdldEJvZHlDb250ZW50KCkpLA0KCQkJCQlzdWJqZWN0ID0gJC50cmltKHRpdGxlSW5wdXQudmFsKCkpLA0KCQkJCQlwYXJlbnQgPSAkKG9wdGlvbnMucGFyZW50SW5wdXQpLA0KCQkJCQl3aWtpSWQgPSAkLnRyaW0od2lraUlkSW5wdXQpLA0KCQkJCQlzdWJzY3JpYmUgPSBzdWJzY3JpYmVJbnB1dC5pcygnOmNoZWNrZWQnKSwNCgkJCQkJc3VibWl0QWN0aW9uOw0KDQoJCQkJaWYoYm9keS5sZW5ndGggPiAwICYmIHN1YmplY3QubGVuZ3RoID4gMCkgew0KCQkJCQlpZihvcHRpb25zLm1vZGUgPT0gJ2FkZCcpIHsNCgkJCQkJCXN1Ym1pdEFjdGlvbiA9IG1vZGVsLmFkZFRocmVhZCh7DQoJCQkJCQkJc3ViamVjdDogc3ViamVjdCwNCgkJCQkJCQlwYXJlbnQ6IHBhcmVudCwNCgkJCQkJCQlib2R5OiBib2R5LA0KCQkJCQkJCXdpa2lJZDogd2lraUlkLA0KCQkJCQkJCXN1YnNjcmliZVRvVGhyZWFkOiBzdWJzY3JpYmVJbnB1dC5sZW5ndGggPT0gMCA/IG51bGwgOiBzdWJzY3JpYmVJbnB1dC5pcygnOmNoZWNrZWQnKQ0KCQkJCQkJfSk7DQoJCQkJCX0gZWxzZSBpZihvcHRpb25zLm1vZGUgPT0gJ2VkaXQnKSB7DQoJCQkJCQlzdWJtaXRBY3Rpb24gPSBtb2RlbC5lZGl0VGhyZWFkKHsNCgkJCQkJCQlzdWJqZWN0OiBzdWJqZWN0LA0KCQkJCQkJCXBhcmVudDogcGFyZW50LA0KCQkJCQkJCWJvZHk6IGJvZHksDQoJCQkJCQkJd2lraUlkOiB3aWtpSWQsDQoJCQkJCQkJd2lraVBhZ2VJZDogb3B0aW9ucy53aWtpUGFnZUlkLA0KCQkJCQkJCXN1YnNjcmliZVRvVGhyZWFkOiAoc3Vic2NyaWJlSW5wdXQubGVuZ3RoID09IDAgPyBudWxsIDogc3Vic2NyaWJlSW5wdXQuaXMoJzpjaGVja2VkJykpDQoJCQkJCQl9KTsNCgkJCQkJfQ0KDQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoc3VibWl0QWN0aW9uKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXsNCgkJCQkJCXZhciBsaW5rID0gJy93aWtpcGFnZXMvJyArIHJlc3BvbnNlLldpa2lQYWdlLklkOw0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7DQoJCQkJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvd2lraXMve3dpa2lpZH0vcGFnZXMve3dpa2lwYWdlaWR9L3N1YnNjcmlwdGlvbnMuanNvbicsDQoJCQkJCQkJZGF0YTogew0KCQkJCQkJCQl3aWtpaWQ6IHJlc3BvbnNlLldpa2lQYWdlLldpa2lJZCwNCgkJCQkJCQkJd2lraXBhZ2VpZDogcmVzcG9uc2UuV2lraVBhZ2UuSWQsDQoJCQkJCQkJCUlzU3Vic2NyaWJlZDogc3Vic2NyaWJlDQoJCQkJCQkJfQ0KCQkJCQkJfSkuZG9uZShmdW5jdGlvbigpIHsNCgkJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmxvYWQobGluaywgeyByZWZyZXNoOiB0cnVlIH0pOw0KCQkJCQkJfSk7DQoJCQkJCX0pOw0KCQkJCX0NCgkJCX0pOw0KDQoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNldEhlYWRlckJ1dHRvbihwb3N0TGluayk7DQoNCgkJCWJpbmRFbGVtZW50cyhvcHRpb25zKTsNCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMud2lraVBhZ2VBZGRFZGl0ID0gYXBpOw0KDQp9KShqUXVlcnksIHdpbmRvdyk7</file>
    </files>
  </scriptedContentFragment>
</scriptedContentFragments>