<scriptedContentFragments>
  <scriptedContentFragment name="${resource:ActivityStory_Name}" version="7.0.0.1" description="" instanceIdentifier="6252ef55611d4b26955d695433396c27" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="activity-story">
    <contentScript>
		

#set ($activityId = $core_v2_utility.ParseGuid($mobile_v1_urlToken.Value('ActivityStoryId')))
#set ($story = $core_v2_activityStory.Get($activityId))

#set ($accessingUser = $core_v2_user.Accessing)
#set ($accessingUserIsRegistered = false)
#if ($core_v2_user.IsRegistered($accessingUser.Id))
	#set ($accessingUserIsRegistered = true)
#end

#set ($widgetUniqueStoryId = "${core_v2_widget.WrapperElementId}_story_${message.StoryId}")

#set ($primaryStoryUser = $story.PrimaryUser)

#set ($primaryStoryUserIsRegistered = false)
#set ($primaryStoryUserIsRegistered = $core_v2_user.IsRegistered($primaryStoryUser.Id))
#set ($primaryStoryUserIsAccessingUser = false)
#if ($accessingUser.Id == $primaryStoryUser.Id)
	#set ($primaryStoryUserIsAccessingUser = true)
#end

#set ($commentsSupported = false)
#set ($commentsSupported = $core_v2_comments.SupportsComments($story.ContentTypeId))

#set ($accessingUserCanComment = false)
#if ($commentsSupported)
	#set ($accessingUserCanComment = $core_v2_comments.CanCreateComment($story.ContentId, $story.ContentTypeId))
#end

#set ($widgetUniqueStoryId = "${core_v2_widget.WrapperElementId}_story_${story.StoryId}")
#set ($storyType = $story.StoryTypeId)

&lt;div class="post activity isolated"&gt;
	&lt;div class="avatar"&gt;
		#if ($primaryStoryUser.ProfileUrl)
			&lt;a href="$core_v2_encoding.HtmlAttributeEncode($primaryStoryUser.ProfileUrl)" class="internal-link view-user-profile"&gt;
				$core_v2_ui.GetResizedImageHtml($primaryStoryUser.AvatarUrl, 40, 40, "%{border='0', alt=$primaryStoryUser.DisplayName, ResizeMethod='ZoomAndCrop',border='0'}")
			&lt;/a&gt;
		#else
			$core_v2_ui.GetResizedImageHtml($primaryStoryUser.AvatarUrl, 40, 40, "%{border='0', alt=$primaryStoryUser.DisplayName, ResizeMethod='ZoomAndCrop',border='0'}")
		#end
	&lt;/div&gt;

	&lt;div class="date"&gt;$core_v2_language.FormatAgoDate($story.CreatedDate)&lt;/div&gt;
	&lt;div class="content"&gt;
		$mobile_v1_dataFormat.Detect($story.ViewHtml('Web'))
	&lt;/div&gt;

	&lt;div class="ui-links actions" data-maxlinks="1"&gt;
		#if ($accessingUserIsRegistered &amp;&amp; $core_v2_like.CanLike($story.ContentId, $story.ContentTypeId))
			&lt;li class="action-like-message"&gt;
				#set($format = '{toggle} &lt;span class="count"&gt;&lt;span class="icon"&gt;&lt;/span&gt;{count}&lt;/span&gt;')
				#set ($likeOptions = "%{ Format = $format }")
				#if ($story.TypeId)
					$likeOptions.Add('LikeTypeId', $story.TypeId)
				#end
				$core_v2_ui.Like($story.ContentId, $story.ContentTypeId, $likeOptions)
			&lt;/li&gt;
		#end

		#if($core_v2_activityStory.CanDelete($story.StoryId))
			&lt;li class="action-delete"&gt;&lt;a href="#" class="delete" data-storyid="$story.StoryId"&gt;$core_v2_language.GetResource('delete')&lt;/a&gt;&lt;/li&gt;
		#end
		&lt;li class="action-moderate"&gt;$core_v2_ui.Moderate($story.ContentId, $story.ContentTypeId)&lt;/li&gt;
		&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('Cancel')&lt;/a&gt;&lt;/li&gt;
	&lt;/div&gt;
&lt;/div&gt;
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;

&lt;script&gt;
var deleteContext = {
	confirm: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('deleteActivityMessage'))'
}
## Handle Delete clicks
jQuery('#$core_v2_widget.WrapperElementId a.delete').each(function(){
	var delLink = $(this);
	delLink.off('tap').on('tap', function(){
		jQuery.telligent.evolution.widgets.activityStory.del(delLink.data('storyid'), deleteContext);
	});
});
&lt;/script&gt;

$mobile_v1_ui.Comments($story.ContentId, $story.ContentTypeId, "%{ CanFlagAsAbusive = $accessingUserIsRegistered, AccessingUserId = $accessingUser.Id }")

		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="ActivityStory_Name">Activity Story</resource>
		<resource name="deleteActivityMessage">Are you sure you want to delete this story?</resource>
		<resource name="deleteCommentMessage">Are you sure you want to delete this comment?</resource>
		<resource name="delete">Delete</resource>
		<resource name="comment">Comment</resource>
		<resource name="comments">Comments</resource>
		<resource name="Cancel">Cancel</resource>
	  </language>
	</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQpewoKCXZhciBhcGkgPSB7CgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCgkJfSwKCQlkZWw6IGZ1bmN0aW9uKGlkLCBjb250ZXh0KSB7CgkJCWlmKGNvbmZpcm0oY29udGV4dC5jb25maXJtKSkgewoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygkLnRlbGxpZ2VudC5ldm9sdXRpb24uZGVsKHsKCQkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi9zdG9yaWVzL3tTdG9yeUlkfS5qc29uJywKCQkJCQlkYXRhOiB7IFN0b3J5SWQ6IGlkIH0sCgkJCQkJY2FjaGU6IGZhbHNlCgkJCQl9KSkuZG9uZShmdW5jdGlvbigpewoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuYmFjayh0cnVlKTsKCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmhpZGVTaGVldCgpOwoJCQkJfSkKCQkJfSBlbHNlIHsKCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuaGlkZVNoZWV0KCk7CgkJCX0KCQl9Cgl9CgoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5hY3Rpdml0eVN0b3J5ID0gYXBpOwoKfSkoalF1ZXJ5KTsK</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:ActivityStoryStream_Name}" version="7.0.0.1" description="" instanceIdentifier="cb7d40730a64458792894cec206da723" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="activity-story-stream">
    <contentScript>


#set ($pageSize = $core_v2_widget.GetIntValue('pageSize', 7))
#set ($endlessScroll = $core_v2_widget.GetBoolValue('endlessScroll', true))

#set($filterType = false)
#set($filterType = $core_v2_widget.GetStringValue('filterType', ''))

#set($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))

#set ($user = false)
#if ($filterType == 'User')
	#set ($userId = false)
	#set ($userId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('UserId')))

	#set ($user = false)
	#set ($user = $core_v2_user.Get("%{ Id = $userId }"))

	#if (!$user)
		#set ($user = $core_v2_user.Accessing)
	#end
	## if contextual/accessing user is anonymous, fall back to site filter mode
	#if (!$core_v2_user.IsRegistered($user.Id))
		#set ($filterType = 'Site')
	#else
		&lt;div class="banner condensed"&gt;
			&lt;div class="context"&gt;
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($user.ProfileUrl)"&gt;$user.DisplayName&lt;/a&gt;
				&lt;h1&gt;$!core_v2_language.FormatString($core_v2_language.GetResource('User_Activity'), $user.DisplayName)&lt;/h1&gt;
			&lt;/div&gt;
			&lt;div class="avatar"&gt;$!core_v2_ui.GetResizedImageHtml($user.AvatarUrl, 40, 40, "%{ alt = $user.DisplayName, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
		&lt;/div&gt;
	#end
#else
	#set($user = $core_v2_user.Accessing)
#end

#set ($isAdministrator = false)
#if ($core_v2_nodePermission.Get('Site_ModerateUserContent').IsAllowed)
	#set($isAdministrator = true)
#end

#set ($accessingUser = $core_v2_user.Accessing)
#set ($accessingUserIsRegistered = false)
#if ($core_v2_user.IsRegistered($accessingUser.Id))
	#set ($accessingUserIsRegistered = true)
#end

#set ($group = false)
#set ($enablePosting = false)
#if ($groupId &gt; 0)
	#set($group = $core_v2_group.Get("%{Id = $groupId}"))
	#set ($enablePosting = $group.EnableGroupMessages)
	#if ($group.GroupType == 'Joinless')
		#set ($enablePosting = $enablePosting &amp;&amp; $core_v2_user.IsRegistered($core_v2_user.Accessing.Id))
	#else
		#set ($groupUserMember = false)
		#set ($groupUserMember = $core_v2_groupUserMember.Get($group.Id, "%{ UserId = $accessingUser.Id }"))
		#set ($enablePosting = $enablePosting &amp;&amp; $groupUserMember != false &amp;&amp; ($groupUserMember.MembershipType == "Owner" || $groupUserMember.MembershipType == "Manager" || $groupUserMember.MembershipType == "Member"))
	#end
#else
	#set($enablePosting = $core_v2_user.IsRegistered($core_v2_user.Accessing.Id))
#end
#set ($enablePosting = $enablePosting &amp;&amp; $core_v2_activityStoryUserPreference.Get($core_v2_statusMessage.StoryTypeId).IsLoggingEnabled)

## Hide the stream if private and not a member
#set ($hasAcess = true)
#if ($group)
	#set ($member = $core_v2_groupUserMember.Get($group.Id, "%{ UserId = $accessingUser.Id }"))
	#if (($group.GroupType == 'PrivateListed' || $group.GroupType == 'PrivateUnlisted') &amp;&amp; !($member.IsRoleMember || $member.MembershipType == "Owner" || $member.MembershipType == "Manager" || $member.MembershipType == "Member"))
		#set ($hasAcess = false)
	#end
#end

#if ($hasAcess)

	## ######################
	## Determine Configured Filters
	## ######################

	#set ($filterName0 = $core_v2_widget.ApplyTokens($core_v2_widget.GetStringValue('filterName0',$core_v2_language.GetResource('filterNameDefault'))))
	#set ($filterTypes0 = false)
	#if($filterType == 'User')
		#set ($filterTypes0 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterUserActivityTypes0','')))
	#else
		#set ($filterTypes0 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterActivityTypes0','')))
	#end

	#set ($filterName1 = $core_v2_widget.ApplyTokens($core_v2_widget.GetStringValue('filterName1',$core_v2_language.GetResource('filterNameDefault'))))
	#set ($filterTypes1 = false)
	#if($filterType == 'User')
		#set ($filterTypes1 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterUserActivityTypes1','')))
	#else
		#set ($filterTypes1 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterActivityTypes1','')))
	#end

	#set ($filterName2 = $core_v2_widget.ApplyTokens($core_v2_widget.GetStringValue('filterName2',$core_v2_language.GetResource('filterNameDefault'))))
	#set ($filterTypes2 = false)
	#if($filterType == 'User')
		#set ($filterTypes2 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterUserActivityTypes2','')))
	#else
		#set ($filterTypes2 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterActivityTypes2','')))
	#end

	#set ($filterName3 = $core_v2_widget.ApplyTokens($core_v2_widget.GetStringValue('filterName3',$core_v2_language.GetResource('filterNameDefault'))))
	#set ($filterTypes3 = false)
	#if($filterType == 'User')
		#set ($filterTypes3 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterUserActivityTypes3','')))
	#else
		#set ($filterTypes3 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterActivityTypes3','')))
	#end

	#set ($filterName4 = $core_v2_widget.ApplyTokens($core_v2_widget.GetStringValue('filterName4',$core_v2_language.GetResource('filterNameDefault'))))
	#set ($filterTypes4 = false)
	#if($filterType == 'User')
		#set ($filterTypes4 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterUserActivityTypes4','')))
	#else
		#set ($filterTypes4 = $core_v2_page.ParseQueryString($core_v2_widget.GetCustomValue('filterActivityTypes4','')))
	#end


	## ######################
	## Render Filters
	## ######################

	## get any querystring-sent parameters

	## end date (endless scrolling)

	#set ($endDate = false)
	#if ($core_v2_page.GetQueryStringValue('w_endDate').length &gt; 0)
		#set($endDate = $core_v2_utility.ParseDate($core_v2_page.GetQueryStringValue('w_endDate')))
	#end

	## filter index

	#set ($filterIndex = 0)
	#set ($filterIndex = $core_v2_page.GetQueryStringValue('w_filterIndex'))

	## only show filters if there's more than one defined
	#set ($explicitFilters = 0)
	#if ($filterTypes0.Values('filters').Count &gt; 0)
		#set ($explicitFilters = $explicitFilters + 1)
	#end
	#if ($filterTypes1.Values('filters').Count &gt; 0)
		#set ($explicitFilters = $explicitFilters + 1)
	#end
	#if ($filterTypes2.Values('filters').Count &gt; 0)
		#set ($explicitFilters = $explicitFilters + 1)
	#end
	#if ($filterTypes3.Values('filters').Count &gt; 0)
		#set ($explicitFilters = $explicitFilters + 1)
	#end
	#if ($filterTypes4.Values('filters').Count &gt; 0)
		#set ($explicitFilters = $explicitFilters + 1)
	#end

	#if ($explicitFilters &gt; 1 &amp;&amp; ($filterTypes0.Values('filters').Count &gt; 0 || $filterTypes1.Values('filters').Count &gt; 0 || $filterTypes2.Values('filters').Count &gt; 0 || $filterTypes3.Values('filters').Count &gt; 0 || $filterTypes4.Values('filters').Count &gt; 0))
		&lt;div class="ui-links filters" data-minlinks="50" data-animate="true"&gt;
			&lt;ul class="activity-filters"&gt;
				#if ($filterTypes0.Values('filters').Count &gt; 0 &amp;&amp; $filterName0.length &gt; 0)
					&lt;li&gt;&lt;a class="#if($filterIndex == 0)selected #end" href="#" data-filterindex="0" #if($filterIndex == 0)data-selected #end&gt;$filterName0&lt;/a&gt;&lt;/li&gt;
				#end
				#if ($filterTypes1.Values('filters').Count &gt; 0 &amp;&amp; $filterName1.length &gt; 0)
					&lt;li&gt;&lt;a class="#if($filterIndex == 1)selected #end" href="#" data-filterindex="1" #if($filterIndex == 1)data-selected #end&gt;$filterName1&lt;/a&gt;&lt;/li&gt;
				#end
				#if ($filterTypes2.Values('filters').Count &gt; 0 &amp;&amp; $filterName2.length &gt; 0)
					&lt;li&gt;&lt;a class="#if($filterIndex == 2)selected #end" href="#" data-filterindex="2" #if($filterIndex == 2)data-selected #end&gt;$filterName2&lt;/a&gt;&lt;/li&gt;
				#end
				#if ($filterTypes3.Values('filters').Count &gt; 0 &amp;&amp; $filterName3.length &gt; 0)
					&lt;li&gt;&lt;a class="#if($filterIndex == 3)selected #end" href="#" data-filterindex="3" #if($filterIndex == 3)data-selected #end&gt;$filterName3&lt;/a&gt;&lt;/li&gt;
				#end
				#if ($filterTypes4.Values('filters').Count &gt; 0 &amp;&amp; $filterName4.length &gt; 0)
					&lt;li&gt;&lt;a class="#if($filterIndex == 4)selected #end" href="#" data-filterindex="4" #if($filterIndex == 4)data-selected #end&gt;$filterName4&lt;/a&gt;&lt;/li&gt;
				#end
			&lt;/ul&gt;
		&lt;/div&gt;
	#end

	## load and render stories
	&lt;div class="post-list stream"&gt;
		$core_v2_widget.ExecuteFile("stream.vm")
	&lt;/div&gt;

	## render client script inline since it's short and to avoid extra http requests
	&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
	&lt;script&gt;
	jQuery(function(){
		jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
			jQuery.telligent.evolution.widgets.activityStoryStream.register({
				wrapper: '#$core_v2_widget.WrapperElementId',
				currentFilterIndex: $filterIndex,
				pageSize: $pageSize,
				filterType: '$filterType',
				groupId: $groupId,
				moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
				postUrl: #if ($enablePosting) #if ($groupId &gt; 0) '$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('group-status-add', $groupId))' #else '$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('status-add'))' #end #else null #end,
				postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('Post'))'
			});
		});
	})
	&lt;/script&gt;

#else
	&lt;div class="post topic full"&gt;
		&lt;div class="content"&gt;
			$core_v2_language.GetResource('access_denied')
		&lt;/div&gt;
	&lt;/div&gt;
#end


	</contentScript>
    <headerScript>
	</headerScript>
    <configuration>
	  
&lt;propertyGroup id="options" resourceName="options"&gt;
	&lt;property id="fragmentHeader" resourceName="title" dataType="string" defaultValue="${resource:activityStoryStream_name}" /&gt;
	&lt;property id="pageSize" resourceName="pageSize" dataType="int" defaultValue="10" /&gt;
	&lt;property id="filterType" resourceName="filterType" descriptionResourceName="filterType_Desc" dataType="string" defaultValue="" &gt;
		&lt;propertyValue value="Site" resourceName="filterType_site"
			propertiesToHide="includeSubGroups,filterUserActivityTypes0,filterUserActivityTypes1,filterUserActivityTypes2,filterUserActivityTypes3,filterUserActivityTypes4"
			propertiesToShow="activityTypes0,filterActivityTypes1,filterActivityTypes2,filterActivityTypes3,filterActivityTypes4" /&gt;
		&lt;propertyValue value="Group" resourceName="filterType_group"
			propertiesToHide="filterUserActivityTypes0,filterUserActivityTypes1,filterUserActivityTypes2,filterUserActivityTypes3,filterUserActivityTypes4"
			propertiesToShow="includeSubGroups,filterActivityTypes0,filterActivityTypes1,filterActivityTypes2,filterActivityTypes3,filterActivityTypes4" /&gt;
		&lt;propertyValue value="User" resourceName="filterType_userProfile"
			propertiesToHide="includeSubGroups,filterActivityTypes0,filterActivityTypes1,filterActivityTypes2,filterActivityTypes3,activityTypes4"
			propertiesToShow="filterUserActivityTypes0,filterUserActivityTypes1,filterUserActivityTypes2,filterUserActivityTypes3,filterUserActivityTypes4" /&gt;
	&lt;/property&gt;
	&lt;property id="includeSubGroups" resourceName="includeSubGroups" dataType="bool" defaultValue="false" /&gt;
	&lt;property id="endlessScroll" resourceName="endlessScroll" descriptionResourceName="endlessScrollDesc" dataType="bool" defaultValue="true" /&gt;
&lt;/propertyGroup&gt;
&lt;propertyGroup id="filter0" resourceName="filter0" descriptionResourceName="filter_desc"&gt;
	&lt;property id="filterName0" resourceName="filterName" descriptionResourceName="filterDesc" dataType="string"
		defaultValue="${resource:filterNameDefault}" /&gt;
	&lt;property id="filterActivityTypes0" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom"
		defaultValue="filters=948477cb045b40778bf17ce1a091db11&amp;amp;filters=44a697e2d1b348f6951945cfa2bfc4fd&amp;amp;filters=0f7404b7d8f24a1b97c9175af1be4570&amp;amp;filters=06336ce1600c40e4b32d97ff811ad7bd&amp;amp;filters=acf00be657174a25a17de2036c694444&amp;amp;filters=0a680cf3f19648c592dbdf8cebe3fe92&amp;amp;filters=ecf7e9ef76f0447c9b252a531c7bb651&amp;amp;filters=edebd6ada45a470f89e63dfc31714bd6&amp;amp;filters=a23334fb669a421d85e91945a7b80581&amp;amp;filters=14656a259a034311b8e346cef57ac02b&amp;amp;filters=333cc77c019644c5aefa6e35a0011ee8&amp;amp;filters=276a9e5128394ae98291e3f24b49cbc4&amp;amp;filters=e9dd0cb7adf74518b0961b00f3f51246&amp;amp;filters=3d10e9df357b42038f7d3bf15f60fd61&amp;amp;filters=cf26068cf6644050bf69f1d5c3e7eb1a&amp;amp;filters=432f675c15bb429c98a99e99d539587b&amp;amp;948477cb045b40778bf17ce1a091db11=All&amp;amp;44a697e2d1b348f6951945cfa2bfc4fd=All&amp;amp;0f7404b7d8f24a1b97c9175af1be4570=All&amp;amp;06336ce1600c40e4b32d97ff811ad7bd=All&amp;amp;acf00be657174a25a17de2036c694444=All&amp;amp;0a680cf3f19648c592dbdf8cebe3fe92=All&amp;amp;ecf7e9ef76f0447c9b252a531c7bb651=All&amp;amp;edebd6ada45a470f89e63dfc31714bd6=All&amp;amp;a23334fb669a421d85e91945a7b80581=All&amp;amp;14656a259a034311b8e346cef57ac02b=All&amp;amp;333cc77c019644c5aefa6e35a0011ee8=All&amp;amp;276a9e5128394ae98291e3f24b49cbc4=All&amp;amp;e9dd0cb7adf74518b0961b00f3f51246=All&amp;amp;3d10e9df357b42038f7d3bf15f60fd61=All&amp;amp;cf26068cf6644050bf69f1d5c3e7eb1a=All&amp;amp;432f675c15bb429c98a99e99d539587b=All"&gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_User" /&gt;
		&lt;propertyValue value="Followed" resourceName="activityTypeUsers_Followed" /&gt;
		&lt;propertyValue value="User,Followed" resourceName="activityTypeUsers_UserAndFollowed" /&gt;
		&lt;propertyValue value="All" resourceName="activityTypeUsers_All" /&gt;
	&lt;/property&gt;
	&lt;property id="filterUserActivityTypes0" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom" &gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_Include" /&gt;
	&lt;/property&gt;
&lt;/propertyGroup&gt;
&lt;propertyGroup id="filter1" resourceName="filter1" descriptionResourceName="filter_desc"&gt;
	&lt;property id="filterName1" resourceName="filterName" descriptionResourceName="filterDesc" dataType="string"
		defaultValue="${resource:filterNameDefault}" /&gt;
	&lt;property id="filterActivityTypes1" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom"&gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_User" /&gt;
		&lt;propertyValue value="Followed" resourceName="activityTypeUsers_Followed" /&gt;
		&lt;propertyValue value="User,Followed" resourceName="activityTypeUsers_UserAndFollowed" /&gt;
		&lt;propertyValue value="All" resourceName="activityTypeUsers_All" /&gt;
	&lt;/property&gt;
	&lt;property id="filterUserActivityTypes1" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom"&gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_Include" /&gt;
	&lt;/property&gt;
&lt;/propertyGroup&gt;
&lt;propertyGroup id="filter2" resourceName="filter2" descriptionResourceName="filter_desc"&gt;
	&lt;property id="filterName2" resourceName="filterName" descriptionResourceName="filterDesc" dataType="string"
		defaultValue="${resource:filterNameDefault}" /&gt;
	&lt;property id="filterActivityTypes2" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom" &gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_User" /&gt;
		&lt;propertyValue value="Followed" resourceName="activityTypeUsers_Followed" /&gt;
		&lt;propertyValue value="User,Followed" resourceName="activityTypeUsers_UserAndFollowed" /&gt;
		&lt;propertyValue value="All" resourceName="activityTypeUsers_All" /&gt;
	&lt;/property&gt;
	&lt;property id="filterUserActivityTypes2" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom"&gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_Include" /&gt;
	&lt;/property&gt;
&lt;/propertyGroup&gt;
&lt;propertyGroup id="filter3" resourceName="filter3" descriptionResourceName="filter_desc"&gt;
	&lt;property id="filterName3" resourceName="filterName" descriptionResourceName="filterDesc" dataType="string"
		defaultValue="${resource:filterNameDefault}" /&gt;
	&lt;property id="filterActivityTypes3" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom"&gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_User" /&gt;
		&lt;propertyValue value="Followed" resourceName="activityTypeUsers_Followed" /&gt;
		&lt;propertyValue value="User,Followed" resourceName="activityTypeUsers_UserAndFollowed" /&gt;
		&lt;propertyValue value="All" resourceName="activityTypeUsers_All" /&gt;
	&lt;/property&gt;
	&lt;property id="filterUserActivityTypes3" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom"&gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_Include" /&gt;
	&lt;/property&gt;
&lt;/propertyGroup&gt;
&lt;propertyGroup id="filter4" resourceName="filter4" descriptionResourceName="filter_desc"&gt;
	&lt;property id="filterName4" resourceName="filterName" descriptionResourceName="filterDesc" dataType="string"
		defaultValue="${resource:filterNameDefault}" /&gt;
	&lt;property id="filterActivityTypes4" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom"&gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_User" /&gt;
		&lt;propertyValue value="Followed" resourceName="activityTypeUsers_Followed" /&gt;
		&lt;propertyValue value="User,Followed" resourceName="activityTypeUsers_UserAndFollowed" /&gt;
		&lt;propertyValue value="All" resourceName="activityTypeUsers_All" /&gt;
	&lt;/property&gt;
	&lt;property id="filterUserActivityTypes4" resourceName="activityTypes" descriptionResourceName="activityTypesDesc" dataType="custom"&gt;
		&lt;propertyValue value="" resourceName="activityTypeUsers_Exclude" /&gt;
		&lt;propertyValue value="User" resourceName="activityTypeUsers_Include" /&gt;
	&lt;/property&gt;
&lt;/propertyGroup&gt;

	
	</configuration>
    <languageResources>
	  <language key="en-us">
		<resource name="ActivityStoryStream_Name">Activity Story Stream</resource>
		<resource name="options">Options</resource>
		<resource name="pageSize">Number of Items to Display</resource>
		<resource name="filterType">Activity Stream Mode</resource>
		<resource name="filterType_site">Site (all site activity)</resource>
		<resource name="filterType_group">Group (activity in a group and optionally subgroups)</resource>
		<resource name="filterType_userProfile">User (activity for contextual user)</resource>
		<resource name="filterType_Desc">Determines the default view of the Activity Stream and the set of filters to display</resource>
		<resource name="includeSubGroups">Include subgroup activity</resource>
		<resource name="endlessScroll">Endless Stream</resource>
		<resource name="endlessScrollDesc">Automatically load more stories when scrolled near the end</resource>
		<resource name="loading">Loading...</resource>
		<resource name="showMore">Show More</resource>
		<resource name="hideOriginalPost">Hide original post</resource>
		<resource name="showOriginalPost">Show original post</resource>
		<resource name="hideHistory">Hide revision history</resource>
		<resource name="showHistory">Show revision history</resource>
		<resource name="deleteActivityMessage">Are you sure you want to delete this story?</resource>
		<resource name="deleteCommentMessage">Are you sure you want to delete this comment?</resource>
		<resource name="delete">Delete</resource>
		<resource name="message">Send a Private Message</resource>
		<resource name="comment">Comment</resource>
		<resource name="comment_format">{0} comment</resource>
		<resource name="comments_format">{0} comments</resource>
		<resource name="comments">Comments</resource>
		<resource name="writeComment">Write a comment...</resource>
		<resource name="filterName">Filter Name</resource>
		<resource name="filterDesc">Determines the display name of the filter</resource>
		<resource name="filterNameDefault">Filter</resource>
		<resource name="filter0">Filter 1</resource>
		<resource name="filter1">Filter 2</resource>
		<resource name="filter2">Filter 3</resource>
		<resource name="filter3">Filter 4</resource>
		<resource name="filter4">Filter 5</resource>
		<resource name="filter_desc">Configures an optional filter</resource>
		<resource name="activityTypes">Activity Story Types</resource>
		<resource name="activityTypesDesc">Determines which activities from which users are included in this filter. If no types are selected, the filter will not be displayed.</resource>
		<resource name="activityTypeUsers_Exclude">Exclude activity</resource>
		<resource name="activityTypeUsers_Include">Include contextual user's activity</resource>
		<resource name="activityTypeUsers_User">Include accessing user's activity</resource>
		<resource name="activityTypeUsers_Followed">Include accessing user's followed users' activity</resource>
		<resource name="activityTypeUsers_UserAndFollowed">Include accessing user's and followed users' activity</resource>
		<resource name="activityTypeUsers_All">Include all users' activity</resource>
		<resource name="today">Today</resource>
		<resource name="View">View</resource>
		<resource name="no_messages">There was no activity to display.</resource>
		<resource name="view_more_comments">View more comments</resource>
		<resource name="CF_Comment_ModeratedMessaage">Thank you, your comment requires moderation so it may take a while to appear.</resource>
		<resource name="Cancel">Cancel</resource>
		<resource name="User_Activity">Activity</resource>
		<resource name="Post">Post</resource>
		<resource name="access_denied">You must be a member to view this group's activity.</resource>
	  </language>
	</languageResources>
    <files>
      <file name="more.vm">IyMKIyMgQWpheCBjYWxsYmFjayBmb3IgbG9hZGluZyBtb3JlIHByZS1yZW5kZXJlZCBzdG9yaWVzCiMjCiNzZXQgKCRmaWx0ZXJUeXBlID0gJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCdGaWx0ZXJUeXBlJykpCiNzZXQgKCRmaWx0ZXJJbmRleCA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnRmlsdGVySW5kZXgnKSkKI3NldCAoJHBhZ2VTaXplID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUludCgkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ1BhZ2VTaXplJykpKQojc2V0ICgkZ3JvdXBJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCdHcm91cElkJykpKQojc2V0ICgkZW5kRGF0ZSA9IGZhbHNlKQojaWYgKCRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnRW5kRGF0ZScpLmxlbmd0aCA+IDApCgkjc2V0KCRlbmREYXRlID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZURhdGUoJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCdFbmREYXRlJykpKQojZW5kCgojc2V0ICgkYWNjZXNzaW5nVXNlciA9ICRjb3JlX3YyX3VzZXIuQWNjZXNzaW5nKQojc2V0ICgkYWNjZXNzaW5nVXNlcklzUmVnaXN0ZXJlZCA9IGZhbHNlKQojaWYgKCRjb3JlX3YyX3VzZXIuSXNSZWdpc3RlcmVkKCRhY2Nlc3NpbmdVc2VyLklkKSkKCSNzZXQgKCRhY2Nlc3NpbmdVc2VySXNSZWdpc3RlcmVkID0gdHJ1ZSkKI2VuZAoKJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCdzdHJlYW0udm0nKQo=</file>
      <file name="story.vm">IyMKIyMgUmVuZGVycyBhbiBpbmRpdmlkdWFsIGFjdGl2aXR5IHN0b3J5CiMjIFJlcXVpcmVzIGluIHNjb3BlOgojIyAgICRzdG9yeSBpbnN0YW5jZQojIwoKI3NldCAoJHdpZGdldFVuaXF1ZVN0b3J5SWQgPSAiJHtjb3JlX3YyX3dpZGdldC5XcmFwcGVyRWxlbWVudElkfV9zdG9yeV8ke21lc3NhZ2UuU3RvcnlJZH0iKQoKI3NldCAoJHByaW1hcnlTdG9yeVVzZXIgPSAkc3RvcnkuUHJpbWFyeVVzZXIpCgojc2V0ICgkcHJpbWFyeVN0b3J5VXNlcklzUmVnaXN0ZXJlZCA9IGZhbHNlKQojc2V0ICgkcHJpbWFyeVN0b3J5VXNlcklzUmVnaXN0ZXJlZCA9ICRjb3JlX3YyX3VzZXIuSXNSZWdpc3RlcmVkKCRwcmltYXJ5U3RvcnlVc2VyLklkKSkKI3NldCAoJHByaW1hcnlTdG9yeVVzZXJJc0FjY2Vzc2luZ1VzZXIgPSBmYWxzZSkKI2lmICgkYWNjZXNzaW5nVXNlci5JZCA9PSAkcHJpbWFyeVN0b3J5VXNlci5JZCkKCSNzZXQgKCRwcmltYXJ5U3RvcnlVc2VySXNBY2Nlc3NpbmdVc2VyID0gdHJ1ZSkKI2VuZAoKI3NldCAoJGNvbW1lbnRzU3VwcG9ydGVkID0gZmFsc2UpCiNzZXQgKCRjb21tZW50c1N1cHBvcnRlZCA9ICRjb3JlX3YyX2NvbW1lbnRzLlN1cHBvcnRzQ29tbWVudHMoJHN0b3J5LkNvbnRlbnRUeXBlSWQpKQoKI3NldCAoJGFjY2Vzc2luZ1VzZXJDYW5Db21tZW50ID0gZmFsc2UpCiNpZiAoJGNvbW1lbnRzU3VwcG9ydGVkKQoJI3NldCAoJGFjY2Vzc2luZ1VzZXJDYW5Db21tZW50ID0gJGNvcmVfdjJfY29tbWVudHMuQ2FuQ3JlYXRlQ29tbWVudCgkc3RvcnkuQ29udGVudElkLCAkc3RvcnkuQ29udGVudFR5cGVJZCkpCiNlbmQKCiNzZXQgKCR3aWRnZXRVbmlxdWVTdG9yeUlkID0gIiR7Y29yZV92Ml93aWRnZXQuV3JhcHBlckVsZW1lbnRJZH1fc3RvcnlfJHtzdG9yeS5TdG9yeUlkfSIpCiNzZXQgKCRzdG9yeVR5cGUgPSAkc3RvcnkuU3RvcnlUeXBlSWQpCgo8ZGl2IGlkPSIkIXdpZGdldFVuaXF1ZVN0b3J5SWQiIGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gYWN0aXZpdHktc3RvcnkgJCFzdG9yeVR5cGUgY29udGVudC10eXBlLSR7c3RvcnkuQ29udGVudFR5cGVJZH0iCglkYXRhLWF1dGhvcmlkPSIkIWxhdGVzdEFjdG9yLlVzZXIuSWQiCglkYXRhLWFjdGl2aXR5aWQ9IiQhc3RvcnkuU3RvcnlJZCIKCWRhdGEtYWN0aXZpdHl0eXBlPSIkIXN0b3J5VHlwZSIKCWRhdGEtYWN0aXZpdHlkYXRlPSIkIWNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0RGF0ZSgkc3RvcnkuTGFzdFVwZGF0ZSwgJGRhdGVUaW1lUm91bmRUcmlwRm9ybWF0KSIKCWRhdGEtY29udGVudGlkPSIkIXN0b3J5LkNvbnRlbnRJZCIKCWRhdGEtY29udGVudHR5cGVpZD0iJCFzdG9yeS5Db250ZW50VHlwZUlkIgoJZGF0YS10eXBlaWQ9IiQhc3RvcnkuVHlwZUlkIgoJZGF0YS10YXJnZXR1cmw9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJHN0b3J5LkNvbnRlbnQuVXJsKSI+CgoJPGRpdiBjbGFzcz0icG9zdCBhY3Rpdml0eSI+CgkJPGRpdiBjbGFzcz0iYXZhdGFyIj4KCQkJI2lmICgkcHJpbWFyeVN0b3J5VXNlci5Qcm9maWxlVXJsKQoJCQkJPGEgaHJlZj0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkcHJpbWFyeVN0b3J5VXNlci5Qcm9maWxlVXJsKSIgY2xhc3M9ImludGVybmFsLWxpbmsgdmlldy11c2VyLXByb2ZpbGUiPgoJCQkJCSRjb3JlX3YyX3VpLkdldFJlc2l6ZWRJbWFnZUh0bWwoJHByaW1hcnlTdG9yeVVzZXIuQXZhdGFyVXJsLCA0MCwgNDAsICIle2JvcmRlcj0nMCcsIGFsdD0kcHJpbWFyeVN0b3J5VXNlci5EaXNwbGF5TmFtZSwgUmVzaXplTWV0aG9kPSdab29tQW5kQ3JvcCcsYm9yZGVyPScwJ30iKQoJCQkJPC9hPgoJCQkjZWxzZQoJCQkJJGNvcmVfdjJfdWkuR2V0UmVzaXplZEltYWdlSHRtbCgkcHJpbWFyeVN0b3J5VXNlci5BdmF0YXJVcmwsIDQwLCA0MCwgIiV7Ym9yZGVyPScwJywgYWx0PSRwcmltYXJ5U3RvcnlVc2VyLkRpc3BsYXlOYW1lLCBSZXNpemVNZXRob2Q9J1pvb21BbmRDcm9wJyxib3JkZXI9JzAnfSIpCgkJCSNlbmQKCQk8L2Rpdj4KCQk8ZGl2IGNsYXNzPSJkYXRlIj4kY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRBZ29EYXRlKCRzdG9yeS5DcmVhdGVkRGF0ZSk8L2Rpdj4KCQk8ZGl2IGNsYXNzPSJjb250ZW50Ij4KCQkJJG1vYmlsZV92MV9kYXRhRm9ybWF0LkRldGVjdCgkc3RvcnkuVmlld0h0bWwoJ1dlYicpKQoJCTwvZGl2PgoJCTxkaXYgY2xhc3M9InVpLWxpbmtzIGFjdGlvbnMiIGRhdGEtbWF4bGlua3M9IjIiIGRhdGEtbWlubGlua3M9IjIiPgoJCQk8dWwgY2xhc3M9ImFjdGlvbnMiPgoJCQkJIyMgTGlrZXMKCQkJCSNpZiAoJGFjY2Vzc2luZ1VzZXJJc1JlZ2lzdGVyZWQgJiYgJGNvcmVfdjJfbGlrZS5DYW5MaWtlKCRzdG9yeS5Db250ZW50SWQsICRzdG9yeS5Db250ZW50VHlwZUlkKSkKCQkJCQk8bGkgY2xhc3M9ImFjdGlvbi1saWtlIj4KCQkJCQkJI3NldCgkZm9ybWF0ID0gJ3t0b2dnbGV9IDxzcGFuIGNsYXNzPSJjb3VudCI+PHNwYW4gY2xhc3M9Imljb24iPjwvc3Bhbj57Y291bnR9PC9zcGFuPicpCgkJCQkJCSNzZXQgKCRsaWtlT3B0aW9ucyA9ICIleyBGb3JtYXQgPSAkZm9ybWF0IH0iKQoJCQkJCQkjaWYgKCRzdG9yeS5UeXBlSWQpCgkJCQkJCQkkbGlrZU9wdGlvbnMuQWRkKCdMaWtlVHlwZUlkJywgJHN0b3J5LlR5cGVJZCkKCQkJCQkJI2VuZAoJCQkJCQkkY29yZV92Ml91aS5MaWtlKCRzdG9yeS5Db250ZW50SWQsICRzdG9yeS5Db250ZW50VHlwZUlkLCAkbGlrZU9wdGlvbnMpCgkJCQkJPC9saT4KCQkJCSNlbmQKCgkJCQkjIyBDb21tZW50cwoJCQkJI2lmICgkY29tbWVudHNTdXBwb3J0ZWQpCgkJCQkJI3NldCAoJGNvbW1lbnRDb3VudCA9IDApCgkJCQkJI3NldCAoJGNvbW1lbnRzID0gJGNvcmVfdjJfY29tbWVudHMuTGlzdCgiJXsgUGFnZUluZGV4ID0gMCwgUGFnZVNpemUgPSAxLCBDb250ZW50SWQgPSAkc3RvcnkuQ29udGVudElkLCBDb250ZW50VHlwZUlkID0gJHN0b3J5LkNvbnRlbnRUeXBlSWQgfSIpKQoJCQkJCSNzZXQgKCRjb21tZW50Q291bnQgPSAkY29tbWVudHMuVG90YWxDb3VudCkKCQkJCQk8bGkgY2xhc3M9ImFjdGlvbi1jb21tZW50Ij4KCQkJCQkJPGEgY2xhc3M9ImNvbW1lbnQiIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJHN0b3J5LkNvbnRlbnQuVXJsKSI+CgkJCQkJCSNpZiAoJGNvbW1lbnRDb3VudCA9PSAwKQoJCQkJCQkJCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdjb21tZW50JykKCQkJCQkJI2Vsc2VpZiAoJGNvbW1lbnRDb3VudCA9PSAxKQoJCQkJCQkJJGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0U3RyaW5nKCRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdjb21tZW50X2Zvcm1hdCcpLCAkY29tbWVudENvdW50KQoJCQkJCQkjZWxzZQoJCQkJCQkJI2lmICgkY29tbWVudENvdW50ID4gMTAwMDAwMCkKCQkJCQkJCQkjc2V0KCRjb21tZW50Q291bnQgPSAkY29tbWVudENvdW50IC8gMTAwMDAwMCkKCQkJCQkJCQkjc2V0KCRjb21tZW50Q291bnQgPSAiJHtjb21tZW50Q291bnR9TSIpCgkJCQkJCQkjZWxzZWlmICgkY29tbWVudENvdW50ID4gMTAwMCkKCQkJCQkJCQkjc2V0KCRjb21tZW50Q291bnQgPSAkY29tbWVudENvdW50IC8gMTAwMCkKCQkJCQkJCQkjc2V0KCRjb21tZW50Q291bnQgPSAiJHtjb21tZW50Q291bnR9ayIpCgkJCQkJCQkjZW5kCgkJCQkJCQkkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRTdHJpbmcoJGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ2NvbW1lbnRzX2Zvcm1hdCcpLCAkY29tbWVudENvdW50KQoJCQkJCQkjZW5kCgkJCQkJCTwvYT4KCQkJCQk8L2xpPgoJCQkJI2VuZAoJCQk8L3VsPgoJCTwvZGl2PgoJPC9kaXY+CjwvZGl2Pg==</file>
      <file name="stream.vm">I3NldCgkc3RvcmllcyA9IGZhbHNlKQoKI3NldCAoJGRhdGVUaW1lUm91bmRUcmlwRm9ybWF0ID0gInl5eXktTU0tZGRUSEg6bW06c3MuZmZmIikKCiNpZiAoJGZpbHRlclR5cGUgPT0gJ1VzZXInKQoJI3NldCAoJGZpbHRlckFjdGl2aXR5VHlwZXNQcm9wZXJ0eSA9ICJmaWx0ZXJVc2VyQWN0aXZpdHlUeXBlcyR7ZmlsdGVySW5kZXh9IikKI2Vsc2UKCSNzZXQgKCRmaWx0ZXJBY3Rpdml0eVR5cGVzUHJvcGVydHkgPSAiZmlsdGVyQWN0aXZpdHlUeXBlcyR7ZmlsdGVySW5kZXh9IikKI2VuZAoKI3NldCAoJGZpbHRlckFjdGl2aXR5VHlwZXMgPSBmYWxzZSkKI3NldCAoJGZpbHRlckFjdGl2aXR5VHlwZXMgPSAkY29yZV92Ml9wYWdlLlBhcnNlUXVlcnlTdHJpbmcoJGNvcmVfdjJfd2lkZ2V0LkdldEN1c3RvbVZhbHVlKCRmaWx0ZXJBY3Rpdml0eVR5cGVzUHJvcGVydHksJycpKSkKI2lmICgkZmlsdGVyVHlwZSA9PSAnVXNlcicpICMjIHVzZXIgaWQKCSNzZXQgKCRxdWVyeSA9ICIleyBTb3J0QnkgPSAnRGF0ZScsIFNvcnRPcmRlciA9ICdEZXNjZW5kaW5nJywgUGFnZVNpemUgPSAkcGFnZVNpemUgfSIpCiNlbHNlaWYgKCRmaWx0ZXJUeXBlID09ICdHcm91cCcpICMjIGdyb3VwCgkjc2V0ICgkY3VycmVudEdyb3VwID0gZmFsc2UpCgkjc2V0ICgkY3VycmVudEdyb3VwID0gJGNvcmVfdjJfZ3JvdXAuR2V0KCIle0lkPSRncm91cElkfSIpKQoJI3NldCAoJGluY2x1ZGVTdWJHcm91cHMgPSAkY29yZV92Ml93aWRnZXQuR2V0Qm9vbFZhbHVlKCdpbmNsdWRlU3ViR3JvdXBzJywgZmFsc2UpKQoJI3NldCAoJGNvbnRhaW5lcklkcyA9ICIiKQoJI2lmICgkY3VycmVudEdyb3VwKQoJCSNzZXQgKCRjb250YWluZXJJZHMgPSAiJGN1cnJlbnRHcm91cC5Db250YWluZXJJZCIpCgkjaWYgKCRpbmNsdWRlU3ViR3JvdXBzKQoJCSNzZXQgKCRzdWJHcm91cHMgPSAkY29yZV92Ml9ncm91cC5MaXN0KCIleyBJbmNsdWRlQWxsU3ViR3JvdXBzID0gJ3RydWUnLCBQYWdlU2l6ZSA9IDUwLCBQYXJlbnRHcm91cElkID0gJGN1cnJlbnRHcm91cC5JZCwgUGVybWlzc2lvbiA9ICdHcm91cF9SZWFkR3JvdXAnIH0iKSkKCQkjZm9yZWFjaCAoJHN1Ykdyb3VwIGluICRzdWJHcm91cHMpCgkJCSNzZXQgKCRjb250YWluZXJJZHMgPSAiJHtjb250YWluZXJJZHN9LCR7c3ViR3JvdXAuQ29udGFpbmVySWR9IikKCQkjZW5kCgkjZW5kCgkjZW5kCgkjc2V0ICgkcXVlcnkgPSAiJXsgU29ydEJ5ID0gJ0RhdGUnLCBTb3J0T3JkZXIgPSAnRGVzY2VuZGluZycsIFBhZ2VTaXplID0gJHBhZ2VTaXplLCBDb250YWluZXJJZHMgPSAkY29udGFpbmVySWRzIH0iKQojZWxzZSAgIyMgc2l0ZQoJI3NldCAoJHF1ZXJ5ID0gIiV7IFNvcnRCeSA9ICdEYXRlJywgU29ydE9yZGVyID0gJ0Rlc2NlbmRpbmcnLCBQYWdlU2l6ZSA9ICRwYWdlU2l6ZSB9IikKI2VuZAoKI2lmICghJHN0b3JpZXMpCgkjIyBpbmNsdWRlIGZpbHRlcnMsIGlmIHNwZWNpZmllZAoJI3NldCAoJGhhc1VzZXJGaWx0ZXJzID0gZmFsc2UpCgkjaWYgKCRmaWx0ZXJBY3Rpdml0eVR5cGVzICYmICRmaWx0ZXJBY3Rpdml0eVR5cGVzLlZhbHVlcygnZmlsdGVycycpLkNvdW50ID4gMCkKCQkjc2V0ICgkaW5jbHVkZWRTdG9yeVR5cGVzID0gZmFsc2UpCgkJI3NldCAoJGluY2x1ZGVkU3RvcnlUeXBlcyA9ICRmaWx0ZXJBY3Rpdml0eVR5cGVzLlZhbHVlcygnZmlsdGVycycpKQoJCSNmb3JlYWNoICgkc3RvcnlUeXBlIGluICRpbmNsdWRlZFN0b3J5VHlwZXMpCgkJCSNzZXQgKCRpbmNsdWRlZFVzZXJzID0gZmFsc2UpCgkJCSNzZXQgKCRpbmNsdWRlZFVzZXJzID0gJGZpbHRlckFjdGl2aXR5VHlwZXMuVmFsdWUoJHN0b3J5VHlwZSkpCgkJCSNpZiAoJGluY2x1ZGVkVXNlcnMpCgkJCQkjc2V0ICgkZmlsdGVyTmFtZSA9ICJfRmlsdGVyXyR7c3RvcnlUeXBlfSIpCgkJCQkjc2V0ICgkaGFzVXNlckZpbHRlcnMgPSB0cnVlKQoJCQkJJHF1ZXJ5LkFkZCgkZmlsdGVyTmFtZSwgJGluY2x1ZGVkVXNlcnMpCgkJCSNlbmQKCQkjZW5kCgkjZW5kCgoJI2lmICgkaGFzVXNlckZpbHRlcnMgfHwgJGZpbHRlclR5cGUgPT0gJ1VzZXInKQoJCSNzZXQoJHVzZXJJZCA9IGZhbHNlKQoJCSNzZXQgKCR1c2VySWQgPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlSW50KCRtb2JpbGVfdjFfdXJsVG9rZW4uVmFsdWUoJ1VzZXJJZCcpKSkKCQkjaWYoISR1c2VySWQgfHwgJHVzZXJJZCA8PSAwKQoJCQkjc2V0KCR1c2VySWQgPSAkY29yZV92Ml91c2VyLkFjY2Vzc2luZy5JZCkKCQkjZW5kCgkJJHF1ZXJ5LkFkZCgnVXNlcklkJywgJHVzZXJJZCkKCSNlbmQKCgkjIyBpbmNsdWRlIGRhdGUgb2Zmc2V0LCBpZiBzcGVjaWZpZWQKCSNpZiAoJGVuZERhdGUpCgkJJHF1ZXJ5LkFkZCgnRW5kRGF0ZScsICRlbmREYXRlKQoJI2VuZAoKCSNzZXQgKCRzdG9yaWVzID0gJGNvcmVfdjJfYWN0aXZpdHlTdG9yeS5MaXN0KCRxdWVyeSkpCiNlbmQKCiNzZXQoJGhhZERhdGVGaWx0ZXIgPSBmYWxzZSkKI2lmICghJGVuZERhdGUpCgkjc2V0KCRoYWREYXRlRmlsdGVyID0gdHJ1ZSkKI2VuZAojc2V0KCRlbmREYXRlID0gZmFsc2UpCgojZm9yZWFjaCgkc3RvcnkgaW4gJHN0b3JpZXMpCiNlYWNoCgkjc2V0ICgkZW5kRGF0ZSA9ICRzdG9yeS5MYXN0VXBkYXRlKQoJJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCJzdG9yeS52bSIpCiNub2RhdGEKCTxkaXYgaWQ9IiR7Y29yZV92Ml93aWRnZXQuV3JhcHBlckVsZW1lbnRJZH1fbWVzc2FnZV9ub3JlY29yZHMiPjxkaXYgY2xhc3M9Im1lc3NhZ2Ugbm9yZWNvcmRzIj4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbm9fbWVzc2FnZXMnKTwvZGl2PjwvZGl2PgojYWZ0ZXJhbGwKCTxkaXYgY2xhc3M9ImRhdGEiIGRhdGEtbGFzdG1lc3NhZ2VkYXRlPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRlbmREYXRlLlRvU3RyaW5nKCRkYXRlVGltZVJvdW5kVHJpcEZvcm1hdCkpIj48L2Rpdj4KI2VuZAo=</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpewoKCXZhciBhcGkgPSB7CgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCgkJCS8vIGhhbmRsZSBmaWx0ZXIgY2hhbmdlcwoJCQkkKG9wdGlvbnMud3JhcHBlciArICcgdWwuYWN0aXZpdHktZmlsdGVycyBhJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkgewoJCQkJdmFyIGZpbHRlckluZGV4ID0gJCh0aGlzKS5kYXRhKCdmaWx0ZXJpbmRleCcpOwoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5hZGRSZWZyZXNoUGFyYW1ldGVyKCd3X2ZpbHRlckluZGV4JywgZmlsdGVySW5kZXgpOwoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5yZWZyZXNoKCk7CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0pOwoKCQkJLy8gaWYgdGhlcmUncyBhIGN1cnJlbnRseS1hcHBsaWVkIGZpbHRlciBpbmRleAoJCQkvLyByZS1hcHBseSBpdCBzbyBpdCdzIHJlYWR5IGZvciBhbnkgbWFudWFsIHB1bGwtdG8tcmVmcmVzaGVzCgkJCWlmKG9wdGlvbnMuY3VycmVudEZpbHRlckluZGV4KSB7CgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmFkZFJlZnJlc2hQYXJhbWV0ZXIoJ3dfZmlsdGVySW5kZXgnLCBvcHRpb25zLmN1cnJlbnRGaWx0ZXJJbmRleCk7CgkJCX0KCgkJCWlmIChvcHRpb25zLnBvc3RVcmwpIHsKCQkJCXZhciBwb3N0TGluayA9ICQoJzxhIGhyZWY9IiMiIGNsYXNzPSJhZGQiPicgKyBvcHRpb25zLnBvc3RMYWJlbCArICc8L2E+Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkgewoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuY2xlYXJDb250ZW50KCk7CgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5sb2FkKG9wdGlvbnMucG9zdFVybCk7CgkJCQl9KTsKCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2V0SGVhZGVyQnV0dG9uKHBvc3RMaW5rKTsKCQkJfQoKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zY3JvbGxhYmxlKHsKCQkJCXJlZ2lvbjogJ2NvbnRlbnQnLAoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgewoJCQkJCXZhciBsYXN0RGF0ZSA9ICQob3B0aW9ucy53cmFwcGVyICsgJyBkaXYuZGF0YTpsYXN0JykuZGF0YSgnbGFzdG1lc3NhZ2VkYXRlJyk7CgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLmdldCh7CgkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLAoJCQkJCQlkYXRhOiB7CgkJCQkJCQlGaWx0ZXJUeXBlOiBvcHRpb25zLmZpbHRlclR5cGUsCgkJCQkJCQlGaWx0ZXJJbmRleDogb3B0aW9ucy5jdXJyZW50RmlsdGVySW5kZXgsCgkJCQkJCQlQYWdlU2l6ZTogb3B0aW9ucy5wYWdlU2l6ZSwKCQkJCQkJCUVuZERhdGU6IGxhc3REYXRlLAoJCQkJCQkJR3JvdXBJZDogb3B0aW9ucy5ncm91cElkCgkJCQkJCX0sCgkJCQkJCXN1Y2Nlc3M6IGZ1bmN0aW9uKHIpIHsKCQkJCQkJCXZhciByZXNwb25zZSA9ICQociksCgkJCQkJCQkJaGFzTm9SZWNvcmRzID0gcmVzcG9uc2UuZmluZCgnLm1lc3NhZ2Uubm9yZWNvcmRzOmZpcnN0JykubGVuZ3RoID4gMDsKCQkJCQkJCWlmKGhhc05vUmVjb3JkcykgewoJCQkJCQkJCXN1Y2Nlc3MoKTsKCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJc3VjY2VzcyhyZXNwb25zZSk7CgkJCQkJCQl9CgkJCQkJCX0sCgkJCQkJCWVycm9yOiBmdW5jdGlvbigpIHsKCQkJCQkJCWVycm9yKCk7CgkJCQkJCX0KCQkJCQl9KQoJCQkJfSwKCQkJCWNvbXBsZXRlOiBmdW5jdGlvbihjb250ZW50KSB7CgkJCQkJY29udGVudCA9ICQoY29udGVudCkuY3NzKHsgb3BhY2l0eTogMCB9KTsKCQkJCQkkKG9wdGlvbnMud3JhcHBlcikuZmluZCgnZGl2LnN0cmVhbScpLmFwcGVuZChjb250ZW50KTsKCQkJCQljb250ZW50LmV2b2x1dGlvblRyYW5zZm9ybSh7IG9wYWNpdHk6IDEgfSwgeyBkdXJhdGlvbjogNDAwIH0pOwoJCQkJfQoJCQl9KTsKCQl9Cgl9CgoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5hY3Rpdml0eVN0b3J5U3RyZWFtID0gYXBpOwoKfSkoalF1ZXJ5KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:BlogList_Name}" version="7.0.0.1" description="" instanceIdentifier="e6cd209c87184394b6e2921019d204f6" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="blog-list">
    <contentScript>
		

#set ($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#set ($showSubGroups = $core_v2_widget.GetBoolValue('groupAndSubGroups', true))
#set ($pageSize = $core_v2_widget.GetIntValue('pageSize', 5))
#set ($pageIndex = 0)

#set($group = false)
#set($group = $core_v2_group.Get("%{Id=$groupId}"))
#if (!$group)
	$core_v2_widget.Hide()
#end

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($group.Url)"&gt;$group.Name&lt;/a&gt;
		&lt;h1&gt;$core_v2_language.GetResource('blogs')&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 40, 40, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
&lt;/div&gt;

&lt;div class="post-list blogs"&gt;
	$core_v2_widget.ExecuteFile('list.vm')
&lt;/div&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;

&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.blogList.register({
		moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
				wrapper: '#$core_v2_widget.WrapperElementId',
		pageSize: $pageSize,
			showSubGroups: '$showSubGroups'
		});
	});
})
&lt;/script&gt;
		
	</contentScript>
    <headerScript>
	</headerScript>
    <configuration>
		
&lt;propertyGroup id="options" resourceName="Options"&gt;
	&lt;property id="groupAndSubGroups" resourceName="groupAndSubGroups" dataType="bool" defaultValue="false" /&gt;
	&lt;property id="pageSize" resourceName="itemsToShow" dataType="int" defaultValue="5" /&gt;
&lt;/propertyGroup&gt;
		
	</configuration>
    <languageResources>
<language key="en-us">
	<resource name="BlogList_Name">Blog List</resource>
	<resource name="options">Options</resource>
	<resource name="itemsToShow">Number of results to display</resource>
	<resource name="groupAndSubGroups">Show data from Group and all Subgroups</resource>
	<resource name="blogs">Blogs</resource>
	<resource name="no_blogs">There were no blogs to display.</resource>
	<resource name="no_posts">No blog posts</resource>
	<resource name="post_count">{0} blog post</resource>
	<resource name="posts_count">{0} blog posts</resource>
	<resource name="NA">N/A</resource>
</language>
		</languageResources>
    <files>
      <file name="list.vm">I3NldCgkYmxvZ3MgPSBmYWxzZSkNCiNzZXQoJGJsb2dzID0gJGNvcmVfdjJfYmxvZy5MaXN0KCIle0dyb3VwSWQ9JGdyb3VwSWQsSW5jbHVkZVN1Ykdyb3Vwcz0kc2hvd1N1Ykdyb3VwcyxQYWdlSW5kZXg9JHBhZ2VJbmRleCxQYWdlU2l6ZT0kcGFnZVNpemV9IikpDQoNCiNmb3JlYWNoKCRibG9nIGluICRibG9ncykNCiNlYWNoDQoNCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gYmxvZyIgZGF0YS10YXJnZXR1cmw9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJGJsb2cuVXJsKSI+DQoJCTxkaXYgY2xhc3M9InBvc3Qgd2l0aG91dC1hdmF0YXIiPg0KCQkJPGRpdiBjbGFzcz0iZGV0YWlscyI+DQoJCQkJPGRpdiBjbGFzcz0iZGF0ZSI+I2lmKCRibG9nLlBvc3RDb3VudCA+IDApJHtjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdEFnb0RhdGUoJGJsb2cuTGF0ZXN0UG9zdERhdGUpfSNlbHNlJHtjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdOQScpfSNlbmQNCgkJCQk8L2Rpdj4NCgkJCTwvZGl2Pg0KCQkJPGRpdiBjbGFzcz0iY29udGVudCI+DQoJCQkJPGEgaHJlZj0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkYmxvZy5VcmwpIj4kYmxvZy5OYW1lPC9hPg0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJhY3Rpb25zIj4NCgkJCQk8dWw+DQoJCQkJCTxsaT4NCgkJCQkJCTxkaXYgY2xhc3M9ImRldGFpbCBibG9ncG9zdHMiPg0KCQkJCQkJCSNpZiAoJGJsb2cuUG9zdENvdW50ID09IDApDQoJCQkJCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdub19wb3N0cycpDQoJCQkJCQkJI2Vsc2VpZiAoJGJsb2cuUG9zdENvdW50ID09IDEpDQoJCQkJCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdFN0cmluZygkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgncG9zdF9jb3VudCcpLCAkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXROdW1iZXIoJGJsb2cuUG9zdENvdW50KSkNCgkJCQkJCQkjZWxzZQ0KCQkJCQkJCQkkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRTdHJpbmcoJGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ3Bvc3RzX2NvdW50JyksICRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdE51bWJlcigkYmxvZy5Qb3N0Q291bnQpKQ0KCQkJCQkJCSNlbmQNCgkJCQkJCTwvZGl2Pg0KCQkJCQk8L2xpPg0KCQkJCTwvdWw+DQoJCQk8L2Rpdj4NCgkJPC9kaXY+DQoJPC9kaXY+DQoNCiNub2RhdGENCgk8ZGl2IGlkPSIke2NvcmVfdjJfd2lkZ2V0LldyYXBwZXJFbGVtZW50SWR9X21lc3NhZ2Vfbm9yZWNvcmRzIj48ZGl2IGNsYXNzPSJtZXNzYWdlIG5vcmVjb3JkcyI+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ25vX2Jsb2dzJyk8L2Rpdj48L2Rpdj4NCiNhZnRlcmFsbA0KCSNzZXQgKCRoYXNNb3JlID0gZmFsc2UpDQoJI2lmICgkYmxvZ3MuVG90YWxDb3VudCA+ICgoJGJsb2dzLlBhZ2VJbmRleCArIDEpICogJGJsb2dzLlBhZ2VTaXplKSkNCgkJI3NldCgkaGFzTW9yZSA9IHRydWUpDQoJI2VuZA0KCTxkaXYgY2xhc3M9ImRhdGEiICNpZigkaGFzTW9yZSlkYXRhLWhhc21vcmU9InRydWUiI2VuZD48L2Rpdj4NCiNlbmQNCg==</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBibG9ncw0KIyMNCiNzZXQgKCRwYWdlSW5kZXggPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlSW50KCRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnUGFnZUluZGV4JykpKQ0KI3NldCAoJHBhZ2VTaXplID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUludCgkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ1BhZ2VTaXplJykpKQ0KI3NldCAoJGdyb3VwSWQgPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlSW50KCRtb2JpbGVfdjFfdXJsVG9rZW4uVmFsdWUoJ0dyb3VwSWQnKSkpDQojc2V0ICgkc2hvd1N1Ykdyb3VwcyA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VCb29sKCRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnU2hvd1N1Ykdyb3VwcycpKSkNCg0KJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCdsaXN0LnZtJyk=</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpewoKCXZhciBhcGkgPSB7CgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zY3JvbGxhYmxlKHsKCQkJCXJlZ2lvbjogJ2NvbnRlbnQnLAoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgewoJCQkJCWlmICgkKG9wdGlvbnMud3JhcHBlciArICcgZGl2LmRhdGE6bGFzdCcpLmRhdGEoJ2hhc21vcmUnKSkgewoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsKCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLAoJCQkJCQkJZGF0YTogewoJCQkJCQkJCVBhZ2VTaXplOiBvcHRpb25zLnBhZ2VTaXplLAoJCQkJCQkJCVBhZ2VJbmRleDogcGFnZUluZGV4LAoJCQkJCQkJCVNob3dTdWJHcm91cHM6IG9wdGlvbnMuc2hvd1N1Ykdyb3VwcwoJCQkJCQkJfSwKCQkJCQkJCXN1Y2Nlc3M6IGZ1bmN0aW9uKHIpIHsKCQkJCQkJCQlzdWNjZXNzKHIpOwoJCQkJCQkJfSwKCQkJCQkJCWVycm9yOiBmdW5jdGlvbigpIHsKCQkJCQkJCQllcnJvcigpOwoJCQkJCQkJfQoJCQkJCQl9KTsKCQkJCQl9IGVsc2UgewoJCQkJCQlzdWNjZXNzKCk7CgkJCQkJfQoJCQkJfSwKCQkJCWNvbXBsZXRlOiBmdW5jdGlvbihjb250ZW50KSB7CgkJCQkJY29udGVudCA9ICQoY29udGVudCkuY3NzKHsgb3BhY2l0eTogMCB9KTsKCQkJCQkkKG9wdGlvbnMud3JhcHBlcikuZmluZCgnZGl2LnBvc3QtbGlzdCcpLmFwcGVuZChjb250ZW50KTsKCQkJCQljb250ZW50LmV2b2x1dGlvblRyYW5zZm9ybSh7IG9wYWNpdHk6IDEgfSwgeyBkdXJhdGlvbjogNDAwIH0pOwoJCQkJfQoJCQl9KTsKCQl9Cgl9CgoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5ibG9nTGlzdCA9IGFwaTsKCn0pKGpRdWVyeSk7</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:BlogPost_Name}" version="7.0.0.1" description="" instanceIdentifier="4f1a3378c9f84f129702bef3fab4eefc" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="blogpost">
    <contentScript>
		
#set($postId = false)
#set($postId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('BlogPostId')))
#set($post = $core_v2_blogPost.Get("%{Id = $postId}"))
#if (!$post)
	$core_v2_widget.Hide()
#end
#set($blog = $core_v2_blog.Get("%{Id = $post.BlogId}"))

#set ($accessingUser = $core_v2_user.Accessing)
#set ($accessingUserIsRegistered = false)
#if ($core_v2_user.IsRegistered($accessingUser.Id))
	#set ($accessingUserIsRegistered = true)
#end

&lt;div class="post topic full"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($blog.Group.Url)"&gt;$blog.Group.Name&lt;/a&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($blog.Url)"&gt;$blog.Name&lt;/a&gt;
	&lt;/div&gt;
	&lt;h1&gt;$post.Title&lt;/h1&gt;
	&lt;div class="details"&gt;
		&lt;div class="date"&gt;$core_v2_language.FormatAgoDate($post.PublishedDate)&lt;/div&gt;
		&lt;div class="avatar"&gt;
			#if ($post.Author.ProfileUrl)
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($post.Author.ProfileUrl)" class="internal-link view-user-profile"&gt;
					$core_v2_ui.GetResizedImageHtml($post.Author.AvatarUrl, 24, 24, "%{border='0', alt=$post.Author.DisplayName, ResizeMethod='ZoomAndCrop',border='0'}")
				&lt;/a&gt;
			#else
				$core_v2_ui.GetResizedImageHtml($post.Author.AvatarUrl, 24, 24, "%{border='0', alt=$post.Author.DisplayName, ResizeMethod='ZoomAndCrop',border='0'}")
			#end
		&lt;/div&gt;
		&lt;div class="author"&gt;
			#if ($post.Author.ProfileUrl)
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($post.Author.ProfileUrl)" class="internal-link view-user-profile"&gt;
					$post.Author.DisplayName
				&lt;/a&gt;
			#else
				$post.Author.DisplayName
			#end
		&lt;/div&gt;
	&lt;/div&gt;
	&lt;div class="content user-generated-content"&gt;
		$mobile_v1_dataFormat.Detect($post.Body('Web'))
		#if ($post.File)
			&lt;p&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($post.File.FileUrl)" class="internal-link download-attachment"&gt;$post.File.FileName&lt;/a&gt;&lt;/p&gt;
		#end
	&lt;/div&gt;

	#set ($canEditBlogPost = false)
	#set ($canEditBlogPost = $core_v2_nodePermission.Get("blogs", $post.BlogId, "Blog_ModifyPost").IsAllowed)

	#set ($canDeleteBlogPost = false)
	#set ($canDeleteBlogPost = $core_v2_nodePermission.Get("blogs", $post.BlogId, "Blog_DeletePost").IsAllowed)

	#set($showLikes = false)
	#if($accessingUserIsRegistered &amp;&amp; $core_v2_like.CanLike($post.ContentId, $core_v2_blogPost.ContentTypeId))
		#set($showLikes = true)
	#end

	&lt;div class="actions ui-links" data-maxlinks="#if($showLikes)1#else 0#end"&gt;
			#if ($showLikes)
				&lt;li class="action-like"&gt;
					#set($format = '{toggle} &lt;span class="count"&gt;&lt;span class="icon"&gt;&lt;/span&gt;{count}&lt;/span&gt;')
					$core_v2_ui.Like($post.ContentId, $core_v2_blogPost.ContentTypeId, "%{ Format = $format }")
				&lt;/li&gt;
			#end

			#if ($canEditBlogPost)
				&lt;li&gt;
					&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('blogpost-edit', $post.Id))"&gt;$core_v2_language.GetResource('edit')&lt;/a&gt;
				&lt;/li&gt;
			#end
			#if ($canDeleteBlogPost)
				&lt;li&gt;
					&lt;a href="#" data-messagename="blogpost.delete"&gt;$core_v2_language.GetResource('delete')&lt;/a&gt;
				&lt;/li&gt;
			#end

			#if ($accessingUserIsRegistered &amp;&amp; $core_v2_bookmark.CanBookmark($post.ContentId, $core_v2_blogPost.ContentTypeId))
				&lt;li class="action-bookmark"&gt;
					$core_v2_ui.Bookmark($post.ContentId, $core_v2_blogPost.ContentTypeId)
				&lt;/li&gt;
			#end&gt;
			&lt;li class="action-moderate"&gt;$core_v2_ui.Moderate($post.ContentId, $core_v2_blogPost.ContentTypeId)&lt;/li&gt;

			&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;&lt;/a&gt;&lt;/li&gt;
			&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
	&lt;/div&gt;
&lt;/div&gt;

$mobile_v1_ui.Comments($post.ContentId, $core_v2_blogPost.ContentTypeId, "%{ CanFlagAsAbusive = $accessingUserIsRegistered, AccessingUserId = $accessingUser.Id }")

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.blogPost.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			blogUrl: '$core_v2_encoding.JavascriptEncode($blog.Url)',
			blogId: '$blog.Id',
			postId: '$post.Id',
			postDeleteConfirmation: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post_delete_confirmation'))'
		});
	});
})
&lt;/script&gt;

		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="BlogPost_Name">Blog Post</resource>
		<resource name="edit">Edit</resource>
		<resource name="delete">Delete</resource>
		<resource name="cancel">Cancel</resource>
		<resource name="post_delete_confirmation">Are you sure you want to delete this post?</resource>
	  </language>
	</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIG1vZGVsID0gew0KCQlkZWxldGVQb3N0OiBmdW5jdGlvbiAoYmxvZ0lkLCBwb3N0SWQpIHsNCgkJCXJldHVybiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uZGVsKHsNCgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi9ibG9ncy97QmxvZ0lkfS9wb3N0cy97UG9zdElkfS5qc29uJywNCgkJCQlkYXRhOiB7DQoJCQkJCUJsb2dJZDogYmxvZ0lkLA0KCQkJCQlQb3N0SWQ6IHBvc3RJZA0KCQkJCX0NCgkJCX0pOw0KCQl9DQoJfQ0KDQoJZnVuY3Rpb24gaGFuZGxlQmxvZ1Bvc3REZWxldGlvbkV2ZW50cyhvcHRpb25zKSB7DQoJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tZXNzYWdpbmcuc3Vic2NyaWJlKCdibG9ncG9zdC5kZWxldGUnLCBmdW5jdGlvbiAoZGF0YSkgew0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlU2hlZXQoKTsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuY29uZmlybShvcHRpb25zLnBvc3REZWxldGVDb25maXJtYXRpb24sIGZ1bmN0aW9uIChjb25maXJtZWQpIHsNCgkJCQlpZiAoY29uZmlybWVkKSB7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcobW9kZWwuZGVsZXRlUG9zdChvcHRpb25zLmJsb2dJZCwgb3B0aW9ucy5wb3N0SWQpKQ0KCQkJCQkJLmRvbmUoZnVuY3Rpb24gKCkgew0KCQkJCQkJCS8vIG5hdmlnYXRlIGJhY2sgdG8gdGhlIGRlbGV0ZWQgcG9zdCdzIGJsb2csIGNsZWFyaW5nIGl0cyBjYWNoZQ0KCQkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUubG9hZChvcHRpb25zLmJsb2dVcmwsIHsgcmVmcmVzaDogdHJ1ZSB9KTsNCgkJCQkJCX0pOw0KCQkJCX0NCgkJCX0pOw0KCQl9KTsNCgl9DQoNCgl2YXIgYXBpID0gew0KCQlyZWdpc3RlcjogZnVuY3Rpb24gKG9wdGlvbnMpIHsNCgkJCWhhbmRsZUJsb2dQb3N0RGVsZXRpb25FdmVudHMob3B0aW9ucyk7DQoJCX0NCgl9DQoNCgkkLnRlbGxpZ2VudCA9ICQudGVsbGlnZW50IHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyA9ICQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzLmJsb2dQb3N0ID0gYXBpOw0KDQp9KShqUXVlcnkpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:BlogPostList_Name}" version="7.0.0.1" description="" instanceIdentifier="42d200b69fd4471b8e7dabce5fa81806" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="blogpost-list">
    <contentScript>
		

#set($pageSize = $core_v2_widget.GetIntValue('pageSize', 5))
#set($pageIndex = 0)


#set($blogId = false)
#set($blogId = $mobile_v1_urlToken.Value('BlogId'))

#if ($blogId)
	#set($blogId = $core_v2_utility.ParseInt($blogId))
	#set($blog = false)
	#set($blog = $core_v2_blog.Get("%{Id = $blogId}"))
	#if (!$blog)
		$core_v2_widget.Hide()
	#end

	#set($contextUrl = $blog.Group.Url)
	#set($contextName = $blog.Group.Name)
	#set($avatarUrl = $blog.Group.AvatarUrl)
	#set($name = $blog.Name)
#else
	#set($userId = false)
	#set($userId = $mobile_v1_urlToken.Value('UserId'))
	#if (!$userId)
		$core_v2_widget.Hide()
	#end

	#set($userId =$core_v2_utility.ParseInt($userId))
	#set ($user = false)
	#set ($user = $core_v2_user.Get("%{ Id = $userId }"))
	#if (!$user)
		$core_v2_widget.Hide()
	#end

	#set($contextUrl = $user.ProfileUrl)
	#set($contextName = $user.DisplayName)
	#set($avatarUrl = $user.AvatarUrl)
	#set($name = $core_v2_language.FormatString($core_v2_language.GetResource('Core_UserBlogPosts_Title'), $user.DisplayName))
#end


&lt;div class="banner condensed with-avatar"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($contextUrl)"&gt;$!contextName&lt;/a&gt;
		&lt;h1&gt;$!name&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($avatarUrl, 40, 40, "%{ alt = $contextName, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
	#if ($blog)
		&lt;div class="ui-links actions" data-maxlinks="0"&gt;
			&lt;ul&gt;
				#set ($bookmarkableContentId = $blog.ApplicationId)
				#set ($bookmarkableContentTypeId = $core_v2_blog.ContentTypeId)
				#if ($core_v2_bookmark.SupportsBookmarks($bookmarkableContentTypeId) &amp;&amp; $core_v2_bookmark.CanBookmark($bookmarkableContentId, $bookmarkableContentTypeId) &amp;&amp; $core_v2_bookmark.CanUnBookmark($bookmarkableContentId, $bookmarkableContentTypeId))
					&lt;li&gt;$core_v2_ui.Bookmark($bookmarkableContentId, $bookmarkableContentTypeId)&lt;/li&gt;
				#end
				&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;$core_v2_language.GetResource('more')&lt;/a&gt;&lt;/li&gt;
				&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
			&lt;/ul&gt;
		&lt;/div&gt;
	#end
&lt;/div&gt;


## load and render blog posts
&lt;div class="post-list blogposts"&gt;
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.blogPostList.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
			pageSize: $pageSize
		});

		#if($blogId &amp;&amp; $core_v2_nodePermission.Get("blogs", $blogId, "Blog_CreatePost").IsAllowed)
			jQuery.telligent.evolution.mobile.setHeaderButton(jQuery('&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('blog-addblogpost', $blogId))" class="add"&gt;$core_v2_language.GetResource('post')&lt;/a&gt;'));
		#end
	});
})

&lt;/script&gt;

</contentScript>
    <headerScript>
		</headerScript>
    <configuration>
		
		&lt;propertyGroup id="options"&gt;
			&lt;property id="pageSize" dataType="int" defaultValue="5" /&gt;
		&lt;/propertyGroup&gt;
		
	</configuration>
    <languageResources>
		<language key="en-us">
			<resource name="BlogPostList_Name">Blog Post List</resource>
			<resource name="no_posts">There are no posts in this blog.</resource>
			<resource name="no_comments">No comments</resource>
			<resource name="comment_count">1 comment</resource>
			<resource name="comments_count">{0} comments</resource>
			<resource name="post">New</resource>
			<resource name="Core_UserBlogPosts_Title">Blog Posts</resource>
			<resource name="more">More</resource>
			<resource name="cancel">Cancel</resource>
		</language>
	</languageResources>
    <files>
      <file name="list.vm">I3NldCAoJGFjY2Vzc2luZ1VzZXIgPSAkY29yZV92Ml91c2VyLkFjY2Vzc2luZykKI3NldCAoJGFjY2Vzc2luZ1VzZXJJc1JlZ2lzdGVyZWQgPSBmYWxzZSkKI2lmICgkY29yZV92Ml91c2VyLklzUmVnaXN0ZXJlZCgkYWNjZXNzaW5nVXNlci5JZCkpCgkjc2V0ICgkYWNjZXNzaW5nVXNlcklzUmVnaXN0ZXJlZCA9IHRydWUpCiNlbmQKCiNzZXQoJHF1ZXJ5ID0gIiV7UGFnZUluZGV4PSRwYWdlSW5kZXgsUGFnZVNpemU9JHBhZ2VTaXplLFNvcnRCeT0nTW9zdFJlY2VudCcsU29ydE9yZGVyPSdEZXNjZW5kaW5nJ30iKQojaWYgKCRibG9nSWQpCgkkcXVlcnkuQWRkKCdCbG9nSWQnLCAkYmxvZ0lkKQojZWxzZWlmICgkdXNlcklkKQoJJHF1ZXJ5LkFkZCgnQXV0aG9ySWQnLCAkdXNlcklkKQoJJHF1ZXJ5LkFkZCgnR3JvdXBJZCcsICRjb3JlX3YyX2dyb3VwLlJvb3QuSWQpCgkkcXVlcnkuQWRkKCdJbmNsdWRlU3ViR3JvdXBzJywgdHJ1ZSkKI2Vsc2UKCSRjb3JlX3YyX3dpZGdldC5IaWRlKCkKI2VuZAoKCiNzZXQoJHBvc3RzID0gJGNvcmVfdjJfYmxvZ1Bvc3QuTGlzdCgkcXVlcnkpKQoKI2ZvcmVhY2goJHBvc3QgaW4gJHBvc3RzKQojZWFjaAoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIGJsb2dwb3N0IiBkYXRhLXRhcmdldHVybD0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkcG9zdC5VcmwpIj4KCQk8ZGl2IGNsYXNzPSJwb3N0Ij4KCQkJPGRpdiBjbGFzcz0iYXZhdGFyIj4KCQkJCSNpZiAoJHBvc3QuQXV0aG9yLlByb2ZpbGVVcmwpCgkJCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRwb3N0LkF1dGhvci5Qcm9maWxlVXJsKSIgY2xhc3M9ImludGVybmFsLWxpbmsgdmlldy11c2VyLXByb2ZpbGUiPgoJCQkJCQkJCSRjb3JlX3YyX3VpLkdldFJlc2l6ZWRJbWFnZUh0bWwoJHBvc3QuQXV0aG9yLkF2YXRhclVybCwgNDAsIDQwLCAiJXtib3JkZXI9JzAnLCBhbHQ9JHBvc3QuQXV0aG9yLkRpc3BsYXlOYW1lLCBSZXNpemVNZXRob2Q9J1pvb21BbmRDcm9wJyxib3JkZXI9JzAnfSIpCgkJCQkJCQk8L2E+CgkJCQkJCSNlbHNlCgkJCQkJCQkkY29yZV92Ml91aS5HZXRSZXNpemVkSW1hZ2VIdG1sKCRwb3N0LkF1dGhvci5BdmF0YXJVcmwsIDQwLCA0MCwgIiV7Ym9yZGVyPScwJywgYWx0PSRwb3N0LkF1dGhvci5EaXNwbGF5TmFtZSwgUmVzaXplTWV0aG9kPSdab29tQW5kQ3JvcCcsYm9yZGVyPScwJ30iKQoJCQkJCQkjZW5kCgkJCTwvZGl2PgoJCQk8ZGl2IGNsYXNzPSJkZXRhaWxzIj4KCQkJCTxkaXYgY2xhc3M9ImRhdGUiPiRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdEFnb0RhdGUoJHBvc3QuUHVibGlzaGVkRGF0ZSk8L2Rpdj4KCQkJPC9kaXY+CgkJCTxkaXYgY2xhc3M9ImNvbnRlbnQiPgoJCQkJPGEgaHJlZj0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkcG9zdC5VcmwpIj4kcG9zdC5UaXRsZTwvYT4KCQkJPC9kaXY+CgkJCTxkaXYgY2xhc3M9ImFjdGlvbnMgdWktbGlua3MiPgoJCQkJPHVsPgoJCQkJCSNpZiAoJGFjY2Vzc2luZ1VzZXJJc1JlZ2lzdGVyZWQgJiYgJGNvcmVfdjJfbGlrZS5DYW5MaWtlKCRwb3N0LkNvbnRlbnRJZCwgJGNvcmVfdjJfYmxvZ1Bvc3QuQ29udGVudFR5cGVJZCkpCgkJCQkJCTxsaSBjbGFzcz0iYWN0aW9uLWxpa2UiPgoJCQkJCQkJI3NldCgkZm9ybWF0ID0gJ3t0b2dnbGV9IDxzcGFuIGNsYXNzPSJjb3VudCI+PHNwYW4gY2xhc3M9Imljb24iPjwvc3Bhbj57Y291bnR9PC9zcGFuPicpCgkJCQkJCQkkY29yZV92Ml91aS5MaWtlKCRwb3N0LkNvbnRlbnRJZCwgJGNvcmVfdjJfYmxvZ1Bvc3QuQ29udGVudFR5cGVJZCwgIiV7IEZvcm1hdCA9ICRmb3JtYXQgfSIpCgkJCQkJCTwvbGk+CgkJCQkJI2VuZAoKCQkJCQk8bGkgY2xhc3M9ImFjdGlvbi1jb21tZW50Ij4KCQkJCQkJPGEgY2xhc3M9ImludGVybmFsLWxpbmsgY29tbWVudCIgaHJlZj0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkcG9zdC5VcmwpIj4KCQkJCQkJCSNpZiAoJHBvc3QuQ29tbWVudENvdW50ID09IDApCgkJCQkJCQkJJGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ25vX2NvbW1lbnRzJykKCQkJCQkJCSNlbHNlaWYgKCRwb3N0LkNvbW1lbnRDb3VudCA9PSAxKQoJCQkJCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdFN0cmluZygkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnY29tbWVudF9jb3VudCcpLCAkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXROdW1iZXIoJHBvc3QuQ29tbWVudENvdW50KSkKCQkJCQkJCSNlbHNlCgkJCQkJCQkJJGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0U3RyaW5nKCRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdjb21tZW50X2NvdW50JyksICRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdE51bWJlcigkcG9zdC5Db21tZW50Q291bnQpKQoJCQkJCQkJI2VuZAoJCQkJCQk8L2E+CgkJCQkJPC9saT4KCQkJCTwvdWw+CgkJCTwvZGl2PgoJCTwvZGl2PgoJPC9kaXY+CiNub2RhdGEKCTxkaXYgY2xhc3M9InBvc3QtbGlzdC1pdGVtIGNvbnRlbnQtaXRlbSBibG9nIj48ZGl2IGNsYXNzPSJtZXNzYWdlIG5vcmVjb3JkcyI+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ25vX3Bvc3RzJyk8L2Rpdj48L2Rpdj4KI2FmdGVyYWxsCgkjc2V0ICgkaGFzTW9yZSA9IGZhbHNlKQoJI2lmICgkcG9zdHMuVG90YWxDb3VudCA+ICgoJHBvc3RzLlBhZ2VJbmRleCArIDEpICogJHBvc3RzLlBhZ2VTaXplKSkKCQkjc2V0KCRoYXNNb3JlID0gdHJ1ZSkKCSNlbmQKCTxkaXYgY2xhc3M9ImRhdGEiICNpZigkaGFzTW9yZSlkYXRhLWhhc21vcmU9InRydWUiI2VuZD48L2Rpdj4KI2VuZA==</file>
      <file name="more.vm">IyMKIyMgQWpheCBjYWxsYmFjayBmb3IgbG9hZGluZyBtb3JlIGJsb2cgcG9zdHMKIyMKI3NldCAoJHBhZ2VJbmRleCA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19wYWdlSW5kZXgnKSkKI3NldCAoJHBhZ2VTaXplID0gJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X3BhZ2VTaXplJykpCgojc2V0KCRibG9nSWQgPSBmYWxzZSkKI3NldCgkYmxvZ0lkID0gJG1vYmlsZV92MV91cmxUb2tlbi5WYWx1ZSgnQmxvZ0lkJykpCiNpZiAoJGJsb2dJZCkKCSNzZXQoJGJsb2dJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJGJsb2dJZCkpCiNlbHNlCgkjc2V0KCR1c2VySWQgPSBmYWxzZSkKCSNzZXQoJHVzZXJJZCA9ICRtb2JpbGVfdjFfdXJsVG9rZW4uVmFsdWUoJ1VzZXJJZCcpKQoJI2lmICgkdXNlcklkKQoJCSNzZXQoJHVzZXJJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJHVzZXJJZCkpCgkjZWxzZQoJCSRjb3JlX3YyX3dpZGdldC5IaWRlKCkKCSNlbmQKI2VuZAokY29yZV92Ml93aWRnZXQuRXhlY3V0ZUZpbGUoJ2xpc3Qudm0nKQo=</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpewoKCXZhciBhcGkgPSB7CgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zY3JvbGxhYmxlKHsKCQkJCXJlZ2lvbjogJ2NvbnRlbnQnLAoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgewoJCQkJCWlmICgkKG9wdGlvbnMud3JhcHBlciArICcgZGl2LmRhdGE6bGFzdCcpLmRhdGEoJ2hhc21vcmUnKSkgewoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsKCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLAoJCQkJCQkJZGF0YTogewoJCQkJCQkJCXdfcGFnZUluZGV4OiBwYWdlSW5kZXgsCgkJCQkJCQkJd19wYWdlU2l6ZTogb3B0aW9ucy5wYWdlU2l6ZQoJCQkJCQkJfSwKCQkJCQkJCXN1Y2Nlc3M6IGZ1bmN0aW9uKHIpIHsKCQkJCQkJCQlzdWNjZXNzKHIpOwoJCQkJCQkJfSwKCQkJCQkJCWVycm9yOiBmdW5jdGlvbigpIHsKCQkJCQkJCQllcnJvcigpOwoJCQkJCQkJfQoJCQkJCQl9KTsKCQkJCQl9IGVsc2UgewoJCQkJCQlzdWNjZXNzKCk7CgkJCQkJfQoJCQkJfSwKCQkJCWNvbXBsZXRlOiBmdW5jdGlvbihjb250ZW50KSB7CgkJCQkJY29udGVudCA9ICQoY29udGVudCkuY3NzKHsgb3BhY2l0eTogMCB9KTsKCQkJCQkkKG9wdGlvbnMud3JhcHBlcikuZmluZCgnZGl2LnBvc3QtbGlzdCcpLmFwcGVuZChjb250ZW50KTsKCQkJCQljb250ZW50LmV2b2x1dGlvblRyYW5zZm9ybSh7IG9wYWNpdHk6IDEgfSwgeyBkdXJhdGlvbjogNDAwIH0pOwoJCQkJfQoJCQl9KTsKCQl9Cgl9CgoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5ibG9nUG9zdExpc3QgPSBhcGk7Cgp9KShqUXVlcnkpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:Conversation_Name}" version="7.0.0.1" description="" instanceIdentifier="607b7626a40345c38821ae6a76b9ff47" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="conversation">
    <contentScript>
		
#set($conversationId = false)
#set($conversationId = $core_v2_utility.ParseGuid($mobile_v1_urlToken.Value('ConversationId')))
#if (!$conversationId)
	$core_v2_widget.Hide()
#end

#set($conversation = $core_v2_conversation.Get($conversationId))
&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('conversations'))"&gt;$core_v2_language.GetResource('conversations')&lt;/a&gt;
		&lt;h1&gt;$conversation.FirstMessage.Subject&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="description"&gt;
#foreach ($participant in $conversation.Participants)
#beforeall
$core_v2_language.GetResource('participants_before')
#each
&lt;a href="$core_v2_encoding.HtmlAttributeEncode($participant.Url)"&gt;$participant.DisplayName&lt;/a&gt;
#between
$core_v2_language.GetResource('participants_between')
#afterall
$core_v2_language.GetResource('participants_after')
#end
	&lt;/div&gt;
&lt;/div&gt;

&lt;div class="post-list messages"&gt;
	#set($pageIndex = 0)
	#set($messages = $core_v2_conversationMessage.List($conversationId, "%{PageSize=5,PageIndex=$pageIndex}"))
	#set($lastPageIndex = $messages.TotalCount / 5)
	#if ($lastPageIndex * 5 &gt;= $messages.TotalCount)
		#set($lastPageIndex = $lastPageIndex - 1)
	#end
	#set($pageIndex = $lastPageIndex)
	#if ($pageIndex &gt;= 1)
		#set($messages = false)
	#end

	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;
&lt;div class="reply-form"&gt;
	&lt;fieldset&gt;
		&lt;div class="form-field"&gt;
			&lt;textarea placeholder="$core_v2_language.GetResource('reply_placeholder')"&gt;&lt;/textarea&gt;
		&lt;/div&gt;
	&lt;/fieldset&gt;
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.conversation.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
			replyUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('reply.vm'))',
			conversationsUrl: '$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('conversations'))',
			conversationId: '$conversationId.ToString()',
			deleteConfirmation: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('conversation_delete_confirmation'))',
			replyText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('reply'))',
			deleteText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('delete'))',
			conversationNotificationTypeId: '$core_v2_conversationMessage.NotificationTypeId.ToString()',
			conversationId: '$conversationId.ToString()',
			getLatestUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('get-latest.vm'))'
		});
	});
})
&lt;/script&gt;
		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="Conversation_Name">Conversation</resource>
		<resource name="conversations">Inbox</resource>
		<resource name="delete">Delete</resource>
		<resource name="conversation_delete_confirmation">Are you sure you want to delete this conversation?</resource>
		<resource name="message_load_more">Load more messages...</resource>
		<resource name="reply_placeholder">Reply...</resource>
		<resource name="reply">Reply</resource>
		<resource name="participants_before">with </resource>
		<resource name="participants_between">, </resource>
		<resource name="participants_after"></resource>
	  </language>
	</languageResources>
    <files>
      <file name="get-latest.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBtZXNzYWdlcw0KIyMNCg0KI3NldCAoJGFjY2Vzc2luZ1VzZXIgPSAkY29yZV92Ml91c2VyLkFjY2Vzc2luZykNCiNzZXQgKCRhY2Nlc3NpbmdVc2VySXNSZWdpc3RlcmVkID0gZmFsc2UpDQojaWYgKCRjb3JlX3YyX3VzZXIuSXNSZWdpc3RlcmVkKCRhY2Nlc3NpbmdVc2VyLklkKSkNCiAgICAjc2V0ICgkYWNjZXNzaW5nVXNlcklzUmVnaXN0ZXJlZCA9IHRydWUpDQojZW5kDQoNCiNzZXQoJGNvbnZlcnNhdGlvbklkID0gZmFsc2UpDQojc2V0KCRjb252ZXJzYXRpb25JZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VHdWlkKCRtb2JpbGVfdjFfdXJsVG9rZW4uVmFsdWUoJ0NvbnZlcnNhdGlvbklkJykpKQ0KI2lmICghJGNvbnZlcnNhdGlvbklkKQ0KCSRjb3JlX3YyX3dpZGdldC5IaWRlKCkNCiNlbmQNCg0KI3NldCgkbWVzc2FnZXMgPSAkY29yZV92Ml9jb252ZXJzYXRpb25NZXNzYWdlLkxpc3QoJGNvbnZlcnNhdGlvbklkLCAiJXtQYWdlU2l6ZT01LFBhZ2VJbmRleD0wfSIpKQ0KI3NldCgkbGFzdFBhZ2VJbmRleCA9ICRtZXNzYWdlcy5Ub3RhbENvdW50IC8gNSkNCiNpZiAoJGxhc3RQYWdlSW5kZXggKiA1ID49ICRtZXNzYWdlcy5Ub3RhbENvdW50KQ0KCSNzZXQoJGxhc3RQYWdlSW5kZXggPSAkbGFzdFBhZ2VJbmRleCAtIDEpDQojZW5kDQojc2V0KCRwYWdlSW5kZXggPSAkbGFzdFBhZ2VJbmRleCkNCiNpZiAoJHBhZ2VJbmRleCA+PSAxKQ0KCSNzZXQoJG1lc3NhZ2VzID0gJGNvcmVfdjJfY29udmVyc2F0aW9uTWVzc2FnZS5MaXN0KCRjb252ZXJzYXRpb25JZCwgIiV7UGFnZVNpemU9NSxQYWdlSW5kZXg9JHBhZ2VJbmRleH0iKSkNCiNlbmQNCg0KI2ZvcmVhY2goJG1lc3NhZ2UgaW4gJG1lc3NhZ2VzKQ0KI2VhY2gNCgkkY29yZV92Ml93aWRnZXQuRXhlY3V0ZUZpbGUoJ3JlbmRlci1yZXBseS52bScpDQojZW5kDQoNCg==</file>
      <file name="list.vm">I2lmICghJG1lc3NhZ2VzKQoJI3NldCgkbWVzc2FnZXMgPSAkY29yZV92Ml9jb252ZXJzYXRpb25NZXNzYWdlLkxpc3QoJGNvbnZlcnNhdGlvbklkLCAiJXtQYWdlU2l6ZT01LFBhZ2VJbmRleD0kcGFnZUluZGV4fSIpKQojZW5kCiNpZiAoJHBhZ2VJbmRleCA+IDApCgkjc2V0KCR0YXJnZXRQYWdlSW5kZXggPSAkcGFnZUluZGV4IC0gMSkKCTxhIGhyZWY9IiMiIGRhdGEtcGFnZWluZGV4PSIkdGFyZ2V0UGFnZUluZGV4IiBjbGFzcz0idmlldy1tb3JlIj4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbWVzc2FnZV9sb2FkX21vcmUnKTwvYT4KI2VuZAojZm9yZWFjaCgkbWVzc2FnZSBpbiAkbWVzc2FnZXMpCiNlYWNoCgkkY29yZV92Ml93aWRnZXQuRXhlY3V0ZUZpbGUoJ3JlbmRlci1yZXBseS52bScpCiNlbmQ=</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBtZXNzYWdlcw0KIyMNCg0KI3NldCAoJGFjY2Vzc2luZ1VzZXIgPSAkY29yZV92Ml91c2VyLkFjY2Vzc2luZykNCiNzZXQgKCRhY2Nlc3NpbmdVc2VySXNSZWdpc3RlcmVkID0gZmFsc2UpDQojaWYgKCRjb3JlX3YyX3VzZXIuSXNSZWdpc3RlcmVkKCRhY2Nlc3NpbmdVc2VyLklkKSkNCiAgICAjc2V0ICgkYWNjZXNzaW5nVXNlcklzUmVnaXN0ZXJlZCA9IHRydWUpDQojZW5kDQoNCiNzZXQgKCRwYWdlSW5kZXggPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfcGFnZUluZGV4JykpDQojc2V0KCRjb252ZXJzYXRpb25JZCA9IGZhbHNlKQ0KI3NldCgkY29udmVyc2F0aW9uSWQgPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlR3VpZCgkbW9iaWxlX3YxX3VybFRva2VuLlZhbHVlKCdDb252ZXJzYXRpb25JZCcpKSkNCiNpZiAoISRjb252ZXJzYXRpb25JZCkNCgkkY29yZV92Ml93aWRnZXQuSGlkZSgpDQojZW5kDQoNCiNzZXQoJG1lc3NhZ2VzID0gZmFsc2UpDQoNCiRjb3JlX3YyX3dpZGdldC5FeGVjdXRlRmlsZSgnbGlzdC52bScp</file>
      <file name="render-reply.vm">PGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIG1lc3NhZ2UiIGRhdGEtcmVwbHlpZD0iJG1lc3NhZ2UuSWQuVG9TdHJpbmcoKSI+Cgk8ZGl2IGNsYXNzPSJwb3N0IGZ1bGwiPgoJCTxkaXYgY2xhc3M9ImRldGFpbHMiPgoJCQk8ZGl2IGNsYXNzPSJkYXRlIj4kY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRBZ29EYXRlKCRtZXNzYWdlLkNyZWF0ZWREYXRlKTwvZGl2PgoJCQk8ZGl2IGNsYXNzPSJhdmF0YXIiPgoJCQkJI2lmICgkbWVzc2FnZS5BdXRob3IuUHJvZmlsZVVybCkKICAgICAgICAgICAgCQkJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJG1lc3NhZ2UuQXV0aG9yLlByb2ZpbGVVcmwpIiBjbGFzcz0iaW50ZXJuYWwtbGluayB2aWV3LXVzZXItcHJvZmlsZSI+CiAgICAgICAgICAgICAgICAJCQkJJGNvcmVfdjJfdWkuR2V0UmVzaXplZEltYWdlSHRtbCgkbWVzc2FnZS5BdXRob3IuQXZhdGFyVXJsLCAyNCwgMjQsICIle2JvcmRlcj0nMCcsIGFsdD0kbWVzc2FnZS5BdXRob3IuRGlzcGxheU5hbWUsIFJlc2l6ZU1ldGhvZD0nWm9vbUFuZENyb3AnLGJvcmRlcj0nMCd9IikKICAgICAgICAgICAgCQkJCTwvYT4KICAgICAgICAJCQkjZWxzZQogICAgICAgICAgICAJCQkJJGNvcmVfdjJfdWkuR2V0UmVzaXplZEltYWdlSHRtbCgkbWVzc2FnZS5BdXRob3IuQXZhdGFyVXJsLCAyNCwgMjQsICIle2JvcmRlcj0nMCcsIGFsdD0kbWVzc2FnZS5BdXRob3IuRGlzcGxheU5hbWUsIFJlc2l6ZU1ldGhvZD0nWm9vbUFuZENyb3AnLGJvcmRlcj0nMCd9IikKICAgICAgICAJCQkjZW5kCgkJCTwvZGl2PgoJCQk8ZGl2IGNsYXNzPSJhdXRob3IiPgoJCQkJI2lmICgkbWVzc2FnZS5BdXRob3IuUHJvZmlsZVVybCkKCQkgICAgICAgICAgICAJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJG1lc3NhZ2UuQXV0aG9yLlByb2ZpbGVVcmwpIiBjbGFzcz0iaW50ZXJuYWwtbGluayB2aWV3LXVzZXItcHJvZmlsZSI+CgkJICAgICAgICAgICAgICAgIAkJJG1lc3NhZ2UuQXV0aG9yLkRpc3BsYXlOYW1lCgkJICAgICAgICAgICAgCQk8L2E+CgkJICAgICAgICAJI2Vsc2UKCQkgICAgICAgICAgICAJCSRtZXNzYWdlLkF1dGhvci5EaXNwbGF5TmFtZQoJCSAgICAgICAgCSNlbmQKCQkJPC9kaXY+CgkJPC9kaXY+CgkJPGRpdiBjbGFzcz0iY29udGVudCB1c2VyLWdlbmVyYXRlZC1jb250ZW50Ij4KCQkJJG1lc3NhZ2UuUmVuZGVyZWRCb2R5CgkJPC9kaXY+Cgk8L2Rpdj4KPC9kaXY+</file>
      <file name="reply.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgdG8gYWRkIGEgcmVwbHkNCiMjDQoNCiRjb3JlX3YyX3BhZ2UuU2V0Q29udGVudFR5cGUoJ2FwcGxpY2F0aW9uL2pzb24nKQ0KDQojc2V0KCRjb252ZXJzYXRpb25JZCA9IGZhbHNlKQ0KI3NldCgkY29udmVyc2F0aW9uSWQgPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlR3VpZCgkbW9iaWxlX3YxX3VybFRva2VuLlZhbHVlKCdDb252ZXJzYXRpb25JZCcpKSkNCiNpZiAoISRjb252ZXJzYXRpb25JZCkNCgkkY29yZV92Ml9wYWdlLlNlbmRKc29uRXJyb3IoJ1RoZSBzcGVjaWZpZWQgY29udmVyc2F0aW9uIGNvdWxkIG5vdCBiZSBkZXRlcm1pbmVkJykNCiNlbmQNCg0KI3NldCgkYm9keSA9ICRjb3JlX3YyX3VpLkZvcm1hdFRleHRBc0h0bWwoJGNvcmVfdjJfcGFnZS5HZXRGb3JtVmFsdWUoJ0JvZHknKSwgIiV7Q29udmVydFRvUGFyYWdyYXBocz0ndHJ1ZScsIERldGVjdE1lZGlhVXJscz0ndHJ1ZSd9IikpDQoNCiNzZXQoJHJlc3BvbnNlID0gJGNvcmVfdjJfY29udmVyc2F0aW9uTWVzc2FnZS5DcmVhdGUoJGNvbnZlcnNhdGlvbklkLCAkYm9keSwgIiV7fSIpKQ0KI2lmICgkcmVzcG9uc2UuRXJyb3JzLkNvdW50ID4gMCkNCgkkY29yZV92Ml9wYWdlLlNlbmRKc29uRXJyb3IoJHJlc3BvbnNlLkVycm9ycykNCiNlbHNlDQoJeyJzdWNjZXNzIjoidHJ1ZSJ9DQojZW5k</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIG1vZGVsID0gew0KCQlkZWxldGVDb252ZXJzYXRpb246IGZ1bmN0aW9uKGNvbnZlcnNhdGlvbklkKSB7DQoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygkLnRlbGxpZ2VudC5ldm9sdXRpb24uZGVsKHsNCgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi9jb252ZXJzYXRpb25zL3tDb252ZXJzYXRpb25JZH0uanNvbicsDQoJCQkJZGF0YTogew0KCQkJCQlDb252ZXJzYXRpb25JZDogY29udmVyc2F0aW9uSWQNCgkJCQl9DQoJCQl9KSk7DQoJCX0sDQoJCWFkZE1lc3NhZ2U6IGZ1bmN0aW9uKHJlcGx5VXJsLCBjb252ZXJzYXRpb25JZCwgdGV4dCkgew0KCQkJcmV0dXJuICQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnBvc3Qoew0KCQkJCXVybDogcmVwbHlVcmwsDQoJCQkJZGF0YTogew0KCQkJCQlDb252ZXJzYXRpb25JZDogY29udmVyc2F0aW9uSWQsDQoJCQkJCUJvZHk6IHRleHQNCgkJCQl9DQoJCQl9KSk7DQoJCX0sDQoJCWdldExhdGVzdE1lc3NhZ2VzOiBmdW5jdGlvbihsYXRlc3RNZXNzYWdlVXJsKSB7DQoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsNCgkJCQl1cmw6IGxhdGVzdE1lc3NhZ2VVcmwsDQoJCQkJY2FjaGU6IGZhbHNlDQoJCQl9KSk7DQoJCX0sDQoJCW1hcmtBc1JlYWQ6IGZ1bmN0aW9uKGNvbnZlcnNhdGlvbklkKSB7DQoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7DQoJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvY29udmVyc2F0aW9ucy97Q29udmVyc2F0aW9uSWR9L3JlYWQuanNvbicsDQoJCQkJZGF0YTogew0KCQkJCQlDb252ZXJzYXRpb25JZDogY29udmVyc2F0aW9uSWQsDQoJCQkJCUhhc1JlYWQ6ICdUcnVlJw0KCQkJCX0NCgkJCX0pOw0KCQl9LA0KCQlsb2FkTW9yZTogZnVuY3Rpb24obW9yZVVybCwgcGFnZUluZGV4KSB7DQoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsNCgkJCQl1cmw6IG1vcmVVcmwsDQoJCQkJZGF0YTogew0KCQkJCQl3X3BhZ2VJbmRleDogcGFnZUluZGV4DQoJCQkJfQ0KCQkJfSkpOw0KCQl9DQoJfQ0KDQoJZnVuY3Rpb24gcmVuZGVyTGF0ZXN0TWVzc2FnZXMod3JhcHBlciwgbWVzc2FnZXMpIHsNCgkJdmFyIHAgPSAkKHdyYXBwZXIgKyAnIC5wb3N0LWxpc3QubWVzc2FnZXMnKTsNCgkJJCgnPGRpdj4nICsgbWVzc2FnZXMgKyAnPC9kaXY+JykuZmluZCgnLnBvc3QtbGlzdC1pdGVtLm1lc3NhZ2UnKS5lYWNoKGZ1bmN0aW9uKCkgew0KCQkJdmFyIHBhcmVudCA9ICQodGhpcyk7DQoJCQl2YXIgcmVwbHlJZCA9IHBhcmVudC5kYXRhKCdyZXBseWlkJyk7DQoJCQlpZiAocC5maW5kKCcucG9zdC1saXN0LWl0ZW0ubWVzc2FnZVtkYXRhLXJlcGx5aWQ9IicgKyByZXBseUlkICsgJyJdJykubGVuZ3RoID09IDApIHsNCgkJCQlwLmFwcGVuZChwYXJlbnQpOw0KCQkJfQ0KCQl9KTsNCgl9DQoNCglmdW5jdGlvbiBoYW5kbGVEZWxldGVFdmVudChvcHRpb25zKSB7DQoJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuY29uZmlybShvcHRpb25zLmRlbGV0ZUNvbmZpcm1hdGlvbiwgZnVuY3Rpb24oY29uZmlybWVkKSB7DQoJCQlpZiAoY29uZmlybWVkKSB7DQoJCQkJbW9kZWwuZGVsZXRlQ29udmVyc2F0aW9uKG9wdGlvbnMuY29udmVyc2F0aW9uSWQpDQoJCQkJCS5kb25lKGZ1bmN0aW9uKCl7DQoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmxvYWQob3B0aW9ucy5jb252ZXJzYXRpb25zVXJsKTsNCgkJCQkJfSk7DQoJCQl9DQoJCX0pOw0KCX0NCg0KCWZ1bmN0aW9uIGhhbmRsZVJlcGx5RXZlbnQob3B0aW9ucykgew0KCQl2YXIgaW5wdXQgPSAkKG9wdGlvbnMud3JhcHBlciArICcgLnJlcGx5LWZvcm0gdGV4dGFyZWEnKTsNCgkJaWYgKGlucHV0LnZhbCgpLmxlbmd0aCA+IDApIHsNCgkJCWlucHV0LmJsdXIoKTsNCgkJCW1vZGVsLmFkZE1lc3NhZ2Uob3B0aW9ucy5yZXBseVVybCwgb3B0aW9ucy5jb252ZXJzYXRpb25JZCwgaW5wdXQudmFsKCkpDQoJCQkJLmRvbmUoZnVuY3Rpb24oKSB7DQoJCQkJCWlucHV0LnZhbCgnJyk7DQoJCQkJCW1vZGVsLmdldExhdGVzdE1lc3NhZ2VzKG9wdGlvbnMuZ2V0TGF0ZXN0VXJsKS50aGVuKGZ1bmN0aW9uKHIpew0KCQkJCQkJcmVuZGVyTGF0ZXN0TWVzc2FnZXMob3B0aW9ucy53cmFwcGVyLCByKTsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuY29udGVudFNjcm9sbFRvcChpbnB1dC5nZXQoMCkpOw0KCQkJCQl9KQ0KCQkJCX0pOw0KCQl9DQoJfQ0KDQoJZnVuY3Rpb24gaW5pdFBhZ2luZyhvcHRpb25zKSB7DQoJCSQob3B0aW9ucy53cmFwcGVyKS5vbigndGFwJywgJy5wb3N0LWxpc3QubWVzc2FnZXMgYS52aWV3LW1vcmUnLCBmdW5jdGlvbihlKSB7DQoJCQl2YXIgbCA9ICQodGhpcyk7DQoJCQl2YXIgcGkgPSBwYXJzZUludChsLmRhdGEoJ3BhZ2VpbmRleCcpLCAxMCk7DQoJCQlpZiAoaXNOYU4ocGkpKSB7DQoJCQkJcmV0dXJuOw0KCQkJfQ0KDQoJCQltb2RlbC5sb2FkTW9yZShvcHRpb25zLm1vcmVVcmwsIHBpKS5kb25lKGZ1bmN0aW9uKHIpew0KCQkJCXZhciB0b3AgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmNvbnRlbnRTY3JvbGxUb3AoKTsNCgkJCQl2YXIgbGlzdCA9IGwucGFyZW50cygnLnBvc3QtbGlzdC5tZXNzYWdlcycpOw0KCQkJCXZhciBoID0gbGlzdC5vdXRlckhlaWdodCgpOw0KCQkJCWwuYmVmb3JlKHIpOw0KCQkJCWwuaGlkZSgpOw0KCQkJCXRvcCA9IHRvcCArIGxpc3Qub3V0ZXJIZWlnaHQoKSAtIGg7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5jb250ZW50U2Nyb2xsVG9wKHRvcCk7DQoJCQl9KTsNCg0KCQkJcmV0dXJuIGZhbHNlOw0KCQl9KTsNCgl9DQoNCgl2YXIgYXBpID0gew0KCQlyZWdpc3RlcjogZnVuY3Rpb24ob3B0aW9ucykgew0KDQoJCQlpbml0UGFnaW5nKG9wdGlvbnMpOw0KDQoJCQl2YXIgZGVsZXRlTGluayA9ICQoJzxhIGhyZWY9IiMiPicgKyBvcHRpb25zLmRlbGV0ZVRleHQgKyAnPC9hPicpOw0KCQkJZGVsZXRlTGluay5vbignY2xpY2snLCBmdW5jdGlvbigpIHsNCgkJCQloYW5kbGVEZWxldGVFdmVudChvcHRpb25zKTsNCgkJCX0pOw0KDQoJCQl2YXIgcmVwbHlMaW5rID0gJCgnPGEgaHJlZj0iIyI+JyArIG9wdGlvbnMucmVwbHlUZXh0ICsgJzwvYT4nKTsNCgkJCXJlcGx5TGluay5vbignY2xpY2snLCBmdW5jdGlvbigpIHsNCgkJCQloYW5kbGVSZXBseUV2ZW50KG9wdGlvbnMpOw0KCQkJfSk7DQoNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2V0SGVhZGVyQnV0dG9uKGRlbGV0ZUxpbmspOw0KCQkJJChvcHRpb25zLndyYXBwZXIgKyAnIC5yZXBseS1mb3JtIHRleHRhcmVhJykNCgkJCQkub24oJ2ZvY3VzJywgZnVuY3Rpb24oKSB7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2V0SGVhZGVyQnV0dG9uKHJlcGx5TGluayk7DQoJCQkJfSkNCgkJCQkub24oJ2JsdXInLCBmdW5jdGlvbigpIHsNCgkJCQkJd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7DQoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNldEhlYWRlckJ1dHRvbihkZWxldGVMaW5rKTsNCgkJCQkJfSwgMjQ5KTsNCgkJCQl9KTsNCg0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ25vdGlmaWNhdGlvbi5yYWlzZWQnLCBmdW5jdGlvbihkKSB7DQoJCQkJaWYgKGQudHlwZUlkID09IG9wdGlvbnMuY29udmVyc2F0aW9uTm90aWZpY2F0aW9uVHlwZUlkICYmIGQuY29udGVudElkID09IG9wdGlvbnMuY29udmVyc2F0aW9uSWQpIHsNCgkJCQkJbW9kZWwuZ2V0TGF0ZXN0TWVzc2FnZXMob3B0aW9ucy5nZXRMYXRlc3RVcmwpLnRoZW4oZnVuY3Rpb24ocil7DQoJCQkJCQlyZW5kZXJMYXRlc3RNZXNzYWdlcyhvcHRpb25zLndyYXBwZXIsIHIpOw0KCQkJCQl9KTsNCgkJCQkJbW9kZWwubWFya0FzUmVhZChkLmNvbnRlbnRJZCkudGhlbihmdW5jdGlvbihyKXsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tZXNzYWdpbmcucHVibGlzaCgnbm90aWZpY2F0aW9uLnJlYWQnLCB7DQoJCQkJCQkJdHlwZUlkOiBvcHRpb25zLmNvbnZlcnNhdGlvbk5vdGlmaWNhdGlvblR5cGVJZCwNCgkJCQkJCQl1bnJlYWRDb3VudDogJy09MScNCgkJCQkJCX0pOw0KCQkJCQl9KTsNCgkJCQl9DQoJCQl9KTsNCg0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5jb250ZW50U2Nyb2xsVG9wKCQob3B0aW9ucy53cmFwcGVyICsgJyAucmVwbHktZm9ybScpLm9mZnNldCgpLnRvcCk7DQoJCX0NCgl9DQoNCgkkLnRlbGxpZ2VudCA9ICQudGVsbGlnZW50IHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyA9ICQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzLmNvbnZlcnNhdGlvbiA9IGFwaTsNCg0KfSkoalF1ZXJ5KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:ConversationList_Name}" version="7.0.0.1" description="" instanceIdentifier="5bf0e5f843ca4cd8a69bbab3ac7a6629" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="conversation-list">
    <contentScript>
		
&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;h1&gt;$core_v2_language.GetResource('conversations')&lt;/h1&gt;
	&lt;/div&gt;
&lt;/div&gt;

## load and render threads
&lt;div class="post-list conversations"&gt;
	#set($pageIndex = 0)
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.conversationList.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
			notificationTypeId: '$core_v2_encoding.JavascriptEncode($core_v2_conversationMessage.NotificationTypeId.ToString())',
			newConversationUrl: '$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('conversation-add'))',
			newConversationLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('new_conversation'))'
		});
	});
})
&lt;/script&gt;
		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="ConversationList_Name">Conversation List</resource>
		<resource name="conversations">Inbox</resource>
		<resource name="no_conversations">There are no messages in your inbox.</resource>
		<resource name="no_messages">No messages</resource>
		<resource name="message_count">{0} message</resource>
		<resource name="messages_count">{0} messages</resource>
		<resource name="participants_before">with </resource>
	  </language>
	</languageResources>
    <files>
      <file name="list.vm">I3NldCAoJGFjY2Vzc2luZ1VzZXIgPSAkY29yZV92Ml91c2VyLkFjY2Vzc2luZykKI3NldCAoJGFjY2Vzc2luZ1VzZXJJc1JlZ2lzdGVyZWQgPSBmYWxzZSkKI2lmICgkY29yZV92Ml91c2VyLklzUmVnaXN0ZXJlZCgkYWNjZXNzaW5nVXNlci5JZCkpCgkjc2V0ICgkYWNjZXNzaW5nVXNlcklzUmVnaXN0ZXJlZCA9IHRydWUpCiNlbmQKCiNzZXQoJGNvbnZlcnNhdGlvbnMgPSAkY29yZV92Ml9jb252ZXJzYXRpb24uTGlzdCgiJXtQYWdlSW5kZXg9JHBhZ2VJbmRleCxQYWdlU2l6ZT03fSIpKQojZm9yZWFjaCgkY29udmVyc2F0aW9uIGluICRjb252ZXJzYXRpb25zKQojZWFjaAoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIGNvbnZlcnNhdGlvbiAjaWYgKCEkY29udmVyc2F0aW9uLkhhc1JlYWQpIHVucmVhZCNlbmQiIGRhdGEtdGFyZ2V0dXJsPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRjb252ZXJzYXRpb24uVXJsKSIgZGF0YS1jb252ZXJzYXRpb25pZD0iJGNvbnZlcnNhdGlvbi5JZC5Ub1N0cmluZygpIj4KCQk8ZGl2IGNsYXNzPSJwb3N0Ij4KCQkJPGRpdiBjbGFzcz0iYXZhdGFyIj4KCQkJCSNpZiAoJGNvbnZlcnNhdGlvbi5GaXJzdE1lc3NhZ2UuQXV0aG9yLlByb2ZpbGVVcmwpCgkJCQkJPGEgaHJlZj0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkY29udmVyc2F0aW9uLkZpcnN0TWVzc2FnZS5BdXRob3IuUHJvZmlsZVVybCkiIGNsYXNzPSJpbnRlcm5hbC1saW5rIHZpZXctdXNlci1wcm9maWxlIj4KCQkJCQkJJGNvcmVfdjJfdWkuR2V0UmVzaXplZEltYWdlSHRtbCgkY29udmVyc2F0aW9uLkZpcnN0TWVzc2FnZS5BdXRob3IuQXZhdGFyVXJsLCA0MCwgNDAsICIle2JvcmRlcj0nMCcsIGFsdD0kY29udmVyc2F0aW9uLkZpcnN0TWVzc2FnZS5BdXRob3IuRGlzcGxheU5hbWUsIFJlc2l6ZU1ldGhvZD0nWm9vbUFuZENyb3AnLGJvcmRlcj0nMCd9IikKCQkJCQk8L2E+CgkJCQkjZWxzZQoJCQkJCSRjb3JlX3YyX3VpLkdldFJlc2l6ZWRJbWFnZUh0bWwoJGNvbnZlcnNhdGlvbi5GaXJzdE1lc3NhZ2UuQXV0aG9yLkF2YXRhclVybCwgNDAsIDQwLCAiJXtib3JkZXI9JzAnLCBhbHQ9JGNvbnZlcnNhdGlvbi5GaXJzdE1lc3NhZ2UuQXV0aG9yLkRpc3BsYXlOYW1lLCBSZXNpemVNZXRob2Q9J1pvb21BbmRDcm9wJyxib3JkZXI9JzAnfSIpCgkJCQkjZW5kCgkJCTwvZGl2PgoJCQk8ZGl2IGNsYXNzPSJkZXRhaWxzIj4KCQkJCTxkaXYgY2xhc3M9ImRhdGUiPiRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdEFnb0RhdGUoJGNvbnZlcnNhdGlvbi5MYXN0TWVzc2FnZS5DcmVhdGVkRGF0ZSk8L2Rpdj4KCQkJPC9kaXY+CgkJCTxkaXYgY2xhc3M9ImNvbnRlbnQiPgoJCQkJPGEgaHJlZj0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkY29udmVyc2F0aW9uLlVybCkiPiRjb252ZXJzYXRpb24uRmlyc3RNZXNzYWdlLlN1YmplY3Q8L2E+CgkJCQkjc2V0ICgkRFEgPSAnIicpCgkJCQkjc2V0ICgkYXV0aG9ycyA9ICIiKQoJCQkJI2ZvcmVhY2ggKCRwYXJ0aWNpcGFudCBpbiAkY29udmVyc2F0aW9uLlBhcnRpY2lwYW50cykKCQkJCSNiZWZvcmVhbGwKCQkJCQkkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgncGFydGljaXBhbnRzX2JlZm9yZScpCgkJCQkjZWFjaAoJCQkJCSNzZXQgKCRhdXRob3JzID0gIiRhdXRob3JzPGEgaHJlZj0ke0RRfSRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJHBhcnRpY2lwYW50LlByb2ZpbGVVcmwpJHtEUX0+JHBhcnRpY2lwYW50LkRpc3BsYXlOYW1lPC9hPiIpCgkJCQkjYmV0d2VlbgoJCQkJCSNzZXQgKCRhdXRob3JzID0gIiRhdXRob3JzLCAiKQoJCQkJI2VuZAoJCQkJJGF1dGhvcnMKCQkJPC9kaXY+CgkJCTxkaXYgY2xhc3M9ImFjdGlvbnMgdWktbGlua3MiPgoJCQkJPHVsPgoJCQkJCTxsaT4KCQkJCQkJPHNwYW4gY2xhc3M9ImRldGFpbCBjb21tZW50Ij4KCQkJCQkJCSNpZiAoJGNvbnZlcnNhdGlvbi5NZXNzYWdlQ291bnQgPT0gMCkKCQkJCQkJCQkkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbm9fbWVzc2FnZXMnKQoJCQkJCQkJI2Vsc2VpZiAoJGNvbnZlcnNhdGlvbi5NZXNzYWdlQ291bnQgPT0gMSkKCQkJCQkJCQkkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRTdHJpbmcoJGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ21lc3NhZ2VfY291bnQnKSwgJGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0TnVtYmVyKCRjb252ZXJzYXRpb24uTWVzc2FnZUNvdW50KSkKCQkJCQkJCSNlbHNlCgkJCQkJCQkJJGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0U3RyaW5nKCRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdtZXNzYWdlc19jb3VudCcpLCAkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXROdW1iZXIoJGNvbnZlcnNhdGlvbi5NZXNzYWdlQ291bnQpKQoJCQkJCQkJI2VuZAoJCQkJCQk8L3NwYW4+CgkJCQkJPC9saT4KCQkJCTwvdWw+CgkJCTwvZGl2PgoJCTwvZGl2PgoJPC9kaXY+CiNub2RhdGEKCTxkaXYgY2xhc3M9InBvc3QtbGlzdC1pdGVtIGNvbnRlbnQtaXRlbSBjb252ZXJzYXRpb24iPjxkaXYgY2xhc3M9Im1lc3NhZ2Ugbm9yZWNvcmRzIj4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbm9fY29udmVyc2F0aW9ucycpPC9kaXY+PC9kaXY+CiNhZnRlcmFsbAoJI3NldCAoJGhhc01vcmUgPSBmYWxzZSkKCSNpZiAoJGNvbnZlcnNhdGlvbnMuVG90YWxDb3VudCA+ICgoJGNvbnZlcnNhdGlvbnMuUGFnZUluZGV4ICsgMSkgKiAkY29udmVyc2F0aW9ucy5QYWdlU2l6ZSkpCgkJI3NldCgkaGFzTW9yZSA9IHRydWUpCgkjZW5kCgk8ZGl2IGNsYXNzPSJkYXRhIiAjaWYoJGhhc01vcmUpZGF0YS1oYXNtb3JlPSJ0cnVlIiNlbmQ+PC9kaXY+CiNlbmQ=</file>
      <file name="more.vm">IyMKIyMgQWpheCBjYWxsYmFjayBmb3IgbG9hZGluZyBtb3JlIGNvbnZlcnNhdGlvbnMKIyMKI3NldCAoJHBhZ2VJbmRleCA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19wYWdlSW5kZXgnKSkKJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCdsaXN0LnZtJykK</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpewoKCXZhciBhcGkgPSB7CgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCQkJJChvcHRpb25zLndyYXBwZXIpLm9uKCd0YXAnLCAnZGl2LmNvbnZlcnNhdGlvbicsIGZ1bmN0aW9uKGUpewoJCQkJdmFyIG4gPSAkKHRoaXMpOwoJCQkJaWYgKG4uaGFzQ2xhc3MoJ3VucmVhZCcpKSB7CgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7CgkJCQkJCXVybDogJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ2FwaS5hc2h4L3YyL2NvbnZlcnNhdGlvbnMve0NvbnZlcnNhdGlvbklkfS9yZWFkLmpzb24nLAoJCQkJCQlkYXRhOiB7CgkJCQkJCQlDb252ZXJzYXRpb25JZDogbi5kYXRhKCdjb252ZXJzYXRpb25pZCcpLAoJCQkJCQkJSGFzUmVhZDogJ1RydWUnCgkJCQkJCX0sCgkJCQkJCXN1Y2Nlc3M6IGZ1bmN0aW9uKHIpIHsKCQkJCQkJCW4ucmVtb3ZlQ2xhc3MoJ3VucmVhZCcpOwoJCQkJCQkJalF1ZXJ5LnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnB1Ymxpc2goJ25vdGlmaWNhdGlvbi5yZWFkJywgewoJCQkJCQkJCXR5cGVJZDogb3B0aW9ucy5ub3RpZmljYXRpb25UeXBlSWQsCgkJCQkJCQkJdW5yZWFkQ291bnQ6ICctPTEnCgkJCQkJCQl9KTsKCQkJCQkJfQoJCQkJCX0pOwoJCQkJCS8vIGZvcmNlIGEgcmVsb2FkIG9mIHRoaXMgcGFnZSBvbiBuZXh0IHZpZXcgdG8gaW5kaWNhdGUgcmVhZCBzdGF0ZQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuY2xlYXJDb250ZW50KCk7CgkJCQl9CgkJCX0pOwoKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zY3JvbGxhYmxlKHsKCQkJCXJlZ2lvbjogJ2NvbnRlbnQnLAoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgewoJCQkJCWlmICgkKG9wdGlvbnMud3JhcHBlciArICcgZGl2LmRhdGE6bGFzdCcpLmRhdGEoJ2hhc21vcmUnKSkgewoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsKCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLAoJCQkJCQkJZGF0YTogewoJCQkJCQkJCXdfcGFnZUluZGV4OiBwYWdlSW5kZXgKCQkJCQkJCX0sCgkJCQkJCQlzdWNjZXNzOiBmdW5jdGlvbihyKSB7CgkJCQkJCQkJc3VjY2VzcyhyKTsKCQkJCQkJCX0sCgkJCQkJCQllcnJvcjogZnVuY3Rpb24oKSB7CgkJCQkJCQkJZXJyb3IoKTsKCQkJCQkJCX0KCQkJCQkJfSk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJc3VjY2VzcygpOwoJCQkJCX0KCQkJCX0sCgkJCQljb21wbGV0ZTogZnVuY3Rpb24oY29udGVudCkgewoJCQkJCWNvbnRlbnQgPSAkKGNvbnRlbnQpLmNzcyh7IG9wYWNpdHk6IDAgfSk7CgkJCQkJJChvcHRpb25zLndyYXBwZXIpLmZpbmQoJ2Rpdi5wb3N0LWxpc3QnKS5hcHBlbmQoY29udGVudCk7CgkJCQkJY29udGVudC5ldm9sdXRpb25UcmFuc2Zvcm0oeyBvcGFjaXR5OiAxIH0sIHsgZHVyYXRpb246IDQwMCB9KTsKCQkJCX0KCQkJfSk7CgoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnN1YnNjcmliZSgnbm90aWZpY2F0aW9uLnJhaXNlZCcsIGZ1bmN0aW9uKGQpIHsKCQkJCWlmIChkLnR5cGVJZCAhPSBvcHRpb25zLm5vdGlmaWNhdGlvblR5cGVJZCkgewoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUucmVmcmVzaCgpOwoJCQkJfQoJCQl9KTsKCgkJCXZhciBuZXdMaW5rID0gJCgnPGEgaHJlZj0iJyArIG9wdGlvbnMubmV3Q29udmVyc2F0aW9uVXJsICsgJyIgY2xhc3M9ImFkZCI+JyArIG9wdGlvbnMubmV3Q29udmVyc2F0aW9uTGFiZWwgKyAnPC9hPicpOwoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNldEhlYWRlckJ1dHRvbihuZXdMaW5rKTsKCQl9Cgl9CgoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5jb252ZXJzYXRpb25MaXN0ID0gYXBpOwoKfSkoalF1ZXJ5KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:CreateConversation_Name}" version="7.0.0.1" description="" instanceIdentifier="e87b6c2fb05a48718565338e6f5243d2" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="create-conversation">
    <contentScript>
			
#set($userId = false)
#set($userId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('UserId')))
#if (!$userId)
	$core_v2_widget.Hide()
#end

#set($user = false)
#set($user = $core_v2_user.Get("%{Id=$userId}"))
#if ($user &amp;&amp; !$core_v2_urls.AddConversation($userId))
	&lt;div class="message error"&gt;
		$core_v2_language.GetResource('message_not_allowed')
	&lt;/div&gt;
#end

#set ($bodyId = $core_v2_widget.UniqueId('Body'))
#set ($subjectId = $core_v2_widget.UniqueId('Subject'))
#set ($recipientsId = $core_v2_widget.UniqueId('Recipients'))

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('conversations'))"&gt;$core_v2_language.GetResource('conversations')&lt;/a&gt;
		&lt;h1&gt;$core_v2_language.GetResource('create_conversation')&lt;/h1&gt;
	&lt;/div&gt;
&lt;/div&gt;
&lt;fieldset&gt;

	## Participants
	&lt;div class="form-field username lookup"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;$core_v2_language.GetResource('participants')&lt;/label&gt;
		&lt;input type="text" id="$core_v2_encoding.HtmlAttributeEncode($recipientsId)" value="#if ($user)$user.Username#end" /&gt;
	&lt;/div&gt;

	## Subject
	&lt;div class="form-field text"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($subjectId)"&gt;$core_v2_language.GetResource('subject')&lt;/label&gt;
		&lt;input type="text" maxlength="256" id="$core_v2_encoding.HtmlAttributeEncode($subjectId)" /&gt;
	&lt;/div&gt;

	## Body
	&lt;div class="form-field textarea"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;$core_v2_language.GetResource('body')&lt;/label&gt;
		&lt;textarea id="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;&lt;/textarea&gt;
	&lt;/div&gt;
&lt;/fieldset&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.createConversation.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			addConversationUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('add-conversation.vm'))',
			lookupUserUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('lookup-user.vm'))',
			bodyInput: '#$core_v2_encoding.JavascriptEncode($bodyId)',
			recipientInput: '#$core_v2_encoding.JavascriptEncode($recipientsId)',
			subjectInput: '#$core_v2_encoding.JavascriptEncode($subjectId)',
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			selectedUserDisplayName:#if($user) '$core_v2_encoding.JavascriptEncode($user.DisplayName)'#else null#end,
			userLookupLoadingText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('participants_loading'))',
			noUserMatchesText:'$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('participants_nomatch'))'
		});

		jQuery.telligent.evolution.mobile.refreshable(false);
		jQuery.telligent.evolution.mobile.excludeFromHistory();
	});
})
&lt;/script&gt;
		
		</contentScript>
    <languageResources>
		  <language key="en-us">
			<resource name="CreateConversation_Name">Create Conversation</resource>
			<resource name="conversations">Inbox</resource>
			<resource name="subject">Subject</resource>
			<resource name="body">Message</resource>
			<resource name="participants">Send to</resource>
			<resource name="post">Send</resource>
			<resource name="message_not_allowed">The person you attempted to send a message to does not accept messages.</resource>
			<resource name="participants_loading">Finding matching people...</resource>
			<resource name="participants_nomatch">No matches accepting messages could be found</resource>
			<resource name="create_conversation">New private message</resource>
		  </language>
		</languageResources>
    <files>
      <file name="add-conversation.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgdG8gYWRkIGEgY29udmVyc2F0aW9uDQojIw0KDQokY29yZV92Ml9wYWdlLlNldENvbnRlbnRUeXBlKCdhcHBsaWNhdGlvbi9qc29uJykNCg0KI3NldCgkYm9keSA9ICRjb3JlX3YyX3VpLkZvcm1hdFRleHRBc0h0bWwoJGNvcmVfdjJfcGFnZS5HZXRGb3JtVmFsdWUoJ0JvZHknKSwgIiV7Q29udmVydFRvUGFyYWdyYXBocz0ndHJ1ZScsIERldGVjdE1lZGlhVXJscz0ndHJ1ZSd9IikpDQoNCiNzZXQoJHJlc3BvbnNlID0gJGNvcmVfdjJfY29udmVyc2F0aW9uLkNyZWF0ZSgkY29yZV92Ml9wYWdlLkdldEZvcm1WYWx1ZSgnU3ViamVjdCcpLCAkYm9keSwgJGNvcmVfdjJfcGFnZS5HZXRGb3JtVmFsdWUoJ1BhcnRpY2lwYW50cycpKSkNCiNpZiAoJHJlc3BvbnNlLkVycm9ycy5Db3VudCA+IDApDQoJJGNvcmVfdjJfcGFnZS5TZW5kSnNvbkVycm9yKCRyZXNwb25zZS5FcnJvcnMpDQojZWxzZQ0KCXsiY29udmVyc2F0aW9uVXJsIjoiJGNvcmVfdjJfZW5jb2RpbmcuSmF2YXNjcmlwdEVuY29kZSgkcmVzcG9uc2UuVXJsKSJ9DQojZW5k</file>
      <file name="lookup-user.vm">I3NldCgkc2VhcmNoVGV4dCA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19TZWFyY2hUZXh0JykpDQoNCiNzZXQoJGxvd2VyZWRTZWFyY2hUZXh0ID0gIiRjb3JlX3YyX2xhbmd1YWdlLkxvd2VyY2FzZSgkc2VhcmNoVGV4dCkqIikNCiNzZXQoJHF1ZXJ5ID0gJycpDQojc2V0KCR0b2tlbkNvdW50ID0gMCkNCiNmb3JlYWNoKCR0b2tlbiBpbiAkY29yZV92Ml91dGlsaXR5LlNwbGl0KCcgJywgJHNlYXJjaFRleHQpKQ0KCSNpZiAoJHRva2VuICYmICR0b2tlbi5MZW5ndGggPiAwKQ0KCQkjaWYgKCR0b2tlbkNvdW50ID4gMCkNCgkJCSNzZXQoJHF1ZXJ5ID0gIiRxdWVyeSBBTkQgIikNCgkJI2VuZA0KCQkjc2V0KCRxdWVyeSA9ICIke3F1ZXJ5fSR7Y29yZV92Ml9sYW5ndWFnZS5Mb3dlcmNhc2UoJHRva2VuKX0qIikNCgkJI3NldCgkdG9rZW5Db3VudCA9ICR0b2tlbkNvdW50ICsgMSkNCgkjZW5kDQojZW5kDQojaWYgKCR0b2tlbkNvdW50ID4gMSkNCgkjc2V0KCRxdWVyeSA9ICJ1c2VybmFtZTooJHF1ZXJ5KSBPUiB0aXRsZWxvb2t1cDooJHF1ZXJ5KSIpDQojZWxzZQ0KCSNzZXQoJHF1ZXJ5ID0gInVzZXJuYW1lOiRxdWVyeSBPUiB0aXRsZWxvb2t1cDokcXVlcnkiKQ0KI2VuZA0KDQojc2V0KCRtYXRjaGluZ1VzZXJzID0gJGNvcmVfdjJfc2VhcmNoUmVzdWx0Lkxpc3QoIiV7UXVlcnk9JHF1ZXJ5LEZpbHRlcnM9J3R5cGU6OnVzZXInLFBhZ2VTaXplPTEwfSIpKQ0KDQojc2V0KCRleGFjdFVzZXIgPSBmYWxzZSkNCiNzZXQoJGV4YWN0VXNlciA9ICRjb3JlX3YyX3VzZXIuR2V0KCIle1VzZXJuYW1lPSRzZWFyY2hUZXh0fSIpKQ0KDQokY29yZV92Ml9wYWdlLlNldENvbnRlbnRUeXBlKCdhcHBsaWNhdGlvbi9qc29uJykNCg0KI3NldCgkYWNjZXNzaW5nVXNlciA9ICRjb3JlX3YyX3VzZXIuQWNjZXNzaW5nKQ0KDQp7InRvdGFsTWF0Y2hlcyI6JG1hdGNoaW5nVXNlcnMuVG90YWxDb3VudCwNCiAibWF0Y2hlcyI6Ww0KCSNpZiAoJGV4YWN0VXNlciAmJiAkZXhhY3RVc2VyLklkICE9ICRhY2Nlc3NpbmdVc2VyLklkICYmICRjb3JlX3YyX3VybHMuQWRkQ29udmVyc2F0aW9uKCRleGFjdFVzZXIuSWQpKQ0KCQl7InVzZXJOYW1lIjoiJGNvcmVfdjJfZW5jb2RpbmcuSmF2YXNjcmlwdEVuY29kZSgkZXhhY3RVc2VyLlVzZXJuYW1lKSIsInRpdGxlIjoiJGNvcmVfdjJfZW5jb2RpbmcuSmF2YXNjcmlwdEVuY29kZSgkZXhhY3RVc2VyLkRpc3BsYXlOYW1lKSNpZigkZXhhY3RVc2VyLkRpc3BsYXlOYW1lICE9ICRleGFjdFVzZXIuVXNlcm5hbWUpICgkY29yZV92Ml9lbmNvZGluZy5KYXZhc2NyaXB0RW5jb2RlKCRleGFjdFVzZXIuVXNlcm5hbWUpKSNlbmQifSwNCgkjZW5kDQoJI2lmKCRtYXRjaGluZ1VzZXJzKQ0KCQkjZm9yZWFjaCgkbWF0Y2hlZFVzZXIgaW4gJG1hdGNoaW5nVXNlcnMpDQoJCQkjZm9yZWFjaCgkdXNlciBpbiAkbWF0Y2hlZFVzZXIuVXNlcnMpDQoJCQkJI2lmICgkdXNlciAmJiAoISRleGFjdFVzZXIgfHwgJGV4YWN0VXNlci5JZCAhPSAkdXNlci5JZCkgJiYgJHVzZXIuSWQgIT0gJGFjY2Vzc2luZ1VzZXIuSWQgJiYgJGNvcmVfdjJfdXJscy5BZGRDb252ZXJzYXRpb24oJHVzZXIuSWQpKQ0KCQkJCQl7InVzZXJOYW1lIjoiJGNvcmVfdjJfZW5jb2RpbmcuSmF2YXNjcmlwdEVuY29kZSgkdXNlci5Vc2VybmFtZSkiLCJ0aXRsZSI6IiRjb3JlX3YyX2VuY29kaW5nLkphdmFzY3JpcHRFbmNvZGUoJHVzZXIuRGlzcGxheU5hbWUpI2lmKCR1c2VyLkRpc3BsYXlOYW1lICE9ICR1c2VyLlVzZXJuYW1lKSAoJGNvcmVfdjJfZW5jb2RpbmcuSmF2YXNjcmlwdEVuY29kZSgkdXNlci5Vc2VybmFtZSkpI2VuZCJ9LA0KCQkJCSNlbmQNCgkJCSNlbmQNCgkJI2VuZA0KCSNlbmQNCm51bGxdfQ==</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCwgdW5kZWYpewoKCXZhciBtb2RlbCA9IHsKCQlhZGRDb252ZXJzYXRpb246IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCQkJdmFyIGRhdGEgPSB7CgkJCQlQYXJ0aWNpcGFudHM6IG9wdGlvbnMucGFydGljaXBhbnRzLAoJCQkJQm9keTogb3B0aW9ucy5ib2R5LAoJCQkJU3ViamVjdDogb3B0aW9ucy5zdWJqZWN0CgkJCX07CgoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnBvc3QoewoJCQkJdXJsOiBvcHRpb25zLmFkZENvbnZlcnNhdGlvblVybCwKCQkJCWRhdGE6IGRhdGEKCQkJfSk7CgkJfQoJfQoKCXZhciBhcGkgPSB7CgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCQkJdmFyIHN1YmplY3RJbnB1dCA9ICQob3B0aW9ucy5zdWJqZWN0SW5wdXQpLAoJCQkJYm9keUlucHV0ID0gJChvcHRpb25zLmJvZHlJbnB1dCksCgkJCQlwYXJ0aWNpcGFudHMgPSAkKG9wdGlvbnMucmVjaXBpZW50SW5wdXQpLAoJCQkJcG9zdExpbmsgPSAkKCc8YSBocmVmPSIjIiBjbGFzcz0ic3VibWl0Ij4nICsgb3B0aW9ucy5wb3N0TGFiZWwgKyAnPC9hPicpLAoJCQkJZm9ybWF0U3VnZ2VzdGlvbiA9IGZ1bmN0aW9uKHRleHQpIHsKCQkJCQlyZXR1cm4gJzxkaXYgc3R5bGU9InBhZGRpbmc6IDRweCAwOyI+JyArIHRleHQgKyAiPC9kaXY+IjsKCQkJCX07CgoJCQlwb3N0TGluay5vbigndGFwJywgZnVuY3Rpb24oKXsKCQkJCXZhciBib2R5ID0gJC50cmltKGJvZHlJbnB1dC52YWwoKSksCgkJCQkJc3ViamVjdCA9ICQudHJpbShzdWJqZWN0SW5wdXQudmFsKCkpLAoJCQkJCXVzZXJMaXN0ID0gJyc7CgoJCQkJZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJ0aWNpcGFudHMuZ2xvd0xvb2tVcFRleHRCb3goJ2NvdW50Jyk7IGkrKykgewoJCQkJCWlmICh1c2VyTGlzdC5sZW5ndGggPiAwKSB7CgkJCQkJCXVzZXJMaXN0ICs9ICcsJzsKCQkJCQl9CgkJCQkJdXNlckxpc3QgKz0gcGFydGljaXBhbnRzLmdsb3dMb29rVXBUZXh0Qm94KCdnZXRCeUluZGV4JywgaSkuVmFsdWU7CgkJCQl9CgoJCQkJaWYoYm9keS5sZW5ndGggPiAwICYmIHN1YmplY3QubGVuZ3RoID4gMCAmJiB1c2VyTGlzdC5sZW5ndGggPiAwKSB7CgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZyhtb2RlbC5hZGRDb252ZXJzYXRpb24oewoJCQkJCQlhZGRDb252ZXJzYXRpb25Vcmw6IG9wdGlvbnMuYWRkQ29udmVyc2F0aW9uVXJsLAoJCQkJCQlzdWJqZWN0OiBzdWJqZWN0LAoJCQkJCQlib2R5OiBib2R5LAoJCQkJCQlwYXJ0aWNpcGFudHM6IHVzZXJMaXN0CgkJCQkJfSkpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpewoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmxvYWQocmVzcG9uc2UuY29udmVyc2F0aW9uVXJsLCB7IHJlZnJlc2g6IHRydWUgfSk7CgkJCQkJfSk7CgkJCQl9CgkJCX0pOwoKCQkJcGFydGljaXBhbnRzLmdsb3dMb29rVXBUZXh0Qm94KHsKCQkJICAgIGVtcHR5SHRtbDogJycsCgkJCSAgICBtYXhWYWx1ZXM6IDIwLAoJCQkgICAgb25HZXRMb29rVXBzOiBmdW5jdGlvbiAodGIsIHNlYXJjaFRleHQpIHsKCQkJICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KG9wdGlvbnMubG9va3VwVGltZW91dCk7CgkJCSAgICAgICAgaWYgKHNlYXJjaFRleHQgJiYgc2VhcmNoVGV4dC5sZW5ndGggPj0gMikgewoJCQkgICAgICAgICAgICB0Yi5nbG93TG9va1VwVGV4dEJveCgndXBkYXRlU3VnZ2VzdGlvbnMnLCBbdGIuZ2xvd0xvb2tVcFRleHRCb3goJ2NyZWF0ZUxvb2tVcCcsICcnLCBvcHRpb25zLnVzZXJMb29rdXBMb2FkaW5nVGV4dCwgZm9ybWF0U3VnZ2VzdGlvbihvcHRpb25zLnVzZXJMb29rdXBMb2FkaW5nVGV4dCksIGZhbHNlKV0pOwoJCQkgICAgICAgICAgICBvcHRpb25zLmxvb2t1cFRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CgkJCSAgICAgICAgICAgICAgICAkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsKCQkJICAgICAgICAgICAgICAgICAgICB1cmw6IG9wdGlvbnMubG9va3VwVXNlclVybCwKCQkJICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IHdfU2VhcmNoVGV4dDogc2VhcmNoVGV4dCB9LAoJCQkgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXNwb25zZSkgewoJCQkgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2UubWF0Y2hlcy5sZW5ndGggPiAxKSB7CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VnZ2VzdGlvbnMgPSBbXTsKCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzcG9uc2UubWF0Y2hlcy5sZW5ndGggLSAxOyBpKyspIHsKCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IHJlc3BvbnNlLm1hdGNoZXNbaV07CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnNbc3VnZ2VzdGlvbnMubGVuZ3RoXSA9IHRiLmdsb3dMb29rVXBUZXh0Qm94KCdjcmVhdGVMb29rVXAnLCBpdGVtLnVzZXJOYW1lLCBpdGVtLnRpdGxlLCBmb3JtYXRTdWdnZXN0aW9uKGl0ZW0udGl0bGUpLCB0cnVlKTsKCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Yi5nbG93TG9va1VwVGV4dEJveCgndXBkYXRlU3VnZ2VzdGlvbnMnLCBzdWdnZXN0aW9ucyk7CgkJCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCQkJICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGIuZ2xvd0xvb2tVcFRleHRCb3goJ3VwZGF0ZVN1Z2dlc3Rpb25zJywgW3RiLmdsb3dMb29rVXBUZXh0Qm94KCdjcmVhdGVMb29rVXAnLCAnJywgb3B0aW9ucy5ub1VzZXJNYXRjaGVzVGV4dCwgZm9ybWF0U3VnZ2VzdGlvbihvcHRpb25zLm5vVXNlck1hdGNoZXNUZXh0KSwgZmFsc2UpXSk7CgkJCSAgICAgICAgICAgICAgICAgICAgfQoJCQkgICAgICAgICAgICAgICAgfSk7CgkJCSAgICAgICAgICAgIH0sIDc0OSk7CgkJCSAgICAgICAgfQoJCQkgICAgfSwKCQkJICAgIHNlbGVjdGVkTG9va1Vwc0h0bWw6IG9wdGlvbnMuc2VsZWN0ZWRVc2VyRGlzcGxheU5hbWUgPyBbb3B0aW9ucy5zZWxlY3RlZFVzZXJEaXNwbGF5TmFtZV0gOiBbXSwKCQkJICAgIGxvb2tVcFBvcFVwSGVpZ2h0OiA3NQoJCQl9KTsKCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2V0SGVhZGVyQnV0dG9uKHBvc3RMaW5rKTsKCQl9Cgl9CgoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5jcmVhdGVDb252ZXJzYXRpb24gPSBhcGk7Cgp9KShqUXVlcnksIHdpbmRvdyk7</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:CreateEditBlogPost_Name}" version="7.0.0.1" description="" instanceIdentifier="48d3b46f0c164d9eb36ef4ab8dabaa2f" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="create-edit-blog-post">
    <contentScript>
			
#set ($pageName = $mobile_v1_url.Current)
#set ($contentTypeId = $core_v2_blogPost.ContentTypeId)

#set ($title = "")
#set ($body = "")

#set ($blogId = false)
#set ($blogPostId = false)
#set ($blogPost = false)



#if ($pageName == 'blog-addblogpost')

	#set($blogId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('BlogId')))

#elseif($pageName == 'blogpost-edit')


	#set($blogPostId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('BlogPostId')))

	#set ($blogPost = $core_v2_blogPost.Get("%{Id=$blogPostId}"))
	#if (!$blogPost)
		$core_v2_widget.Hide()
	#end

	#set($blogId = $blogPost.BlogId)
	#set($title = $blogPost.Title)
	#set($body = $blogPost.Body('raw'))

#end

#if (!$blogId)
	$core_v2_widget.Hide()
#end

#set ($blog = false)
#set ($blog = $core_v2_blog.Get("%{Id= $blogId}"))

#if (!$blog)
	$core_v2_widget.Hide()
#end



#set ($bodyId = $core_v2_widget.UniqueId('PostBody'))
#set ($titleId = $core_v2_widget.UniqueId('Title'))

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($blog.Group.Url)"&gt;$blog.Group.Name&lt;/a&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($blog.Url)"&gt;$blog.Name&lt;/a&gt;
		&lt;h1&gt;
			#if ($blogPost)
				$blogPost.Title
			#else
				$core_v2_language.GetResource('new_post')
			#end
		&lt;/h1&gt;
	&lt;/div&gt;
&lt;/div&gt;
&lt;fieldset&gt;

	&lt;div class="form-field text"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($subjectId)"&gt;$core_v2_language.GetResource('title')&lt;/label&gt;
		&lt;input type="text" maxlength="256" id="$core_v2_encoding.HtmlAttributeEncode($titleId)" value="$!core_v2_encoding.HtmlAttributeEncode($title)" /&gt;
	&lt;/div&gt;

	&lt;div class="form-field editor"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;$core_v2_language.GetResource('body')&lt;/label&gt;
		$core_v2_editor.Render('PostBody', "%{Width='100%', Height='60px', Value=$body, ContentTypeId=$contentTypeId}")
	&lt;/div&gt;

&lt;/fieldset&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
	jQuery.telligent.evolution.widgets.createEditBlogPost.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			blogId: $blogId,
			blogPostId: #if ($blogPost) $blogPost.Id #else null #end,
			getBodyContent: function() { return $core_v2_editor.GetContentScript('PostBody') },
			titleInput: '#$core_v2_encoding.JavascriptEncode($titleId)',
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			editLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('edit'))'
		});

		jQuery.telligent.evolution.mobile.refreshable(false);
		jQuery.telligent.evolution.mobile.excludeFromHistory();
	});
})
&lt;/script&gt;
		
		</contentScript>
    <languageResources>
		  <language key="en-us">
			<resource name="CreateEditBlogPost_Name">Create Edit Blog Post</resource>
			<resource name="title">Title</resource>
			<resource name="body">Description</resource>
			<resource name="post">Post</resource>
			<resource name="edit">Edit</resource>
			<resource name="new_post">New post</resource>
		  </language>
		</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCwgdW5kZWYpewoKCXZhciBtb2RlbCA9IHsKCQlhZGRCbG9nUG9zdDogZnVuY3Rpb24oZGF0YSkgewoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNob3dMb2FkaW5nKCk7CgkJCXZhciBhZGRCbG9nUG9zdFByb21pc2UgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ucG9zdCh7CgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi9ibG9ncy97QmxvZ0lkfS9wb3N0cy5qc29uJywKCQkJCWRhdGE6IGRhdGEKCQkJfSkuZmFpbChmdW5jdGlvbigpewoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlTG9hZGluZygpOwoJCQl9KTsKCQkJcmV0dXJuIGFkZEJsb2dQb3N0UHJvbWlzZTsKCQl9LAoJCWVkaXRCbG9nUG9zdDogZnVuY3Rpb24oZGF0YSkgewoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNob3dMb2FkaW5nKCk7CgkJCXZhciBlZGl0QmxvZ1Bvc3RQcm9taXNlID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7CgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi9ibG9ncy97QmxvZ0lkfS9wb3N0cy97QmxvZ1Bvc3RJZH0uanNvbicsCgkJCQlkYXRhOiBkYXRhCgkJCX0pLmZhaWwoZnVuY3Rpb24oKXsKCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuaGlkZUxvYWRpbmcoKTsKCQkJfSk7CgkJCXJldHVybiBlZGl0QmxvZ1Bvc3RQcm9taXNlOwoJCX0KCX0KCgl2YXIgYXBpID0gewoJCXJlZ2lzdGVyOiBmdW5jdGlvbihvcHRpb25zKSB7CgkJCXZhciBwb3N0TGluayA9ICQoJzxhIGhyZWY9IiMiIGNsYXNzPSJzdWJtaXQiPicgKyAoIW9wdGlvbnMuYmxvZ1Bvc3RJZCA/IG9wdGlvbnMucG9zdExhYmVsIDogb3B0aW9ucy5lZGl0TGFiZWwpICsgJzwvYT4nKTsKCgkJCXBvc3RMaW5rLm9uKCd0YXAnLCBmdW5jdGlvbigpewoKCQkJCXZhciBkYXRhID0gewoJCQkJCUJvZHk6ICQudHJpbShvcHRpb25zLmdldEJvZHlDb250ZW50KCkpLAoJCQkJCVRpdGxlOiAkLnRyaW0oJChvcHRpb25zLnRpdGxlSW5wdXQpLnZhbCgpKSwKCQkJCQlCbG9nSWQ6IG9wdGlvbnMuYmxvZ0lkLAoJCQkJCUJsb2dQb3N0SWQ6IG9wdGlvbnMuYmxvZ1Bvc3RJZAoJCQkJfQoKCQkJCWlmKGRhdGEuQm9keS5sZW5ndGggPiAwICYmIGRhdGEuVGl0bGUubGVuZ3RoID4gMCkgewoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoKCFvcHRpb25zLmJsb2dQb3N0SWQgPyBtb2RlbC5hZGRCbG9nUG9zdChkYXRhKSA6IG1vZGVsLmVkaXRCbG9nUG9zdChkYXRhKSkpCgkJCQkJCS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXsKCQkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUubG9hZChyZXNwb25zZS5CbG9nUG9zdC5VcmwsIHsgcmVmcmVzaDogdHJ1ZSB9KTsKCQkJCQkJfSk7CgkJCQl9CgkJCX0pOwoKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zZXRIZWFkZXJCdXR0b24ocG9zdExpbmspOwoJCX0KCX0KCgkkLnRlbGxpZ2VudCA9ICQudGVsbGlnZW50IHx8IHt9OwoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9OwoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzLmNyZWF0ZUVkaXRCbG9nUG9zdCA9IGFwaTsKCn0pKGpRdWVyeSwgd2luZG93KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:CreateEditForumReply_Name}" version="7.0.0.1" description="" instanceIdentifier="df209287ea8d4eccaf8cbb08a568c8f9" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="create-edit-forum-reply">
    <contentScript>
			
#set ($pageName = $mobile_v1_url.Current)
#set ($mode = false)
#set ($contentTypeId = $core_v2_forumThread.ContentTypeId)

#set ($forumThread = false)
#set ($forumThreadId = false)
#set ($forumThreadId = $mobile_v1_urlToken.Value('ForumThreadId'))
#if ($forumThreadId)
	#set ($forumThreadId = $core_v2_utility.ParseInt($forumThreadId))
#end

#set ($forumReply = false)
#set ($forumReplyId = false)
#set ($forumReplyId = $mobile_v1_urlToken.Value('ForumReplyId'))
#if ($forumReplyId)
	#set ($forumReplyId = $core_v2_utility.ParseInt($forumReplyId))
#end

#if ($pageName == 'forumthread-addreply' || $pageName == 'forumreply-addreply')
	#set ($mode = 'add')
	#if (!$forumReplyId &amp;&amp; !$forumThreadId)
		$core_v2_widget.Hide()
	#end
	#if ($forumReplyId)
		#set ($forumReply = $core_v2_forumReply.Get($forumReplyId))
		#if (!$forumReply)
			$core_v2_widget.Hide()
		#end
		#set ($forumThread = $core_v2_forumThread.Get($forumReply.ThreadId))
		#set($forum = $core_v2_forum.Get($forumReply.ForumId))
	#elseif ($forumThreadId)
		#set ($forumThread = $core_v2_forumThread.Get($forumThreadId))
		#if (!$forumThread)
			$core_v2_widget.Hide()
		#end
		#set($forum = $core_v2_forum.Get($forumThread.ForumId))
	#end
#elseif($pageName == 'forumreply-edit')
	#set ($mode = 'edit')
	#if (!$forumReplyId)
		$core_v2_widget.Hide()
	#end
	#set ($forumReply = $core_v2_forumReply.Get($forumReplyId))
	#if (!$forumReply)
		$core_v2_widget.Hide()
	#end
	#set ($forumThread = $core_v2_forumThread.Get($forumReply.ThreadId))
	#set($forum = $core_v2_forum.Get($forumReply.ForumId))
#end

#set ($bodyId = $core_v2_widget.UniqueId('Body'))
#set ($suggestAnswerId = $core_v2_widget.UniqueId('SuggestAnswer'))
#set ($subscribeId = $core_v2_widget.UniqueId('Subscribe'))

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($forum.Group.Url)"&gt;$forum.Group.Name&lt;/a&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($forum.Url)"&gt;$forum.Name&lt;/a&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($forumThread.Url)"&gt;$forumThread.Subject&lt;/a&gt;
		#if ($mode == 'add')
			&lt;h1&gt;$core_v2_language.GetResource('add_reply')&lt;/h1&gt;
		#else
			&lt;h1&gt;$core_v2_language.GetResource('edit_reply')&lt;/h1&gt;
		#end
	&lt;/div&gt;
&lt;/div&gt;
&lt;fieldset&gt;
	## Body
	&lt;div class="form-field editor"&gt;
		#set ($body = '')
		#if ($forumReply &amp;&amp; $mode == 'edit')
			#set ($body = $forumReply.Body('raw'))
		#end
		$core_v2_editor.Render('PostBody', "%{Width='100%', Height='60px', Value=$body, ContentTypeId=$contentTypeId}")
	&lt;/div&gt;

	## Suggest as answer
	#set($replyToThread = false)
	#if($forumReply)
		#set($replyToThread = $core_v2_forumThread.Get($forumReply.ThreadId))
	#else
		#set($replyToThread = $forumThread)
	#end
	#if($replyToThread &amp;&amp; $replyToThread.ThreadType == 'QuestionAndAnswer')
		&lt;div class="form-field checkbox inline-label"&gt;
			&lt;label for="$core_v2_encoding.HtmlAttributeEncode($suggestAnswerId)"&gt;$core_v2_language.GetResource('suggest_answer')&lt;/label&gt;
			&lt;input id="$core_v2_encoding.HtmlAttributeEncode($suggestAnswerId)" type="checkbox" #if ($threadOrReply &amp;&amp; $threadOrReply.IsSuggestedAnswer) checked="checked" #end /&gt;
		&lt;/div&gt;
	#end

	## Email Replies
	#if ($mode == "add" &amp;&amp; $core_v2_user.IsRegistered($core_v2_user.Accessing.Id))
		&lt;div class="form-field checkbox inline-label"&gt;
			&lt;label for="$core_v2_encoding.HtmlAttributeEncode($subscribeId)"&gt;$core_v2_language.GetResource('subscribe')&lt;/label&gt;
			&lt;input id="$core_v2_encoding.HtmlAttributeEncode($subscribeId)" type="checkbox" checked/&gt;
		&lt;/div&gt;
	#end
&lt;/fieldset&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.createEditForumReply.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			forumId: $replyToThread.ForumId,
			forumThreadId: #if ($replyToThread) $replyToThread.Id #else null #end,
			forumReplyId: #if ($forumReplyId) $forumReplyId	#else null #end,
			mode: '$core_v2_encoding.JavascriptEncode($mode)',
			getBodyContent: function() { return $core_v2_editor.GetContentScript('PostBody') },
			suggestAsAnswerInput: '#$core_v2_encoding.JavascriptEncode($suggestAnswerId)',
			subscribeInput: '#$core_v2_encoding.JavascriptEncode($subscribeId)',
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			editLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('edit'))'
		});

		jQuery.telligent.evolution.mobile.refreshable(false);
		jQuery.telligent.evolution.mobile.excludeFromHistory();
	});
})
&lt;/script&gt;
		
		</contentScript>
    <headerScript>
			Placeholder
		</headerScript>
    <languageResources>
		  <language key="en-us">
			<resource name="CreateEditForumReply_Name">Create Edit Forum Reply</resource>
			<resource name="reply">Reply...</resource>
			<resource name="suggest_answer">Suggest as answer</resource>
			<resource name="subscribe">Notify me about replies</resource>
			<resource name="post">Reply</resource>
			<resource name="edit">Edit</resource>
			<resource name="add_reply">Reply</resource>
			<resource name="edit_reply">Edit reply</resource>
		  </language>
		</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCwgdW5kZWYpewoKCXZhciBtb2RlbCA9IHsKCQlhZGRSZXBseTogZnVuY3Rpb24ob3B0aW9ucykgewoJCQl2YXIgZGF0YSA9IHsKCQkJCVRocmVhZElkOiBvcHRpb25zLnRocmVhZElkLAoJCQkJQm9keTogb3B0aW9ucy5ib2R5CgkJCX07CgoJCQlpZihvcHRpb25zLnBhcmVudFJlcGx5SWQpCgkJCQlkYXRhLlBhcmVudFJlcGx5SWQgPSBvcHRpb25zLnBhcmVudFJlcGx5SWQ7CgkJCWlmKG9wdGlvbnMuc3Vic2NyaWJlVG9UaHJlYWQgIT0gdW5kZWYgJiYgb3B0aW9ucy5zdWJzY3JpYmVUb1RocmVhZCAhPSBudWxsKQoJCQkJZGF0YS5TdWJzY3JpYmVUb1RocmVhZCA9IG9wdGlvbnMuc3Vic2NyaWJlVG9UaHJlYWQ7CgkJCWlmKG9wdGlvbnMuaXNTdWdnZXN0ZWRBbnN3ZXIgIT0gdW5kZWYgJiYgb3B0aW9ucy5pc1N1Z2dlc3RlZEFuc3dlciAhPSBudWxsKQoJCQkJZGF0YS5Jc1N1Z2dlc3RlZEFuc3dlciA9IG9wdGlvbnMuaXNTdWdnZXN0ZWRBbnN3ZXI7CgoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnBvc3QoewoJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvZm9ydW1zL3RocmVhZHMve1RocmVhZElkfS9yZXBsaWVzLmpzb24nLAoJCQkJZGF0YTogZGF0YQoJCQl9KTsKCQl9LAoJCWVkaXRSZXBseTogZnVuY3Rpb24ob3B0aW9ucykgewoJCQl2YXIgZGF0YSA9IHsKCQkJCUZvcnVtSWQ6IG9wdGlvbnMuZm9ydW1JZCwKCQkJCVRocmVhZElkOiBvcHRpb25zLnRocmVhZElkLAoJCQkJUmVwbHlJZDogb3B0aW9ucy5yZXBseUlkLAoJCQkJQm9keTogb3B0aW9ucy5ib2R5CgkJCX07CgoJCQlpZihvcHRpb25zLnN1YnNjcmliZVRvVGhyZWFkICE9IHVuZGVmICYmIG9wdGlvbnMuc3Vic2NyaWJlVG9UaHJlYWQgIT0gbnVsbCkKCQkJCWRhdGEuU3Vic2NyaWJlVG9UaHJlYWQgPSBvcHRpb25zLnN1YnNjcmliZVRvVGhyZWFkOwoJCQlpZihvcHRpb25zLmlzU3VnZ2VzdGVkQW5zd2VyICE9IHVuZGVmICYmIG9wdGlvbnMuaXNTdWdnZXN0ZWRBbnN3ZXIgIT0gbnVsbCkKCQkJCWRhdGEuSXNTdWdnZXN0ZWRBbnN3ZXIgPSBvcHRpb25zLmlzU3VnZ2VzdGVkQW5zd2VyOwoKCQkJcmV0dXJuICQudGVsbGlnZW50LmV2b2x1dGlvbi5wdXQoewoJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvZm9ydW1zL3tGb3J1bUlkfS90aHJlYWRzL3tUaHJlYWRJZH0vcmVwbGllcy97UmVwbHlJZH0uanNvbicsCgkJCQlkYXRhOiBkYXRhCgkJCX0pOwoJCX0KCX0KCgl2YXIgYXBpID0gewoJCXJlZ2lzdGVyOiBmdW5jdGlvbihvcHRpb25zKSB7CgoJCQl2YXIgc3VnZ2VzdEFzQW5zd2VySW5wdXQgPSAkKG9wdGlvbnMuc3VnZ2VzdEFzQW5zd2VySW5wdXQpLAoJCQkJc3Vic2NyaWJlSW5wdXQgPSAkKG9wdGlvbnMuc3Vic2NyaWJlSW5wdXQpLAoJCQkJcG9zdExpbmsgPSAkKCc8YSBocmVmPSIjIiBjbGFzcz0ic3VibWl0Ij4nICsgKG9wdGlvbnMubW9kZSA9PSAnYWRkJyA/IG9wdGlvbnMucG9zdExhYmVsIDogb3B0aW9ucy5lZGl0TGFiZWwpICsgJzwvYT4nKTsKCgkJCXBvc3RMaW5rLm9uKCd0YXAnLCBmdW5jdGlvbigpewoJCQkJdmFyIGJvZHkgPSAkLnRyaW0ob3B0aW9ucy5nZXRCb2R5Q29udGVudCgpKSwKCQkJCQlzdWJtaXRBY3Rpb247CgoJCQkJaWYoYm9keS5sZW5ndGggPiAwKSB7CgoJCQkJCWlmKG9wdGlvbnMubW9kZSA9PSAnYWRkJykgewoJCQkJCQlzdWJtaXRBY3Rpb24gPSBtb2RlbC5hZGRSZXBseSh7CgkJCQkJCQl0aHJlYWRJZDogb3B0aW9ucy5mb3J1bVRocmVhZElkLAoJCQkJCQkJcGFyZW50UmVwbHlJZDogb3B0aW9ucy5mb3J1bVJlcGx5SWQsCgkJCQkJCQlib2R5OiBib2R5LAoJCQkJCQkJaXNTdWdnZXN0ZWRBbnN3ZXI6IHN1Z2dlc3RBc0Fuc3dlcklucHV0Lmxlbmd0aCA9PSAwID8gbnVsbCA6IHN1Z2dlc3RBc0Fuc3dlcklucHV0LmlzKCc6Y2hlY2tlZCcpLAoJCQkJCQkJc3Vic2NyaWJlVG9UaHJlYWQ6IHN1YnNjcmliZUlucHV0Lmxlbmd0aCA9PSAwID8gbnVsbCA6IHN1YnNjcmliZUlucHV0LmlzKCc6Y2hlY2tlZCcpCgkJCQkJCX0pOwoJCQkJCX0gZWxzZSBpZihvcHRpb25zLm1vZGUgPT0gJ2VkaXQnKSB7CgkJCQkJCXN1Ym1pdEFjdGlvbiA9IG1vZGVsLmVkaXRSZXBseSh7CgkJCQkJCQlmb3J1bUlkOiBvcHRpb25zLmZvcnVtSWQsCgkJCQkJCQl0aHJlYWRJZDogb3B0aW9ucy5mb3J1bVRocmVhZElkLAoJCQkJCQkJcmVwbHlJZDogb3B0aW9ucy5mb3J1bVJlcGx5SWQsCgkJCQkJCQlib2R5OiBib2R5LAoJCQkJCQkJaXNTdWdnZXN0ZWRBbnN3ZXI6IHN1Z2dlc3RBc0Fuc3dlcklucHV0Lmxlbmd0aCA9PSAwID8gbnVsbCA6IHN1Z2dlc3RBc0Fuc3dlcklucHV0LmlzKCc6Y2hlY2tlZCcpLAoJCQkJCQkJc3Vic2NyaWJlVG9UaHJlYWQ6IHN1YnNjcmliZUlucHV0Lmxlbmd0aCA9PSAwID8gbnVsbCA6IHN1YnNjcmliZUlucHV0LmlzKCc6Y2hlY2tlZCcpCgkJCQkJCX0pOwoJCQkJCX0KCgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygpOwoJCQkJCXN1Ym1pdEFjdGlvbi5kb25lKGZ1bmN0aW9uKHJlc3BvbnNlKXsKCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5sb2FkKHJlc3BvbnNlLlJlcGx5LlVybCwgeyByZWZyZXNoOiB0cnVlIH0pOwoJCQkJCX0pLmZhaWwoZnVuY3Rpb24oKXsKCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlTG9hZGluZygpOwoJCQkJCX0pCgkJCQl9CgkJCX0pOwoKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zZXRIZWFkZXJCdXR0b24ocG9zdExpbmspOwoJCX0KCX0KCgkkLnRlbGxpZ2VudCA9ICQudGVsbGlnZW50IHx8IHt9OwoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9OwoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzLmNyZWF0ZUVkaXRGb3J1bVJlcGx5ID0gYXBpOwoKfSkoalF1ZXJ5LCB3aW5kb3cpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:CreateEditForumThread_Name}" version="7.0.0.1" description="" instanceIdentifier="f50a8f2949d2477c9fb18ffa47f64cbf" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="create-edit-forum-thread">
    <contentScript>
			
#set ($pageName = $mobile_v1_url.Current)
#set ($mode = false)
#set ($contentTypeId = $core_v2_forumThread.ContentTypeId)

#set ($forum = false)
#set ($forumId = false)
#set ($forumId = $mobile_v1_urlToken.Value('ForumId'))
#if ($forumId)
	#set ($forumId = $core_v2_utility.ParseInt($forumId))
#end

#set ($forumThread = false)
#set ($forumThreadId = false)
#set ($forumThreadId = $mobile_v1_urlToken.Value('ForumThreadId'))
#if ($forumThreadId)
	#set ($forumThreadId = $core_v2_utility.ParseInt($forumThreadId))
#end

#if ($pageName == 'forum-addthread')
	#set ($mode = 'add')
	#if (!$forumId)
		$core_v2_widget.Hide()
	#end
	#set ($forum = $core_v2_forum.Get($forumId))
	#if (!$forum)
		$core_v2_widget.Hide()
	#end
#elseif($pageName == 'forumthread-edit')
	#set ($mode = 'edit')
	#if (!$forumThreadId)
		$core_v2_widget.Hide()
	#end
	#set ($forumThread = $core_v2_forumThread.Get($forumThreadId))
	#if (!$forumThread)
		$core_v2_widget.Hide()
	#end
	#set ($forum = $core_v2_forum.Get($forumThread.ForumId))
	#if (!$forum)
		$core_v2_widget.Hide()
	#end
#end

#set ($bodyId = $core_v2_widget.UniqueId('PostBody'))
#set ($subjectId = $core_v2_widget.UniqueId('Subject'))
#set ($threadTypeId = $core_v2_widget.UniqueId('ThreadType'))
#set ($subscribeId = $core_v2_widget.UniqueId('Subscribe'))

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($forum.Group.Url)"&gt;$forum.Group.Name&lt;/a&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($forum.Url)"&gt;$forum.Name&lt;/a&gt;
		#if ($mode == 'add')
			#if ($forum.AllowedThreadTypes.Count &gt; 1)
				&lt;h1&gt;$core_v2_language.GetResource('NewQuestionOrDiscussion')&lt;/h1&gt;
			#elseif ($forum.AllowedThreadTypes.get_Item(0) == 'QuestionAndAnswer')
				&lt;h1&gt;$core_v2_language.GetResource('NewQuestion')&lt;/h1&gt;
			#else
				&lt;h1&gt;$core_v2_language.GetResource('NewDiscussion')&lt;/h1&gt;
			#end
		#else
			&lt;h1&gt;$forumThread.Subject&lt;/h1&gt;
		#end
	&lt;/div&gt;
&lt;/div&gt;


&lt;fieldset&gt;

	## Thread Type
	#if ($core_v2_forumConfiguration.EnableThreadStatus &amp;&amp; $forum.AllowedThreadTypes.Count &gt; 1)
		#set($threadType = $forum.DefaultThreadType)
		#set($threadType = $forumThread.ThreadType)
		&lt;div class="form-field select"&gt;
			&lt;select id="$core_v2_encoding.HtmlAttributeEncode($threadTypeId)"&gt;
				&lt;option value="QuestionAndAnswer" #if($threadType == 'QuestionAndAnswer') selected="selected"#end&gt;$core_v2_language.GetResource('threadType_QA')&lt;/option&gt;
				&lt;option value="Discussion" #if($threadType == 'Discussion') selected="selected"#end&gt;$core_v2_language.GetResource('threadType_Discussion')&lt;/option&gt;
			&lt;/select&gt;
		&lt;/div&gt;
	#end

	## Subject
	&lt;div class="form-field text"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($subjectId)"&gt;$core_v2_language.GetResource('subject')&lt;/label&gt;
		&lt;input type="text" maxlength="256" id="$core_v2_encoding.HtmlAttributeEncode($subjectId)" value="#if($forumThread)$!core_v2_encoding.HtmlAttributeEncode($forumThread.Subject)#end" /&gt;
	&lt;/div&gt;

	## Body
	&lt;div class="form-field editor"&gt;
		#set ($body = '')
		#if ($forumThread &amp;&amp; $mode == 'edit')
			#set ($body = $forumThread.Body('raw'))
		#end
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;$core_v2_language.GetResource('body')&lt;/label&gt;
		$core_v2_editor.Render('PostBody', "%{Width='100%', Height='60px', Value=$body, ContentTypeId=$contentTypeId}")
	&lt;/div&gt;

	## Email Replies
	#if ($mode == "add" &amp;&amp; $core_v2_user.IsRegistered($core_v2_user.Accessing.Id))
		&lt;div class="form-field checkbox inline-label"&gt;
			&lt;label for="$core_v2_encoding.HtmlAttributeEncode($subscribeId)"&gt;$core_v2_language.GetResource('subscribe')&lt;/label&gt;
			&lt;input id="$core_v2_encoding.HtmlAttributeEncode($subscribeId)" type="checkbox" checked/&gt;
		&lt;/div&gt;
	#end
&lt;/fieldset&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.createEditForumThread.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			threadUrl: #if ($forumThread) '$core_v2_encoding.JavascriptEncode($forumThread.Url)' #else null #end,
			forumId: $forum.Id,
			forumThreadId: #if ($forumThread) $forumThread.Id #else null #end,
			mode: '$core_v2_encoding.JavascriptEncode($mode)',
			getBodyContent: function() { return $core_v2_editor.GetContentScript('PostBody') },
			subjectInput: '#$core_v2_encoding.JavascriptEncode($subjectId)',
			threadTypeInput: '#$core_v2_encoding.JavascriptEncode($threadTypeId)',
			subscribeInput: '#$core_v2_encoding.JavascriptEncode($subscribeId)',
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			editLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('edit'))'
		});

		jQuery.telligent.evolution.mobile.refreshable(false);
		jQuery.telligent.evolution.mobile.excludeFromHistory();
	});
})
&lt;/script&gt;
		
		</contentScript>
    <languageResources>
		  <language key="en-us">
			<resource name="CreateEditForumThread_Name">Create Edit Forum Thread</resource>
			<resource name="subject">Subject</resource>
			<resource name="body">Description</resource>
			<resource name="threadType">Thread type</resource>
			<resource name="threadType_QA">Question</resource>
			<resource name="threadType_Discussion">Discussion</resource>
			<resource name="subscribe">Notify me about replies</resource>
			<resource name="post">Post</resource>
			<resource name="edit">Edit</resource>
			<resource name="NewQuestionOrDiscussion">Ask a question or start a discussion</resource>
			<resource name="NewQuestion">Ask a question</resource>
			<resource name="NewDiscussion">Start a discussion</resource>
		  </language>
		</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCwgdW5kZWYpewoKCXZhciBtb2RlbCA9IHsKCQlhZGRUaHJlYWQ6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCQkJdmFyIGRhdGEgPSB7CgkJCQlGb3J1bUlkOiBvcHRpb25zLmZvcnVtSWQsCgkJCQlCb2R5OiBvcHRpb25zLmJvZHksCgkJCQlTdWJqZWN0OiBvcHRpb25zLnN1YmplY3QKCQkJfTsKCgkJCWlmKG9wdGlvbnMuaXNRdWVzdGlvbiAhPSB1bmRlZiAmJiBvcHRpb25zLmlzUXVlc3Rpb24gIT0gbnVsbCkKCQkJCWRhdGEuSXNRdWVzdGlvbiA9IG9wdGlvbnMuaXNRdWVzdGlvbjsKCQkJaWYob3B0aW9ucy5zdWJzY3JpYmVUb1RocmVhZCAhPSB1bmRlZiAmJiBvcHRpb25zLnN1YnNjcmliZVRvVGhyZWFkICE9IG51bGwpCgkJCQlkYXRhLlN1YnNjcmliZVRvVGhyZWFkID0gb3B0aW9ucy5zdWJzY3JpYmVUb1RocmVhZDsKCgkJCXJldHVybiAkLnRlbGxpZ2VudC5ldm9sdXRpb24ucG9zdCh7CgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi9mb3J1bXMve0ZvcnVtSWR9L3RocmVhZHMuanNvbicsCgkJCQlkYXRhOiBkYXRhCgkJCX0pOwoJCX0sCgkJZWRpdFRocmVhZDogZnVuY3Rpb24ob3B0aW9ucykgewoJCQl2YXIgZGF0YSA9IHsKCQkJCUZvcnVtSWQ6IG9wdGlvbnMuZm9ydW1JZCwKCQkJCVRocmVhZElkOiBvcHRpb25zLnRocmVhZElkLAoJCQkJQm9keTogb3B0aW9ucy5ib2R5LAoJCQkJU3ViamVjdDogb3B0aW9ucy5zdWJqZWN0CgkJCX07CgoJCQlpZihvcHRpb25zLmlzUXVlc3Rpb24gIT0gdW5kZWYgJiYgb3B0aW9ucy5pc1F1ZXN0aW9uICE9IG51bGwpCgkJCQlkYXRhLklzUXVlc3Rpb24gPSBvcHRpb25zLmlzUXVlc3Rpb247CgkJCWlmKG9wdGlvbnMuc3Vic2NyaWJlVG9UaHJlYWQgIT0gdW5kZWYgJiYgb3B0aW9ucy5zdWJzY3JpYmVUb1RocmVhZCAhPSBudWxsKQoJCQkJZGF0YS5TdWJzY3JpYmVUb1RocmVhZCA9IG9wdGlvbnMuc3Vic2NyaWJlVG9UaHJlYWQ7CgoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7CgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi9mb3J1bXMve0ZvcnVtSWR9L3RocmVhZHMve1RocmVhZElkfS5qc29uJywKCQkJCWRhdGE6IGRhdGEKCQkJfSk7CgkJfQoJfQoKCXZhciBhcGkgPSB7CgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCQkJdmFyIHRpdGxlSW5wdXQgPSAkKG9wdGlvbnMuc3ViamVjdElucHV0KSwKCQkJCWJvZHlJbnB1dCA9ICQob3B0aW9ucy5ib2R5SW5wdXQpLAoJCQkJdGhyZWFkVHlwZUlucHV0ID0gJChvcHRpb25zLnRocmVhZFR5cGVJbnB1dCksCgkJCQlzdWJzY3JpYmVJbnB1dCA9ICQob3B0aW9ucy5zdWJzY3JpYmVJbnB1dCksCgkJCQlwb3N0TGluayA9ICQoJzxhIGhyZWY9IiMiIGNsYXNzPSJzdWJtaXQiPicgKyAob3B0aW9ucy5tb2RlID09ICdhZGQnID8gb3B0aW9ucy5wb3N0TGFiZWwgOiBvcHRpb25zLmVkaXRMYWJlbCkgKyAnPC9hPicpOwoKCQkJcG9zdExpbmsub24oJ3RhcCcsIGZ1bmN0aW9uKCl7CgkJCQl2YXIgYm9keSA9ICQudHJpbShvcHRpb25zLmdldEJvZHlDb250ZW50KCkpLAoJCQkJCXN1YmplY3QgPSAkLnRyaW0odGl0bGVJbnB1dC52YWwoKSksCgkJCQkJc3VibWl0QWN0aW9uOwoKCQkJCWlmKGJvZHkubGVuZ3RoID4gMCAmJiBzdWJqZWN0Lmxlbmd0aCA+IDApIHsKCgkJCQkJaWYob3B0aW9ucy5tb2RlID09ICdhZGQnKSB7CgkJCQkJCXN1Ym1pdEFjdGlvbiA9IG1vZGVsLmFkZFRocmVhZCh7CgkJCQkJCQlmb3J1bUlkOiBvcHRpb25zLmZvcnVtSWQsCgkJCQkJCQl0aHJlYWRJZDogb3B0aW9ucy5mb3J1bVRocmVhZElkLAoJCQkJCQkJc3ViamVjdDogc3ViamVjdCwKCQkJCQkJCWJvZHk6IGJvZHksCgkJCQkJCQlpc1F1ZXN0aW9uOiAodGhyZWFkVHlwZUlucHV0Lmxlbmd0aCA9PSAwID8gbnVsbCA6IHRocmVhZFR5cGVJbnB1dC52YWwoKSA9PSAnUXVlc3Rpb25BbmRBbnN3ZXInKSwKCQkJCQkJCXN1YnNjcmliZVRvVGhyZWFkOiBzdWJzY3JpYmVJbnB1dC5sZW5ndGggPT0gMCA/IG51bGwgOiBzdWJzY3JpYmVJbnB1dC5pcygnOmNoZWNrZWQnKQoJCQkJCQl9KTsKCQkJCQl9IGVsc2UgaWYob3B0aW9ucy5tb2RlID09ICdlZGl0JykgewoJCQkJCQlzdWJtaXRBY3Rpb24gPSBtb2RlbC5lZGl0VGhyZWFkKHsKCQkJCQkJCWZvcnVtSWQ6IG9wdGlvbnMuZm9ydW1JZCwKCQkJCQkJCXRocmVhZElkOiBvcHRpb25zLmZvcnVtVGhyZWFkSWQsCgkJCQkJCQlzdWJqZWN0OiBzdWJqZWN0LAoJCQkJCQkJYm9keTogYm9keSwKCQkJCQkJCWlzUXVlc3Rpb246ICh0aHJlYWRUeXBlSW5wdXQubGVuZ3RoID09IDAgPyBudWxsIDogdGhyZWFkVHlwZUlucHV0LnZhbCgpID09ICdRdWVzdGlvbkFuZEFuc3dlcicpLAoJCQkJCQkJc3Vic2NyaWJlVG9UaHJlYWQ6IChzdWJzY3JpYmVJbnB1dC5sZW5ndGggPT0gMCA/IG51bGwgOiBzdWJzY3JpYmVJbnB1dC5pcygnOmNoZWNrZWQnKSkKCQkJCQkJfSk7CgkJCQkJfQoKCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNob3dMb2FkaW5nKCk7CgkJCQkJc3VibWl0QWN0aW9uLmRvbmUoZnVuY3Rpb24ocmVzcG9uc2UpewoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmxvYWQocmVzcG9uc2UuVGhyZWFkLlVybCwgeyByZWZyZXNoOiB0cnVlIH0pOwoJCQkJCX0pLmZhaWwoZnVuY3Rpb24oKXsKCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlTG9hZGluZygpOwoJCQkJCX0pOwoJCQkJfQoJCQl9KTsKCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2V0SGVhZGVyQnV0dG9uKHBvc3RMaW5rKTsKCQl9Cgl9CgoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5jcmVhdGVFZGl0Rm9ydW1UaHJlYWQgPSBhcGk7Cgp9KShqUXVlcnksIHdpbmRvdyk7</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:CreateStatus_Name}" version="7.0.0.1" description="" instanceIdentifier="710ffc21661e48ca877df34037d90d94" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="create-status">
    <contentScript>
		
#set($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#set ($accessingUser = $core_v2_user.Accessing)

#set ($enablePosting = false)
#if ($groupId &gt; 0)
	#set($group = $core_v2_group.Get("%{Id = $groupId}"))
	#set ($enablePosting = $group.EnableGroupMessages)
	#if ($group.GroupType == 'Joinless')
		#set ($enablePosting = $enablePosting &amp;&amp; $core_v2_user.IsRegistered($accessingUser.Id))
	#else
		#set ($groupUserMember = false)
		#set ($groupUserMember = $core_v2_groupUserMember.Get($group.Id, "%{ UserId = $accessingUser.Id }"))
		#set ($enablePosting = $enablePosting &amp;&amp; $groupUserMember != false &amp;&amp; ($groupUserMember.MembershipType == "Owner" || $groupUserMember.MembershipType == "Manager" || $groupUserMember.MembershipType == "Member"))
	#end
#else
	#set($enablePosting = true)
#end
#set ($enablePosting = $enablePosting &amp;&amp; $core_v2_activityStoryUserPreference.Get($core_v2_statusMessage.StoryTypeId).IsLoggingEnabled)

#if (!$enablePosting)
	$core_v2_widget.Hide()
#end

#set($userId = $accessingUser.Id)
#set($contextId = $core_v2_uploadedFile.CreateContextId())
#set($uploadUrl = $core_v2_uploadedFile.GetUploadUrl($contextId))

#set($uploadContainer = $core_v2_widget.UniqueId('uploadFileContainer'))
#set($uploadInput = $core_v2_widget.UniqueId('uploadFileInput'))
#set($uploadFileStateId = $core_v2_widget.UniqueId('uploadFileState'))
#set($uploadButtonId = $core_v2_widget.UniqueId('upload'))
#set($removeButtonId = $core_v2_widget.UniqueId('remove'))

#set($bodyId = $core_v2_widget.UniqueId('Body'))

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		#if ($group)
			&lt;a href="$core_v2_encoding.HtmlAttributeEncode($group.Url)"&gt;$group.Name&lt;/a&gt;
		#else
			&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('home'))"&gt;$core_v2_language.GetResource('home')&lt;/a&gt;
		#end
		&lt;h1&gt;$core_v2_language.GetResource('create_status')&lt;/h1&gt;
	&lt;/div&gt;
&lt;/div&gt;
&lt;fieldset&gt;
	&lt;div class="form-field editor"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;$core_v2_language.GetResource('body')&lt;/label&gt;
		&lt;textarea id="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;&lt;/textarea&gt;
	&lt;/div&gt;

	&lt;div class="form-field"&gt;
		&lt;div class="preview" style="display: none;"&gt;&lt;/div&gt;
		&lt;a href="#" class="upload with-icon" id="$core_v2_encoding.HtmlAttributeEncode($uploadButtonId)"&gt;$core_v2_language.GetResource('StatusMessage_UploadFile')&lt;/a&gt;
		&lt;a href="#" class="remove" id="$core_v2_encoding.HtmlAttributeEncode($removeButtonId)" style="display: none;"&gt;$core_v2_language.GetResource('RemoveFile')&lt;/a&gt;
	&lt;/div&gt;

&lt;/fieldset&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.createStatus.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			bodyId : '#$core_v2_encoding.JavascriptEncode($bodyId)',
			uploadFileUrl : '$core_v2_encoding.JavascriptEncode($uploadUrl)',
			uploadContextId : '$core_v2_encoding.JavascriptEncode($contextId)',
			uploadButtonId: "$core_v2_encoding.JavascriptEncode($uploadButtonId)",
			removeButtonId: "$core_v2_encoding.JavascriptEncode($removeButtonId)",
			previewAttachmentUrl: "$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('preview-attachment.vm'))",
			progressMessage: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('Uploading'))',
			changeFileMessage: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('ChangeFile'))',
			uploadFileMessage: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('StatusMessage_UploadFile'))',
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			addStatusUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('add-status.vm'))',
			groupId: $groupId
		});

		jQuery.telligent.evolution.mobile.refreshable(false);
		jQuery.telligent.evolution.mobile.excludeFromHistory();
	});
})
&lt;/script&gt;
		

		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
			<resource name="CreateStatus_Name">Create Status</resource>
			<resource name="post">Post</resource>
			<resource name="invalid_file_type">The file type is invalid.</resource>
			<resource name="StatusMessage_UploadFile">Add a photo, video or file</resource>
			<resource name="RemoveFile">Remove file</resource>
			<resource name="ChangeFile">Change file</resource>
			<resource name="Uploading">Uploading ({0}%)...</resource>
			<resource name="home">Home</resource>
			<resource name="create_status">Add status</resource>
		  </language>
		</languageResources>
    <files>
      <file name="add-status.vm">JGNvcmVfdjJfcGFnZS5TZXRDb250ZW50VHlwZSgnYXBwbGljYXRpb24vanNvbicpDQoNCiNpZiAoJGNvcmVfdjJfcGFnZS5Jc1Bvc3QpDQoJI3NldCgkZ3JvdXBJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJGNvcmVfdjJfcGFnZS5HZXRGb3JtVmFsdWUoJ2dyb3VwSWQnKSkpDQoJI3NldCgkbWVzc2FnZUJvZHkgPSAkY29yZV92Ml9wYWdlLkdldEZvcm1WYWx1ZSgnbWVzc2FnZScpKQ0KCSNzZXQoJGdyb3VwID0gZmFsc2UpDQoJI3NldCgkZ3JvdXAgPSAkY29yZV92Ml9ncm91cC5HZXQoIiV7IElkID0gJyR7Z3JvdXBJZH0nfSIpKQ0KCSNzZXQoJGZpbGVOYW1lID0gZmFsc2UpDQoJI3NldCgkZmlsZU5hbWUgPSAkY29yZV92Ml9wYWdlLkdldEZvcm1WYWx1ZSgnZmlsZU5hbWUnKSkNCgkjc2V0KCRjb250ZXh0SWQgPSBmYWxzZSkNCgkjc2V0KCRjb250ZXh0SWQgPSAkY29yZV92Ml9wYWdlLkdldEZvcm1WYWx1ZSgnY29udGV4dElkJykpDQoJI3NldCgkb3B0aW9ucyA9ICIle30iKQ0KDQoJI2lmICgkZmlsZU5hbWUgJiYgJGZpbGVOYW1lLmxlbmd0aCA+IDAgJiYgJGNvbnRleHRJZCkNCgkJI3NldCAoJGF0dGFjaGVkRmlsZSA9ICRjb3JlX3YyX3VwbG9hZGVkRmlsZS5HZXQoJGNvbnRleHRJZCwgJGZpbGVOYW1lKSkNCgkJI2lmICgkYXR0YWNoZWRGaWxlKQ0KCQkJJG9wdGlvbnMuQWRkKCdBdHRhY2hlZFVybCcsICRhdHRhY2hlZEZpbGUuVXJsKQ0KCQkjZW5kDQoJI2VuZA0KDQoJI2lmICgkZ3JvdXAgJiYgJGdyb3VwLlBhcmVudEdyb3VwSWQgIT0gLTEpDQoJCSRvcHRpb25zLkFkZCgnR3JvdXBJZCcsICRncm91cC5JZCkNCgkjZW5kDQoNCgkjc2V0ICgkbWVzc2FnZSA9ICRjb3JlX3YyX3N0YXR1c01lc3NhZ2UuQ3JlYXRlKCRtZXNzYWdlQm9keSwgJG9wdGlvbnMpKQ0KCSNpZiAoJG1lc3NhZ2UuRXJyb3JzLkNvdW50ID4gMCkNCgkJJGNvcmVfdjJfcGFnZS5TZW5kSnNvbkVycm9yKCRtZXNzYWdlLkVycm9ycykNCgkjZWxzZQ0KCQkkY29yZV92Ml9wYWdlLlNldENvbnRlbnRUeXBlKCdhcHBsaWNhdGlvbi9qc29uJykNCgkJeyJzdWNjZXNzIjogInRydWUifQ0KCSNlbmQNCiNlbmQ=</file>
      <file name="preview-attachment.vm">IyMgTG9hZHMgQXR0YWNobWVudCBQcmV2aWV3DQojc2V0KCRtZXNzYWdlQm9keSA9ICRjb3JlX3YyX3BhZ2UuR2V0Rm9ybVZhbHVlKCd3X21lc3NhZ2VCb2R5JykpDQojc2V0KCRncm91cElkID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUludCgkY29yZV92Ml9wYWdlLkdldEZvcm1WYWx1ZSgnd19ncm91cElkJykpKQ0KDQojc2V0ICgkYXR0YWNoZWRGaWxlTmFtZSA9IGZhbHNlKQ0KI3NldCAoJGF0dGFjaGVkRmlsZU5hbWUgPSAkY29yZV92Ml9wYWdlLkdldEZvcm1WYWx1ZSgnd19hdHRhY2hlZEZpbGVOYW1lJykpDQojc2V0ICgkYXR0YWNoZWRGaWxlQ29udGV4dCA9IGZhbHNlKQ0KI3NldCAoJGF0dGFjaGVkRmlsZUNvbnRleHQgPSAkY29yZV92Ml9wYWdlLkdldEZvcm1WYWx1ZSgnd19hdHRhY2hlZEZpbGVDb250ZXh0JykpDQojc2V0ICgkYXR0YWNoZWRVcmwgPSBmYWxzZSkNCiNpZiAoJGF0dGFjaGVkRmlsZU5hbWUubGVuZ3RoID4gMCAmJiAkYXR0YWNoZWRGaWxlQ29udGV4dC5sZW5ndGggPiAwKQ0KICAgICNzZXQgKCRhdHRhY2hlZEZpbGUgPSBmYWxzZSkNCgkjc2V0ICgkYXR0YWNoZWRGaWxlID0gJGNvcmVfdjJfdXBsb2FkZWRGaWxlLkdldCgkYXR0YWNoZWRGaWxlQ29udGV4dCwgJGF0dGFjaGVkRmlsZU5hbWUpKQ0KCSNpZiAoJGF0dGFjaGVkRmlsZSkNCgkgICAjc2V0ICgkYXR0YWNoZWRVcmwgPSAkYXR0YWNoZWRGaWxlLlVybCkNCgkjZW5kDQojZW5kDQoNCiNzZXQgKCRvcHRpb25zID0gIiV7IEdyb3VwSWQgPSAkZ3JvdXBJZCB9IikNCiNpZiAoJGF0dGFjaGVkVXJsKQ0KICAgICRvcHRpb25zLkFkZCgnQXR0YWNoZWRVcmwnLCAkYXR0YWNoZWRVcmwpDQojZW5kDQoNCiRjb3JlX3YyX3N0YXR1c01lc3NhZ2UuUHJldmlld0F0dGFjaG1lbnQoJG1lc3NhZ2VCb2R5LCAkb3B0aW9ucyk=</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCwgdW5kZWYpew0KDQoJdmFyIGNyZWF0ZVN0YXR1cyA9IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygpOw0KCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnBvc3Qoew0KCQkJdXJsOiBvcHRpb25zLmFkZFN0YXR1c1VybCwNCgkJCWRhdGE6IHsNCgkJCQltZXNzYWdlOiBvcHRpb25zLm1lc3NhZ2UuZXZvbHV0aW9uQ29tcG9zZXIoJ3ZhbCcpLA0KCQkJCWZpbGVOYW1lOiBvcHRpb25zLmF0dGFjaGVkRmlsZU5hbWUsDQoJCQkJY29udGV4dElkOiBvcHRpb25zLnVwbG9hZENvbnRleHRJZCwNCgkJCQlncm91cElkOiBvcHRpb25zLmdyb3VwSWQNCgkJCX0sDQoJCQlzdWNjZXNzOiBmdW5jdGlvbihyZXNwb25zZSkgew0KCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuYmFjayh0cnVlKTsNCgkJCX0sDQoJCQlmYWlsOiBmdW5jdGlvbigpIHsNCgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmhpZGVMb2FkaW5nKCk7DQoJCQl9DQoJCX0pOw0KCX0sDQoJbG9hZFByZXZpZXcgPSAgZnVuY3Rpb24oY29udGV4dCwgZmlsZU5hbWUpIHsNCgkJaWYoZmlsZU5hbWUpICB7DQoJCQljb250ZXh0LmF0dGFjaGVkRmlsZU5hbWUgPSBmaWxlTmFtZTsNCgkJfQ0KCQljbGVhclRpbWVvdXQoY29udGV4dC5wcmV2aWV3VGltZW91dCk7DQoJCWNvbnRleHQucHJldmlld1RpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7DQoJCQl2YXIgZGF0YSA9IHsNCgkJCQl3X21lc3NhZ2VCb2R5OiBjb250ZXh0Lm1lc3NhZ2UuZXZvbHV0aW9uQ29tcG9zZXIoJ3ZhbCcpLA0KCQkJCXdfZ3JvdXBJZDogY29udGV4dC5ncm91cElkDQoJCQl9Ow0KCQkJaWYoY29udGV4dC5hdHRhY2hlZEZpbGVOYW1lKSB7DQoJCQkJZGF0YS53X2F0dGFjaGVkRmlsZU5hbWUgPSBjb250ZXh0LmF0dGFjaGVkRmlsZU5hbWU7DQoJCQkJZGF0YS53X2F0dGFjaGVkRmlsZUNvbnRleHQgPSBjb250ZXh0LnVwbG9hZENvbnRleHRJZDsNCgkJCX0NCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5wb3N0KHsNCgkJCQl1cmw6IGNvbnRleHQucHJldmlld0F0dGFjaG1lbnRVcmwsDQoJCQkJZGF0YTogZGF0YSwNCgkJCQlzdWNjZXNzOiBmdW5jdGlvbihyZXNwb25zZSkgew0KCQkJCQlyZXNwb25zZSA9ICQudHJpbShyZXNwb25zZSk7DQoJCQkJCWlmKHJlc3BvbnNlICYmIHJlc3BvbnNlLmxlbmd0aCA+IDApIHsNCgkJCQkJCWlmIChyZXNwb25zZSAhPT0gY29udGV4dC5wcmV2aWV3Q29udGVudCkgew0KCQkJCQkJCWNvbnRleHQucHJldmlld0NvbnRlbnQgPSByZXNwb25zZTsNCgkJCQkJCQljb250ZXh0LnByZXZpZXdDb250YWluZXIuaHRtbChjb250ZXh0LnByZXZpZXdDb250ZW50KTsNCgkJCQkJCQljb250ZXh0LnByZXZpZXdDb250YWluZXIuc2xpZGVEb3duKDEwMCk7DQoJCQkJCQkJaWYoY29udGV4dC5wb3N0KQ0KCQkJCQkJCQljb250ZXh0LnBvc3Quc2hvdygpOw0KCQkJCQkJfQ0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJY29udGV4dC5wcmV2aWV3Q29udGVudCA9ICcnOw0KCQkJCQkJY29udGV4dC5wcmV2aWV3Q29udGFpbmVyLmh0bWwoJycpOw0KCQkJCQkJY29udGV4dC5wcmV2aWV3Q29udGFpbmVyLnNsaWRlVXAoMTAwKTsNCgkJCQkJCWlmKCEkKCdib2R5JykuaGFzQ2xhc3MoJ3RvdWNoJykgJiYgY29udGV4dC5wb3N0KQ0KCQkJCQkJCWNvbnRleHQucG9zdC5oaWRlKCk7DQoJCQkJCX0NCgkJCQl9DQoJCQl9KTsNCgkJfSwgMTUwKTsNCgl9LA0KCWNsZWFyUHJldmlldyA9IGZ1bmN0aW9uKGNvbnRleHQpIHsNCgkJY29udGV4dC5wcmV2aWV3Q29udGFpbmVyLnNsaWRlVXAoMTAwKTsNCgkJY2xlYXJUaW1lb3V0KGNvbnRleHQucHJldmlld1RpbWVvdXQpOw0KCQljb250ZXh0LmF0dGFjaGVkRmlsZU5hbWUgPSBudWxsOw0KCQljb250ZXh0LnByZXZpZXdDb250ZW50ID0gbnVsbDsNCgkJY29udGV4dC5wcmV2aWV3Q29udGFpbmVyLmVtcHR5KCk7DQoJfSwNCglpbml0aWFsaXplRmlsZVVwbG9hZCA9IGZ1bmN0aW9uKGNvbnRleHQpIHsNCgkJY29udGV4dC5maWxlVXBsb2FkLmdsb3dVcGxvYWQoew0KCQkJZmlsZUZpbHRlcjogbnVsbCwNCgkJCXVwbG9hZFVybDogY29udGV4dC51cGxvYWRGaWxlVXJsLA0KCQkJcmVuZGVyTW9kZTogJ2xpbmsnDQoJCX0pLm9uKCdnbG93VXBsb2FkQmVndW4nLCBmdW5jdGlvbihlKSB7DQoJCQljb250ZXh0LnVwbG9hZGluZyA9IHRydWU7DQoJCQl2YWxpZGF0ZShjb250ZXh0KTsNCgkJCWNvbnRleHQuZmlsZVVwbG9hZC5odG1sKGNvbnRleHQucHJvZ3Jlc3NNZXNzYWdlLnJlcGxhY2UoJ3swfScsIDApKTsNCgkJCSQoJyMnICsgY29udGV4dC51cGxvYWRCdXR0b25JZCkucmVtb3ZlQ2xhc3MoJ3dpdGgtaWNvbicpOw0KCQl9KS5vbignZ2xvd1VwbG9hZENvbXBsZXRlJywgZnVuY3Rpb24oZSwgZmlsZSkgew0KCQkJbG9hZFByZXZpZXcoY29udGV4dCwgZmlsZS5uYW1lKTsNCgkJCWNvbnRleHQudXBsb2FkaW5nID0gZmFsc2U7DQoJCQljb250ZXh0LmZpbGVVcGxvYWQuaHRtbChjb250ZXh0LmNoYW5nZUZpbGVNZXNzYWdlKS5yZW1vdmVDbGFzcygndXBsb2FkJykuYWRkQ2xhc3MoJ2NoYW5nZScpOw0KCQkJY29udGV4dC5maWxlUmVtb3ZlLnNob3coKTsNCgkJCXZhbGlkYXRlKGNvbnRleHQpOw0KCQl9KS5vbignZ2xvd1VwbG9hZEZpbGVQcm9ncmVzcycsIGZ1bmN0aW9uKGUsIGRldGFpbHMpIHsNCgkJCWNvbnRleHQuZmlsZVVwbG9hZC5odG1sKGNvbnRleHQucHJvZ3Jlc3NNZXNzYWdlLnJlcGxhY2UoJ3swfScsIGRldGFpbHMucGVyY2VudCkpOw0KCQl9KTsNCgl9LA0KCXZhbGlkYXRlID0gZnVuY3Rpb24oY29udGV4dCkgew0KCQlpZiAoJC50cmltKGNvbnRleHQubWVzc2FnZS52YWwoKSkgPT0gIiIgfHwgY29udGV4dC51cGxvYWRpbmcgPT09IHRydWUpIHsNCgkJCXJldHVybiBmYWxzZTsNCgkJfQ0KDQoJCXJldHVybiB0cnVlOw0KCX0sDQoJcmVtb3ZlRmlsZSA9IGZ1bmN0aW9uKGNvbnRleHQpIHsNCgkJY29udGV4dC5maWxlUmVtb3ZlLmhpZGUoKTsNCgkJY29udGV4dC5hdHRhY2hlZEZpbGVOYW1lID0gbnVsbDsNCgkJY29udGV4dC51cGxvYWRpbmcgPSBmYWxzZTsNCgkJbG9hZFByZXZpZXcoY29udGV4dCk7DQoJCWNvbnRleHQuZmlsZVVwbG9hZC5odG1sKGNvbnRleHQudXBsb2FkRmlsZU1lc3NhZ2UpLmFkZENsYXNzKCd1cGxvYWQnKS5yZW1vdmVDbGFzcygnY2hhbmdlJyk7DQoJCSQoJyMnICsgY29udGV4dC51cGxvYWRCdXR0b25JZCkuYWRkQ2xhc3MoJ3dpdGgtaWNvbicpOw0KCX07DQoNCgl2YXIgYXBpID0gew0KCQlyZWdpc3RlcjogZnVuY3Rpb24ob3B0aW9ucykgew0KCQkJb3B0aW9ucy53cmFwcGVyID0gJChvcHRpb25zLndyYXBwZXIpOw0KCQkJb3B0aW9ucy5maWxlVXBsb2FkID0gJCgnLnVwbG9hZCcsIG9wdGlvbnMud3JhcHBlcik7DQoJCQlvcHRpb25zLnByZXZpZXdDb250YWluZXIgPSAkKCcucHJldmlldycsIG9wdGlvbnMud3JhcHBlcik7DQoJCQlvcHRpb25zLmZpbGVSZW1vdmUgPSAkKCcucmVtb3ZlJywgb3B0aW9ucy53cmFwcGVyKTsNCgkJCW9wdGlvbnMubWVzc2FnZSA9ICQob3B0aW9ucy5ib2R5SWQpOw0KCQkJb3B0aW9ucy5wcmV2aWV3VGltZW91dCA9IG51bGw7DQoJCQlvcHRpb25zLmF0dGFjaGVkRmlsZU5hbWUgPSBudWxsOw0KCQkJb3B0aW9ucy5wcmV2aWV3Q29udGVudCA9IG51bGw7DQoJCQlvcHRpb25zLnVwbG9hZGluZyA9IGZhbHNlOw0KCQkJdmFyIHBvc3RMaW5rOw0KDQoJCQlwb3N0TGluayA9ICQoJzxhIGhyZWY9IiMiIGNsYXNzPSJzdWJtaXQiPicgKyBvcHRpb25zLnBvc3RMYWJlbCArICc8L2E+Jyk7DQoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNldEhlYWRlckJ1dHRvbihwb3N0TGluayk7DQoJCQlwb3N0TGluay5oaWRlKCk7DQoNCgkJCW9wdGlvbnMubWVzc2FnZS5ldm9sdXRpb25Db21wb3Nlcih7DQoJCQkJcGx1Z2luczogWydtZW50aW9ucycsJ2hhc2h0YWdzJywndXJsaGlnaGxpZ2h0J10sDQoJCQkJZm9jdXM6IGZhbHNlDQoJCQl9KS5ldm9sdXRpb25Db21wb3Nlcignb25pbnB1dCcsIGZ1bmN0aW9uKGUpew0KCQkJCWNsZWFyVGltZW91dChvcHRpb25zLmlucHV0UHJldmlld0hhbmRsZSk7DQoJCQkJb3B0aW9ucy5pbnB1dFByZXZpZXdIYW5kbGUgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgew0KCQkJCQlsb2FkUHJldmlldyhvcHRpb25zKTsNCgkJCQl9LCA5OTkpOw0KCQkJfSkuZm9jdXMoZnVuY3Rpb24oKXsNCgkJCQlwb3N0TGluay5zaG93KCk7DQoJCQl9KS5ibHVyKGZ1bmN0aW9uKCl7DQoJCQkJdmFsaWRhdGUob3B0aW9ucyk7DQoJCQl9KS5mb2N1cygpOw0KDQoJCQlpbml0aWFsaXplRmlsZVVwbG9hZChvcHRpb25zKTsNCg0KCQkJb3B0aW9ucy5maWxlUmVtb3ZlLmNsaWNrKGZ1bmN0aW9uKCkgew0KCQkJCXJlbW92ZUZpbGUob3B0aW9ucyk7DQoJCQkJcmV0dXJuIGZhbHNlOw0KCQkJfSk7DQoNCg0KCQkJcG9zdExpbmsub24oJ3RhcCcsIGZ1bmN0aW9uKCl7DQoJCQkJaWYgKHZhbGlkYXRlKG9wdGlvbnMpKSB7DQoJCQkJCWNyZWF0ZVN0YXR1cyhvcHRpb25zKTsNCgkJCQl9DQoJCQkJcmV0dXJuIGZhbHNlOw0KCQkJfSk7DQoNCgkJCXZhbGlkYXRlKG9wdGlvbnMpOw0KCQl9DQoJfQ0KDQoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24gPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24gfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5jcmVhdGVTdGF0dXMgPSBhcGk7DQoNCn0pKGpRdWVyeSwgd2luZG93KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:FeaturedContentSlider_Name}" description="" instanceIdentifier="387656725d5b48bdae2c451035b95d4d" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="featured-content-slider">
    <contentScript>
	
#set ($pageSize = 5)
#set ($transition = 'transitionAutomatic')
#set ($duration = 5000)
#set ($shadowText = true)
#set ($featureCount = 0)
#set ($featureBackground = '#444')
#set ($featureForeground = false)

#set ($previousId = $core_v2_widget.UniqueId('previous'))
#set ($nextId = $core_v2_widget.UniqueId('next'))

## collect content features
#set ($group = $core_v2_group.Current)
#set ($contentFeatures = $core_v2_feature.List("%{ GroupId = $group.Id, Count = $pageSize }"))
#if (!$contentFeatures || $contentFeatures.Count == 0)
	$core_v2_widget.Hide()
#end

#foreach ($featuredContent in $contentFeatures)
#beforeall
	&lt;div class="featured-content-slider"&gt;
		&lt;div class="content-list-wrapper"&gt;
			&lt;ul class="content-list content"&gt;
#each
				#set ($feature = "%{ Shadow = $shadowText, Image = $featuredContent.Image, Url = $featuredContent.Url, Title = $featuredContent.Title, Description = $featuredContent.Content, Background = $featureBackground, Foreground = $featureForeground }")
				#if ($featuredContent.User)
					$feature.Add('UserAvatarUrl', $featuredContent.User.AvatarUrl)
					$feature.Add('UserProfileUrl', $featuredContent.User.ProfileUrl)
					$feature.Add('UserDisplayName', $featuredContent.User.DisplayName)
				#end

				#set ($hasImageMedia = false)
				#if ($feature.Image &amp;&amp; $feature.Image.length &gt; 0)
					#set ($mediaType = $core_v2_ui.GetMediaType($feature.Image, "%{ ViewType = 'View' }"))
					#if ($mediaType == 'Image')
						#set ($hasImageMedia = true)
					#end
				#end

				&lt;li class="content-item"
					style="
						#if ($feature.Foreground)
							color: $feature.Foreground;
						#end
						#if ($feature.Background)
							background-color: $feature.Background;
						#end
					"&gt;
					#if ($hasImageMedia)
						&lt;div class="avatar-container"&gt;
							&lt;div class="avatar-wrapper"&gt;
								&lt;div class="avatar #if ($hasImageMedia &amp;&amp; $feature.Shadow) shadowed #end"&gt;
									$core_v2_ui.GetResizedImageHtml($feature.Image, 640, 214, "%{ border='0px', ResizeMethod = 'ZoomAndCrop' }")
								&lt;/div&gt;
							&lt;/div&gt;
						&lt;/div&gt;
					#end

					&lt;div class="caption #if ($hasImageMedia &amp;&amp; $feature.Shadow) shadowed #end"&gt;
						#if ($feature.Title &amp;&amp; $feature.Title.length &gt; 0)
							&lt;h3 class="name"&gt;
								#if ($feature.Url &amp;&amp; $feature.Url.length &gt; 0)
									&lt;a href="$core_v2_encoding.HtmlAttributeEncode($feature.Url)"
										class="internal-link view-post"
										#if ($feature.Foreground) style="color: $feature.Foreground" #end
										&gt;
										$core_v2_language.Truncate($feature.Title, 35, '...')
									&lt;/a&gt;
								#else
									$core_v2_language.Truncate($feature.Title, 35, '...')
								#end
							&lt;/h3&gt;
						#end

						#if ($feature.UserAvatarUrl &amp;&amp; $feature.UserAvatarUrl.length &gt; 0 &amp;&amp; $feature.UserDisplayName &amp;&amp; $feature.UserDisplayName.length &gt; 0)
							&lt;div class="author"&gt;
								&lt;div class="avatar"&gt;
									#if ($feature.UserProfileUrl &amp;&amp; $feature.UserProfileUrl.length &gt; 0)
										&lt;a href="$core_v2_encoding.HtmlAttributeEncode($feature.UserProfileUrl)"&gt;
											$core_v2_ui.GetResizedImageHtml($feature.UserAvatarUrl, 20, 20, "%{border='0px', alt=$feature.UserDisplayName, ResizeMethod = 'ZoomAndCrop' }")
										&lt;/a&gt;
									#else
										$core_v2_ui.GetResizedImageHtml($feature.UserAvatarUrl, 20, 20, "%{border='0px', alt=$feature.UserDisplayName, ResizeMethod = 'ZoomAndCrop' }")
									#end
								&lt;/div&gt;
								&lt;span class="user-name"&gt;
									#if ($feature.UserProfileUrl &amp;&amp; $feature.UserProfileUrl.length &gt; 0)
										&lt;a href="$core_v2_encoding.HtmlAttributeEncode($feature.UserProfileUrl)" class="internal-link view-user-profile"&gt;
											$core_v2_language.Truncate($feature.UserDisplayName, 50, '...')
										&lt;/a&gt;
									#else
										$core_v2_language.Truncate($feature.UserDisplayName, 50, '...')
									#end
								&lt;/span&gt;
							&lt;/div&gt;
						#end

						#if ($feature.Description &amp;&amp; $feature.Description.length &gt; 0)
							&lt;div class="content"&gt;
								$core_v2_language.Truncate($feature.Description, 25, '...')
							&lt;/div&gt;
						#end
					&lt;/div&gt;
				&lt;/li&gt;
#afterall
			&lt;/ul&gt;
		&lt;/div&gt;
		#if ($contentFeatures.Count &gt; 1)
			&lt;a href="#" id="$core_v2_encoding.HtmlAttributeEncode($previousId)" class="navigation previous"&gt;Previous&lt;/a&gt;
			&lt;a href="#" id="$core_v2_encoding.HtmlAttributeEncode($nextId)" class="navigation next"&gt;Next&lt;/a&gt;
			#set ($maxFeatutureIndex = $contentFeatures.Count - 1)
			#foreach($i in [0..$maxFeatutureIndex])
			#beforeall
				&lt;div class="feature-links"&gt;
					&lt;ul&gt;
			#each
						&lt;li&gt;
							&lt;a href="#" class="feature-link" data-featureindex="$i"&gt;
								$core_v2_language.FormatString($core_v2_language.GetResource("feature"), $i.ToString())
							&lt;/a&gt;
						&lt;/li&gt;
			#afterall
					&lt;/ul&gt;
				&lt;/div&gt;
			#end
		#end
	&lt;/div&gt;

	&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
	&lt;script&gt;
		jQuery(function(){
			jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
				jQuery.telligent.evolution.widgets.featuredContentList.register({
					wrapper: '#$core_v2_widget.WrapperElementId',
					automatic: #if ($transition == 'transitionAutomatic') true #else false #end,
					duration: $duration,
					previousId: '#$core_v2_encoding.JavascriptEncode($previousId)',
					nextId: '#$core_v2_encoding.JavascriptEncode($nextId)'
				});
			});
		});
	&lt;/script&gt;
#end

	
	</contentScript>
    <headerScript>
	</headerScript>
    <languageResources>
<language key="en-us">
	<resource name="FeaturedContentSlider_Name">Featured Content Slider</resource>
	<resource name="feature">Feature {0}</resource>
</language>
		</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCkgew0KDQoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24gPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24gfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyB8fCB7fTsNCg0KCWZ1bmN0aW9uIGluaXQoY29udGV4dCwgcmVzaXplZCkgew0KCQlpZihyZXNpemVkKSB7DQoJCQljb250ZXh0Lmxpc3RXcmFwcGVyLmNzcyh7DQoJCQkJJ29wYWNpdHknOiAwDQoJCQl9KTsNCgkJCWNvbnRleHQubGlzdC5jc3Moew0KCQkJCXBvc2l0aW9uOiAnc3RhdGljJywNCgkJCQl3aWR0aDogJzEwMCUnDQoJCQl9KTsNCgkJCWNvbnRleHQubGlzdC5maW5kKCcuY29udGVudC1pdGVtJykuY3NzKHsNCgkJCQknd2lkdGgnOiAnMTAwJScsDQoJCQkJJ2Zsb2F0JzogJ25vbmUnDQoJCQl9KTsNCgkJfQ0KCQljb250ZXh0Lmxpc3RXcmFwcGVyLmNzcyh7DQoJCQknb3BhY2l0eSc6IDAsDQoJCQknb3ZlcmZsb3cnOiAnaGlkZGVuJw0KCQl9KTsNCg0KCQkvLyBjb2xsZWN0IGxpc3QgaXRlbXMNCgkJLy8gY29sbGVjdCB0aGUgZnVsbCB3aWR0aCwgYW5kIG1ha2UgdGhlIHdpZHRoIG9mIGVhY2ggcGFuZSBleHBsaWNpdA0KCQl2YXIgZnVsbFdpZHRoID0gMDsNCgkJY29udGV4dC5saXN0SXRlbXMgPSBbXTsNCgkJY29udGV4dC5saXN0LmZpbmQoJy5jb250ZW50LWl0ZW0nKS5lYWNoKGZ1bmN0aW9uKCl7DQoJCQl2YXIgcGFuZSA9ICQodGhpcyk7DQoJCQl2YXIgd2lkdGggPSBwYW5lLndpZHRoKCk7DQoJCQljb250ZXh0Lmxpc3RJdGVtcy5wdXNoKHsNCgkJCQllbG06IHBhbmUsDQoJCQkJb2Zmc2V0OiBmdWxsV2lkdGgNCgkJCX0pOw0KCQkJcGFuZS5jc3Moew0KCQkJCSd3aWR0aCc6IHdpZHRoLA0KCQkJCSdwb3NpdGlvbic6ICdhYnNvbHV0ZScsDQoJCQkJJ2xlZnQnOiBmdWxsV2lkdGggKyAncHgnLA0KCQkJCSd0b3AnOiAnMHB4Jw0KCQkJfSk7DQoNCgkJCXZhciBvZmZzZXQgPSBmdWxsV2lkdGgsDQoJCQkJc3RhcnRYLA0KCQkJCW1vdmVUaHJlc2hvbGQgPSB3aWR0aCAvIDIsDQoJCQkJZGlmZjsNCgkJCXBhbmUub2ZmKCdzd2lwZWxlZnQnKQ0KCQkJCS5vZmYoJ3N3aXBlcmlnaHQnKQ0KCQkJCS5vZmYoJ3BhbnN0YXJ0JykNCgkJCQkub2ZmKCdwYW4nKQ0KCQkJCS5vZmYoJ3BhbmVuZCcpDQoJCQkJLm9uKHsNCgkJCQkJc3dpcGVsZWZ0OiBmdW5jdGlvbihlKSB7DQoJCQkJCQlpZihjb250ZXh0LnN1cHByZXNzUGFubmluZykgcmV0dXJuOw0KCQkJCQkJaWYoIWNvbnRleHQuc2hvdWxkSGFuZGxlR2VzdHVyZXMpIHJldHVybjsNCgkJCQkJCW1vdmVOZXh0KGNvbnRleHQpOw0KCQkJCQkJc3RhcnRSZXNldEF1dG9QYWdlKGNvbnRleHQpOw0KCQkJCQkJZS5wcmV2ZW50RGVmYXVsdCgpOw0KCQkJCQkJcmV0dXJuIGZhbHNlOw0KCQkJCQl9LA0KCQkJCQlzd2lwZXJpZ2h0OiBmdW5jdGlvbihlKSB7DQoJCQkJCQlpZihjb250ZXh0LmN1cnJlbnRJbmRleCA+IDApDQoJCQkJCQkJZS5wcmV2ZW50RGVmYXVsdCgpOw0KDQoJCQkJCQlpZihjb250ZXh0LnN1cHByZXNzUGFubmluZykgcmV0dXJuOw0KCQkJCQkJaWYoIWNvbnRleHQuc2hvdWxkSGFuZGxlR2VzdHVyZXMpIHJldHVybjsNCgkJCQkJCW1vdmVQcmV2aW91cyhjb250ZXh0KTsNCgkJCQkJCXN0YXJ0UmVzZXRBdXRvUGFnZShjb250ZXh0KTsNCgkJCQkJCWUucHJldmVudERlZmF1bHQoKTsNCgkJCQkJCXJldHVybiBmYWxzZTsNCgkJCQkJfSwNCgkJCQkJcG9pbnRlcm1vdmU6IGZ1bmN0aW9uKGUpIHsNCgkJCQkJCWlmKGNvbnRleHQucGFubmluZykgew0KCQkJCQkJCWUucHJldmVudERlZmF1bHQoKTsNCgkJCQkJCQlyZXR1cm4gZmFsc2U7DQoJCQkJCQl9DQoJCQkJCX0sDQoJCQkJCXBhbnN0YXJ0OiBmdW5jdGlvbihlKSB7DQoJCQkJCQlpZighKGUuZGlyZWN0aW9uID09ICdsZWZ0JyB8fCAoZS5kaXJlY3Rpb24gPT0gJ3JpZ2h0JyAmJiBjb250ZXh0LmN1cnJlbnRJbmRleCA+IDApKSkgcmV0dXJuOw0KCQkJCQkJaWYoIWNvbnRleHQuc2hvdWxkSGFuZGxlR2VzdHVyZXMpIHJldHVybjsNCgkJCQkJCXN0YXJ0WCA9IGUucGFnZVg7DQoJCQkJCQljb250ZXh0LnBhbm5pbmcgPSB0cnVlOw0KCQkJCQkJc3RvcEF1dG9QYWdlKGNvbnRleHQpOw0KCQkJCQl9LA0KCQkJCQlwYW46IGZ1bmN0aW9uKGUpIHsNCgkJCQkJCWlmKChlLmRpcmVjdGlvbiA9PSAnbGVmdCcgfHwgKGUuZGlyZWN0aW9uID09ICdyaWdodCcgJiYgY29udGV4dC5jdXJyZW50SW5kZXggPiAwKSkpDQoJCQkJCQkJZS5wcmV2ZW50RGVmYXVsdCgpOw0KCQkJCQkJaWYoIWNvbnRleHQuc3VwcHJlc3NQYW5uaW5nICYmIChlLmRpcmVjdGlvbiA9PSAnbGVmdCcgfHwgKGUuZGlyZWN0aW9uID09ICdyaWdodCcgJiYgY29udGV4dC5jdXJyZW50SW5kZXggPiAwKSkpIHsNCgkJCQkJCQllLnByZXZlbnREZWZhdWx0KCk7DQoJCQkJCQkJaWYoIWNvbnRleHQuc2hvdWxkSGFuZGxlR2VzdHVyZXMpIHJldHVybjsNCgkJCQkJCQlkaWZmID0gZS5wYWdlWCAtIHN0YXJ0WDsNCgkJCQkJCQljb250ZXh0Lmxpc3QuZXZvbHV0aW9uVHJhbnNmb3JtKHsNCgkJCQkJCQkJbGVmdDogKC0xICogKG9mZnNldCAtIGRpZmYpKQ0KCQkJCQkJCX0pDQoJCQkJCQkJcmV0dXJuIGZhbHNlOw0KCQkJCQkJfQ0KCQkJCQl9LA0KCQkJCQlwYW5lbmQ6IGZ1bmN0aW9uKGUpIHsNCgkJCQkJCWlmKGNvbnRleHQuc3VwcHJlc3NQYW5uaW5nKSByZXR1cm47DQoJCQkJCQlpZighY29udGV4dC5zaG91bGRIYW5kbGVHZXN0dXJlcykgcmV0dXJuOw0KCQkJCQkJZGlmZiA9IGUucGFnZVggLSBzdGFydFg7DQoJCQkJCQlpZihNYXRoLmFicyhkaWZmKSA+PSBtb3ZlVGhyZXNob2xkKSB7DQoJCQkJCQkJaWYoZGlmZiA+IDApIHsNCgkJCQkJCQkJaWYoY29udGV4dC5jdXJyZW50SW5kZXggPiAwKQ0KCQkJCQkJCQkJbW92ZVByZXZpb3VzKGNvbnRleHQpOw0KCQkJCQkJCQllbHNlDQoJCQkJCQkJCQltb3ZlVG8oY29udGV4dCwgY29udGV4dC5saXN0SXRlbXMubGVuZ3RoIC0gMSk7DQoJCQkJCQkJfQ0KCQkJCQkJCWVsc2UgaWYoZGlmZiA8PSAwKSB7DQoJCQkJCQkJCWlmKGNvbnRleHQuY3VycmVudEluZGV4IDwgY29udGV4dC5saXN0SXRlbXMubGVuZ3RoIC0gMSkNCgkJCQkJCQkJCW1vdmVOZXh0KGNvbnRleHQpOw0KCQkJCQkJCQllbHNlDQoJCQkJCQkJCQltb3ZlVG8oY29udGV4dCwgMCk7DQoJCQkJCQkJfQ0KCQkJCQkJCWVsc2Ugew0KCQkJCQkJCQltb3ZlVG8oY29udGV4dCwgY29udGV4dC5jdXJyZW50SW5kZXggfHwgMCk7DQoJCQkJCQkJfQ0KCQkJCQkJCXJldHVybiBmYWxzZTsNCgkJCQkJCX0gZWxzZSB7DQoJCQkJCQkJbW92ZVRvKGNvbnRleHQsIGNvbnRleHQuY3VycmVudEluZGV4IHx8IDApOw0KCQkJCQkJfQ0KCQkJCQkJY29udGV4dC5wYW5uaW5nID0gZmFsc2U7DQoJCQkJCQlzdGFydFJlc2V0QXV0b1BhZ2UoY29udGV4dCk7DQoJCQkJCX0NCgkJCQl9KTsNCg0KCQkJZnVsbFdpZHRoID0gZnVsbFdpZHRoICsgd2lkdGg7DQoJCX0pDQoNCgkJaWYoIWNvbnRleHQubGlzdEl0ZW1zIHx8IGNvbnRleHQubGlzdEl0ZW1zLmxlbmd0aCA9PSAwKQ0KCQkJcmV0dXJuOw0KDQoJCWNvbnRleHQuc2hvdWxkSGFuZGxlR2VzdHVyZXMgPSBjb250ZXh0Lmxpc3RJdGVtcy5sZW5ndGggPiAxOw0KDQoJCS8vIG1ha2UgdGhlIHdyYXBwZXINCgkJY29udGV4dC5saXN0LmNzcyh7DQoJCQkncG9zaXRpb24nOiAncmVsYXRpdmUnLA0KCQkJJ3dpZHRoJzogZnVsbFdpZHRoDQoJCX0pOw0KDQoJCWNvbnRleHQubGlzdFdyYXBwZXIuZXZvbHV0aW9uVHJhbnNmb3JtKHsNCgkJCW9wYWNpdHk6IDENCgkJfSwgew0KCQkJZHVyYXRpb246IDIwMA0KCQl9KTsNCg0KCQljb250ZXh0LnN1cHByZXNzUGFubmluZyA9IGZhbHNlOw0KCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnN1YnNjcmliZSgnbW9iaWxlLm5hdmlnYXRpb24ub3BlbmVkJywgZnVuY3Rpb24oKXsNCgkJCXNldFRpbWVvdXQoZnVuY3Rpb24oKXsNCgkJCQljb250ZXh0LnN1cHByZXNzUGFubmluZyA9IHRydWU7DQoJCQl9LCAxMCkNCgkJfSkNCgkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ21vYmlsZS5uYXZpZ2F0aW9uLmNsb3NlZCcsIGZ1bmN0aW9uKCl7DQoJCQljb250ZXh0LnN1cHByZXNzUGFubmluZyA9IGZhbHNlOw0KCQl9KQ0KCX0NCg0KCWZ1bmN0aW9uIG1vdmVUbyhjb250ZXh0LCBpbmRleCkgew0KCQlnbG9iYWwuY2xlYXJUaW1lb3V0KGNvbnRleHQubW92ZURlYm91bmNlKTsNCgkJY29udGV4dC5tb3ZlRGVib3VuY2UgPSBnbG9iYWwuc2V0VGltZW91dChmdW5jdGlvbigpew0KCQkJLy8gbm9ybWFsaXplIGluZGV4DQoJCQlpZihpbmRleCA+PSBjb250ZXh0Lmxpc3RJdGVtcy5sZW5ndGgpDQoJCQkJaW5kZXggPSBjb250ZXh0Lmxpc3RJdGVtcy5sZW5ndGggLSAxOw0KCQkJZWxzZSBpZihpbmRleCA8IDApDQoJCQkJaW5kZXggPSAwOw0KCQkJY29udGV4dC5jdXJyZW50SW5kZXggPSBpbmRleDsNCg0KCQkJc2V0VGltZW91dChmdW5jdGlvbigpew0KCQkJCWNvbnRleHQubGlzdC5ldm9sdXRpb25UcmFuc2Zvcm0oew0KCQkJCQlsZWZ0OiAtMSAqIGNvbnRleHQubGlzdEl0ZW1zW2luZGV4XS5vZmZzZXQNCgkJCQl9LCB7DQoJCQkJCWR1cmF0aW9uOiAyMDANCgkJCQl9KTsNCgkJCX0sIDEpDQoNCgkJCWNvbnRleHQuZmVhdHVyZUxpbmtzLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTsNCgkJCSQoY29udGV4dC5mZWF0dXJlTGlua3MuZ2V0KGluZGV4KSkuYWRkQ2xhc3MoJ2FjdGl2ZScpOw0KCQkJY29udGV4dC5wYW5uaW5nID0gZmFsc2U7DQoJCX0sIDI1KTsNCgl9DQoNCglmdW5jdGlvbiBtb3ZlTmV4dChjb250ZXh0KSB7DQoJCWlmKChjb250ZXh0LmN1cnJlbnRJbmRleCB8fCAwKSA+PSBjb250ZXh0Lmxpc3RJdGVtcy5sZW5ndGggLSAxKQ0KCQkJbW92ZVRvKGNvbnRleHQsIDApOw0KCQllbHNlDQoJCQltb3ZlVG8oY29udGV4dCwgKGNvbnRleHQuY3VycmVudEluZGV4IHx8IDApICsgMSk7DQoJfQ0KDQoJZnVuY3Rpb24gbW92ZVByZXZpb3VzKGNvbnRleHQpIHsNCgkJaWYoKGNvbnRleHQuY3VycmVudEluZGV4IHx8IDApIDw9IDApDQoJCQltb3ZlVG8oY29udGV4dCwgY29udGV4dC5saXN0SXRlbXMubGVuZ3RoIC0gMSk7DQoJCWVsc2UNCgkJCW1vdmVUbyhjb250ZXh0LCAoY29udGV4dC5jdXJyZW50SW5kZXggfHwgMCkgLSAxKTsNCgl9DQoNCglmdW5jdGlvbiBpbml0UGFnaW5nKGNvbnRleHQpIHsNCgkJLy8gZm9yd2FyZC9iYWNrDQoJCWNvbnRleHQubmV4dCA9ICQoY29udGV4dC5uZXh0SWQpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpew0KCQkJZS5wcmV2ZW50RGVmYXVsdCgpOw0KCQkJbW92ZU5leHQoY29udGV4dCk7DQoJCQlzdGFydFJlc2V0QXV0b1BhZ2UoY29udGV4dCk7DQoJCX0pOw0KCQljb250ZXh0LnByZXZpb3VzID0gJChjb250ZXh0LnByZXZpb3VzSWQpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpew0KCQkJZS5wcmV2ZW50RGVmYXVsdCgpOw0KCQkJbW92ZVByZXZpb3VzKGNvbnRleHQpOw0KCQkJc3RhcnRSZXNldEF1dG9QYWdlKGNvbnRleHQpOw0KCQl9KTsNCg0KCQkvLyBzaW5nbGUgaXRlbSBwYWdpbmcNCgkJY29udGV4dC53cmFwcGVyLm9uKCdjbGljaycsICcuZmVhdHVyZS1saW5rJywgZnVuY3Rpb24oZSl7DQoJCQllLnByZXZlbnREZWZhdWx0KCk7DQoJCQltb3ZlVG8oY29udGV4dCwgJCh0aGlzKS5kYXRhKCdmZWF0dXJlaW5kZXgnKSk7DQoJCX0pOw0KCX0NCg0KCWZ1bmN0aW9uIHN0YXJ0UmVzZXRBdXRvUGFnZShjb250ZXh0KSB7DQoJCWdsb2JhbC5jbGVhclRpbWVvdXQoY29udGV4dC5hdXRvSGFuZGxlKTsNCgkJaWYgKGNvbnRleHQuYXV0b21hdGljKSB7DQoJCQljb250ZXh0LmF1dG9IYW5kbGUgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7DQoJCQkJaWYoIWNvbnRleHQucGFubmluZykNCgkJCQkJbW92ZU5leHQoY29udGV4dCk7DQoNCgkJCQlzdGFydFJlc2V0QXV0b1BhZ2UoY29udGV4dCk7DQoJCQl9LCBjb250ZXh0LmR1cmF0aW9uKTsNCgkJfQ0KCX0NCg0KCWZ1bmN0aW9uIHN0b3BBdXRvUGFnZShjb250ZXh0KSB7DQoJCWdsb2JhbC5jbGVhclRpbWVvdXQoY29udGV4dC5hdXRvSGFuZGxlKTsNCgl9DQoNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5mZWF0dXJlZENvbnRlbnRMaXN0ID0gew0KCQlyZWdpc3RlcjogZnVuY3Rpb24ob3B0aW9ucykgew0KCQkJLy8gY29sbGVjdCBVSSBlbGVtZW50cw0KCQkJb3B0aW9ucy53cmFwcGVyID0gJChvcHRpb25zLndyYXBwZXIpOw0KCQkJb3B0aW9ucy5saXN0ID0gb3B0aW9ucy53cmFwcGVyLmZpbmQoJy5jb250ZW50LWxpc3QnKTsNCgkJCW9wdGlvbnMubGlzdFdyYXBwZXIgPSBvcHRpb25zLmxpc3QucGFyZW50KCcuY29udGVudC1saXN0LXdyYXBwZXInKTsNCgkJCW9wdGlvbnMuZmVhdHVyZUxpbmtzID0gb3B0aW9ucy53cmFwcGVyLmZpbmQoJy5mZWF0dXJlLWxpbmtzIGEnKTsNCgkJCW9wdGlvbnMubGFzdE1vdmUgPSBuZXcgRGF0ZSgpOw0KDQoJCQkvLyBpbml0DQoJCQlpbml0KG9wdGlvbnMsIGZhbHNlKTsNCgkJCWlmKCFvcHRpb25zLmxpc3RJdGVtcyB8fCBvcHRpb25zLmxpc3RJdGVtcy5sZW5ndGggPT0gMCkNCgkJCQlyZXR1cm47DQoJCQltb3ZlVG8ob3B0aW9ucywgMCk7DQoJCQkkKHdpbmRvdykub24oJ3Jlc2l6ZWQnLCBmdW5jdGlvbigpew0KCQkJCWluaXQob3B0aW9ucywgdHJ1ZSk7DQoJCQkJaWYob3B0aW9ucy5jdXJyZW50SW5kZXgpDQoJCQkJCW1vdmVUbyhvcHRpb25zLCBvcHRpb25zLmN1cnJlbnRJbmRleCk7DQoJCQl9KTsNCg0KCQkJaW5pdFBhZ2luZyhvcHRpb25zKTsNCgkJCXN0YXJ0UmVzZXRBdXRvUGFnZShvcHRpb25zKTsNCgkJfQ0KCX07DQoNCn0pKGpRdWVyeSwgd2luZG93KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:ForumList_Name}" version="7.0.0.1" description="" instanceIdentifier="59feef7f27aa473180bb52071008660b" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="forum-list">
    <contentScript>
		
#set($groupId = false)
#set($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#if (!$groupId)
	$core_v2_widget.Hide()
#end

#set($group = $core_v2_group.Get("%{Id=$groupId}"))
&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($group.Url)"&gt;$group.Name&lt;/a&gt;
		&lt;h1&gt;$core_v2_language.GetResource('forums')&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 40, 40, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
&lt;/div&gt;

## load and render forums
&lt;div class="post-list forums"&gt;
	#set($pageIndex = 0)
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.forumList.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))'
		});
	});
})
&lt;/script&gt;
		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="ForumList_Name">Forum List</resource>
		<resource name="no_forums">There are no forums in this group.</resource>
		<resource name="no_threads">No threads</resource>
		<resource name="thread_count">{0} thread</resource>
		<resource name="threads_count">{0} threads</resource>
		<resource name="forums">Forums</resource>
	  </language>
	</languageResources>
    <files>
      <file name="list.vm">I3NldCgkZm9ydW1zID0gJGNvcmVfdjJfZm9ydW0uTGlzdCgiJXtHcm91cElkPSRncm91cElkLFBhZ2VJbmRleD0kcGFnZUluZGV4LFBhZ2VTaXplPTIwLFNvcnRCeT0nTGFzdFBvc3QnLFNvcnRPcmRlcj0nRGVzY2VuZGluZyd9IikpCiNmb3JlYWNoKCRmb3J1bSBpbiAkZm9ydW1zKQojZWFjaAoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIGZvcnVtIiBkYXRhLXRhcmdldHVybD0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkZm9ydW0uVXJsKSI+CgkJPGRpdiBjbGFzcz0icG9zdCB3aXRob3V0LWF2YXRhciI+CgkJCTxkaXYgY2xhc3M9ImRldGFpbHMiPgoJCQkJI2lmICgkZm9ydW0uTGF0ZXN0UG9zdERhdGUpCgkJCQkJPGRpdiBjbGFzcz0iZGF0ZSI+JGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0QWdvRGF0ZSgkZm9ydW0uTGF0ZXN0UG9zdERhdGUpPC9kaXY+CgkJCQkjZW5kCgkJCTwvZGl2PgoJCQk8ZGl2IGNsYXNzPSJjb250ZW50Ij4KCQkJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJGZvcnVtLlVybCkiPiRmb3J1bS5OYW1lPC9hPgoJCQk8L2Rpdj4KCQkJPGRpdiBjbGFzcz0iYWN0aW9ucyI+CgkJCQk8dWw+CgkJCQkJPGxpPgoJCQkJCQk8c3BhbiBjbGFzcz0iZGV0YWlsIHRocmVhZHMiPgoJCQkJCQkJI2lmICgkZm9ydW0uVGhyZWFkQ291bnQgPT0gMCkKCQkJCQkJCQkkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbm9fdGhyZWFkcycpCgkJCQkJCQkjZWxzZWlmICgkZm9ydW0uVGhyZWFkQ291bnQgPT0gMSkKCQkJCQkJCQkkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRTdHJpbmcoJGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ3RocmVhZF9jb3VudCcpLCAkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXROdW1iZXIoJGZvcnVtLlRocmVhZENvdW50KSkKCQkJCQkJCSNlbHNlCgkJCQkJCQkJJGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0U3RyaW5nKCRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCd0aHJlYWRzX2NvdW50JyksICRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdE51bWJlcigkZm9ydW0uVGhyZWFkQ291bnQpKQoJCQkJCQkJI2VuZAoJCQkJCQk8L3NwYW4+CgkJCQkJPC9saT4KCQkJCTwvdWw+CgkJCTwvZGl2PgoJCTwvZGl2PgoJPC9kaXY+CiNub2RhdGEKCTxkaXYgY2xhc3M9InBvc3QtbGlzdC1pdGVtIGNvbnRlbnQtaXRlbSBmb3J1bSI+PGRpdiBjbGFzcz0ibWVzc2FnZSBub3JlY29yZHMiPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdub19mb3J1bXMnKTwvZGl2PjwvZGl2PgojYWZ0ZXJhbGwKCSNzZXQgKCRoYXNNb3JlID0gZmFsc2UpCgkjaWYgKCRmb3J1bXMuVG90YWxDb3VudCA+ICgoJGZvcnVtcy5QYWdlSW5kZXggKyAxKSAqICRmb3J1bXMuUGFnZVNpemUpKQoJCSNzZXQoJGhhc01vcmUgPSB0cnVlKQoJI2VuZAoJPGRpdiBjbGFzcz0iZGF0YSIgI2lmKCRoYXNNb3JlKWRhdGEtaGFzbW9yZT0idHJ1ZSIjZW5kPjwvZGl2PgojZW5k</file>
      <file name="more.vm">IyMKIyMgQWpheCBjYWxsYmFjayBmb3IgbG9hZGluZyBtb3JlIGZvcnVtcwojIwojc2V0ICgkcGFnZUluZGV4ID0gJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X3BhZ2VJbmRleCcpKQojc2V0KCRncm91cElkID0gZmFsc2UpCiNzZXQoJGdyb3VwSWQgPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlSW50KCRtb2JpbGVfdjFfdXJsVG9rZW4uVmFsdWUoJ0dyb3VwSWQnKSkpCiNpZiAoISRncm91cElkKQoJJGNvcmVfdjJfd2lkZ2V0LkhpZGUoKQojZW5kCiRjb3JlX3YyX3dpZGdldC5FeGVjdXRlRmlsZSgnbGlzdC52bScpCg==</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpewoKCXZhciBhcGkgPSB7CgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zY3JvbGxhYmxlKHsKCQkJCXJlZ2lvbjogJ2NvbnRlbnQnLAoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgewoJCQkJCWlmICgkKG9wdGlvbnMud3JhcHBlciArICcgZGl2LmRhdGE6bGFzdCcpLmRhdGEoJ2hhc21vcmUnKSkgewoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsKCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLAoJCQkJCQkJZGF0YTogewoJCQkJCQkJCXdfcGFnZUluZGV4OiBwYWdlSW5kZXgKCQkJCQkJCX0sCgkJCQkJCQlzdWNjZXNzOiBmdW5jdGlvbihyKSB7CgkJCQkJCQkJc3VjY2VzcyhyKTsKCQkJCQkJCX0sCgkJCQkJCQllcnJvcjogZnVuY3Rpb24oKSB7CgkJCQkJCQkJZXJyb3IoKTsKCQkJCQkJCX0KCQkJCQkJfSk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJc3VjY2VzcygpOwoJCQkJCX0KCQkJCX0sCgkJCQljb21wbGV0ZTogZnVuY3Rpb24oY29udGVudCkgewoJCQkJCWNvbnRlbnQgPSAkKGNvbnRlbnQpLmNzcyh7IG9wYWNpdHk6IDAgfSk7CgkJCQkJJChvcHRpb25zLndyYXBwZXIpLmZpbmQoJ2Rpdi5wb3N0LWxpc3QnKS5hcHBlbmQoY29udGVudCk7CgkJCQkJY29udGVudC5ldm9sdXRpb25UcmFuc2Zvcm0oeyBvcGFjaXR5OiAxIH0sIHsgZHVyYXRpb246IDQwMCB9KTsKCQkJCX0KCQkJfSk7CgkJfQoJfQoKCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24gPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24gfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyA9ICQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzIHx8IHt9OwoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMuZm9ydW1MaXN0ID0gYXBpOwoKfSkoalF1ZXJ5KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:ForumThread_Name}" version="7.0.0.1" description="" instanceIdentifier="70eb79f7675b42078f78355560839784" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="forumthread">
    <contentScript>
		
$!core_v2_utility.Wait(1000)

#set($threadId = false)
#set($threadId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('ForumThreadId')))
#if (!$threadId)
	$core_v2_widget.Hide()
#end

#set ($accessingUser = $core_v2_user.Accessing)
#set ($accessingUserIsRegistered = false)
#if ($core_v2_user.IsRegistered($accessingUser.Id))
	#set ($accessingUserIsRegistered = true)
#end

#set($thread = $core_v2_forumThread.Get($threadId))
#set($forum = $core_v2_forum.Get($thread.ForumId))

#set ($canEditThread = false)
#set ($canEditThread = $core_v2_nodePermission.Get("forums", $thread.ForumId, "Forum_ModifyPost", "%{ PostId = '${threadId}', PostType = 'threads'}").IsAllowed)

#set ($canDeleteThread = false)
#set ($canDeleteThread = $core_v2_nodePermission.Get("forums", $thread.ForumId, "Forum_DeletePost", "%{ PostId = '${threadId}', PostType = 'threads'}").IsAllowed)

#set($replyId = false)
#set($replyId = $core_v2_utility.ParseInt($core_v2_page.GetQueryStringValue('ForumReplyId')))

&lt;div class="post topic full#if($thread.ThreadType == 'QuestionAndAnswer' &amp;&amp; $thread.ThreadStatus == 'Answered') with-filter#end"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($forum.Group.Url)"&gt;&lt;span&gt;$forum.Group.Name&lt;/span&gt;&lt;/a&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($forum.Url)"&gt;&lt;span&gt;$forum.Name&lt;/span&gt;&lt;/a&gt;
	&lt;/div&gt;
	&lt;h1&gt;$thread.Subject&lt;/h1&gt;
	&lt;div class="details"&gt;
		&lt;div class="date"&gt;$core_v2_language.FormatAgoDate($thread.Date)&lt;/div&gt;
		&lt;div class="avatar"&gt;
			#if ($thread.Author.ProfileUrl)
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($thread.Author.ProfileUrl)" class="internal-link view-user-profile"&gt;
					$core_v2_ui.GetResizedImageHtml($thread.Author.AvatarUrl, 24, 24, "%{border='0', alt=$thread.Author.DisplayName, ResizeMethod='ZoomAndCrop',border='0'}")
				&lt;/a&gt;
			#else
				$core_v2_ui.GetResizedImageHtml($thread.Author.AvatarUrl, 24, 24, "%{border='0', alt=$thread.Author.DisplayName, ResizeMethod='ZoomAndCrop',border='0'}")
			#end
		&lt;/div&gt;
		&lt;div class="author"&gt;
			#if ($thread.Author.ProfileUrl)
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($thread.Author.ProfileUrl)" class="internal-link view-user-profile"&gt;
					$thread.Author.DisplayName
				&lt;/a&gt;
			#else
				$thread.Author.DisplayName
			#end
		&lt;/div&gt;
	&lt;/div&gt;
	&lt;div class="content"&gt;
		&lt;div class="user-generated-content"&gt;
			$mobile_v1_dataFormat.Detect($thread.Body('Web'))
		&lt;/div&gt;
		#if ($thread.File)
			&lt;p&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($thread.File.FileUrl)" class="internal-link download-attachment"&gt;$thread.File.FileName&lt;/a&gt;&lt;/p&gt;
		#end
		#if($thread.EmailFiles &amp;&amp; $thread.EmailFiles.Count &gt; 0)
			#foreach($emailFile in $thread.EmailFiles)
				&lt;p&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($emailFile.DownloadUrl)" class="internal-link download-attachment"&gt;$emailFile.FileName&lt;/a&gt;&lt;/p&gt;
			#end
		#end
	&lt;/div&gt;
	#set($showLikes = false)
	#if($accessingUserIsRegistered &amp;&amp; $core_v2_like.CanLike($thread.ContentId, $core_v2_forumThread.ContentTypeId))
		#set($showLikes = true)
	#end
	#set($canReply = false)
	#set($canReply = $core_v2_nodePermission.Get("forums", $forum.Id, "Forum_CreateReply", "%{ PostId = '${postId}', PostType = 'threads'}").IsAllowed)
	#set($maxLinkCount = 0)
	#if ($showLikes)
		#set($maxLinkCount = $maxLinkCount + 1)
	#end
	#if ($canReply)
		#set($maxLinkCount = $maxLinkCount + 1)
	#end
	&lt;div class="actions ui-links" data-minlinks="0" data-maxlinks="$maxLinkCount"&gt;
		&lt;ul&gt;
			#if ($accessingUserIsRegistered &amp;&amp; $core_v2_like.CanLike($thread.ContentId, $core_v2_forumThread.ContentTypeId))
				&lt;li class="action-like"&gt;
					#set($format = '{toggle} &lt;span class="count"&gt;&lt;span class="icon"&gt;&lt;/span&gt;{count}&lt;/span&gt;')
					$core_v2_ui.Like($thread.ContentId, $core_v2_forumThread.ContentTypeId, "%{ Format = '$format' }")
				&lt;/li&gt;
			#end

			#if ($canReply)
				&lt;li class="action-reply"&gt;
					&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('forumthread-addreply', $thread.Id))" class="comment"&gt;$core_v2_language.GetResource('reply')&lt;/a&gt;
				&lt;/li&gt;
			#end

			#if ($canEditThread)
				&lt;li&gt;
					&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('forumthread-edit', $thread.Id))"&gt;$core_v2_language.GetResource('edit')&lt;/a&gt;
				&lt;/li&gt;
			#end
			#if ($canDeleteThread)
				&lt;li&gt;
					&lt;a href="#" data-messagename="forumreply.delete-thread"&gt;$core_v2_language.GetResource('delete')&lt;/a&gt;
				&lt;/li&gt;
			#end

			#if ($accessingUserIsRegistered &amp;&amp; $core_v2_bookmark.CanBookmark($thread.ContentId, $core_v2_forumThread.ContentTypeId))
				&lt;li&gt;
					$core_v2_ui.Bookmark($thread.ContentId, $core_v2_forumThread.ContentTypeId)
				&lt;/li&gt;
			#end&gt;
			&lt;li class="action-moderate"&gt;$core_v2_ui.Moderate($thread.ContentId, $core_v2_forumThread.ContentTypeId)&lt;/li&gt;

			&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;&lt;/a&gt;&lt;/li&gt;
			&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
		&lt;/ul&gt;
	&lt;/div&gt;
&lt;/div&gt;

#set($filter = false)
#set($filter = $core_v2_page.GetQueryStringValue('w_filter'))
#if ($thread.ThreadType == 'QuestionAndAnswer' &amp;&amp; $thread.ThreadStatus == 'Answered')
	#if (!$filter)
		#if(!$replyId || $replyId &lt; 0)
			#set($filter = 'verified-answers')
		#else
			#set($filter = '')
		#end
	#end
	&lt;div class="ui-links filters content" data-minlinks="100" data-animate="true"&gt;
		&lt;ul&gt;
			&lt;li&gt;&lt;a href="#" data-filter="verified-answers"#if($filter == 'verified-answers') data-selected#end&gt;&lt;span&gt;&lt;/span&gt;$core_v2_language.GetResource('answers_only')&lt;/a&gt;&lt;/li&gt;
			&lt;li&gt;&lt;a href="#" data-filter=""#if($filter == '') data-selected#end&gt;$core_v2_language.GetResource('all_replies')&lt;/a&gt;&lt;/li&gt;
		&lt;/ul&gt;
	&lt;/div&gt;
#else
	#set($filter = '')
	&lt;div class="reply-count content"&gt;
		#if ($thread.ReplyCount == 1)
			#set ($countResource = 'ReplyCount_Singular')
		#else
			#set ($countResource = "ReplyCount_Plural")
		#end
		$core_v2_language.FormatString($core_v2_language.GetResource($countResource), $core_v2_language.FormatNumber($thread.ReplyCount))
	&lt;/div&gt;
#end

&lt;div class="post-list replies"&gt;
	#set($pageIndex = 0)
	#set($replies = $core_v2_forumReply.List($threadId, "%{ForumReplyQueryType=$filter,PageSize=5,PageIndex=$pageIndex,IncludeThreadStarter='False'}"))
	#set($lastPageIndex = $replies.TotalCount / 5)
	#if ($lastPageIndex * 5 &gt;= $replies.TotalCount)
		#set($lastPageIndex = $lastPageIndex - 1)
	#end
	#set($pageIndex = $lastPageIndex)
	#if ($replyId &gt; 0)
		#set($replyPageIndex = $core_v2_forumReply.GetForumReplyPageIndex($threadId, $replyId, "%{ForumReplyQueryType=$filter,PageSize=5,IncludeThreadStarter='False'}"))
		#set($pageIndex = $replyPageIndex)
	#end

	#if ($pageIndex &gt;= 1)
		#set($replies = false)
	#end

	$core_v2_widget.ExecuteFile("list.vm")

	#if ($pageIndex &lt; $lastPageIndex)
		#set($targetPageIndex = $pageIndex + 1)
		&lt;a href="#" data-pageindex="$targetPageIndex" data-lastpageindex="$lastPageIndex" class="view-more"&gt;$core_v2_language.GetResource('reply_load_more')&lt;/a&gt;
	#end
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.forumThread.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
			forumUrl: '$core_v2_encoding.JavascriptEncode($forum.Url)',
			filter: '$filter',
			forumId: '$forum.Id',
			threadId: '$thread.Id',
			replyId: #if($replyId) $replyId#else null#end,
			markAsAnswerText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('mark_as_answer'))',
			markAsNotAnswerText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('mark_as_not_answer'))',
			replyDeleteConfirmation: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('reply_delete_confirmation'))',
			threadDeleteConfirmation: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('thread_delete_confirmation'))'
		});
	});
})
&lt;/script&gt;
		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="ForumThread_Name">Forum Thread</resource>
		<resource name="no_forums">There are no forums in this group.</resource>
		<resource name="no_replies">No replies</resource>
		<resource name="no_answers">There are no answers</resource>
		<resource name="answers_only">Answers Only</resource>
		<resource name="all_replies">All Replies</resource>
		<resource name="mark_as_not_answer">Reject answer</resource>
		<resource name="mark_as_answer">Verify answer</resource>
		<resource name="accept_answer">Accept answer</resource>
		<resource name="reject_answer">Reject answer</resource>
		<resource name="answer">Answer</resource>
		<resource name="suggested_answer">Suggested Answer</resource>
		<resource name="reply">Reply</resource>
		<resource name="edit">Edit</resource>
		<resource name="delete">Delete</resource>
		<resource name="cancel">Cancel</resource>
		<resource name="reply_delete_confirmation">Are you sure you want to delete this reply?</resource>
		<resource name="thread_delete_confirmation">Are you sure you want to delete this thread?</resource>
		<resource name="reply_load_more">Load more replies...</resource>
		<resource name="InReplyTo">In reply to &lt;a href="{0}"&gt;{1}&lt;/a&gt;:</resource>
		<resource name="ReplyCount_Singular">{0} Reply</resource>
		<resource name="ReplyCount_Plural">{0} Replies</resource>
	  </language>
	</languageResources>
    <files>
      <file name="list.vm">I2lmICghJHJlcGxpZXMpCgkjc2V0KCRyZXBsaWVzID0gJGNvcmVfdjJfZm9ydW1SZXBseS5MaXN0KCR0aHJlYWRJZCwgIiV7Rm9ydW1SZXBseVF1ZXJ5VHlwZT0kZmlsdGVyLFBhZ2VTaXplPTUsUGFnZUluZGV4PSRwYWdlSW5kZXgsSW5jbHVkZVRocmVhZFN0YXJ0ZXI9J0ZhbHNlJ30iKSkKI2VuZAojaWYgKCRwYWdlSW5kZXggPiAwKQoJI3NldCgkdGFyZ2V0UGFnZUluZGV4ID0gJHBhZ2VJbmRleCAtIDEpCgk8YSBocmVmPSIjIiBkYXRhLXBhZ2VpbmRleD0iJHRhcmdldFBhZ2VJbmRleCIgY2xhc3M9InZpZXctbW9yZSI+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ3JlcGx5X2xvYWRfbW9yZScpPC9hPgojZW5kCiNmb3JlYWNoKCRyZXBseSBpbiAkcmVwbGllcykKI2VhY2gKCSNzZXQgKCRjYW5FZGl0UmVwbHkgPSBmYWxzZSkKCSNzZXQgKCRjYW5FZGl0UmVwbHkgPSAkY29yZV92Ml9ub2RlUGVybWlzc2lvbi5HZXQoImZvcnVtcyIsICRmb3J1bS5JZCwgIkZvcnVtX01vZGlmeVBvc3QiLCAiJXsgUG9zdElkID0gJyR7cmVwbHkuSWR9JywgUG9zdFR5cGUgPSAncmVwbGllcyd9IikuSXNBbGxvd2VkKQoKCSNzZXQgKCRjYW5EZWxldGVSZXBseSA9IGZhbHNlKQoJI3NldCAoJGNhbkRlbGV0ZVJlcGx5ID0gJGNvcmVfdjJfbm9kZVBlcm1pc3Npb24uR2V0KCJmb3J1bXMiLCAkZm9ydW0uSWQsICJGb3J1bV9EZWxldGVQb3N0IiwgIiV7IFBvc3RJZCA9ICcke3JlcGx5LklkfScsIFBvc3RUeXBlID0gJ3JlcGxpZXMnfSIpLklzQWxsb3dlZCkKCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gZm9ydW1yZXBseSAjaWYoJHRocmVhZC5UaHJlYWRUeXBlID09ICdRdWVzdGlvbkFuZEFuc3dlcicpI2lmICgkcmVwbHkuSXNBbnN3ZXIpIGFuc3dlciNlbHNlaWYoJHJlcGx5LklzU3VnZ2VzdGVkQW5zd2VyKSBzdWdnZXN0ZWQtYW5zd2VyI2VuZCNlbmQiIGRhdGEtcmVwbHlpZD0iJHJlcGx5LklkIj4KCQk8ZGl2IGNsYXNzPSJwb3N0IGZ1bGwiPgoJCQk8ZGl2IGNsYXNzPSJkZXRhaWxzIj4KCQkJCTxkaXYgY2xhc3M9ImRhdGUiPiRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdEFnb0RhdGUoJHJlcGx5LkRhdGUpPC9kaXY+CgkJCQk8ZGl2IGNsYXNzPSJhdmF0YXIiPgoJCQkJCSNpZiAoJHJlcGx5LkF1dGhvci5Qcm9maWxlVXJsKQoJCQkJCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRyZXBseS5BdXRob3IuUHJvZmlsZVVybCkiIGNsYXNzPSJpbnRlcm5hbC1saW5rIHZpZXctdXNlci1wcm9maWxlIj4KCQkJCQkJCQkJCSRjb3JlX3YyX3VpLkdldFJlc2l6ZWRJbWFnZUh0bWwoJHJlcGx5LkF1dGhvci5BdmF0YXJVcmwsIDI0LCAyNCwgIiV7Ym9yZGVyPScwJywgYWx0PSRyZXBseS5BdXRob3IuRGlzcGxheU5hbWUsIFJlc2l6ZU1ldGhvZD0nWm9vbUFuZENyb3AnLGJvcmRlcj0nMCd9IikKCQkJCQkJCQkJPC9hPgoJCQkJCQkJI2Vsc2UKCQkJCQkJCQkJJGNvcmVfdjJfdWkuR2V0UmVzaXplZEltYWdlSHRtbCgkcmVwbHkuQXV0aG9yLkF2YXRhclVybCwgMjQsIDI0LCAiJXtib3JkZXI9JzAnLCBhbHQ9JHJlcGx5LkF1dGhvci5EaXNwbGF5TmFtZSwgUmVzaXplTWV0aG9kPSdab29tQW5kQ3JvcCcsYm9yZGVyPScwJ30iKQoJCQkJCQkJI2VuZAoJCQkJPC9kaXY+CgkJCQk8ZGl2IGNsYXNzPSJhdXRob3IiPgoJCQkJCSNpZiAoJHJlcGx5LkF1dGhvci5Qcm9maWxlVXJsKQoJCQkJCQkJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJHJlcGx5LkF1dGhvci5Qcm9maWxlVXJsKSIgY2xhc3M9ImludGVybmFsLWxpbmsgdmlldy11c2VyLXByb2ZpbGUiPgoJCQkJCQkJCQkkcmVwbHkuQXV0aG9yLkRpc3BsYXlOYW1lCgkJCQkJCQkJPC9hPgoJCQkJCQkjZWxzZQoJCQkJCQkJCSRyZXBseS5BdXRob3IuRGlzcGxheU5hbWUKCQkJCQkJI2VuZAoJCQkJPC9kaXY+CgkJCTwvZGl2PgoJCQk8ZGl2IGNsYXNzPSJjb250ZW50Ij4KCQkJCTxkaXYgY2xhc3M9InVzZXItZ2VuZXJhdGVkLWNvbnRlbnQiPgoJCQkJCSNpZiAoJHJlcGx5LlBhcmVudElkICYmICRyZXBseS5QYXJlbnRJZCA+IDApCgkJCQkJCSNzZXQgKCRwYXJlbnQgPSBmYWxzZSkKCQkJCQkJI3NldCAoJHBhcmVudCA9ICRjb3JlX3YyX2ZvcnVtUmVwbHkuR2V0KCRyZXBseS5QYXJlbnRJZCkpCgkJCQkJCSNpZiAoJHBhcmVudCkKCQkJCQkJCSNpZiAoJHJlcGx5LklkID09ICRyZXBseS5QYXJlbnRJZCkKCQkJCQkJCQk8cCBjbGFzcz0iaW4tcmVwbHktdG8iPiRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdFN0cmluZygkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnSW5SZXBseVRvJyksICRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJHRocmVhZC5VcmwpLCAkdGhyZWFkLkF1dGhvci5EaXNwbGF5TmFtZSk8L3A+CgkJCQkJCQkjZWxzZQoJCQkJCQkJCTxwIGNsYXNzPSJpbi1yZXBseS10byI+JGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0U3RyaW5nKCRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdJblJlcGx5VG8nKSwgJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkcGFyZW50LlVybCksICRwYXJlbnQuQXV0aG9yLkRpc3BsYXlOYW1lKTwvcD4KCQkJCQkJCSNlbmQKCQkJCQkJI2VuZAoJCQkJCSNlbmQKCQkJCQkkbW9iaWxlX3YxX2RhdGFGb3JtYXQuRGV0ZWN0KCRyZXBseS5Cb2R5KCdXZWInKSkKCQkJCTwvZGl2PgoJCQkJI2lmICgkcmVwbHkuRmlsZSkKCQkJCQk8cD48YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRyZXBseS5GaWxlLkZpbGVVcmwpIiBjbGFzcz0iaW50ZXJuYWwtbGluayBkb3dubG9hZC1hdHRhY2htZW50Ij4kcmVwbHkuRmlsZS5GaWxlTmFtZTwvYT48L3A+CgkJCQkjZW5kCgkJCQkjaWYoJHJlcGx5LkVtYWlsRmlsZXMgJiYgJHJlcGx5LkVtYWlsRmlsZXMuQ291bnQgPiAwKQoJCQkJCSNmb3JlYWNoKCRlbWFpbEZpbGUgaW4gJHJlcGx5LkVtYWlsRmlsZXMpCgkJCQkJCTxwPjxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJGVtYWlsRmlsZS5Eb3dubG9hZFVybCkiIGNsYXNzPSJpbnRlcm5hbC1saW5rIGRvd25sb2FkLWF0dGFjaG1lbnQiPiRlbWFpbEZpbGUuRmlsZU5hbWU8L2E+PC9wPgoJCQkJCSNlbmQKCQkJCSNlbmQKCQkJPC9kaXY+CgkJCSNzZXQoJHNob3dMaWtlcyA9IGZhbHNlKQoJCQkjaWYoJGFjY2Vzc2luZ1VzZXJJc1JlZ2lzdGVyZWQgJiYgJGNvcmVfdjJfbGlrZS5DYW5MaWtlKCRyZXBseS5Db250ZW50SWQsICRjb3JlX3YyX2ZvcnVtUmVwbHkuQ29udGVudFR5cGVJZCkpCgkJCQkjc2V0KCRzaG93TGlrZXMgPSB0cnVlKQoJCQkjZW5kCgkJCSNzZXQoJGNhblJlcGx5ID0gJGNvcmVfdjJfbm9kZVBlcm1pc3Npb24uR2V0KCJmb3J1bXMiLCAkZm9ydW0uSWQsICJGb3J1bV9DcmVhdGVSZXBseSIsICIleyBQb3N0SWQgPSAnJHtyZXBseS5JZH0nLCBQb3N0VHlwZSA9ICdyZXBsaWVzJ30iKS5Jc0FsbG93ZWQpCgkJCSNzZXQoJG1heExpbmtDb3VudCA9IDApCgkJCSNpZiAoJHNob3dMaWtlcykKCQkJCSNzZXQoJG1heExpbmtDb3VudCA9ICRtYXhMaW5rQ291bnQgKyAxKQoJCQkjZW5kCgkJCSNpZiAoJGNhblJlcGx5KQoJCQkJI3NldCgkbWF4TGlua0NvdW50ID0gJG1heExpbmtDb3VudCArIDEpCgkJCSNlbmQKCQkJPGRpdiBjbGFzcz0iYWN0aW9ucyB1aS1saW5rcyIgZGF0YS1taW5saW5rcz0iMCIgZGF0YS1tYXhsaW5rcz0iJG1heExpbmtDb3VudCI+CgkJCQk8dWw+CgkJCQkJI2lmICgkc2hvd0xpa2VzKQoJCQkJCQk8bGkgY2xhc3M9ImFjdGlvbi1saWtlIj4KCQkJCQkJICAgI3NldCgkZm9ybWF0ID0gJ3t0b2dnbGV9IDxzcGFuIGNsYXNzPSJjb3VudCI+PHNwYW4gY2xhc3M9Imljb24iPjwvc3Bhbj57Y291bnR9PC9zcGFuPicpCgkJCQkJCSAgICRjb3JlX3YyX3VpLkxpa2UoJHJlcGx5LkNvbnRlbnRJZCwgJGNvcmVfdjJfZm9ydW1SZXBseS5Db250ZW50VHlwZUlkLCAiJXsgRm9ybWF0ID0gJGZvcm1hdCB9IikKCQkJCQkJPC9saT4KCQkJCQkjZW5kCgoJCQkJCSNpZigkY2FuUmVwbHkpCgkJCQkJCTxsaSBjbGFzcz0iYWN0aW9uLXJlcGx5Ij4KCQkJCQkJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJG1vYmlsZV92MV91cmwuRm9ybWF0KCdmb3J1bXJlcGx5LWFkZHJlcGx5JywgJHJlcGx5LklkKSkiIGNsYXNzPSJjb21tZW50Ij4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgncmVwbHknKTwvYT4KCQkJCQkJPC9saT4KCQkJCQkjZW5kCgoJCQkJCSNpZiAoJHRocmVhZC5UaHJlYWRUeXBlID09ICdRdWVzdGlvbkFuZEFuc3dlcicpCgkJCQkJCSNpZiAoJGNvcmVfdjJfbm9kZVBlcm1pc3Npb24uR2V0KCJmb3J1bXMiLCAkZm9ydW0uSWQsICJGb3J1bV9NYXJrQXNBbnN3ZXIiLCAiJXsgUG9zdElkID0gJyR7cmVwbHkuSWR9JywgUG9zdFR5cGUgPSAncmVwbGllcyd9IikuSXNBbGxvd2VkKQoJCQkJCQkJI2lmICgkcmVwbHkuSXNBbnN3ZXIpCgkJCQkJCQkJPGxpPjxhIGhyZWY9IiMiIGRhdGEtbWVzc2FnZW5hbWU9ImZvcnVtcmVwbHkuYW5zd2VyLWFjdGlvbiIgY2xhc3M9ImFuc3dlci1hY3Rpb24iIGRhdGEtYWN0aW9uPSJyZWplY3QtYW5zd2VyIiBkYXRhLXJlcGx5aWQ9IiRyZXBseS5JZCI+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ21hcmtfYXNfbm90X2Fuc3dlcicpPC9hPjwvbGk+CgkJCQkJCQkjZWxzZWlmICgkcmVwbHkuSXNTdWdnZXN0ZWRBbnN3ZXIpCgkJCQkJCQkJPGxpPjxhIGhyZWY9IiMiIGRhdGEtbWVzc2FnZW5hbWU9ImZvcnVtcmVwbHkuYW5zd2VyLWFjdGlvbiIgY2xhc3M9ImFuc3dlci1hY3Rpb24iIGRhdGEtYWN0aW9uPSJhY2NlcHQtYW5zd2VyIiBkYXRhLXJlcGx5aWQ9IiRyZXBseS5JZCI+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ2FjY2VwdF9hbnN3ZXInKTwvYT48L2xpPgoJCQkJCQkJCTxsaT48YSBocmVmPSIjIiBkYXRhLW1lc3NhZ2VuYW1lPSJmb3J1bXJlcGx5LmFuc3dlci1hY3Rpb24iIGNsYXNzPSJhbnN3ZXItYWN0aW9uIHNlY29uZC1saW5rIiBkYXRhLWFjdGlvbj0icmVqZWN0LWFuc3dlciIgZGF0YS1yZXBseWlkPSIkcmVwbHkuSWQiPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdyZWplY3RfYW5zd2VyJyk8L2E+PC9saT4KCQkJCQkJCSNlbHNlCgkJCQkJCQkJPGxpPjxhIGhyZWY9IiMiIGRhdGEtbWVzc2FnZW5hbWU9ImZvcnVtcmVwbHkuYW5zd2VyLWFjdGlvbiIgY2xhc3M9ImFuc3dlci1hY3Rpb24iIGRhdGEtYWN0aW9uPSJhY2NlcHQtYW5zd2VyIiBkYXRhLXJlcGx5aWQ9IiRyZXBseS5JZCI+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ21hcmtfYXNfYW5zd2VyJyk8L2E+PC9saT4KCQkJCQkJCSNlbmQKCQkJCQkJI2VuZAoJCQkJCSNlbmQKCgkJCQkJI2lmICgkY2FuRWRpdFJlcGx5KQoJCQkJCQk8bGk+CgkJCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRtb2JpbGVfdjFfdXJsLkZvcm1hdCgnZm9ydW1yZXBseS1lZGl0JywgJHJlcGx5LklkKSkiPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdlZGl0Jyk8L2E+CgkJCQkJCTwvbGk+CgkJCQkJI2VuZAoJCQkJCSNpZiAoJGNhbkRlbGV0ZVJlcGx5KQoJCQkJCQk8bGk+CgkJCQkJCQk8YSBocmVmPSIjIiBkYXRhLW1lc3NhZ2VuYW1lPSJmb3J1bXJlcGx5LmRlbGV0ZS1yZXBseSIgY2xhc3M9ImRlbGV0ZS1yZXBseSIgZGF0YS1yZXBseWlkPSIkcmVwbHkuSWQiPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdkZWxldGUnKTwvYT4KCQkJCQkJPC9saT4KCQkJCQkjZW5kCgoJCQkJCTxsaSBjbGFzcz0iYWN0aW9uLW1vZGVyYXRlIj4kY29yZV92Ml91aS5Nb2RlcmF0ZSgkcmVwbHkuQ29udGVudElkLCAkY29yZV92Ml9mb3J1bVJlcGx5LkNvbnRlbnRUeXBlSWQpPC9saT4KCgkJCQkJPGxpIGNsYXNzPSJhY3Rpb24tbW9yZSI+PGEgaHJlZj0iIyIgZGF0YS1tb3JlPjwvYT48L2xpPgoJCQkJCTxsaT48YSBocmVmPSIjIiBkYXRhLWNhbmNlbD4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnY2FuY2VsJyk8L2E+PC9saT4KCQkJCTwvdWw+CgkJCTwvZGl2PgoJCTwvZGl2PgoJPC9kaXY+CiNub2RhdGEKCTxkaXYgY2xhc3M9InBvc3QtbGlzdC1pdGVtIGNvbnRlbnQtaXRlbSBmb3J1bSI+PGRpdiBjbGFzcz0ibWVzc2FnZSBub3JlY29yZHMgZnVsbCI+CgkJI2lmICgkZmlsdGVyID09ICd2ZXJpZmllZC1hbnN3ZXJzJykKCQkJJGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ25vX2Fuc3dlcnMnKQoJCSNlbHNlCgkJCSRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdub19yZXBsaWVzJykKCQkjZW5kCgk8L2Rpdj48L2Rpdj4KI2VuZA==</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBmb3J1bXMNCiMjDQoNCiNzZXQgKCRhY2Nlc3NpbmdVc2VyID0gJGNvcmVfdjJfdXNlci5BY2Nlc3NpbmcpDQojc2V0ICgkYWNjZXNzaW5nVXNlcklzUmVnaXN0ZXJlZCA9IGZhbHNlKQ0KI2lmICgkY29yZV92Ml91c2VyLklzUmVnaXN0ZXJlZCgkYWNjZXNzaW5nVXNlci5JZCkpDQoJI3NldCAoJGFjY2Vzc2luZ1VzZXJJc1JlZ2lzdGVyZWQgPSB0cnVlKQ0KI2VuZA0KDQojc2V0ICgkZmlsdGVyID0gZmFsc2UpDQojc2V0ICgkZmlsdGVyID0gJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X2ZpbHRlcicpKQ0KI3NldCAoJHBhZ2VJbmRleCA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19wYWdlSW5kZXgnKSkNCiNzZXQoJHRocmVhZElkID0gZmFsc2UpDQojc2V0KCR0aHJlYWRJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJG1vYmlsZV92MV91cmxUb2tlbi5WYWx1ZSgnRm9ydW1UaHJlYWRJZCcpKSkNCiNpZiAoISR0aHJlYWRJZCkNCgkkY29yZV92Ml93aWRnZXQuSGlkZSgpDQojZW5kDQoNCiNzZXQoJHRocmVhZCA9ICRjb3JlX3YyX2ZvcnVtVGhyZWFkLkdldCgkdGhyZWFkSWQpKQ0KI3NldCgkZm9ydW0gPSAkY29yZV92Ml9mb3J1bS5HZXQoJHRocmVhZC5Gb3J1bUlkKSkNCiNzZXQoJHJlcGxpZXMgPSBmYWxzZSkNCg0KJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCdsaXN0LnZtJyk=</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIG1vZGVsID0gew0KCQl1cGRhdGVBbnN3ZXJTdGF0ZTogZnVuY3Rpb24gKGZvcnVtSWQsIHRocmVhZElkLCByZXBseUlkLCBpc0Fuc3dlcikgew0KCQkJcmV0dXJuICQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7DQoJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvZm9ydW1zL3tGb3J1bUlkfS90aHJlYWRzL3tUaHJlYWRJZH0vcmVwbGllcy97UmVwbHlJZH0uanNvbj9JbmNsdWRlRmllbGRzPVJlcGx5LklzQW5zd2VyLFJlcGx5LklzU3VnZ2VzdGVkQW5zd2VyJywNCgkJCQlkYXRhOiB7DQoJCQkJCUZvcnVtSWQ6IGZvcnVtSWQsDQoJCQkJCVRocmVhZElkOiB0aHJlYWRJZCwNCgkJCQkJcmVwbHlJZDogcmVwbHlJZCwNCgkJCQkJSXNBbnN3ZXI6IGlzQW5zd2VyLA0KCQkJCQlJc1N1Z2dlc3RlZEFuc3dlcjogZmFsc2UNCgkJCQl9DQoJCQl9KSk7DQoJCX0sDQoJCWRlbGV0ZVJlcGx5OiBmdW5jdGlvbihmb3J1bUlkLCB0aHJlYWRJZCwgcmVwbHlJZCkgew0KCQkJcmV0dXJuICQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoJC50ZWxsaWdlbnQuZXZvbHV0aW9uLmRlbCh7DQoJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvZm9ydW1zL3tGb3J1bUlkfS90aHJlYWRzL3tUaHJlYWRJZH0vcmVwbGllcy97UmVwbHlJZH0uanNvbicsDQoJCQkJZGF0YTogew0KCQkJCQlGb3J1bUlkOiBmb3J1bUlkLA0KCQkJCQlUaHJlYWRJZDogdGhyZWFkSWQsDQoJCQkJCVJlcGx5SWQ6IHJlcGx5SWQsDQoJCQkJCURlbGV0ZUNoaWxkcmVuOiBmYWxzZSwNCgkJCQkJU2VuZEF1dGhvckRlbGV0ZU5vdGlmaWNhdGlvbjogZmFsc2UNCgkJCQl9DQoJCQl9KSk7DQoJCX0sDQoJCWRlbGV0ZVRocmVhZDogZnVuY3Rpb24oZm9ydW1JZCwgdGhyZWFkSWQpIHsNCgkJCXJldHVybiAkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNob3dMb2FkaW5nKCQudGVsbGlnZW50LmV2b2x1dGlvbi5kZWwoew0KCQkJCXVybDogJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ2FwaS5hc2h4L3YyL2ZvcnVtcy97Rm9ydW1JZH0vdGhyZWFkcy97VGhyZWFkSWR9Lmpzb24nLA0KCQkJCWRhdGE6IHsNCgkJCQkJRm9ydW1JZDogZm9ydW1JZCwNCgkJCQkJVGhyZWFkSWQ6IHRocmVhZElkLA0KCQkJCQlEZWxldGVDaGlsZHJlbjogdHJ1ZSwNCgkJCQkJU2VuZEF1dGhvckRlbGV0ZU5vdGlmaWNhdGlvbjogZmFsc2UNCgkJCQl9DQoJCQl9KSk7DQoJCX0NCgl9DQoNCglmdW5jdGlvbiBoYW5kbGVSZXBseURlbGV0aW9uRXZlbnRzKG9wdGlvbnMpIHsNCgkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ2ZvcnVtcmVwbHkuZGVsZXRlLXJlcGx5JywgZnVuY3Rpb24oZGF0YSl7DQoJCQl2YXIgYSA9ICQoZGF0YS50YXJnZXQpOw0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlU2hlZXQoKTsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuY29uZmlybShvcHRpb25zLnJlcGx5RGVsZXRlQ29uZmlybWF0aW9uLCBmdW5jdGlvbihjb25maXJtZWQpIHsNCgkJCQlpZiAoY29uZmlybWVkKSB7DQoJCQkJCW1vZGVsLmRlbGV0ZVJlcGx5KG9wdGlvbnMuZm9ydW1JZCwgb3B0aW9ucy50aHJlYWRJZCwgYS5kYXRhKCdyZXBseWlkJykpDQoJCQkJCQkuZG9uZShmdW5jdGlvbigpew0KCQkJCQkJCS8vIGhpZGUgYW5kIHJlbW92ZSB0aGUgZGVsZXRlZCByZXBseQ0KCQkJCQkJCXZhciByZXBseUl0ZW0gPSAkKG9wdGlvbnMud3JhcHBlciArICcgLnBvc3QtbGlzdC1pdGVtW2RhdGEtcmVwbHlpZD0iJyArIGEuZGF0YSgncmVwbHlpZCcpICsgJyJdJyk7DQoJCQkJCQkJcmVwbHlJdGVtLmV2b2x1dGlvblRyYW5zZm9ybSh7DQoJCQkJCQkJCW9wYWNpdHk6IDANCgkJCQkJCQl9LCB7DQoJCQkJCQkJCWR1cmF0aW9uOiAyMDAsDQoJCQkJCQkJCWNvbXBsZXRlOiBmdW5jdGlvbigpIHsNCgkJCQkJCQkJCXJlcGx5SXRlbS5yZW1vdmUoKTsNCgkJCQkJCQkJfQ0KCQkJCQkJCX0pOw0KCQkJCQkJfSk7DQoJCQkJfQ0KCQkJfSk7DQoJCX0pOw0KCX0NCg0KCWZ1bmN0aW9uIGhhbmRsZVRocmVhZERlbGV0aW9uRXZlbnRzKG9wdGlvbnMpIHsNCgkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ2ZvcnVtcmVwbHkuZGVsZXRlLXRocmVhZCcsIGZ1bmN0aW9uKGRhdGEpew0KCQkJdmFyIGEgPSAkKGRhdGEudGFyZ2V0KTsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuaGlkZVNoZWV0KCk7DQoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmNvbmZpcm0ob3B0aW9ucy50aHJlYWREZWxldGVDb25maXJtYXRpb24sIGZ1bmN0aW9uKGNvbmZpcm1lZCkgew0KCQkJCWlmIChjb25maXJtZWQpIHsNCgkJCQkJbW9kZWwuZGVsZXRlVGhyZWFkKG9wdGlvbnMuZm9ydW1JZCwgb3B0aW9ucy50aHJlYWRJZCkNCgkJCQkJCS5kb25lKGZ1bmN0aW9uKCl7DQoJCQkJCQkJLy8gbmF2aWdhdGUgYmFjayB0byB0aGUgZGVsZXRlZCB0aHJlYWQncyBmb3J1bSwgY2xlYXJpbmcgaXRzIGNhY2hlDQoJCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5sb2FkKG9wdGlvbnMuZm9ydW1VcmwsIHsgcmVmcmVzaDogdHJ1ZSB9KTsNCgkJCQkJCX0pOw0KCQkJCX0NCgkJCX0pOw0KCQl9KTsNCgl9DQoNCglmdW5jdGlvbiBoYW5kbGVBbnN3ZXJDaGFuZ2VFdmVudHMob3B0aW9ucykgew0KCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnN1YnNjcmliZSgnZm9ydW1yZXBseS5hbnN3ZXItYWN0aW9uJywgZnVuY3Rpb24oZGF0YSkgew0KCQkJdmFyIGEgPSAkKGRhdGEudGFyZ2V0KSwNCgkJCQlhY3Rpb24gPSBhLmRhdGEoJ2FjdGlvbicpOw0KDQoJCQltb2RlbC51cGRhdGVBbnN3ZXJTdGF0ZShvcHRpb25zLmZvcnVtSWQsIG9wdGlvbnMudGhyZWFkSWQsIGEuZGF0YSgncmVwbHlpZCcpLCBhY3Rpb24gPT0gJ2FjY2VwdC1hbnN3ZXInKQ0KCQkJCS5kb25lKGZ1bmN0aW9uKCl7DQoJCQkJCWlmIChvcHRpb25zLmZpbHRlciA9PSAndmVyaWZpZWQtYW5zd2VycycpIHsNCgkJCQkJCWlmICgkKG9wdGlvbnMud3JhcHBlciArICcgLnBvc3QtbGlzdC5yZXBsaWVzJykuZmluZCgnLnBvc3QtbGlzdC1pdGVtJykubGVuZ3RoID09IDEpIHsNCgkJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnJlZnJlc2goKTsNCgkJCQkJCX0gZWxzZSB7DQoJCQkJCQkJJChvcHRpb25zLndyYXBwZXIgKyAnIC5wb3N0LWxpc3QucmVwbGllcyAucG9zdC1saXN0LWl0ZW0uZm9ydW1yZXBseVtkYXRhLXJlcGx5aWQ9IicgKyBhLmRhdGEoJ3JlcGx5aWQnKSArICciXScpLnJlbW92ZSgpOw0KCQkJCQkJfQ0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlU2hlZXQoKTsNCgkJCQkJfSBlbHNlIHsNCgkJCQkJCXZhciBwID0gJChvcHRpb25zLndyYXBwZXIgKyAnIC5wb3N0LWxpc3QucmVwbGllcyAucG9zdC1saXN0LWl0ZW0uZm9ydW1yZXBseVtkYXRhLXJlcGx5aWQ9IicgKyBhLmRhdGEoJ3JlcGx5aWQnKSArICciXScpOw0KCQkJCQkJcC5yZW1vdmVDbGFzcygnc3VnZ2VzdGVkLWFuc3dlcicpOw0KCQkJCQkJaWYgKGFjdGlvbiA9PSAnYWNjZXB0LWFuc3dlcicpIHsNCgkJCQkJCQlwLmFkZENsYXNzKCdhbnN3ZXInKTsNCgkJCQkJCX0gZWxzZSB7DQoJCQkJCQkJcC5yZW1vdmVDbGFzcygnYW5zd2VyJyk7DQoJCQkJCQl9DQoNCgkJCQkJCWlmIChhY3Rpb24gPT0gJ2FjY2VwdC1hbnN3ZXInKSB7DQoJCQkJCQkJYS5wYXJlbnRzKCd1bCcpLmZpbmQoJ2EuYW5zd2VyLWFjdGlvbicpLmRhdGEoJ2FjdGlvbicsICdyZWplY3QtYW5zd2VyJykuaHRtbChvcHRpb25zLm1hcmtBc05vdEFuc3dlclRleHQpOw0KCQkJCQkJfSBlbHNlIHsNCgkJCQkJCQlhLnBhcmVudHMoJ3VsJykuZmluZCgnYS5hbnN3ZXItYWN0aW9uJykuZGF0YSgnYWN0aW9uJywgJ2FjY2VwdC1hbnN3ZXInKS5odG1sKG9wdGlvbnMubWFya0FzQW5zd2VyVGV4dCk7DQoJCQkJCQl9DQoNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuaGlkZVNoZWV0KCk7DQoNCgkJCQkJCXAuZmluZCgnLnVpLWxpbmtzJykudWlsaW5rcygncmVtb3ZlJywgJ2EuYW5zd2VyLWFjdGlvbi5zZWNvbmQtbGluaycpOw0KCQkJCQl9DQoJCQkJfSkNCgkJCQkuZmFpbChmdW5jdGlvbigpew0KCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmhpZGVTaGVldCgpOw0KCQkJCX0pOw0KCQl9KTsNCgl9DQoNCglmdW5jdGlvbiBpbml0UGFnaW5nKG9wdGlvbnMpIHsNCgkJJChvcHRpb25zLndyYXBwZXIpLm9uKCd0YXAnLCAnLnBvc3QtbGlzdC5yZXBsaWVzIGEudmlldy1tb3JlJywgZnVuY3Rpb24oZSkgew0KCQkJdmFyIGwgPSAkKHRoaXMpOw0KCQkJdmFyIHBpID0gcGFyc2VJbnQobC5kYXRhKCdwYWdlaW5kZXgnKSwgMTApOw0KCQkJaWYgKGlzTmFOKHBpKSkgew0KCQkJCXJldHVybjsNCgkJCX0NCgkJCXZhciBscGkgPSBwYXJzZUludChsLmRhdGEoJ2xhc3RwYWdlaW5kZXgnKSwgMTApOw0KDQoNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoJC50ZWxsaWdlbnQuZXZvbHV0aW9uLmdldCh7DQoJCQkJdXJsOiBvcHRpb25zLm1vcmVVcmwsDQoJCQkJZGF0YTogew0KCQkJCQl3X3BhZ2VJbmRleDogcGksDQoJCQkJCXdfZmlsdGVyOiBvcHRpb25zLmZpbHRlcg0KCQkJCX0sDQoJCQkJc3VjY2VzczogZnVuY3Rpb24ocikgew0KCQkJCQl2YXIgdG9wID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5jb250ZW50U2Nyb2xsVG9wKCk7DQoJCQkJCXZhciBsaXN0ID0gbC5wYXJlbnRzKCcucG9zdC1saXN0LnJlcGxpZXMnKTsNCgkJCQkJdmFyIGggPSBsaXN0Lm91dGVySGVpZ2h0KCk7DQoJCQkJCWwuYmVmb3JlKHIpOw0KCQkJCQlpZiAoaXNOYU4obHBpKSkgew0KCQkJCQkJbC5oaWRlKCk7DQoJCQkJCQl0b3AgPSB0b3AgKyBsaXN0Lm91dGVySGVpZ2h0KCkgLSBoOw0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5jb250ZW50U2Nyb2xsVG9wKHRvcCk7DQoJCQkJCX0gZWxzZSBpZiAocGkgPT0gbHBpKSB7DQoJCQkJCQlsLmhpZGUoKTsNCgkJCQkJCSQob3B0aW9ucy53cmFwcGVyICsgJyAudmlldy1tb3JlW2RhdGEtcGFnZWluZGV4PSInICsgKHBpIC0gMSkgKyAnIl0nKS5oaWRlKCk7DQoJCQkJCX0gZWxzZSB7DQoJCQkJCQlsLmRhdGEoJ3BhZ2VpbmRleCcsIHBpICsgMSk7DQoJCQkJCQkkKG9wdGlvbnMud3JhcHBlciArICcgLnZpZXctbW9yZVtkYXRhLXBhZ2VpbmRleD0iJyArIChwaSAtIDEpICsgJyJdJykuaGlkZSgpOw0KCQkJCQl9DQoJCQkJfQ0KCQkJfSkpOw0KDQoJCQlyZXR1cm4gZmFsc2U7DQoJCX0pOw0KCX0NCg0KCWZ1bmN0aW9uIGFwcGx5RmlsdGVycyhvcHRpb25zKSB7DQoJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuYWRkUmVmcmVzaFBhcmFtZXRlcignd19maWx0ZXInLCBvcHRpb25zLmZpbHRlcik7DQoNCgkJJChvcHRpb25zLndyYXBwZXIgKyAnIC5maWx0ZXJzIGEnKS5vbigndGFwJywgZnVuY3Rpb24oZSkgew0KCQkJdmFyIGZpbHRlciA9ICQodGhpcykuZGF0YSgnZmlsdGVyJyk7DQoJCQlpZiAoZmlsdGVyICE9IG9wdGlvbnMuZmlsdGVyKSB7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5hZGRSZWZyZXNoUGFyYW1ldGVyKCd3X2ZpbHRlcicsIGZpbHRlcik7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5yZWZyZXNoKCk7DQoJCQl9DQoJCQlyZXR1cm4gZmFsc2U7DQoJCX0pOw0KCX0NCg0KCXZhciBhcGkgPSB7DQoJCXJlZ2lzdGVyOiBmdW5jdGlvbihvcHRpb25zKSB7DQoJCQlhcHBseUZpbHRlcnMob3B0aW9ucyk7DQoJCQloYW5kbGVBbnN3ZXJDaGFuZ2VFdmVudHMob3B0aW9ucyk7DQoJCQloYW5kbGVSZXBseURlbGV0aW9uRXZlbnRzKG9wdGlvbnMpOw0KCQkJaGFuZGxlVGhyZWFkRGVsZXRpb25FdmVudHMob3B0aW9ucyk7DQoJCQlpbml0UGFnaW5nKG9wdGlvbnMpOw0KCQkJaWYgKG9wdGlvbnMucmVwbHlJZCkgew0KCQkJCXZhciByZXBseSA9ICQob3B0aW9ucy53cmFwcGVyICsgJyAucG9zdC1saXN0LWl0ZW0uZm9ydW1yZXBseVtkYXRhLXJlcGx5aWQ9IicgKyBvcHRpb25zLnJlcGx5SWQgKyAnIl0nKTsNCgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmNvbnRlbnRTY3JvbGxUb3AocmVwbHkub2Zmc2V0KCkudG9wKTsNCgkJCX0NCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMuZm9ydW1UaHJlYWQgPSBhcGk7DQoNCn0pKGpRdWVyeSk7</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:ForumThreadList_Name}" version="7.0.0.1" description="" instanceIdentifier="c6af9d06240940beae71ade1bf750570" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="forumthread-list">
    <contentScript>
		
#set($forumId = false)
#set($forumId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('ForumId')))
#if (!$forumId)
	$core_v2_widget.Hide()
#end

#set($forum = $core_v2_forum.Get($forumId))
&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($forum.Group.Url)"&gt;$forum.Group.Name&lt;/a&gt;
		&lt;h1&gt;$forum.Name&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($forum.Group.AvatarUrl, 40, 40, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
	&lt;div class="ui-links actions" data-maxlinks="0"&gt;
		&lt;ul&gt;
			#set ($bookmarkableContentId = $forum.ApplicationId)
			#set ($bookmarkableContentTypeId = $core_v2_forum.ContentTypeId)
			#if ($core_v2_bookmark.SupportsBookmarks($bookmarkableContentTypeId) &amp;&amp; $core_v2_bookmark.CanBookmark($bookmarkableContentId, $bookmarkableContentTypeId) &amp;&amp; $core_v2_bookmark.CanUnBookmark($bookmarkableContentId, $bookmarkableContentTypeId))
				&lt;li&gt;$core_v2_ui.Bookmark($bookmarkableContentId, $bookmarkableContentTypeId)&lt;/li&gt;
			#end
			&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;$core_v2_language.GetResource('more')&lt;/a&gt;&lt;/li&gt;
			&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
		&lt;/ul&gt;
	&lt;/div&gt;
&lt;/div&gt;

## load and render threads
&lt;div class="post-list forums"&gt;
	#set($pageIndex = 0)
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.forumThreadList.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
			answerUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('answer.vm'))',
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			postUrl: '$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('forum-addthread', $forumId))',
			canPost: #if($core_v2_nodePermission.Get("forums", $forumId, "Forum_CreatePost").IsAllowed) true#else false#end
		});
	});
})
&lt;/script&gt;
		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="ForumThreadList_Name">Forum Thread List</resource>
		<resource name="no_threads">There are no threads in this forum.</resource>
		<resource name="no_replies">No replies</resource>
		<resource name="reply_count">{0} reply</resource>
		<resource name="replies_count">{0} replies</resource>
		<resource name="answered">Answered</resource>
		<resource name="plus_more_answer">Plus {0} more answer...</resource>
		<resource name="plus_more_answers">Plus {0} more answers...</resource>
		<resource name="post">New</resource>
		<resource name="more">More</resource>
		<resource name="cancel">Cancel</resource>
	  </language>
	</languageResources>
    <files>
      <file name="answer.vm">I3NldCAoJHRocmVhZElkID0gZmFsc2UpCiNzZXQgKCR0aHJlYWRJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X3RocmVhZGlkJykpKQoKI2lmICghJHRocmVhZElkKQoJJGNvcmVfdjJfd2lkZ2V0LkhpZGUoKQojZW5kCgojc2V0KCRhbnN3ZXJzID0gJGNvcmVfdjJfZm9ydW1SZXBseS5MaXN0KCR0aHJlYWRJZCwgIiV7Rm9ydW1SZXBseVF1ZXJ5VHlwZT0ndmVyaWZpZWQtYW5zd2VycycsU29ydEJ5PSdQb3N0RGF0ZScsU29ydE9yZGVyPSdEZXNjZW5kaW5nJyxQYWdlU2l6ZT0xLFBhZ2VJbmRleD0wLEluY2x1ZGVUaHJlYWRTdGFydGVyPSdGYWxzZSd9IikpCiNmb3JlYWNoKCRhbnN3ZXIgaW4gJGFuc3dlcnMpCgk8ZGl2IGNsYXNzPSJjb250ZW50Ij4KCQk8cD4kY29yZV92Ml9sYW5ndWFnZS5UcnVuY2F0ZSgkYW5zd2VyLkJvZHkoJ1dlYicpLCAyNTAsICcuLi4nKTwvcD4KCTwvZGl2PgoJI2lmICgkYW5zd2Vycy5Ub3RhbENvdW50ID4gMSkKCQkjc2V0KCRjb3VudCA9ICRhbnN3ZXJzLlRvdGFsQ291bnQgLSAxKQoJCTxkaXYgY2xhc3M9ImFjdGlvbnMiPgoJCQk8dWw+CgkJCQk8bGk+CgkJCQkJPHNwYW4gY2xhc3M9ImRldGFpbCI+CgkJCQkJCSNpZiAoJGNvdW50ID09IDEpCgkJCQkJCQkkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRTdHJpbmcoJGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ3BsdXNfbW9yZV9hbnN3ZXInKSwgJGNvdW50KQoJCQkJCQkjZWxzZQoJCQkJCQkJJGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0U3RyaW5nKCRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdwbHVzX21vcmVfYW5zd2VycycpLCAkY291bnQpCgkJCQkJCSNlbmQKCQkJCQk8L3NwYW4+CgkJCQk8L2xpPgoJCQk8L3VsPgoJCTwvZGl2PgoJI2VuZAojZW5k</file>
      <file name="list.vm">I3NldCAoJGFjY2Vzc2luZ1VzZXIgPSAkY29yZV92Ml91c2VyLkFjY2Vzc2luZykKI3NldCAoJGFjY2Vzc2luZ1VzZXJJc1JlZ2lzdGVyZWQgPSBmYWxzZSkKI2lmICgkY29yZV92Ml91c2VyLklzUmVnaXN0ZXJlZCgkYWNjZXNzaW5nVXNlci5JZCkpCgkjc2V0ICgkYWNjZXNzaW5nVXNlcklzUmVnaXN0ZXJlZCA9IHRydWUpCiNlbmQKCiNzZXQoJHRocmVhZHMgPSAkY29yZV92Ml9mb3J1bVRocmVhZC5MaXN0KCIle0ZvcnVtSWQ9JGZvcnVtSWQsUGFnZUluZGV4PSRwYWdlSW5kZXgsUGFnZVNpemU9NyxTb3J0Qnk9J0xhc3RQb3N0JyxTb3J0T3JkZXI9J0Rlc2NlbmRpbmcnfSIpKQojZm9yZWFjaCgkdGhyZWFkIGluICR0aHJlYWRzKQojZWFjaAoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIGZvcnVtdGhyZWFkICNpZiAoJHRocmVhZC5UaHJlYWRUeXBlID09ICdRdWVzdGlvbkFuZEFuc3dlcicpI2lmKCR0aHJlYWQuVGhyZWFkU3RhdHVzID09ICdBbnN3ZXJlZCcpIGFuc3dlciNlbHNlaWYoJHRocmVhZC5UaHJlYWRTdGF0dXMgPT0gJ0Fuc3dlcmVkTm90VmVyaWZpZWQnKSBzdWdnZXN0ZWQtYW5zd2VyI2VuZCNlbmQiIGRhdGEtdGFyZ2V0dXJsPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCR0aHJlYWQuVXJsKSI+CgkJPGRpdiBjbGFzcz0icG9zdCI+CgkJCTxkaXYgY2xhc3M9ImF2YXRhciI+CgkJCQkjaWYgKCR0aHJlYWQuQXV0aG9yLlByb2ZpbGVVcmwpCgkJCQkJPGEgaHJlZj0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkdGhyZWFkLkF1dGhvci5Qcm9maWxlVXJsKSIgY2xhc3M9ImludGVybmFsLWxpbmsgdmlldy11c2VyLXByb2ZpbGUiPgoJCQkJCQkkY29yZV92Ml91aS5HZXRSZXNpemVkSW1hZ2VIdG1sKCR0aHJlYWQuQXV0aG9yLkF2YXRhclVybCwgNDAsIDQwLCAiJXtib3JkZXI9JzAnLCBhbHQ9JHRocmVhZC5BdXRob3IuRGlzcGxheU5hbWUsIFJlc2l6ZU1ldGhvZD0nWm9vbUFuZENyb3AnLGJvcmRlcj0nMCd9IikKCQkJCQk8L2E+CgkJCQkjZWxzZQoJCQkJCSRjb3JlX3YyX3VpLkdldFJlc2l6ZWRJbWFnZUh0bWwoJHRocmVhZC5BdXRob3IuQXZhdGFyVXJsLCA0MCwgNDAsICIle2JvcmRlcj0nMCcsIGFsdD0kdGhyZWFkLkF1dGhvci5EaXNwbGF5TmFtZSwgUmVzaXplTWV0aG9kPSdab29tQW5kQ3JvcCcsYm9yZGVyPScwJ30iKQoJCQkJI2VuZAoJCQk8L2Rpdj4KCQkJPGRpdiBjbGFzcz0iZGV0YWlscyI+CgkJCQk8ZGl2IGNsYXNzPSJkYXRlIj4jaWYgKCR0aHJlYWQuTGF0ZXN0UG9zdERhdGUpJHtjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdEFnb0RhdGUoJHRocmVhZC5MYXRlc3RQb3N0RGF0ZSl9I2Vsc2Uke2NvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0QWdvRGF0ZSgkdGhyZWFkLkRhdGUpfSNlbmQ8L2Rpdj4KCQkJPC9kaXY+CgkJCTxkaXYgY2xhc3M9ImNvbnRlbnQiPgoJCQkJPGEgaHJlZj0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkdGhyZWFkLlVybCkiPiR0aHJlYWQuU3ViamVjdDwvYT4KCQkJPC9kaXY+CgkJCTxkaXYgY2xhc3M9ImFjdGlvbnMgdWktbGlua3MiPgoJCQkJPHVsPgoJCQkJCSNpZiAoJGFjY2Vzc2luZ1VzZXJJc1JlZ2lzdGVyZWQgJiYgJGNvcmVfdjJfbGlrZS5DYW5MaWtlKCR0aHJlYWQuQ29udGVudElkLCAkY29yZV92Ml9mb3J1bVRocmVhZC5Db250ZW50VHlwZUlkKSkKCQkJCQkJPGxpIGNsYXNzPSJhY3Rpb24tbGlrZSI+CgkJCQkJCQkjc2V0KCRmb3JtYXQgPSAne3RvZ2dsZX0gPHNwYW4gY2xhc3M9ImNvdW50Ij48c3BhbiBjbGFzcz0iaWNvbiI+PC9zcGFuPntjb3VudH08L3NwYW4+JykKCQkJCQkJCSRjb3JlX3YyX3VpLkxpa2UoJHRocmVhZC5Db250ZW50SWQsICRjb3JlX3YyX2ZvcnVtVGhyZWFkLkNvbnRlbnRUeXBlSWQsICIleyBGb3JtYXQgPSAkZm9ybWF0IH0iKQoJCQkJCQk8L2xpPgoJCQkJCSNlbmQKCQkJCQk8bGk+CgkJCQkJCSNpZiAoJHRocmVhZC5UaHJlYWRUeXBlID09ICdRdWVzdGlvbkFuZEFuc3dlcicgJiYgJHRocmVhZC5UaHJlYWRTdGF0dXMgPT0gJ0Fuc3dlcmVkJykKCQkJCQkJCTxhIGhyZWY9IiMiIGNsYXNzPSJhbnN3ZXJlZCIgZGF0YS10aHJlYWRpZD0iJHRocmVhZC5JZCI+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ2Fuc3dlcmVkJyk8L2E+CgkJCQkJCSNlbHNlCgkJCQkJCQk8c3BhbiBjbGFzcz0iZGV0YWlsIGNvbW1lbnQiPgoJCQkJCQkJCSNpZiAoJHRocmVhZC5SZXBseUNvdW50ID09IDApCgkJCQkJCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdub19yZXBsaWVzJykKCQkJCQkJCQkjZWxzZWlmICgkdGhyZWFkLlJlcGx5Q291bnQgPT0gMSkKCQkJCQkJCQkJJGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0U3RyaW5nKCRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdyZXBseV9jb3VudCcpLCAkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXROdW1iZXIoJHRocmVhZC5SZXBseUNvdW50KSkKCQkJCQkJCQkjZWxzZQoJCQkJCQkJCQkkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRTdHJpbmcoJGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ3JlcGxpZXNfY291bnQnKSwgJGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0TnVtYmVyKCR0aHJlYWQuUmVwbHlDb3VudCkpCgkJCQkJCQkJI2VuZAoJCQkJCQkJPC9zcGFuPgoJCQkJCQkjZW5kCgkJCQkJPC9saT4KCQkJCTwvdWw+CgkJCTwvZGl2PgoJCTwvZGl2PgoJPC9kaXY+CiNub2RhdGEKCTxkaXYgY2xhc3M9InBvc3QtbGlzdC1pdGVtIGNvbnRlbnQtaXRlbSBmb3J1bSI+PGRpdiBjbGFzcz0ibWVzc2FnZSBub3JlY29yZHMiPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdub190aHJlYWRzJyk8L2Rpdj48L2Rpdj4KI2FmdGVyYWxsCgkjc2V0ICgkaGFzTW9yZSA9IGZhbHNlKQoJI2lmICgkdGhyZWFkcy5Ub3RhbENvdW50ID4gKCgkdGhyZWFkcy5QYWdlSW5kZXggKyAxKSAqICR0aHJlYWRzLlBhZ2VTaXplKSkKCQkjc2V0KCRoYXNNb3JlID0gdHJ1ZSkKCSNlbmQKCTxkaXYgY2xhc3M9ImRhdGEiICNpZigkaGFzTW9yZSlkYXRhLWhhc21vcmU9InRydWUiI2VuZD48L2Rpdj4KI2VuZA==</file>
      <file name="more.vm">IyMKIyMgQWpheCBjYWxsYmFjayBmb3IgbG9hZGluZyBtb3JlIGZvcnVtcwojIwojc2V0ICgkcGFnZUluZGV4ID0gJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X3BhZ2VJbmRleCcpKQojc2V0KCRmb3J1bUlkID0gZmFsc2UpCiNzZXQoJGZvcnVtSWQgPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlSW50KCRtb2JpbGVfdjFfdXJsVG9rZW4uVmFsdWUoJ0ZvcnVtSWQnKSkpCiNpZiAoISRmb3J1bUlkKQoJJGNvcmVfdjJfd2lkZ2V0LkhpZGUoKQojZW5kCiRjb3JlX3YyX3dpZGdldC5FeGVjdXRlRmlsZSgnbGlzdC52bScpCg==</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpewoKCXZhciBhcGkgPSB7CgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCQkJJChvcHRpb25zLndyYXBwZXIpLm9uKCd0YXAnLCAnYS5hbnN3ZXJlZCcsIGZ1bmN0aW9uKGUpewoJCQkJdmFyIHQgPSAkKHRoaXMpOwoJCQkJdmFyIHRocmVhZElkID0gdC5kYXRhKCd0aHJlYWRpZCcpOwoKCQkJCXZhciBwID0gdC5wYXJlbnRzKCcucG9zdC1saXN0LWl0ZW0nKTsKCQkJCXZhciBhID0gcC5maW5kKCcucG9zdC5hbnN3ZXInKTsKCQkJCWlmIChhLmxlbmd0aCA+IDApIHsKCQkJCQlpZiAoYS5jc3MoJ2Rpc3BsYXknKSA9PSAnbm9uZScpIHsKCQkJCQkJYS5zaG93KCk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJYS5oaWRlKCk7CgkJCQkJfQoJCQkJfSBlbHNlIHsKCQkJCQlhID0gJCgnPGRpdiBjbGFzcz0icG9zdCBhbnN3ZXIiIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+PC9kaXY+Jyk7CgoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoewoJCQkJCQl1cmw6IG9wdGlvbnMuYW5zd2VyVXJsLAoJCQkJCQlkYXRhOiB7CgkJCQkJCQl3X3RocmVhZGlkOiB0aHJlYWRJZAoJCQkJCQl9LAoJCQkJCQlzdWNjZXNzOiBmdW5jdGlvbihyKSB7CgkJCQkJCQlhLmh0bWwocik7CgkJCQkJCQlwLmFwcGVuZChhKTsKCQkJCQkJCWEuc2hvdygpOwoJCQkJCQl9CgkJCQkJfSk7CgkJCQl9CgoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9KTsKCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2Nyb2xsYWJsZSh7CgkJCQlyZWdpb246ICdjb250ZW50JywKCQkJCWxvYWQ6IGZ1bmN0aW9uKHBhZ2VJbmRleCwgc3VjY2VzcywgZXJyb3IpIHsKCQkJCQlpZiAoJChvcHRpb25zLndyYXBwZXIgKyAnIGRpdi5kYXRhOmxhc3QnKS5kYXRhKCdoYXNtb3JlJykpIHsKCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLmdldCh7CgkJCQkJCQl1cmw6IG9wdGlvbnMubW9yZVVybCwKCQkJCQkJCWRhdGE6IHsKCQkJCQkJCQl3X3BhZ2VJbmRleDogcGFnZUluZGV4CgkJCQkJCQl9LAoJCQkJCQkJc3VjY2VzczogZnVuY3Rpb24ocikgewoJCQkJCQkJCXN1Y2Nlc3Mocik7CgkJCQkJCQl9LAoJCQkJCQkJZXJyb3I6IGZ1bmN0aW9uKCkgewoJCQkJCQkJCWVycm9yKCk7CgkJCQkJCQl9CgkJCQkJCX0pOwoJCQkJCX0gZWxzZSB7CgkJCQkJCXN1Y2Nlc3MoKTsKCQkJCQl9CgkJCQl9LAoJCQkJY29tcGxldGU6IGZ1bmN0aW9uKGNvbnRlbnQpIHsKCQkJCQljb250ZW50ID0gJChjb250ZW50KS5jc3MoeyBvcGFjaXR5OiAwIH0pOwoJCQkJCSQob3B0aW9ucy53cmFwcGVyKS5maW5kKCdkaXYucG9zdC1saXN0JykuYXBwZW5kKGNvbnRlbnQpOwoJCQkJCWNvbnRlbnQuZXZvbHV0aW9uVHJhbnNmb3JtKHsgb3BhY2l0eTogMSB9LCB7IGR1cmF0aW9uOiA0MDAgfSk7CgkJCQl9CgkJCX0pOwoKCQkJaWYgKG9wdGlvbnMuY2FuUG9zdCkgewoJCQkJdmFyIHBvc3RMaW5rID0gJCgnPGEgaHJlZj0iJyArIG9wdGlvbnMucG9zdFVybCArICciIGNsYXNzPSJhZGQiPicgKyBvcHRpb25zLnBvc3RMYWJlbCArICc8L2E+Jyk7CgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNldEhlYWRlckJ1dHRvbihwb3N0TGluayk7CgkJCX0KCQl9Cgl9CgoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5mb3J1bVRocmVhZExpc3QgPSBhcGk7Cgp9KShqUXVlcnkpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:GroupBanner_Name}" version="7.0.0.1" description="" instanceIdentifier="19db5de0a1654ea594b3a1540cf3d553" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="group-banner">
    <contentScript>

#set ($accessingUser = $core_v2_user.Accessing)

#set($groupId = false)
#set($group = false)
#set($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#if ($groupId)
	#set($group = $core_v2_group.Get("%{Id=$groupId}"))
#end
#if (!$group)
	$core_v2_widget.Hide()
#end

#set ($canReadGroup = $core_v2_nodePermission.Get("groups", $group.Id, "Group_ReadGroup").IsAllowed)

#set ($isRegistered = $core_v2_user.IsRegistered($accessingUser.Id))
#set ($groupUser = $core_v2_groupUserMember.Get($group.Id, "%{UserId = $accessingUser.Id}"))
#set ($membershipType = "None")
#set ($membershipType = $groupUser.MembershipType)

#set ($navigationItems = false)
#if ($canReadGroup)
	#set ($navigationItems = $core_v2_customNavigation.FromWidget($core_v2_utility.ParseGuid('ab92f9a89af24721bba1c464c1334be6'), 'navigation', "%{Url=$core_v2_page.Url, GroupId=$group.Id}"))
#end

#if ($group.ParentGroupId &lt; 1)
	## site-level data if root group
	#set ($siteInfo = $core_v2_infoResult.Get())
	#set ($groupName = $siteInfo.SiteName)
	#set ($groupAvatar = $core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 120, 120, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }"))
	#set ($groupDescription = $siteInfo.SiteDescription)
#else
	## otherwise, normal group
	#set ($groupName = $group.Name)
	#set ($groupAvatar = $core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 120, 120, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }"))
	#set ($groupDescription = $group.Description)
#end

&lt;div class="banner"&gt;
	&lt;div class="avatar"&gt;
		$!groupAvatar
	&lt;/div&gt;
	&lt;h1&gt;$!groupName&lt;/h1&gt;

	&lt;div class="ui-links actions" data-maxlinks="0"&gt;
		&lt;ul&gt;
			#if ($group &amp;&amp; $group.GroupType != 'Joinless')
				#set ($member = $core_v2_groupUserMember.Get($group.Id, "%{ UserId = $accessingUser.Id }"))
				#set ($canJoinGroup = $core_v2_nodePermission.Get("groups", $group.Id, "Group_JoinGroup").IsAllowed)
				#set ($canJoinGroupByRequest = $core_v2_nodePermission.Get("groups", $group.Id, "Group_JoinGroupByRequest").IsAllowed)

				#set ($groupLeaveResource = '')
				#if ($member.MembershipType == "PendingMember")
					#set ($groupLeaveResource = $core_v2_language.GetResource('Group_CancelledJoinRequest'))
				#else
					#set ($groupLeaveResource = $core_v2_language.GetResource('Group_Left'))
				#end

				&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
				&lt;script type="text/javascript"&gt;
					jQuery(function(j){
						jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
							j.telligent.evolution.widgets.groupBanner.register({
								groupId: $group.Id,
								userId: $accessingUser.Id,
								canJoinGroup: #if($canJoinGroup) true,#else false,#end
								canJoinGroupByRequest: #if($canJoinGroupByRequest) true,#else false,#end
								joinMessageLinkName: 'widget.${core_v2_widget.WrapperElementId}.join',
								requestJoinMessageLinkName: 'widget.${core_v2_widget.WrapperElementId}.requestjoin',
								cancelMessageLinkName: 'widget.${core_v2_widget.WrapperElementId}.canceljoin',
								requestJoinUrl: #if(!$canJoinGroup) "$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('group-requestmembership', $group.Id))",#else null,#end
								cancelConfirmMessage: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource("Hubs_Membership_LeaveConfirm"))',
								joinedText:'$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('Group_Joined'))',
								leftText:'$core_v2_encoding.JavascriptEncode($groupLeaveResource)'
							});
						});
					});
				&lt;/script&gt;

				#if (!$member.IsRoleMember &amp;&amp; ($member.MembershipType == "Owner" || $member.MembershipType == "Manager" || $member.MembershipType == "Member" || $member.MembershipType == "PendingMember"))
					#set ($canLeaveGroup = $member.MembershipType != "Owner" || $core_v2_groupUserMember.List($groupId, "%{MembershipType = 'Owner', PageSize = 1}").TotalCount &gt; 1)
					#if ($canLeaveGroup)
						&lt;li&gt;
							&lt;a href="#" class="internal-link leave-group" data-messagename="widget.${core_v2_widget.WrapperElementId}.canceljoin"&gt;
								#if ($membershipType == "PendingMember")
									$core_v2_language.GetResource("Hubs_CancelJoinRequest")
								#else
									$core_v2_language.GetResource("Hubs_LeaveGroup")
								#end
							&lt;/a&gt;
						&lt;/li&gt;
					#end
				#elseif ($canJoinGroupByRequest || $canJoinGroup)
					#if ($group.GroupType == "PublicOpen")
						&lt;li&gt;
							&lt;a href="#" class="internal-link join-group" data-messagename="widget.${core_v2_widget.WrapperElementId}.join"&gt;
								$core_v2_language.GetResource('Hubs_JoinGroup')
							&lt;/a&gt;
						&lt;/li&gt;
						#set($hasLinks = true)
					#elseif ($group.GroupType == "PrivateListed")
						&lt;li&gt;
							## If this banner rendering was directly following a leave, don't immediately pop up a re-join message
							#set ($justLeftGroup = false)
							#set ($justLeftGroup = $core_v2_page.GetQueryStringValue('w_justleft'))

							&lt;a href="#" class="internal-link join-group" data-messagename="widget.${core_v2_widget.WrapperElementId}.requestjoin"&gt;
								$core_v2_language.GetResource('Hubs_ApplyToJoin')
							&lt;/a&gt;

							#if (!$justLeftGroup)
								&lt;script type="text/javascript"&gt;
									jQuery(function(j){
										jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
											j.telligent.evolution.mobile.confirm('$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('private_group_request_access'))', function(v) {
												if (v) {
													j.telligent.evolution.messaging.publish('widget.${core_v2_widget.WrapperElementId}.requestjoin', {});
												}
											});
										});
									});
								&lt;/script&gt;
							#end
						&lt;/li&gt;
					#end
				#elseif (!$isRegistered)
					&lt;script type="text/javascript"&gt;
						jQuery(function(j){
							jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
								j.telligent.evolution.mobile.confirm('$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('private_group_login'))', function(v) {
									if (v) {
										j.telligent.evolution.mobile.load('$core_v2_encoding.JavascriptEncode($mobile_v1_authentication.Login())');
									}
								});
							});
						});
					&lt;/script&gt;
				#end
			#end

			#set ($bookmarkableContentId = $group.ContainerId)
			#set ($bookmarkableContentTypeId = $core_v2_group.ContentTypeId)
			#if ($core_v2_bookmark.SupportsBookmarks($bookmarkableContentTypeId) &amp;&amp; $core_v2_bookmark.CanBookmark($bookmarkableContentId, $bookmarkableContentTypeId) &amp;&amp; $core_v2_bookmark.CanUnBookmark($bookmarkableContentId, $bookmarkableContentTypeId))
				&lt;li&gt;$core_v2_ui.Bookmark($bookmarkableContentId, $bookmarkableContentTypeId)&lt;/li&gt;
			#end
			&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;$core_v2_language.GetResource('more')&lt;/a&gt;&lt;/li&gt;
			&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
		&lt;/ul&gt;
	&lt;/div&gt;

	#if ($navigationItems)
		#foreach ($navigationItem in $navigationItems)
			#beforeall
			&lt;div class="ui-links applications" data-minlinks="100" data-animate="true"&gt;
				&lt;ul&gt;
			#each
				#if ($mobile_v1_url.IsRedirected($navigationItem.Url) &amp;&amp; $navigationItem.CssClass != 'internal-link view-group')
					&lt;li&gt;
						&lt;a href="$core_v2_encoding.HtmlAttributeEncode($navigationItem.Url)"&gt;$navigationItem.Label&lt;/a&gt;
					&lt;/li&gt;
				#end
			#afterall
					&lt;li class="application-more"&gt;&lt;a href="#" data-more&gt;$core_v2_language.GetResource('more')&lt;/a&gt;&lt;/li&gt;
					&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
				&lt;/ul&gt;
			&lt;/div&gt;
		#end
	#end
&lt;/div&gt;

	</contentScript>
    <languageResources>
		<language key="en-us">
			<resource name="GroupBanner_Name">Group Banner</resource>
			<resource name="Hubs_LeaveGroup">Leave</resource>
			<resource name="Hubs_CancelJoinRequest">Cancel join request</resource>
			<resource name="Hubs_JoinGroup">Join</resource>
			<resource name="Hubs_ApplyToJoin">Request membership</resource>
			<resource name="Group_Joined">You have joined this group.</resource>
			<resource name="Group_Left">You have left this group.</resource>
			<resource name="Group_CancelledJoinRequest">You have canceled your join request.</resource>
			<resource name="Hubs_Membership_LeaveConfirm">Are you sure you want to leave this group?</resource>
			<resource name="more">More</resource>
			<resource name="cancel">Cancel</resource>
			<resource name="private_group_login">Would you like to login to access this private group?</resource>
			<resource name="private_group_request_access">Would you like to request access to this private group?</resource>
		</language>
	</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQpewoKCXZhciBhcGkgPSB7CgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCQkJdmFyIGpvaW5PcHRpb25zID0gewoJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvZ3JvdXBzL3tHcm91cElkfS9tZW1iZXJzL3VzZXJzLmpzb24nLAoJCQkJZGF0YTogewoJCQkJCUdyb3VwSWQ6IG9wdGlvbnMuZ3JvdXBJZCwKCQkJCQlVc2VySWQ6IG9wdGlvbnMudXNlcklkCgkJCQl9LAoJCQkJc3VjY2VzczogZnVuY3Rpb24oKSB7CgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm5vdGlmaWNhdGlvbnMuc2hvdyhvcHRpb25zLmpvaW5lZFRleHQsIHsgdHlwZTogJ3N1Y2Nlc3MnIH0pOwoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUucmVmcmVzaCgpOwoJCQkJfQoJCQl9OwoKCQkJLy8gYWN0aXZhdGUgZ3JvdXAgam9pbmluZyBidXR0b25zCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tZXNzYWdpbmcuc3Vic2NyaWJlKG9wdGlvbnMuam9pbk1lc3NhZ2VMaW5rTmFtZSwgZnVuY3Rpb24oKSB7CgkJCQlqb2luT3B0aW9ucy5kYXRhLkdyb3VwTWVtYmVyc2hpcFR5cGUgPSAnTWVtYmVyJzsKCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnBvc3Qoam9pbk9wdGlvbnMpKTsKCQkJCXJldHVybiBmYWxzZTsKCQkJfSk7CgoJCQkvLyByZXF1ZXN0IGpvaW4KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUob3B0aW9ucy5yZXF1ZXN0Sm9pbk1lc3NhZ2VMaW5rTmFtZSwgZnVuY3Rpb24oKSB7CgkJCQlpZiAob3B0aW9ucy5jYW5Kb2luR3JvdXApIHsKCQkJCQlqb2luT3B0aW9ucy5kYXRhLkdyb3VwTWVtYmVyc2hpcFR5cGUgPSAnUGVuZGluZ01lbWJlcic7CgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygkLnRlbGxpZ2VudC5ldm9sdXRpb24ucG9zdChqb2luT3B0aW9ucykpOwoJCQkJfSBlbHNlIHsKCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmxvYWQob3B0aW9ucy5yZXF1ZXN0Sm9pblVybCk7CgkJCQl9CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0pOwoKCQkJLy8gYWN0aXZhdGUgbWVtYmVyc2hpcCBjYW5jZWxsYXRpb24gbGlua3MKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUob3B0aW9ucy5jYW5jZWxNZXNzYWdlTGlua05hbWUsIGZ1bmN0aW9uKCkgewoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5jb25maXJtKG9wdGlvbnMuY2FuY2VsQ29uZmlybU1lc3NhZ2UsIGZ1bmN0aW9uKHIpIHsKCQkJCQlpZiAocikgewoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNob3dMb2FkaW5nKCQudGVsbGlnZW50LmV2b2x1dGlvbi5kZWwoewoJCQkJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvZ3JvdXBzL3tHcm91cElkfS9tZW1iZXJzL3VzZXJzL3tVc2VySWR9Lmpzb24nLAoJCQkJCQkJZGF0YTogewoJCQkJCQkJCUdyb3VwSWQ6IG9wdGlvbnMuZ3JvdXBJZCwKCQkJCQkJCQlVc2VySWQ6IG9wdGlvbnMudXNlcklkCgkJCQkJCQl9LAoJCQkJCQkJc3VjY2VzczogZnVuY3Rpb24oKXsKCQkJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubm90aWZpY2F0aW9ucy5zaG93KG9wdGlvbnMubGVmdFRleHQsIHsgdHlwZTogJ3N1Y2Nlc3MnIH0pOwoJCQkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuYWRkUmVmcmVzaFBhcmFtZXRlcignd19qdXN0bGVmdCcsIHRydWUpOwoJCQkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUucmVmcmVzaCgpOwoJCQkJCQkJfQoJCQkJCQl9KSk7CgkJCQkJfQoJCQkJfSk7CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0pOwoJCX0KCX0KCgkkLnRlbGxpZ2VudCA9ICQudGVsbGlnZW50IHx8IHt9OwoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9OwoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzLmdyb3VwQmFubmVyID0gYXBpOwoKfSkoalF1ZXJ5KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:GroupList_Name}" version="7.0.0.1" description="" instanceIdentifier="60ac1bed4b9844b893a5c8d4497261c8" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="group-list">
    <contentScript>
		


#set ($pageIndex = 0)
#set ($pageSize = $core_v2_widget.GetIntValue('pageSize', 5))
#set ($queryType = $core_v2_widget.GetStringValue('queryType','currentUser'))

#if ($queryType == "subGroups")
	#set ($parentGroupId = false)
	#set ($parentGroupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
	#if (!$parentGroupId)
		$core_v2_widget.Hide()
	#end
	#set ($parentGroup = false)
	#set ($parentGroup = $core_v2_group.Get("%{Id=$parentGroupId}"))
	#if (!$parentGroup)
		$core_v2_widget.Hide()
	#end

	#set($bannerUrl = $parentGroup.Url)
	#set($bannerText = $parentGroup.Name)
	#set($bannerAvatarUrl = $parentGroup.AvatarUrl)
	#set($headerText = $core_v2_language.GetResource('GroupList_Groups'))

#elseif ($queryType == "currentUser")
	#set ($userId = false)
	#set ($userId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('UserId')))
	#if (!$userId)
		$core_v2_widget.Hide()
	#end
	#set ($user = false)
	#set ($user = $core_v2_user.Get("%{ Id = $userId }"))
	#if (!$user)
		$core_v2_widget.Hide()
	#end

	#set($bannerUrl = $user.ProfileUrl)
	#set($bannerText = $user.DisplayName)
	#set($bannerAvatarUrl = $user.AvatarUrl)
	#set($headerText = $core_v2_language.FormatString($core_v2_language.GetResource('GroupList_UserGroups'), $user.DisplayName))

#elseif ($queryType == "accessingUser")
	#set($user = $core_v2_user.Accessing)

	#set($bannerUrl = $user.ProfileUrl)
	#set($bannerText = $user.DisplayName)
	#set($bannerAvatarUrl = $user.AvatarUrl)
	#set($headerText = $core_v2_language.FormatString($core_v2_language.GetResource('GroupList_UserGroups'), $user.DisplayName))
#else
	$core_v2_widget.Hide()
#end

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($bannerUrl)"&gt;$bannerText&lt;/a&gt;
		&lt;h1&gt;$headerText&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($bannerAvatarUrl, 40, 40, "%{ alt = $bannerText, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
&lt;/div&gt;

&lt;div class="post-list groups"&gt;
	$core_v2_widget.ExecuteFile('list.vm')
&lt;/div&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;

&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.groupList.register({
		moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
		wrapper: '#$core_v2_widget.WrapperElementId',
		pageSize: $pageSize
		});
	});
})
&lt;/script&gt;
		
	</contentScript>
    <headerScript>
		</headerScript>
    <configuration>
		

&lt;propertyGroup id="options" resourceName="GroupList_Options"&gt;
	&lt;property id="queryType" resourceName="GroupList_QueryType" dataType="string" defaultValue="currentUser"&gt;
		&lt;propertyValue value="subGroups" resourceName="GroupList_QueryType_SubGroups" /&gt;
		&lt;propertyValue value="currentUser" resourceName="GroupList_QueryType_CurrentUser" /&gt;
		&lt;propertyValue value="accessingUser" resourceName="GroupList_QueryType_AccessingUser" /&gt;
	&lt;/property&gt;
	&lt;property id="pageSize" resourceName="GroupList_PageSize" dataType="int" defaultValue="5" /&gt;
&lt;/propertyGroup&gt;
		
	</configuration>
    <languageResources>
<language key="en-us">
	<resource name="GroupList_Name">Group List</resource>
	<resource name="GroupList_Options">Options</resource>
	<resource name="GroupList_QueryType">Show</resource>
	<resource name="GroupList_QueryType_SubGroups">Current contextual group's sub-groups</resource>
	<resource name="GroupList_QueryType_CurrentUser">Current contextual user's groups</resource>
	<resource name="GroupList_QueryType_AccessingUser">Accessing user's groups</resource>
	<resource name="GroupList_PageSize">Number of results to display</resource>
	<resource name="GroupList_Groups">Groups</resource>
	<resource name="GroupList_UserGroups">Groups</resource>
	<resource name="GroupList_No_Groups">There were no groups to display.</resource>
	<resource name="GroupList_No_Members">No members</resource>
	<resource name="GroupList_Member">{0} member</resource>
	<resource name="GroupList_Members">{0} members</resource>
</language>
		</languageResources>
    <files>
      <file name="list.vm">I3NldCgkZ3JvdXBzID0gZmFsc2UpDQojaWYoJHF1ZXJ5VHlwZT09J3N1Ykdyb3VwcycpDQoJI3NldCgkZ3JvdXBzID0gJGNvcmVfdjJfZ3JvdXAuTGlzdCgiJXtQYXJlbnRHcm91cElkPSRwYXJlbnRHcm91cC5JZCxQYWdlU2l6ZT0kcGFnZVNpemUsUGFnZUluZGV4PSRwYWdlSW5kZXgsU29ydEJ5PSdOYW1lJyxTb3J0T3JkZXI9J0FzY2VuZGluZycsR3JvdXBUeXBlcz0nYWxsJ30iKSkNCiNlbHNlaWYoJHF1ZXJ5VHlwZT09J2N1cnJlbnRVc2VyJykNCgkjc2V0KCRncm91cHMgPSAkY29yZV92Ml9ncm91cC5MaXN0KCIle1VzZXJJZD0kdXNlci5JZCxQYWdlU2l6ZT0kcGFnZVNpemUsUGFnZUluZGV4PSRwYWdlSW5kZXgsU29ydEJ5PSdMYXN0VXBkYXRlJyxTb3J0T3JkZXI9J0FzY2VuZGluZyd9IikpDQojZWxzZQ0KCSNzZXQgKCRpbmNsdWRlUGVuZGluZ01lbWJlcnNoaXBzID0gdHJ1ZSkNCgkjc2V0KCRncm91cHMgPSAkY29yZV92Ml9ncm91cC5MaXN0KCIle1VzZXJJZD0kdXNlci5JZCxQYWdlU2l6ZT0kcGFnZVNpemUsUGFnZUluZGV4PSRwYWdlSW5kZXgsU29ydEJ5PSdMYXN0VXBkYXRlJyxTb3J0T3JkZXI9J0FzY2VuZGluZycsSW5jbHVkZVBlbmRpbmdNZW1iZXJzaGlwcz0kaW5jbHVkZVBlbmRpbmdNZW1iZXJzaGlwc30iKSkNCiNlbmQNCg0KDQojZm9yZWFjaCgkZ3JvdXAgaW4gJGdyb3VwcykNCiNlYWNoDQoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIGdyb3VwIiBkYXRhLXRhcmdldHVybD0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkZ3JvdXAuVXJsKSI+DQoJCTxkaXYgY2xhc3M9InBvc3QiPg0KCQkJPGRpdiBjbGFzcz0iYXZhdGFyIj4NCgkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRncm91cC5VcmwpIiBjbGFzcz0iaW50ZXJuYWwtbGluayB2aWV3LWdyb3VwIj4NCgkJCQkJJGNvcmVfdjJfdWkuR2V0UmVzaXplZEltYWdlSHRtbCgkZ3JvdXAuQXZhdGFyVXJsLCA0MCwgNDAsICIle2JvcmRlcj0nMCcsIGFsdD0kZ3JvdXAuTmFtZSwgUmVzaXplTWV0aG9kPSdab29tQW5kQ3JvcCcsYm9yZGVyPScwJ30iKQ0KCQkJCTwvYT4NCg0KCQkJPC9kaXY+DQoNCgkJCTxkaXYgY2xhc3M9ImNvbnRlbnQiPg0KCQkJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJGdyb3VwLlVybCkiPiRncm91cC5OYW1lPC9hPg0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJhY3Rpb25zIHVpLWxpbmtzIj4NCgkJCQk8dWw+DQoJCQkJCSNzZXQgKCRjYW5WaWV3TWVtYmVyc2hpcHMgPSAkY29yZV92Ml9ub2RlUGVybWlzc2lvbi5HZXQoImdyb3VwcyIsICRncm91cC5JZCwgIkdyb3VwX1ZpZXdNZW1iZXJzaGlwIikuSXNBbGxvd2VkKQ0KCQkJCQkjaWYgKCRjYW5WaWV3TWVtYmVyc2hpcHMpDQoJCQkJCQk8bGkgY2xhc3M9ImFjdGlvbi1tZW1iZXJzIj4NCgkJCQkJCQk8YSBjbGFzcz0iaW50ZXJuYWwtbGluayBtZW1iZXJzIiBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRtb2JpbGVfdjFfdXJsLkZvcm1hdCgnZ3JvdXAtbWVtYmVycycsICRncm91cC5JZCkpIj4NCgkJCQkJCQkJI2lmICgkZ3JvdXAuVG90YWxNZW1iZXJzID09IDEpDQoJCQkJCQkJCQkkY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRTdHJpbmcoJGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ0dyb3VwTGlzdF9NZW1iZXInKSwgJGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0TnVtYmVyKCRncm91cC5Ub3RhbE1lbWJlcnMpKQ0KCQkJCQkJCQkjZWxzZWlmICgkZ3JvdXAuVG90YWxNZW1iZXJzID4gMSkNCgkJCQkJCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdFN0cmluZygkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnR3JvdXBMaXN0X01lbWJlcnMnKSwgJGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0TnVtYmVyKCRncm91cC5Ub3RhbE1lbWJlcnMpKQ0KCQkJCQkJCQkjZWxzZQ0KCQkJCQkJCQkJJGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ0dyb3VwTGlzdF9Ob19NZW1iZXJzJykNCgkJCQkJCQkJI2VuZA0KCQkJCQkJCTwvYT4NCgkJCQkJCTwvbGk+DQoJCQkJCSNlbmQNCgkJCQk8L3VsPg0KCQkJPC9kaXY+DQoJCTwvZGl2Pg0KCTwvZGl2Pg0KDQojbm9kYXRhDQoJPGRpdiBpZD0iJHtjb3JlX3YyX3dpZGdldC5XcmFwcGVyRWxlbWVudElkfV9tZXNzYWdlX25vcmVjb3JkcyI+PGRpdiBjbGFzcz0ibWVzc2FnZSBub3JlY29yZHMiPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdHcm91cExpc3RfTm9fR3JvdXBzJyk8L2Rpdj48L2Rpdj4NCiNhZnRlcmFsbA0KCSNzZXQgKCRoYXNNb3JlID0gZmFsc2UpDQoJI2lmICgkZ3JvdXBzLlRvdGFsQ291bnQgPiAoKCRncm91cHMuUGFnZUluZGV4ICsgMSkgKiAkZ3JvdXBzLlBhZ2VTaXplKSkNCgkJI3NldCgkaGFzTW9yZSA9IHRydWUpDQoJI2VuZA0KCTxkaXYgY2xhc3M9ImRhdGEiICNpZigkaGFzTW9yZSlkYXRhLWhhc21vcmU9InRydWUiI2VuZD48L2Rpdj4NCiNlbmQNCg==</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBncm91cHMNCiMjDQojc2V0ICgkcGFnZUluZGV4ID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUludCgkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ1BhZ2VJbmRleCcpKSkNCiNzZXQgKCRwYWdlU2l6ZSA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCdQYWdlU2l6ZScpKSkNCg0KI3NldCAoJHF1ZXJ5VHlwZSA9ICRjb3JlX3YyX3dpZGdldC5HZXRTdHJpbmdWYWx1ZSgncXVlcnlUeXBlJywnY3VycmVudFVzZXInKSkNCiNpZiAoJHF1ZXJ5VHlwZSA9PSAic3ViR3JvdXBzIikNCgkjc2V0ICgkcGFyZW50R3JvdXBJZCA9IGZhbHNlKQ0KCSNzZXQgKCRwYXJlbnRHcm91cElkID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUludCgkbW9iaWxlX3YxX3VybFRva2VuLlZhbHVlKCdHcm91cElkJykpKQ0KCSNpZiAoISRwYXJlbnRHcm91cElkKQ0KCQkkY29yZV92Ml93aWRnZXQuSGlkZSgpDQoJI2VuZCAgICAJDQoJI3NldCAoJHBhcmVudEdyb3VwID0gZmFsc2UpDQoJI3NldCAoJHBhcmVudEdyb3VwID0gJGNvcmVfdjJfZ3JvdXAuR2V0KCIle0lkPSRwYXJlbnRHcm91cElkfSIpKQ0KCSNpZiAoISRwYXJlbnRHcm91cCkNCgkJJGNvcmVfdjJfd2lkZ2V0LkhpZGUoKQ0KCSNlbmQNCiNlbHNlaWYgKCRxdWVyeVR5cGUgPT0gImN1cnJlbnRVc2VyIikNCgkjc2V0ICgkdXNlcklkID0gZmFsc2UpDQoJI3NldCAoJHVzZXJJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJG1vYmlsZV92MV91cmxUb2tlbi5WYWx1ZSgnVXNlcklkJykpKQ0KCSNpZiAoISR1c2VySWQpDQoJCSRjb3JlX3YyX3dpZGdldC5IaWRlKCkNCgkjZW5kDQoJI3NldCAoJHVzZXIgPSBmYWxzZSkNCgkjc2V0ICgkdXNlciA9ICRjb3JlX3YyX3VzZXIuR2V0KCIleyBJZCA9ICR1c2VySWQgfSIpKQ0KCSNpZiAoISR1c2VyKQ0KCQkkY29yZV92Ml93aWRnZXQuSGlkZSgpDQoJI2VuZA0KI2Vsc2VpZiAoJHF1ZXJ5VHlwZSA9PSAiYWNjZXNzaW5nVXNlciIpDQoJI3NldCgkdXNlciA9ICRjb3JlX3YyX3VzZXIuQWNjZXNzaW5nKQkNCiNlbHNlDQoJJGNvcmVfdjJfd2lkZ2V0LkhpZGUoKQkNCiNlbmQNCg0KJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCdsaXN0LnZtJyk=</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpewoKCXZhciBhcGkgPSB7CgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zY3JvbGxhYmxlKHsKCQkJCXJlZ2lvbjogJ2NvbnRlbnQnLAoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgewoJCQkJCWlmICgkKG9wdGlvbnMud3JhcHBlciArICcgZGl2LmRhdGE6bGFzdCcpLmRhdGEoJ2hhc21vcmUnKSkgewoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsKCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLAoJCQkJCQkJZGF0YTogewoJCQkJCQkJCVBhZ2VTaXplOiBvcHRpb25zLnBhZ2VTaXplLAoJCQkJCQkJCVBhZ2VJbmRleDogcGFnZUluZGV4LAoJCQkJCQkJfSwKCQkJCQkJCXN1Y2Nlc3M6IGZ1bmN0aW9uKHIpIHsKCQkJCQkJCQlzdWNjZXNzKHIpOwoJCQkJCQkJfSwKCQkJCQkJCWVycm9yOiBmdW5jdGlvbigpIHsKCQkJCQkJCQllcnJvcigpOwoJCQkJCQkJfQoJCQkJCQl9KTsKCQkJCQl9IGVsc2UgewoJCQkJCQlzdWNjZXNzKCk7CgkJCQkJfQoJCQkJfSwKCQkJCWNvbXBsZXRlOiBmdW5jdGlvbihjb250ZW50KSB7CgkJCQkJY29udGVudCA9ICQoY29udGVudCkuY3NzKHsgb3BhY2l0eTogMCB9KTsKCQkJCQkkKG9wdGlvbnMud3JhcHBlcikuZmluZCgnZGl2LnBvc3QtbGlzdCcpLmFwcGVuZChjb250ZW50KTsKCQkJCQljb250ZW50LmV2b2x1dGlvblRyYW5zZm9ybSh7IG9wYWNpdHk6IDEgfSwgeyBkdXJhdGlvbjogNDAwIH0pOwoJCQkJfQoJCQl9KTsKCQl9Cgl9CgoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5ncm91cExpc3QgPSBhcGk7Cgp9KShqUXVlcnkpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:GroupMembers_Name}" version="7.0.0.1" description="" instanceIdentifier="1b64e4816d424c98b1321eff0f4bce59" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="group-members">
    <contentScript>
		
#set ($pageName = $mobile_v1_url.Current)
#set($groupId = false)
#set($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#if (!$groupId)
	$core_v2_widget.Hide()
#end

#set($group = $core_v2_group.Get("%{Id=$groupId}"))
&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($group.Url)"&gt;$group.Name&lt;/a&gt;
		&lt;h1&gt;$core_v2_language.GetResource('group-members')&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 40, 40, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
&lt;/div&gt;

## load and render group members
&lt;div class="post-list members"&gt;
	#set($pageIndex = 0)
    $core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
    jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
        jQuery.telligent.evolution.widgets.groupMembers.register({
            wrapper: '#$core_v2_widget.WrapperElementId',
            moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))'
        });
    });
})
&lt;/script&gt;
		

		</contentScript>
    <headerScript>
        </headerScript>
    <languageResources>
		  <language key="en-us">
		  	<resource name="GroupMembers_Name">Group Members</resource>
			<resource name="group-members">Group Members</resource>
			<resource name="no-members">No Members</resource>
		  </language>
		</languageResources>
    <files>
      <file name="list.vm">I3NldCgkbWVtYmVycyA9ICRjb3JlX3YyX2dyb3VwVXNlck1lbWJlci5MaXN0KCIle0dyb3VwSWQgPSAkZ3JvdXBJZCxQYWdlSW5kZXg9JHBhZ2VJbmRleCxQYWdlU2l6ZT01fSIpKQ0KI2ZvcmVhY2goJG1lbWJlciBpbiAkbWVtYmVycykNCg0KCTxkaXYgY2xhc3M9InBvc3QtbGlzdC1pdGVtIGNvbnRlbnQtaXRlbSBtZW1iZXIiIGRhdGEtdGFyZ2V0dXJsPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRtZW1iZXIuVXNlci5Qcm9maWxlVXJsKSI+DQoJCTxkaXYgY2xhc3M9InBvc3QiPg0KCQkJPGRpdiBjbGFzcz0iYXZhdGFyIj4NCgkJCQkjaWYgKCRtZW1iZXIuVXNlci5Qcm9maWxlVXJsKQ0KCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRtZW1iZXIuVXNlci5Qcm9maWxlVXJsKSIgY2xhc3M9ImludGVybmFsLWxpbmsgdmlldy11c2VyLXByb2ZpbGUiPg0KCQkJCQkJJGNvcmVfdjJfdWkuR2V0UmVzaXplZEltYWdlSHRtbCgkbWVtYmVyLlVzZXIuQXZhdGFyVXJsLCA0MCwgNDAsICIle2JvcmRlcj0nMCcsIGFsdD0kbWVtYmVyLlVzZXIuRGlzcGxheU5hbWUsIFJlc2l6ZU1ldGhvZD0nWm9vbUFuZENyb3AnLGJvcmRlcj0nMCd9IikNCgkJCQkJPC9hPg0KCQkJCSNlbHNlDQoJCQkJCSRjb3JlX3YyX3VpLkdldFJlc2l6ZWRJbWFnZUh0bWwoJG1lbWJlci5Vc2VyLkF2YXRhclVybCwgNDAsIDQwLCAiJXtib3JkZXI9JzAnLCBhbHQ9JG1lbWJlci5Vc2VyLkRpc3BsYXlOYW1lLCBSZXNpemVNZXRob2Q9J1pvb21BbmRDcm9wJyxib3JkZXI9JzAnfSIpDQoJCQkJI2VuZA0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJkZXRhaWxzIj4NCgkJCQ0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJjb250ZW50Ij4NCgkJCQkjaWYgKCRtZW1iZXIuVXNlci5Qcm9maWxlVXJsKQ0KCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRtZW1iZXIuVXNlci5Qcm9maWxlVXJsKSIgY2xhc3M9ImludGVybmFsLWxpbmsgdmlldy11c2VyLXByb2ZpbGUiPg0KCQkJCQkJJG1lbWJlci5Vc2VyLkRpc3BsYXlOYW1lDQoJCQkJCTwvYT4NCgkJCQkjZWxzZQ0KCQkJCQkkbWVtYmVyLlVzZXIuRGlzcGxheU5hbWUNCgkJCQkjZW5kDQoJCQk8L2Rpdj4NCgkJPC9kaXY+DQoJPC9kaXY+DQojbm9kYXRhDQoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIG1lbWJlcnMiPjxkaXYgY2xhc3M9Im1lc3NhZ2Ugbm9yZWNvcmRzIj4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbm9fd2lraXMnKTwvZGl2PjwvZGl2Pg0KI2FmdGVyYWxsDQoJI3NldCAoJGhhc01vcmUgPSBmYWxzZSkNCgkjaWYgKCRtZW1iZXJzLlRvdGFsQ291bnQgPiAoKCRtZW1iZXJzLlBhZ2VJbmRleCArIDEpICogJG1lbWJlcnMuUGFnZVNpemUpKQ0KCQkjc2V0KCRoYXNNb3JlID0gdHJ1ZSkNCgkjZW5kDQoJPGRpdiBjbGFzcz0iZGF0YSIgI2lmKCRoYXNNb3JlKWRhdGEtaGFzbW9yZT0idHJ1ZSIjZW5kPjwvZGl2Pg0KI2VuZA==</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBncm91cCBtZW1iZXJzDQojIw0KI3NldCAoJHBhZ2VJbmRleCA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19wYWdlSW5kZXgnKSkNCiNzZXQoJGdyb3VwSWQgPSBmYWxzZSkNCiNzZXQoJGdyb3VwSWQgPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlSW50KCRtb2JpbGVfdjFfdXJsVG9rZW4uVmFsdWUoJ0dyb3VwSWQnKSkpDQojaWYgKCEkZ3JvdXBJZCkNCgkkY29yZV92Ml93aWRnZXQuSGlkZSgpDQojZW5kDQokY29yZV92Ml93aWRnZXQuRXhlY3V0ZUZpbGUoJ2xpc3Qudm0nKQ0K</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpewoKCXZhciBhcGkgPSB7CgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zY3JvbGxhYmxlKHsKCQkJCXJlZ2lvbjogJ2NvbnRlbnQnLAoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgewoJCQkJCWlmICgkKG9wdGlvbnMud3JhcHBlciArICcgZGl2LmRhdGE6bGFzdCcpLmRhdGEoJ2hhc21vcmUnKSkgewoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsKCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLAoJCQkJCQkJZGF0YTogewoJCQkJCQkJCXdfcGFnZUluZGV4OiBwYWdlSW5kZXgKCQkJCQkJCX0sCgkJCQkJCQlzdWNjZXNzOiBmdW5jdGlvbihyKSB7CgkJCQkJCQkJc3VjY2VzcyhyKTsKCQkJCQkJCX0sCgkJCQkJCQllcnJvcjogZnVuY3Rpb24oKSB7CgkJCQkJCQkJZXJyb3IoKTsKCQkJCQkJCX0KCQkJCQkJfSk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJc3VjY2VzcygpOwoJCQkJCX0KCQkJCX0sCgkJCQljb21wbGV0ZTogZnVuY3Rpb24oY29udGVudCkgewoJCQkJCWNvbnRlbnQgPSAkKGNvbnRlbnQpLmNzcyh7IG9wYWNpdHk6IDAgfSk7CgkJCQkJJChvcHRpb25zLndyYXBwZXIpLmZpbmQoJ2Rpdi5wb3N0LWxpc3QnKS5hcHBlbmQoY29udGVudCk7CgkJCQkJY29udGVudC5ldm9sdXRpb25UcmFuc2Zvcm0oeyBvcGFjaXR5OiAxIH0sIHsgZHVyYXRpb246IDQwMCB9KTsKCQkJCX0KCQkJfSk7CgkJfQoJfQoKCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24gPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24gfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyA9ICQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzIHx8IHt9OwoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMuZ3JvdXBNZW1iZXJzID0gYXBpOwoKfSkoalF1ZXJ5KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:GroupMembershipRequest_Name}" version="7.0.0.1" description="" instanceIdentifier="fee03ac5964c4e4b832ed8fa466850ff" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="group-membership-request">
    <contentScript>
		
#set($groupId = false)
#set($group = false)
#set($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#if ($groupId)
	#set($group = $core_v2_group.Get("%{Id=$groupId}"))
#end
#if (!$group)
	$core_v2_widget.Hide()
#end

#if (!$core_v2_nodePermission.Get("groups", $group.Id, "Group_JoinGroupByRequest").IsAllowed)
	$core_v2_widget.Hide()
#end

#set($bodyId = $core_v2_widget.UniqueId('body'))

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($group.Url)"&gt;$group.Name&lt;/a&gt;
		&lt;h1&gt;$core_v2_language.GetResource('request_membership')&lt;/h1&gt;
	&lt;/div&gt;
&lt;/div&gt;
&lt;fieldset&gt;
	&lt;div class="form-field editor"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;$core_v2_language.FormatString($core_v2_language.GetResource('request'), $group.Name)&lt;/label&gt;
		&lt;textarea id="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;&lt;/textarea&gt;
	&lt;/div&gt;
&lt;/fieldset&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.groupMembershipRequest.register({
			bodyId: '#$core_v2_encoding.JavascriptEncode($bodyId)',
			sendLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('send'))',
			groupId: $group.Id,
			userId: $core_v2_user.Accessing.Id
		});

		jQuery.telligent.evolution.mobile.refreshable(false);
		jQuery.telligent.evolution.mobile.excludeFromHistory();
	});
})
&lt;/script&gt;
		

		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
			<resource name="GroupMembershipRequest_Name">Group Membership Request</resource>
			<resource name="request">Request access to {0}</resource>
			<resource name="send">Send</resource>
			<resource name="request_membership">Request membership</resource>
		  </language>
		</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCwgdW5kZWYpew0KCXZhciBhcGkgPSB7DQoJCXJlZ2lzdGVyOiBmdW5jdGlvbihvcHRpb25zKSB7DQoJCQlvcHRpb25zLmJvZHkgPSAkKG9wdGlvbnMuYm9keUlkKTsNCg0KCQkJdmFyIHNlbmRMaW5rID0gJCgnPGEgaHJlZj0iIyIgY2xhc3M9InN1Ym1pdCI+JyArIG9wdGlvbnMuc2VuZExhYmVsICsgJzwvYT4nKTsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2V0SGVhZGVyQnV0dG9uKHNlbmRMaW5rKTsNCg0KCQkJc2VuZExpbmsub24oJ3RhcCcsIGZ1bmN0aW9uKCl7DQoJCQkJaWYgKG9wdGlvbnMuYm9keS52YWwoKS5sZW5ndGggPiAwKSB7DQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoKTsNCgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnBvc3Qoew0KCQkJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvZ3JvdXBzL3tHcm91cElkfS9tZW1iZXJzL3VzZXJzLmpzb24nLA0KCQkJCQkJZGF0YTogew0KCQkJCQkJCUdyb3VwSWQ6IG9wdGlvbnMuZ3JvdXBJZCwNCgkJCQkJCQlVc2VySWQ6IG9wdGlvbnMudXNlcklkLA0KCQkJCQkJCUdyb3VwTWVtYmVyc2hpcFR5cGU6ICdQZW5kaW5nTWVtYmVyJywNCgkJCQkJCQlNZXNzYWdlOiBvcHRpb25zLmJvZHkudmFsKCkNCgkJCQkJCX0NCgkJCQkJfSkudGhlbihmdW5jdGlvbigpew0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5iYWNrKHRydWUpOw0KCQkJCQl9KQ0KCQkJCQkuZmFpbChmdW5jdGlvbigpew0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlTG9hZGluZygpOw0KCQkJCQl9KTsNCgkJCQl9DQoJCQkJcmV0dXJuIGZhbHNlOw0KCQkJfSk7DQoJCX0NCgl9DQoNCgkkLnRlbGxpZ2VudCA9ICQudGVsbGlnZW50IHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyA9ICQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzLmdyb3VwTWVtYmVyc2hpcFJlcXVlc3QgPSBhcGk7DQoNCn0pKGpRdWVyeSwgd2luZG93KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:LikerList_Name}" version="7.0.0.1" description="" instanceIdentifier="e0331369e7ad479c8c21b5bc625ca681" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="liker-list">
    <contentScript>
		
#set($contentTypeId = false)
#if ($core_v2_page.GetQueryStringValue('ContentTypeId').length &gt; 0)
	#set($contentTypeId = $core_v2_utility.ParseGuid($core_v2_page.GetQueryStringValue('ContentTypeId')))
#end
#set($contentId = false)
#if ($core_v2_page.GetQueryStringValue('ContentId').length &gt; 0)
	#set($contentId = $core_v2_utility.ParseGuid($core_v2_page.GetQueryStringValue('ContentId')))
#end
#set($typeId = false)
#if ($core_v2_page.GetQueryStringValue('TypeId').length &gt; 0)
	#set($typeId = $core_v2_utility.ParseGuid($core_v2_page.GetQueryStringValue('TypeId')))
#end

#if (!$contentTypeId || !$contentId)
	$core_v2_widget.Hide()
#end

#set($content = false)
#set($content = $core_v2_content.Get($contentId, $contentTypeId))
#if ($content)
	&lt;div class="banner condensed"&gt;
		&lt;div class="context"&gt;
			#if ($content.Application)
				#if ($content.Application.Container &amp;&amp; $content.Application.Container.Id != $content.Application.Id)
					&lt;a href="$core_v2_encoding.HtmlAttributeEncode($content.Application.Container.Url)"&gt;$!content.Application.Container.HtmlName('Web')&lt;/a&gt;
				#end
				#if ($content.Application.Id != $content.Id)
					&lt;a href="$core_v2_encoding.HtmlAttributeEncode($content.Application.Url)"&gt;$!content.Application.HtmlName('Web')&lt;/a&gt;
				#end
			#end
			&lt;a href="$core_v2_encoding.HtmlAttributeEncode($content.Url)"&gt;$!content.HtmlName('Web')&lt;/a&gt;
			&lt;h1&gt;$core_v2_language.GetResource('likers')&lt;/h1&gt;
		&lt;/div&gt;
	&lt;/div&gt;

#end

## load and render likers
&lt;div class="post-list likers"&gt;
	#set($pageIndex = 0)
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.likerList.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
			contentId: '$contentId',
			contentTypeId: '$contentTypeId',
			typeId: #if ($typeId) '$typeId' #else '' #end
		});
	});
})
&lt;/script&gt;
		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
	  	<resource name="LikerList_Name">Like List</resource>
		<resource name="no_likers">No Likers</resource>
		<resource name="likers">Likers</resource>
	  </language>
	</languageResources>
    <files>
      <file name="list.vm">IyMgI3NldCgkbGlrZXJzID0gJGNvcmVfdjJfbGlrZS5MaXN0KCIleyBDb250ZW50SWQgPSAkY29udGVudElkLCBDb250ZW50VHlwZUlkID0gJGNvbnRlbnRUeXBlSWQsIFNvcnRCeSA9ICdEYXRlJywgU29ydE9yZGVyID0gJ0Rlc2NlbmRpbmcnLCBUeXBlSWQgPSAkdHlwZUlkIH0iKSkKI3NldCgkbGlrZXJzID0gJGNvcmVfdjJfbGlrZS5MaXN0KCIleyBDb250ZW50SWQgPSAkY29udGVudElkLCBDb250ZW50VHlwZUlkID0gJGNvbnRlbnRUeXBlSWQsIFNvcnRCeSA9ICdEYXRlJywgU29ydE9yZGVyID0gJ0Rlc2NlbmRpbmcnIH0iKSkKI2ZvcmVhY2goJGxpa2VyIGluICRsaWtlcnMpCiNlYWNoCgkjc2V0ICgkdXNlciA9ICRsaWtlci5Vc2VyKQoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIGxpa2VyIgoJCWRhdGEtdGFyZ2V0dXJsPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCR1c2VyLlByb2ZpbGVVcmwpIj4KCQk8ZGl2IGNsYXNzPSJwb3N0Ij4KCQkJPGRpdiBjbGFzcz0iYXZhdGFyIj4KCQkJCSRjb3JlX3YyX3VpLkdldFJlc2l6ZWRJbWFnZUh0bWwoJHVzZXIuQXZhdGFyVXJsLCA0MCwgNDAsICIle2JvcmRlcj0nMCcsIGFsdD0kdXNlci5EaXNwbGF5TmFtZSwgUmVzaXplTWV0aG9kPSdab29tQW5kQ3JvcCcsYm9yZGVyPScwJ30iKQoJCQk8L2Rpdj4KCQkJPGRpdiBjbGFzcz0iY29udGVudCI+CgkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCR1c2VyLlByb2ZpbGVVcmwpIj4kdXNlci5EaXNwbGF5TmFtZTwvYT4KCQkJPC9kaXY+CgkJPC9kaXY+Cgk8L2Rpdj4KI25vZGF0YQoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIGxpa2VyIj48ZGl2IGNsYXNzPSJtZXNzYWdlIG5vcmVjb3JkcyI+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ25vX2xpa2VycycpPC9kaXY+PC9kaXY+CiNhZnRlcmFsbAoJI3NldCAoJGhhc01vcmUgPSBmYWxzZSkKCSNpZiAoJGxpa2Vycy5Ub3RhbENvdW50ID4gKCgkbGlrZXJzLlBhZ2VJbmRleCArIDEpICogJGxpa2Vycy5QYWdlU2l6ZSkpCgkJI3NldCgkaGFzTW9yZSA9IHRydWUpCgkjZW5kCgk8ZGl2IGNsYXNzPSJkYXRhIiAjaWYoJGhhc01vcmUpZGF0YS1oYXNtb3JlPSJ0cnVlIiNlbmQ+PC9kaXY+CiNlbmQ=</file>
      <file name="more.vm">IyMKIyMgQWpheCBjYWxsYmFjayBmb3IgbG9hZGluZyBtb3JlIGxpa2VycwojIwoKI3NldCAoJHBhZ2VJbmRleCA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19wYWdlSW5kZXgnKSkKCiNzZXQoJGNvbnRlbnRUeXBlSWQgPSBmYWxzZSkKI2lmICgkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfY29udGVudFR5cGVJZCcpLmxlbmd0aCA+IDApCgkjc2V0KCRjb250ZW50VHlwZUlkID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUd1aWQoJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCdDb250ZW50VHlwZUlkJykpKQojZW5kCgojc2V0KCRjb250ZW50SWQgPSBmYWxzZSkKI2lmICgkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfY29udGVudElkJykubGVuZ3RoID4gMCkKCSNzZXQoJGNvbnRlbnRJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VHdWlkKCRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnQ29udGVudElkJykpKQojZW5kCgojc2V0KCR0eXBlSWQgPSBmYWxzZSkKI2lmICgkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfdHlwZUlkJykubGVuZ3RoID4gMCkKCSNzZXQoJHR5cGVJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VHdWlkKCRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnVHlwZUlkJykpKQojZW5kCgojaWYgKCEkY29udGVudFR5cGVJZCB8fCAhJGNvbnRlbnRJZCkKCSRjb3JlX3YyX3dpZGdldC5IaWRlKCkKI2VuZAokY29yZV92Ml93aWRnZXQuRXhlY3V0ZUZpbGUoJ2xpc3Qudm0nKQo=</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpewoKCXZhciBhcGkgPSB7CgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zY3JvbGxhYmxlKHsKCQkJCXJlZ2lvbjogJ2NvbnRlbnQnLAoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgewoJCQkJCWlmICgkKG9wdGlvbnMud3JhcHBlciArICcgZGl2LmRhdGE6bGFzdCcpLmRhdGEoJ2hhc21vcmUnKSkgewoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsKCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLAoJCQkJCQkJZGF0YTogewoJCQkJCQkJCXdfcGFnZUluZGV4OiBwYWdlSW5kZXgsCgkJCQkJCQkJd19jb250ZW50SWQ6IG9wdGlvbnMuY29udGVudElkLAoJCQkJCQkJCXdfY29udGVudFR5cGVJZDogb3B0aW9ucy5jb250ZW50VHlwZUlkLAoJCQkJCQkJCXdfdHlwZUlkOiBvcHRpb25zLnR5cGVJZAoJCQkJCQkJfSwKCQkJCQkJCXN1Y2Nlc3M6IGZ1bmN0aW9uKHIpIHsKCQkJCQkJCQlzdWNjZXNzKHIpOwoJCQkJCQkJfSwKCQkJCQkJCWVycm9yOiBmdW5jdGlvbigpIHsKCQkJCQkJCQllcnJvcigpOwoJCQkJCQkJfQoJCQkJCQl9KTsKCQkJCQl9IGVsc2UgewoJCQkJCQlzdWNjZXNzKCk7CgkJCQkJfQoJCQkJfSwKCQkJCWNvbXBsZXRlOiBmdW5jdGlvbihjb250ZW50KSB7CgkJCQkJY29udGVudCA9ICQoY29udGVudCkuY3NzKHsgb3BhY2l0eTogMCB9KTsKCQkJCQkkKG9wdGlvbnMud3JhcHBlcikuZmluZCgnZGl2LnBvc3QtbGlzdCcpLmFwcGVuZChjb250ZW50KTsKCQkJCQljb250ZW50LmV2b2x1dGlvblRyYW5zZm9ybSh7IG9wYWNpdHk6IDEgfSwgeyBkdXJhdGlvbjogNDAwIH0pOwoJCQkJfQoJCQl9KTsKCQl9Cgl9CgoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5saWtlckxpc3QgPSBhcGk7Cgp9KShqUXVlcnkpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:Login_Name}" version="7.0.0.1" description="" instanceIdentifier="ce856d3882c4417ea991d42844187c8e" isCacheable="true" varyCacheByUser="false" showHeaderByDefault="false" cssClass="login">
    <contentScript>
		

#set ($siteName = '')
#set ($siteInfo = $core_v2_infoResult.Get())
#set ($siteName = $core_v2_language.Truncate($siteInfo.SiteName, 35, '...'))
#set ($siteNameId = $core_v2_widget.UniqueId('siteNameId'))
#set ($loginLinkId = $core_v2_widget.UniqueId('loginLinkId'))

&lt;h1 id="$core_v2_encoding.HtmlAttributeEncode($siteNameId)"&gt;$siteName&lt;/h1&gt;
&lt;a id="$core_v2_encoding.HtmlAttributeEncode($loginLinkId)" class="internal-link login" href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_authentication.Login())"&gt;$core_v2_language.GetResource('login')&lt;/a&gt;

&lt;script&gt;
var wrapperId = "#${core_v2_encoding.JavascriptEncode($core_v2_widget.WrapperElementId)}";
var siteNameId = "#${core_v2_encoding.JavascriptEncode($siteNameId)}";
var loginLinkId = "#${core_v2_encoding.JavascriptEncode($loginLinkId)}";
jQuery(function(j){
	jQuery.telligent.evolution.mobile.setClass('login');
	jQuery.telligent.evolution.mobile.refreshable(false);
	jQuery.telligent.evolution.mobile.navigable(false);
	j.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		j(siteNameId)
			.evolutionTransform({ top: 50 })
			.evolutionTransform({ opacity: 1, top: 0 }, {
				duration: 250,
				easing: 'ease-out',
				complete: function() {
					j(loginLinkId).evolutionTransform({ opacity: 1 }, {
						duration: 250,
						easing: 'ease-out'
					});
				}
			});
		j(wrapperId).on('pointermove', function(e){
			e.preventDefault();
		});
	});
});
&lt;/script&gt;

		
		</contentScript>
    <headerScript>
	</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="Login_Name">Login</resource>
		<resource name="login">Login</resource>
	  </language>
	</languageResources>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:MediaGallery_Name}" version="7.0.0.1" description="" instanceIdentifier="eb11e4073f3d4cc19b6327ecd54614d6" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="media-gallery">
    <contentScript>
		
#set($galleryId = false)
#set($galleryId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GalleryId')))
#if (!$galleryId)
	$core_v2_widget.Hide()
#end

#set ($accessingUser = $core_v2_user.Accessing)
#set ($accessingUserIsRegistered = false)
#if ($core_v2_user.IsRegistered($accessingUser.Id))
	#set ($accessingUserIsRegistered = true)
#end

#set($gallery = $core_v2_gallery.Get("%{Id=$galleryId}"))
#set($group = $gallery.Group)
&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($gallery.Group.Url)"&gt;$gallery.Group.Name&lt;/a&gt;
		&lt;h1&gt;$gallery.Name&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 40, 40, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
	&lt;div class="ui-links actions" data-maxlinks="0"&gt;
		&lt;ul&gt;
			#set ($bookmarkableContentId = $gallery.ApplicationId)
			#set ($bookmarkableContentTypeId = $core_v2_gallery.ContentTypeId)
			#if ($core_v2_bookmark.SupportsBookmarks($bookmarkableContentTypeId) &amp;&amp; $core_v2_bookmark.CanBookmark($bookmarkableContentId, $bookmarkableContentTypeId) &amp;&amp; $core_v2_bookmark.CanUnBookmark($bookmarkableContentId, $bookmarkableContentTypeId))
				&lt;li&gt;$core_v2_ui.Bookmark($bookmarkableContentId, $bookmarkableContentTypeId)&lt;/li&gt;
			#end
			&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;$core_v2_language.GetResource('more')&lt;/a&gt;&lt;/li&gt;
			&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
		&lt;/ul&gt;
	&lt;/div&gt;
&lt;/div&gt;

## load and render media galleries
&lt;div class="post-list galleries"&gt;
	#set($pageIndex = 0)
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.mediaGallery.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
			GalleryId: $galleryId,
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			postUrl: '$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('gallery-addmedia', $galleryId))',
			canPost: #if($core_v2_nodePermission.Get("mediagalleries", $galleryId, "MediaGallery_CreatePost").IsAllowed) true#else false#end
		});
	});
})
&lt;/script&gt;
		

		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
			<resource name="MediaGallery_Name">Media Gallery</resource>
			<resource name="media_gallery">Media Galleries</resource>
			<resource name="no_gallery">There are no files in this gallery.</resource>
			<resource name="post">New</resource>
			<resource name="cancel">Cancel</resource>
			<resource name="more">More</resource>
		  </language>
		</languageResources>
    <files>
      <file name="list.vm">I3NldCgkbWVkaWFzID0gJGNvcmVfdjJfbWVkaWEuTGlzdCgiJXtHYWxsZXJ5SWQ9JGdhbGxlcnlJZCxHcm91cElkPSRncm91cC5JZCxQYWdlSW5kZXg9JHBhZ2VJbmRleCxQYWdlU2l6ZT01LFNvcnRCeT0nUG9zdERhdGUnLFNvcnRPcmRlcj0nRGVzY2VuZGluZyd9IikpDQojZm9yZWFjaCgkbWVkaWEgaW4gJG1lZGlhcykNCiNlYWNoDQoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIG1lZGlhIiBkYXRhLXRhcmdldHVybD0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkbW9iaWxlX3YxX3VybC5Gb3JtYXQoJ21lZGlhJywgJG1lZGlhLklkKSkiPg0KCQk8ZGl2IGNsYXNzPSJwb3N0IHdpdGgtdGh1bWJuYWlsIj4NCgkJCTxkaXYgY2xhc3M9InRodW1ibmFpbCI+DQoJCQkJJCFjb3JlX3YyX3VpLkdldFByZXZpZXdIdG1sKCRtZWRpYS5GaWxlLkZpbGVVcmwsICIle1dpZHRoPTYwLEhlaWdodD02MH0iKQ0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJkZXRhaWxzIj4NCgkJCQk8ZGl2IGNsYXNzPSJkYXRlIj4kY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRBZ29EYXRlKCRtZWRpYS5EYXRlKTwvZGl2Pg0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJjb250ZW50Ij4NCgkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRtb2JpbGVfdjFfdXJsLkZvcm1hdCgnbWVkaWEnLCAkbWVkaWEuSWQpKSI+JG1lZGlhLlRpdGxlPC9hPg0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJhY3Rpb25zIj4NCgkJCQk8dWw+DQoJCQkJCSMjIExpa2UNCgkJCQkJI2lmICgkYWNjZXNzaW5nVXNlcklzUmVnaXN0ZXJlZCAmJiAkY29yZV92Ml9saWtlLkNhbkxpa2UoJG1lZGlhLkNvbnRlbnRJZCwgJGNvcmVfdjJfbWVkaWEuQ29udGVudFR5cGVJZCkpDQoJCQkJCQk8bGkgY2xhc3M9ImFjdGlvbi1saWtlIj4NCgkJCQkJCQkjc2V0KCRmb3JtYXQgPSAne3RvZ2dsZX0gPHNwYW4gY2xhc3M9ImNvdW50Ij48c3BhbiBjbGFzcz0iaWNvbiI+PC9zcGFuPntjb3VudH08L3NwYW4+JykNCgkJCQkJCQkkY29yZV92Ml91aS5MaWtlKCRtZWRpYS5Db250ZW50SWQsICRjb3JlX3YyX21lZGlhLkNvbnRlbnRUeXBlSWQsICIleyBGb3JtYXQgPSAkZm9ybWF0IH0iKQ0KCQkJCQkJPC9saT4NCgkJCQkJI2VuZA0KCQkJCQk8bGk+DQoJCQkJCQk8c3BhbiBjbGFzcz0iZGV0YWlsIHRocmVhZHMiPg0KDQoJCQkJCQkJIyMgQ29tbWVudHMNCgkJCQkJCQkjaWYoJG1lZGlhLkNvbW1lbnRDb3VudCA9PSAwKQ0KCQkJCQkJCQlObyBjb21tZW50cw0KCQkJCQkJCSNlbHNlaWYoJG1lZGlhLkNvbW1lbnRDb3VudCA9PTEpDQoJCQkJCQkJCSRtZWRpYS5Db21tZW50Q291bnQgY29tbWVudA0KCQkJCQkJCSNlbHNlaWYoJG1lZGlhLkNvbW1lbnRDb3VudCA+IDEpDQoJCQkJCQkJCSRtZWRpYS5Db21tZW50Q291bnQgY29tbWVudHMNCgkJCQkJCQkjZW5kDQoJCQkJCQk8L3NwYW4+DQoJCQkJCTwvbGk+DQoJCQkJPC91bD4NCgkJCTwvZGl2Pg0KCQk8L2Rpdj4NCgk8L2Rpdj4NCiNub2RhdGENCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gbWVkaWFzIj48ZGl2IGNsYXNzPSJtZXNzYWdlIG5vcmVjb3JkcyI+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ25vX2dhbGxlcnknKTwvZGl2PjwvZGl2Pg0KI2FmdGVyYWxsDQoJI3NldCAoJGhhc01vcmUgPSBmYWxzZSkNCgkjaWYgKCRtZWRpYXMuVG90YWxDb3VudCA+ICgoJG1lZGlhcy5QYWdlSW5kZXggKyAxKSAqICRtZWRpYXMuUGFnZVNpemUpKQ0KCQkjc2V0KCRoYXNNb3JlID0gdHJ1ZSkNCgkjZW5kDQoJPGRpdiBjbGFzcz0iZGF0YSIgI2lmKCRoYXNNb3JlKWRhdGEtaGFzbW9yZT0idHJ1ZSIjZW5kPjwvZGl2Pg0KI2VuZA==</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSBtZWRpYSBnYWxsZXJpZXMNCiMjDQojc2V0ICgkcGFnZUluZGV4ID0gJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X3BhZ2VJbmRleCcpKQ0KI3NldCgkZ3JvdXBJZCA9IGZhbHNlKQ0KI3NldCgkZ3JvdXBJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJG1vYmlsZV92MV91cmxUb2tlbi5WYWx1ZSgnR3JvdXBJZCcpKSkNCiNpZiAoISRncm91cElkKQ0KCSRjb3JlX3YyX3dpZGdldC5IaWRlKCkNCiNlbmQNCiNzZXQoJGdhbGxlcnlJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJG1vYmlsZV92MV91cmxUb2tlbi5WYWx1ZSgnR2FsbGVyeUlkJykpKQ0KI2lmICghJGdhbGxlcnlJZCkNCgkkY29yZV92Ml93aWRnZXQuSGlkZSgpDQojZW5kDQokY29yZV92Ml93aWRnZXQuRXhlY3V0ZUZpbGUoJ2xpc3Qudm0nKQ0K</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2Nyb2xsYWJsZSh7DQoJCQkJcmVnaW9uOiAnY29udGVudCcsDQoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgew0KCQkJCQlpZiAoJChvcHRpb25zLndyYXBwZXIgKyAnIGRpdi5kYXRhOmxhc3QnKS5kYXRhKCdoYXNtb3JlJykpIHsNCgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoew0KCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLA0KCQkJCQkJCWRhdGE6IHsNCgkJCQkJCQkJd19wYWdlSW5kZXg6IHBhZ2VJbmRleA0KCQkJCQkJCX0sDQoJCQkJCQkJc3VjY2VzczogZnVuY3Rpb24ocikgew0KCQkJCQkJCQlzdWNjZXNzKHIpOw0KCQkJCQkJCX0sDQoJCQkJCQkJZXJyb3I6IGZ1bmN0aW9uKCkgew0KCQkJCQkJCQllcnJvcigpOw0KCQkJCQkJCX0NCgkJCQkJCX0pOw0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJc3VjY2VzcygpOw0KCQkJCQl9DQoJCQkJfSwNCgkJCQljb21wbGV0ZTogZnVuY3Rpb24oY29udGVudCkgew0KCQkJCQljb250ZW50ID0gJChjb250ZW50KS5jc3MoeyBvcGFjaXR5OiAwIH0pOw0KCQkJCQkkKG9wdGlvbnMud3JhcHBlcikuZmluZCgnZGl2LnBvc3QtbGlzdCcpLmFwcGVuZChjb250ZW50KTsNCgkJCQkJY29udGVudC5ldm9sdXRpb25UcmFuc2Zvcm0oeyBvcGFjaXR5OiAxIH0sIHsgZHVyYXRpb246IDQwMCB9KTsNCgkJCQl9DQoJCQl9KTsNCg0KCQkJaWYgKG9wdGlvbnMuY2FuUG9zdCkgew0KCQkJCXZhciBwb3N0TGluayA9ICQoJzxhIGhyZWY9IicgKyBvcHRpb25zLnBvc3RVcmwgKyAnIiBjbGFzcz0iYWRkIj4nICsgb3B0aW9ucy5wb3N0TGFiZWwgKyAnPC9hPicpOw0KCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2V0SGVhZGVyQnV0dG9uKHBvc3RMaW5rKTsNCgkJCX0NCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMubWVkaWFHYWxsZXJ5ID0gYXBpOw0KDQp9KShqUXVlcnkpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:MediaUploadEdit_Name}" version="7.0.0.1" description="" instanceIdentifier="0f8fca892498461cbb1609064576c23f" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="media-gallery-add-edit">
    <contentScript>
		
#set ($pageName = $mobile_v1_url.Current)
#set ($mode = false)
#set ($contentTypeId = $core_v2_media.ContentTypeId)

#set($galleryId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GalleryId')))
#if ($galleryId &lt; 0)
	#set($mediaId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('MediaId')))
	#if ($mediaId &lt; 0)
		$core_v2_widget.Hide()
	#end
#end

#set($editMedia = false)
#set($gallery = false)
#if($pageName == 'gallery-addmedia')
	#set ($mode = 'add')
	#set ($gallery = $core_v2_gallery.Get("%{Id = $galleryId}"))
#elseif ($pageName == 'media-edit')
	#set ($mode = 'edit')
	#set ($editMedia = $core_v2_media.Get($mediaId))
	#set ($gallery = $core_v2_gallery.Get("%{Id = $editMedia.MediaGalleryId}"))
#else
	$core_v2_widget.Hide()
#end

#if (!$gallery)
	$core_v2_widget.Hide()
#end

#set($canUpload = $core_v2_nodePermission.Get('mediagalleries',$gallery.Id,'MediaGallery_AttachFileLocal').IsAllowed)
#set($canLink = $core_v2_nodePermission.Get('mediagalleries',$gallery.Id,'MediaGallery_AttachFileRemote').IsAllowed)
#if (!$canUpload &amp;&amp; !$canLink)
	$core_v2_widget.Hide()
#end

##start of upload stuff

#set ($accessingUser = $core_v2_user.Accessing)
#set ($accessingUserIsRegistered = false)
#if ($core_v2_user.IsRegistered($accessingUser.Id))
	#set ($accessingUserIsRegistered = true)
#end

#set($userId = $accessingUser.Id)
#set($contextId = $core_v2_uploadedFile.CreateContextId())

#set($attachmentFileName = false)
#set($attachmentUrl = false)
#set($attachmentIsRemote = false)
#if ($editMedia)
	#set($attachmentFileName = $editMedia.File.FileName)
	#set($attachmentUrl = $editMedia.File.FileUrl)
	#set($attachmentIsRemote = $editMedia.File.IsRemoteAttachment)
#end


##Uploaded CSS Id's
#set($titleId = $core_v2_widget.UniqueId('Title'))
#set($fileTitleId = $core_v2_widget.UniqueId('fileTitle'))
#set($saveFileId = $core_v2_widget.UniqueId('saveFile'))
#set($bodyId = $core_v2_widget.UniqueId('Body'))
#set ($subscribeId = $core_v2_widget.UniqueId('Subscribe'))

#set($group = $gallery.Group)
&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($gallery.Group.Url)"&gt;$gallery.Group.Name&lt;/a&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($gallery.Url)"&gt;$gallery.Name&lt;/a&gt;
		#if ($editMedia)
			&lt;h1&gt;$editMedia.Title&lt;/h1&gt;
		#else
			&lt;h1&gt;$core_v2_language.GetResource('NewPost')&lt;/h1&gt;
		#end
	&lt;/div&gt;
&lt;/div&gt;

&lt;fieldset&gt;
	## Title
	&lt;div class="form-field text"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($titleId)"&gt;$core_v2_language.GetResource('title')&lt;/label&gt;
		&lt;input type="text" maxlength="256" id="$core_v2_encoding.HtmlAttributeEncode($titleId)" value="#if($mode=='edit')$editMedia.Title#end" /&gt;
	&lt;/div&gt;

	##File Uploads
	&lt;div class="form-field" id="$core_v2_widget.UniqueId('attachment')" data-upload="$canUpload" data-link="$canLink"&gt;
		#if ($canUpload &amp;&amp; $canLink)
			&lt;label for="$core_v2_widget.UniqueId('attachment_input')" class="field-item-name"&gt;$core_v2_language.GetResource('MediaGalleryPostAdmin_FileOrUrl')&lt;/label&gt;
		#elseif ($canUpload)
			&lt;label for="$core_v2_widget.UniqueId('attachment_input')" class="field-item-name"&gt;$core_v2_language.GetResource('Attachment_File')&lt;/label&gt;
		#elseif ($canLink)
			&lt;label for="$core_v2_widget.UniqueId('attachment_input')" class="field-item-name"&gt;$core_v2_language.GetResource('Attachment_Url')&lt;/label&gt;
		#end
		&lt;span class="file"&gt;
			&lt;input type="text" columns="90" id="$core_v2_widget.UniqueId('attachment_input')" #if($attachmentUrl &amp;&amp; $attachmentIsRemote)value="$core_v2_encoding.HtmlAttributeEncode($attachmentUrl)"#elseif($attachmentFileName)value="$core_v2_encoding.HtmlAttributeEncode($attachmentFileName)"#end /&gt;
		&lt;/span&gt;
		&lt;div class="preview"&gt;
		&lt;/div&gt;
		#if ($canUpload)
			&lt;span class="upload"&gt;
				&lt;a href="#" class="upload add" id="$core_v2_widget.UniqueId('upload')"&gt;$core_v2_language.GetResource('UploadFile')&lt;/a&gt;
				&lt;a href="#" class="remove" style="margin-left: 1em;"&gt;$core_v2_language.GetResource('RemoveFile')&lt;/a&gt;
			&lt;/span&gt;
		#end
	&lt;/div&gt;

	## TinyMCE
	&lt;div class="form-field editor"&gt;
		#set($body = '')
		#if($editMedia)
			#set($body = $editMedia.Body('raw'))
		#end

		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;$core_v2_language.GetResource('body')&lt;/label&gt;
		$core_v2_editor.Render('PostBody', "%{Width='100%', Height='60px', Value=$body, ContentTypeId=$contentTypeId}")
	&lt;/div&gt;

	## Email Replies
	#if ($core_v2_user.IsRegistered($core_v2_user.Accessing.Id))
		&lt;div class="form-field checkbox inline-label"&gt;
			&lt;label for="$core_v2_encoding.HtmlAttributeEncode($subscribeId)"&gt;$core_v2_language.GetResource('subscribe')&lt;/label&gt;
			&lt;input id="$core_v2_encoding.HtmlAttributeEncode($subscribeId)" type="checkbox" #if($editMedia &amp;&amp; $core_v2_media.IsSubscribed($editMedia.Id)) checked="checked"#end/&gt;
		&lt;/div&gt;
	#end
&lt;/fieldset&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.mediaGalleryAddEdit.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			mode: '$mode',
			file: {
				fileName: '#if($attachmentFileName)$core_v2_encoding.JavascriptEncode($attachmentFileName)#end',
				url: '#if($attachmentUrl)$core_v2_encoding.JavascriptEncode($attachmentUrl)#end',
				isRemote:#if($attachmentIsRemote) true#else false#end,
				isNew: false
			},
			attachmentId: '$core_v2_widget.UniqueId('attachment')',
			attachmentProgressText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UploadProgress'))',
			attachmentChangeText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('ChangeFile'))',
			attachmentAddText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UploadFile'))',
			previewAttachmentUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('previewAttachment.vm'))',
			uploadContextId: '$core_v2_encoding.JavascriptEncode($contextId)',
			uploadFileUrl : '$core_v2_encoding.JavascriptEncode($core_v2_uploadedFile.GetUploadUrl($contextId))',
			fileId: '$!editMedia.Id',
			mediaGalleryId: '$gallery.Id',
			titleInput: '#$core_v2_encoding.JavascriptEncode($titleId)',
			getBodyContent: function() { return $core_v2_editor.GetContentScript('PostBody') },
			subscribeInput: '#$core_v2_encoding.JavascriptEncode($subscribeId)',
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			editLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('edit'))',
			lookUpUrl : "$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('lookUp.vm'))",
			selectFileLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('file_upload'))'
		});

		jQuery.telligent.evolution.mobile.refreshable(false);
		jQuery.telligent.evolution.mobile.excludeFromHistory();
	});
})
&lt;/script&gt;
		

		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
			<resource name="MediaUploadEdit_Name">Media Gallery Upload Edit</resource>
			<resource name="title">Title</resource>
			<resource name="post">Post</resource>
			<resource name="edit">Edit</resource>
			<resource name="subscribe">Notify me about comments</resource>
			<resource name="MediaGalleryPostAdmin_FileOrUrl">File or website</resource>
			<resource name="Attachment_File">File</resource>
			<resource name="Attachment_Url">URL</resource>
			<resource name="UploadFile">Upload file</resource>
			<resource name="UploadProgress">Uploading ({0}%)...</resource>
			<resource name="ChangeFile">Change file</resource>
			<resource name="RemoveFile">Remove file</resource>
			<resource name="NewPost">Upload a file</resource>
		  </language>
		</languageResources>
    <files>
      <file name="lookUp.vm">JGNvcmVfdjJfcGFnZS5TZXRDb250ZW50VHlwZSgnYXBwbGljYXRpb24vanNvbicpDQojc2V0KCRmaWxlID0gJGNvcmVfdjJfcGFnZS5HZXRGb3JtVmFsdWUoJ2ZpbGVUeXBlJykpDQojc2V0KCRmaWxlVHlwZSA9ICRjb3JlX3YyX3VpLkdldE1pbWVUeXBlKCRmaWxlKSkNCnsidHlwZSI6IiRmaWxlVHlwZSJ9</file>
      <file name="previewAttachment.vm">IyMgTG9hZHMgQXR0YWNobWVudCBQcmV2aWV3DQoNCiNzZXQoJHVybCA9IGZhbHNlKQ0KI3NldCAoJHVybCA9ICRjb3JlX3YyX3BhZ2UuR2V0Rm9ybVZhbHVlKCd3X3VybCcpKQ0KI2lmICghJHVybCkNCgkjc2V0ICgkZmlsZU5hbWUgPSBmYWxzZSkNCgkjc2V0ICgkZmlsZU5hbWUgPSAkY29yZV92Ml9wYWdlLkdldEZvcm1WYWx1ZSgnd19maWxlbmFtZScpKQ0KCSNzZXQgKCR1cGxvYWRDb250ZXh0SWQgPSBmYWxzZSkNCgkjc2V0ICgkdXBsb2FkQ29udGV4dElkID0gJGNvcmVfdjJfcGFnZS5HZXRGb3JtVmFsdWUoJ3dfdXBsb2FkQ29udGV4dElkJykpDQoJI2lmICgkZmlsZU5hbWUgJiYgJHVwbG9hZENvbnRleHRJZCkNCgkJI3NldCAoJGZpbGUgPSBmYWxzZSkNCgkJI3NldCAoJGZpbGUgPSAkY29yZV92Ml91cGxvYWRlZEZpbGUuR2V0KCR1cGxvYWRDb250ZXh0SWQsICRmaWxlTmFtZSkpDQoJCSNpZiAoJGZpbGUpDQoJCSAgICNzZXQgKCR1cmwgPSAkZmlsZS5VcmwpDQoJCSNlbmQNCgkjZW5kDQojZW5kDQoNCiNpZiAoJHVybCkNCgkkIWNvcmVfdjJfdWkuR2V0UHJldmlld0h0bWwoJHVybCwgIiV7V2lkdGg9MzIwLCBIZWlnaHQ9MjQwLCBPdXRwdXRJc1BlcnNpc3RlZD0nRmFsc2UnfSIpDQojZW5k</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCwgdW5kZWYpew0KDQoJdmFyIF9jcmVhdGVGaWxlID0gZnVuY3Rpb24ob3B0aW9ucykgew0KDQoJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoKTsNCg0KCQl2YXIgZGF0YSA9IHt9Ow0KCQlpZiAob3B0aW9ucy5maWxlICYmIG9wdGlvbnMuZmlsZS5pc05ldykgew0KCQkJaWYgKG9wdGlvbnMuZmlsZS5pc1JlbW90ZSkgew0KCQkJCWRhdGEuRmlsZU5hbWUgPSBvcHRpb25zLmZpbGUudXJsOw0KCQkJCWRhdGEuRmlsZVVybCA9IG9wdGlvbnMuZmlsZS51cmw7DQoJCQl9IGVsc2Ugew0KCQkJCWRhdGEuRmlsZU5hbWUgPSBvcHRpb25zLmZpbGUuZmlsZU5hbWU7DQoJCQkJZGF0YS5GaWxlVXBsb2FkQ29udGV4dCA9IG9wdGlvbnMudXBsb2FkQ29udGV4dElkOw0KCQkJfQ0KCQl9DQoNCgkJaWYob3B0aW9ucy5tb2RlID09ICdhZGQnKSB7DQoJCQlkYXRhLk5hbWUgPSBvcHRpb25zLnRpdGxlOw0KCQkJZGF0YS5EZXNjcmlwdGlvbiA9IG9wdGlvbnMuZGVzY3JpcHRpb247DQoJCQlkYXRhLm1lZGlhZ2FsbGVyeWlkID0gb3B0aW9ucy5tZWRpYUdhbGxlcnlJZDsNCgkJCWRhdGEuQ29udGVudFR5cGUgPSBvcHRpb25zLmZpbGVUeXBlOw0KDQoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ucG9zdCh7DQoJCQkJdXJsOiBqUXVlcnkudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi9tZWRpYS97bWVkaWFnYWxsZXJ5aWR9L2ZpbGVzLmpzb24nLA0KCQkJCWRhdGE6IGRhdGEsDQoJCQkJc3VjY2VzczogZnVuY3Rpb24ocmVzcG9uc2UpIHsNCgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7DQoJCQkJCQl1cmw6IGpRdWVyeS50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ2FwaS5hc2h4L3YyL21lZGlhL3ttZWRpYWdhbGxlcnlpZH0vZmlsZXMve2ZpbGVpZH0vc3Vic2NyaXB0aW9ucy5qc29uJywNCgkJCQkJCWRhdGE6IHsNCgkJCQkJCQltZWRpYWdhbGxlcnlpZDogcmVzcG9uc2UuTWVkaWEuTWVkaWFHYWxsZXJ5SWQsDQoJCQkJCQkJZmlsZWlkOiByZXNwb25zZS5NZWRpYS5JZCwNCgkJCQkJCQlJc1N1YnNjcmliZWQ6IG9wdGlvbnMuc3Vic2NyaWJlDQoJCQkJCQl9LA0KCQkJCQkJc3VjY2VzczogZnVuY3Rpb24oYW5zd2VyKSB7DQoNCgkJCQkJCX0NCgkJCQkJfSk7DQoJCQkJCXZhciBsaW5rID0gJy9tZWRpYWZpbGVzLycgKyByZXNwb25zZS5NZWRpYS5JZDsNCgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5sb2FkKGxpbmssIHsgcmVmcmVzaDogdHJ1ZSB9KTsNCgkJCQl9DQoJCQl9KQ0KCQkJLmZhaWwoZnVuY3Rpb24oKSB7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlTG9hZGluZygpOw0KCQkJfSk7DQoJCX0gZWxzZSBpZiAob3B0aW9ucy5tb2RlID09ICdlZGl0Jykgew0KCQkJZGF0YS5tZWRpYWdhbGxlcnlpZCA9IG9wdGlvbnMubWVkaWFHYWxsZXJ5SWQ7DQoJCQlkYXRhLmZpbGVpZCA9IG9wdGlvbnMuZmlsZUlkOw0KCQkJZGF0YS5OYW1lID0gb3B0aW9ucy50aXRsZTsNCgkJCWRhdGEuRGVzY3JpcHRpb24gPSBvcHRpb25zLmRlc2NyaXB0aW9uOw0KCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7DQoJCQkJdXJsOiBqUXVlcnkudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi9tZWRpYS97bWVkaWFnYWxsZXJ5aWR9L2ZpbGVzL3tmaWxlaWR9Lmpzb24nLA0KCQkJCWRhdGE6IGRhdGEsDQoJCQkJc3VjY2VzczogZnVuY3Rpb24ocmVzcG9uc2UpIHsNCgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7DQoJCQkJCQl1cmw6IGpRdWVyeS50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ2FwaS5hc2h4L3YyL21lZGlhL3ttZWRpYWdhbGxlcnlpZH0vZmlsZXMve2ZpbGVpZH0vc3Vic2NyaXB0aW9ucy5qc29uJywNCgkJCQkJCWRhdGE6IHsNCgkJCQkJCQltZWRpYWdhbGxlcnlpZDogcmVzcG9uc2UuTWVkaWEuTWVkaWFHYWxsZXJ5SWQsDQoJCQkJCQkJZmlsZWlkOiByZXNwb25zZS5NZWRpYS5JZCwNCgkJCQkJCQlJc1N1YnNjcmliZWQ6IG9wdGlvbnMuc3Vic2NyaWJlDQoJCQkJCQl9LA0KCQkJCQkJc3VjY2VzczogZnVuY3Rpb24oYW5zd2VyKSB7DQoNCgkJCQkJCX0NCgkJCQkJfSk7DQoJCQkJCXZhciBsaW5rID0gJy9tZWRpYWZpbGVzLycgKyByZXNwb25zZS5NZWRpYS5JZDsNCgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5sb2FkKGxpbmssIHsgcmVmcmVzaDogdHJ1ZSB9KTsNCgkJCQl9DQoJCQl9KQ0KCQkJLmZhaWwoZnVuY3Rpb24oKSB7DQoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlTG9hZGluZygpOw0KCQkJfSk7DQoJCX0NCgl9LA0KDQoJX2xvb2tVcCA9IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnBvc3Qoew0KCQkJdXJsOiBvcHRpb25zLmxvb2tVcFVybCwNCgkJCWRhdGE6IHsNCgkJCQlmaWxlVHlwZTogb3B0aW9ucy5maWxlLmZpbGVOYW1lDQoJCQl9LA0KCQkJc3VjY2VzczogZnVuY3Rpb24ocmVzcG9uc2UpIHsNCgkJCQlvcHRpb25zLmZpbGVUeXBlID0gcmVzcG9uc2UudHlwZTsNCgkJCX0NCgkJfSk7DQoJfQ0KDQoJdmFyIGFwaSA9IHsNCgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCV9sb29rVXAob3B0aW9ucyk7DQoNCgkJCW9wdGlvbnMuYXR0YWNobWVudCA9ICQoJyMnICsgb3B0aW9ucy5hdHRhY2htZW50SWQpOw0KICAgICAgICAJb3B0aW9ucy5hdHRhY2htZW50VXBsb2FkID0gb3B0aW9ucy5hdHRhY2htZW50LmZpbmQoJ2EudXBsb2FkJyk7DQogICAgICAgIAlvcHRpb25zLmF0dGFjaG1lbnRSZW1vdmUgPSBvcHRpb25zLmF0dGFjaG1lbnQuZmluZCgnYS5yZW1vdmUnKTsNCiAgICAgICAgCW9wdGlvbnMuYXR0YWNobWVudE5hbWUgPSBvcHRpb25zLmF0dGFjaG1lbnQuZmluZCgnaW5wdXQnKTsNCiAgICAgICAgCW9wdGlvbnMuYXR0YWNobWVudFByZXZpZXcgPSBvcHRpb25zLmF0dGFjaG1lbnQuZmluZCgnLnByZXZpZXcnKTsNCg0KICAgICAgICAJZnVuY3Rpb24gbG9hZFByZXZpZXcoKSB7DQogICAgICAgICAgICAJaWYgKG9wdGlvbnMuZmlsZSAmJiAob3B0aW9ucy5maWxlLmZpbGVOYW1lIHx8IG9wdGlvbnMuZmlsZS51cmwpKSB7DQogICAgICAgICAgICAJCWNsZWFyVGltZW91dChvcHRpb25zLmF0dGFjaG1lbnRQcmV2aWV3VGltZW91dCk7DQoJCQkgICAgICAgIG9wdGlvbnMuYXR0YWNobWVudFByZXZpZXdUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpew0KCQkJICAgICAgICAgICAgdmFyIGRhdGEgPSB7DQoJCQkgICAgICAgICAgICAJd191cGxvYWRDb250ZXh0SWQ6IG9wdGlvbnMudXBsb2FkQ29udGV4dElkDQoJCQkgICAgICAgICAgICB9Ow0KCQkJICAgICAgICAgICAgaWYob3B0aW9ucy5maWxlLnVybCkgew0KCQkJICAgICAgICAgICAgICAgIGRhdGEud191cmwgPSBvcHRpb25zLmZpbGUudXJsOw0KCQkJICAgICAgICAgICAgfQ0KCQkJICAgICAgICAgICAgaWYgKG9wdGlvbnMuZmlsZS5maWxlTmFtZSkgew0KCQkJICAgICAgICAgICAgCWRhdGEud19maWxlbmFtZSA9IG9wdGlvbnMuZmlsZS5maWxlTmFtZTsNCgkJCSAgICAgICAgICAgIH0NCgkJCSAgICAgICAgICAgICQudGVsbGlnZW50LmV2b2x1dGlvbi5wb3N0KHsNCgkJCSAgICAgICAgICAgICAgICB1cmw6IG9wdGlvbnMucHJldmlld0F0dGFjaG1lbnRVcmwsDQoJCQkgICAgICAgICAgICAgICAgZGF0YTogZGF0YSwNCgkJCSAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXNwb25zZSkgew0KCQkJICAgICAgICAgICAgICAgICAgICByZXNwb25zZSA9ICQudHJpbShyZXNwb25zZSk7DQoJCQkJCQkJCWlmKHJlc3BvbnNlICYmIHJlc3BvbnNlLmxlbmd0aCA+IDAgJiYgcmVzcG9uc2UgIT09IG9wdGlvbnMuYXR0YWNobWVudFByZXZpZXdDb250ZW50KSB7DQoJCQkJCQkJCQlvcHRpb25zLmF0dGFjaG1lbnRQcmV2aWV3Q29udGVudCA9IHJlc3BvbnNlOw0KCQkJCQkJCQkJb3B0aW9ucy5hdHRhY2htZW50UHJldmlldy5odG1sKG9wdGlvbnMuYXR0YWNobWVudFByZXZpZXdDb250ZW50KS5yZW1vdmVDbGFzcygnZW1wdHknKTsNCgkJCQkJCQkJfQ0KCQkJICAgICAgICAgICAgICAgIH0NCgkJCSAgICAgICAgICAgIH0pOw0KCQkJICAgICAgICB9LCAxNTApOw0KICAgICAgICAgICAgCX0gZWxzZSB7DQogICAgICAgICAgICAJCW9wdGlvbnMuYXR0YWNobWVudFByZXZpZXdDb250ZW50ID0gJyc7DQogICAgICAgICAgICAJCW9wdGlvbnMuYXR0YWNobWVudFByZXZpZXcuaHRtbCgnJykuYWRkQ2xhc3MoJ2VtcHR5Jyk7DQogICAgICAgICAgICAJfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgIAlvcHRpb25zLmF0dGFjaG1lbnRSZW1vdmUuaGlkZSgpOw0KICAgICAgICAJaWYgKG9wdGlvbnMuZmlsZSAmJiBvcHRpb25zLmZpbGUudXJsICYmIG9wdGlvbnMuZmlsZS5pc1JlbW90ZSkgew0KICAgICAgICAJCW9wdGlvbnMuYXR0YWNobWVudFJlbW92ZS5oaWRlKCk7DQogICAgICAgIAl9IGVsc2UgaWYgKG9wdGlvbnMuZmlsZSAmJiBvcHRpb25zLmZpbGUuZmlsZU5hbWUgJiYgIW9wdGlvbnMuZmlsZS5pc1JlbW90ZSkgew0KICAgICAgICAJCW9wdGlvbnMuYXR0YWNobWVudE5hbWUuYXR0cigncmVhZG9ubHknLCAncmVhZG9ubHknKTsNCiAgICAgICAgCQlvcHRpb25zLmF0dGFjaG1lbnRVcGxvYWQuaHRtbChvcHRpb25zLmF0dGFjaG1lbnRDaGFuZ2VUZXh0KS5yZW1vdmVDbGFzcygnYWRkJykuYWRkQ2xhc3MoJ2NoYW5nZScpOw0KICAgICAgICAJCW9wdGlvbnMuYXR0YWNobWVudFJlbW92ZS5zaG93KCk7DQogICAgICAgIAl9IGVsc2UgaWYgKG9wdGlvbnMuYXR0YWNobWVudC5kYXRhKCdsaW5rJykgIT0gJ1RydWUnKSB7DQogICAgICAgIAkJb3B0aW9ucy5hdHRhY2htZW50TmFtZS5hdHRyKCdyZWFkb25seScsICdyZWFkb25seScpOw0KICAgICAgICAJfQ0KDQogICAgICAgIAlsb2FkUHJldmlldygpOw0KDQogICAgICAgIAlvcHRpb25zLmF0dGFjaG1lbnROYW1lLm9uKCdrZXl1cCBjaGFuZ2UnLCBmdW5jdGlvbigpIHsNCiAgICAgICAgCQlpZiAoIW9wdGlvbnMuYXR0YWNobWVudE5hbWUuYXR0cigncmVhZG9ubHknKSkgew0KCSAgICAgICAgCQlvcHRpb25zLmZpbGUgPSB7DQoJICAgICAgICAJCQl1cmw6ICQodGhpcykudmFsKCksDQoJICAgICAgICAJCQlpc1JlbW90ZTogdHJ1ZSwNCgkgICAgICAgIAkJCWlzTmV3OiB0cnVlDQoJICAgICAgICAJCX0NCgkgICAgICAgIAkJbG9hZFByZXZpZXcoKTsNCgkgICAgICAgIAl9DQogICAgICAgIAl9KTsNCg0KICAgICAgICAJb3B0aW9ucy5hdHRhY2htZW50UmVtb3ZlLmNsaWNrKGZ1bmN0aW9uKCkgew0KICAgICAgICAJCW9wdGlvbnMuZmlsZSA9IG51bGw7DQogICAgICAgIAkJb3B0aW9ucy5hdHRhY2htZW50TmFtZS52YWwoJycpOw0KICAgICAgICAJCW9wdGlvbnMuYXR0YWNobWVudFVwbG9hZC5odG1sKG9wdGlvbnMuYXR0YWNobWVudEFkZFRleHQpLnJlbW92ZUNsYXNzKCdjaGFuZ2UnKS5hZGRDbGFzcygnYWRkJykNCiAgICAgICAgCQlpZiAob3B0aW9ucy5hdHRhY2htZW50LmRhdGEoJ2xpbmsnKSA9PSAnVHJ1ZScpIHsNCgkgICAgICAgIAkJb3B0aW9ucy5hdHRhY2htZW50TmFtZS5yZW1vdmVBdHRyKCdyZWFkb25seScpOw0KCSAgICAgICAgCX0NCgkgICAgICAgIAlvcHRpb25zLmF0dGFjaG1lbnRSZW1vdmUuaGlkZSgpOw0KCSAgICAgICAgCWxvYWRQcmV2aWV3KCk7DQoJICAgICAgICAJcmV0dXJuIGZhbHNlOw0KICAgICAgICAJfSk7DQoNCgkJCW9wdGlvbnMuYXR0YWNobWVudFVwbG9hZC5nbG93VXBsb2FkKHsNCgkJCQlmaWxlRmlsdGVyOiBudWxsLA0KCQkJCXVwbG9hZFVybDogb3B0aW9ucy51cGxvYWRGaWxlVXJsLA0KCQkJCXJlbmRlck1vZGU6ICdsaW5rJw0KCQkJfSkNCgkJCS5iaW5kKCdnbG93VXBsb2FkQmVndW4nLCBmdW5jdGlvbihlKSB7DQoJICAgICAgICAgICAgb3B0aW9ucy51cGxvYWRpbmcgPSB0cnVlOw0KCSAgICAgICAgICAgIG9wdGlvbnMuYXR0YWNobWVudFVwbG9hZC5odG1sKG9wdGlvbnMuYXR0YWNobWVudFByb2dyZXNzVGV4dC5yZXBsYWNlKCd7MH0nLCAwKSk7DQoJICAgICAgICB9KQ0KCSAgICAgICAgLmJpbmQoJ2dsb3dVcGxvYWRDb21wbGV0ZScsIGZ1bmN0aW9uKGUsIGZpbGUpIHsNCgkgICAgICAgIAlpZiAoZmlsZSAmJiBmaWxlLm5hbWUubGVuZ3RoID4gMCkgew0KCQkJCQlvcHRpb25zLmZpbGUgPSB7DQoJCQkJCQlmaWxlTmFtZTogZmlsZS5uYW1lLA0KCQkJCQkJaXNSZW1vdGU6IGZhbHNlLA0KCQkJCQkJaXNOZXc6IHRydWUNCgkJCQkJfQ0KCQkJCQlfbG9va1VwKG9wdGlvbnMpOw0KDQoJCQkJCW9wdGlvbnMuYXR0YWNobWVudE5hbWUudmFsKG9wdGlvbnMuZmlsZS5maWxlTmFtZSkuYXR0cigncmVhZG9ubHknLCAncmVhZG9ubHknKTsNCgkJICAgICAgICAgICAgbG9hZFByZXZpZXcoKTsNCgkJICAgICAgICAgICAgb3B0aW9ucy51cGxvYWRpbmcgPSBmYWxzZTsNCgkJICAgICAgICAgICAgb3B0aW9ucy5hdHRhY2htZW50VXBsb2FkLmh0bWwob3B0aW9ucy5hdHRhY2htZW50Q2hhbmdlVGV4dCkucmVtb3ZlQ2xhc3MoJ2FkZCcpLmFkZENsYXNzKCdjaGFuZ2UnKTsNCgkJICAgICAgICAgICAgb3B0aW9ucy5hdHRhY2htZW50UmVtb3ZlLnNob3coKTsNCgkJICAgIAl9DQoJICAgICAgICB9KQ0KCSAgICAgICAgLmJpbmQoJ2dsb3dVcGxvYWRGaWxlUHJvZ3Jlc3MnLCBmdW5jdGlvbihlLCBkZXRhaWxzKSB7DQoJICAgICAgICAJb3B0aW9ucy5hdHRhY2htZW50VXBsb2FkLmh0bWwob3B0aW9ucy5hdHRhY2htZW50UHJvZ3Jlc3NUZXh0LnJlcGxhY2UoJ3swfScsIGRldGFpbHMucGVyY2VudCkpOw0KCSAgICAgICAgfSk7DQoNCgkJCXBvc3RMaW5rID0gJCgnPGEgaHJlZj0iIyIgY2xhc3M9InN1Ym1pdCI+JyArIChvcHRpb25zLm1vZGUgPT0gJ2FkZCcgPyBvcHRpb25zLnBvc3RMYWJlbCA6IG9wdGlvbnMuZWRpdExhYmVsKSArICc8L2E+Jyk7DQoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNldEhlYWRlckJ1dHRvbihwb3N0TGluayk7DQoNCgkJCXBvc3RMaW5rLm9uKCd0YXAnLCBmdW5jdGlvbigpew0KCQkJCXZhciB0aXRsZUlucHV0ID0gJChvcHRpb25zLnRpdGxlSW5wdXQpLA0KCQkJCWJvZHlJbnB1dCA9IG9wdGlvbnMuZ2V0Qm9keUNvbnRlbnQoKSwNCgkJCQlzdWJzY3JpYmVJbnB1dCA9ICQob3B0aW9ucy5zdWJzY3JpYmVJbnB1dCk7DQoNCgkJCQlvcHRpb25zLnRpdGxlID0gIHRpdGxlSW5wdXQudmFsKCk7DQoJCQkJb3B0aW9ucy5kZXNjcmlwdGlvbiA9IGJvZHlJbnB1dDsNCgkJCQlvcHRpb25zLnN1YnNjcmliZSA9IHN1YnNjcmliZUlucHV0LmlzKCc6Y2hlY2tlZCcpOw0KDQoJCQkJX2NyZWF0ZUZpbGUob3B0aW9ucyk7DQoJCQl9KTsNCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMubWVkaWFHYWxsZXJ5QWRkRWRpdCA9IGFwaTsNCg0KfSkoalF1ZXJ5LCB3aW5kb3cpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:MediaGalleryList_Name}" version="7.0.0.1" description="" instanceIdentifier="dd90b05c6d334331b0046de16705e717" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="group-gallery">
    <contentScript>
		
#set($groupId = false)
#set($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#if (!$groupId)
	$core_v2_widget.Hide()
#end

#set($group = $core_v2_group.Get("%{Id=$groupId}"))
&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($group.Url)"&gt;$group.Name&lt;/a&gt;
		&lt;h1&gt;$core_v2_language.GetResource('media_gallery')&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 40, 40, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
&lt;/div&gt;
## load and render media galleries
&lt;div class="post-list galleries"&gt;
	#set($pageIndex = 0)
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.mediaGalleryList.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))'
		});
	});
})
&lt;/script&gt;

		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
			<resource name="MediaGalleryList_Name">Media Gallery List</resource>
			<resource name="media_gallery">Media Galleries</resource>
			<resource name="no_gallery">No Gallery</resource>
		  </language>
		</languageResources>
    <files>
      <file name="list.vm">I3NldCgkZ2FsbGVyaWVzID0gJGNvcmVfdjJfZ2FsbGVyeS5MaXN0KCIle0dyb3VwSWQ9JGdyb3VwSWQsUGFnZUluZGV4PSRwYWdlSW5kZXgsUGFnZVNpemU9NX0iKSkNCiNpZigkZ2FsbGVyaWVzLlRvdGFsc0NvdW50ID09IDEpDQoJI3NldCgkb25lV2lraSA9ICRjb3JlX3YyX2dhbGxlcnkuR2V0KCIle0dyb3VwSWQgPSAkZ3JvdXBJZH0iKSkNCgkjIyRtb2JpbGVfdjFfdXJsLkZvcm1hdCgnd2lraScsJG9uZVdpa2kuSWQpDQojZW5kDQojZm9yZWFjaCgkZ2FsbGVyeSBpbiAkZ2FsbGVyaWVzKQ0KI2VhY2gNCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gZ2FsbGVyeSIgZGF0YS10YXJnZXR1cmw9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJG1vYmlsZV92MV91cmwuRm9ybWF0KCdnYWxsZXJ5JywgJGdhbGxlcnkuSWQpKSI+DQoJCTxkaXYgY2xhc3M9InBvc3Qgd2l0aG91dC1hdmF0YXIiPg0KCQkJPGRpdiBjbGFzcz0iZGV0YWlscyI+DQoJCQkJI2lmKCRnYWxsZXJ5LkxhdGVzdFBvc3REYXRlKTxkaXYgY2xhc3M9ImRhdGUiPiRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdEFnb0RhdGUoJGdhbGxlcnkuTGF0ZXN0UG9zdERhdGUpPC9kaXY+I2VuZA0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJjb250ZW50Ij4NCgkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRtb2JpbGVfdjFfdXJsLkZvcm1hdCgnZ2FsbGVyeScsICRnYWxsZXJ5LklkKSkiPiRnYWxsZXJ5Lk5hbWU8L2E+DQoJCQkJPGRpdj4kIWdhbGxlcnkuRGVzY3JpcHRpb248L2Rpdj4NCgkJCTwvZGl2Pg0KCQk8L2Rpdj4NCgk8L2Rpdj4NCiNub2RhdGENCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gZ2FsbGVyeSI+PGRpdiBjbGFzcz0ibWVzc2FnZSBub3JlY29yZHMiPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdub19nYWxsZXJ5Jyk8L2Rpdj48L2Rpdj4NCiNhZnRlcmFsbA0KCSNzZXQgKCRoYXNNb3JlID0gZmFsc2UpDQoJI2lmICgkZ2FsbGVyaWVzLlRvdGFsQ291bnQgPiAoKCRnYWxsZXJpZXMuUGFnZUluZGV4ICsgMSkgKiAkZ2FsbGVyaWVzLlBhZ2VTaXplKSkNCgkJI3NldCgkaGFzTW9yZSA9IHRydWUpDQoJI2VuZA0KCTxkaXYgY2xhc3M9ImRhdGEiICNpZigkaGFzTW9yZSlkYXRhLWhhc21vcmU9InRydWUiI2VuZD48L2Rpdj4NCiNlbmQNCg==</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSB3aWtpcw0KIyMNCiNzZXQgKCRwYWdlSW5kZXggPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfcGFnZUluZGV4JykpDQojc2V0KCRncm91cElkID0gZmFsc2UpDQojc2V0KCRncm91cElkID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUludCgkbW9iaWxlX3YxX3VybFRva2VuLlZhbHVlKCdHcm91cElkJykpKQ0KI2lmICghJGdyb3VwSWQpDQoJJGNvcmVfdjJfd2lkZ2V0LkhpZGUoKQ0KI2VuZA0KJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCdsaXN0LnZtJykNCg==</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpewoKCXZhciBhcGkgPSB7CgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zY3JvbGxhYmxlKHsKCQkJCXJlZ2lvbjogJ2NvbnRlbnQnLAoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgewoJCQkJCWlmICgkKG9wdGlvbnMud3JhcHBlciArICcgZGl2LmRhdGE6bGFzdCcpLmRhdGEoJ2hhc21vcmUnKSkgewoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsKCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLAoJCQkJCQkJZGF0YTogewoJCQkJCQkJCXdfcGFnZUluZGV4OiBwYWdlSW5kZXgKCQkJCQkJCX0sCgkJCQkJCQlzdWNjZXNzOiBmdW5jdGlvbihyKSB7CgkJCQkJCQkJc3VjY2VzcyhyKTsKCQkJCQkJCX0sCgkJCQkJCQllcnJvcjogZnVuY3Rpb24oKSB7CgkJCQkJCQkJZXJyb3IoKTsKCQkJCQkJCX0KCQkJCQkJfSk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJc3VjY2VzcygpOwoJCQkJCX0KCQkJCX0sCgkJCQljb21wbGV0ZTogZnVuY3Rpb24oY29udGVudCkgewoJCQkJCWNvbnRlbnQgPSAkKGNvbnRlbnQpLmNzcyh7IG9wYWNpdHk6IDAgfSk7CgkJCQkJJChvcHRpb25zLndyYXBwZXIpLmZpbmQoJ2Rpdi5wb3N0LWxpc3QnKS5hcHBlbmQoY29udGVudCk7CgkJCQkJY29udGVudC5ldm9sdXRpb25UcmFuc2Zvcm0oeyBvcGFjaXR5OiAxIH0sIHsgZHVyYXRpb246IDQwMCB9KTsKCQkJCX0KCQkJfSk7CgkJfQoJfQoKCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24gPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24gfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyA9ICQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzIHx8IHt9OwoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMubWVkaWFHYWxsZXJ5TGlzdCA9IGFwaTsKCn0pKGpRdWVyeSk7</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:MediaGalleryPost_Name}" version="7.0.0.1" description="" instanceIdentifier="fad2d5f95f56467e885c112cbc6d47f2" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="media-gallery-post">
    <contentScript>
		
#set($mediaId = false)
#set($mediaId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('MediaId')))
#if (!$mediaId)
	$core_v2_widget.Hide()
#end

#set ($accessingUser = $core_v2_user.Accessing)
#set ($accessingUserIsRegistered = false)
#if ($core_v2_user.IsRegistered($accessingUser.Id))
	#set ($accessingUserIsRegistered = true)
#end

#set($media = $core_v2_media.Get($mediaId))
#set ($mediaType = $core_v2_ui.GetMediaType($media.File.FileUrl))
#set($gallery = $core_v2_gallery.Get("%{Id=$media.MediaGalleryId}"))

&lt;div class="post topic full"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($gallery.Group.Url)"&gt;$gallery.Group.Name&lt;/a&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($gallery.Url)"&gt;$gallery.Name&lt;/a&gt;
	&lt;/div&gt;
	&lt;h1&gt;$media.Title&lt;/h1&gt;
	&lt;div class="details"&gt;
		&lt;div class="avatar"&gt;
			#if ($media.Author.ProfileUrl)
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($media.Author.ProfileUrl)" class="internal-link view-user-profile"&gt;
					$core_v2_ui.GetResizedImageHtml($media.Author.AvatarUrl, 24, 24, "%{border='0', alt=$media.Author.DisplayName, ResizeMethod='ZoomAndCrop',border='0'}")
				&lt;/a&gt;
			#else
				$core_v2_ui.GetResizedImageHtml($media.Author.AvatarUrl, 24, 24, "%{border='0', alt=$media.Author.DisplayName, ResizeMethod='ZoomAndCrop',border='0'}")
			#end
		&lt;/div&gt;
		&lt;div class="date"&gt;$core_v2_language.FormatAgoDate($media.Date)&lt;/div&gt;
		&lt;div class="author"&gt;
			#if ($media.Author.ProfileUrl)
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($media.Author.ProfileUrl)" class="internal-link view-user-profile"&gt;
					$media.Author.DisplayName
				&lt;/a&gt;
			#else
				$media.Author.DisplayName
			#end
		&lt;/div&gt;
	&lt;/div&gt;
	&lt;div class="content"&gt;
		&lt;div&gt;
			$!core_v2_ui.GetViewHtml($media.File.FileUrl, "%{AdjustToContainer='True'}")
		&lt;/div&gt;
		&lt;div class="user-generated-content"&gt;
			$!mobile_v1_dataFormat.Detect($!media.Body())
		&lt;/div&gt;
	&lt;/div&gt;
	#set($showLikes = false)
	#if($accessingUserIsRegistered &amp;&amp; $core_v2_like.CanLike($media.ContentId, $core_v2_media.ContentTypeId))
		#set($showLikes = true)
	#end

	&lt;div class="actions ui-links" data-maxlinks="#if($showLikes)2#else 1#end"&gt;
		#if ($showLikes)
			&lt;li class="action-like"&gt;
				#set($format = '{toggle} &lt;span class="count"&gt;&lt;span class="icon"&gt;&lt;/span&gt;{count}&lt;/span&gt;')
				$core_v2_ui.Like($media.ContentId, $core_v2_media.ContentTypeId, "%{ Format = $format }")
			&lt;/li&gt;
		#end

		&lt;li&gt;
			&lt;a href="#" onclick="window.open('$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Redirect($core_v2_mediaUrls.DownloadMedia($media.Id, false), "%{Target='Host'}"))', '_system'); return false;" class="internal-link download"&gt;
				#if ($media.File.IsRemoteAttachment)
					$core_v2_language.GetResource("MediaGalleries_Button_View")
				#else
					$core_v2_language.GetResource("MediaGalleries_Button_Download")
				#end
			&lt;/a&gt;
		&lt;/li&gt;

		#if ($accessingUserIsRegistered)
			&lt;li&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('media-edit',$mediaId))"&gt;$core_v2_language.GetResource('edit')&lt;/a&gt;&lt;/li&gt;
		#end
		#if ($accessingUserIsRegistered &amp;&amp; $core_v2_bookmark.CanBookmark($media.ContentId, $core_v2_media.ContentTypeId))
			&lt;li class="action-bookmark"&gt;
				$core_v2_ui.Bookmark($media.ContentId, $core_v2_media.ContentTypeId)
			&lt;/li&gt;
		#end
		&lt;li class="action-moderate"&gt;$core_v2_ui.Moderate($media.ContentId, $core_v2_media.ContentTypeId)&lt;/li&gt;

		&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
	&lt;/div&gt;
&lt;/div&gt;


$mobile_v1_ui.Comments($media.ContentId, $core_v2_media.ContentTypeId, "%{ CanFlagAsAbusive = $accessingUserIsRegistered, AccessingUserId = $accessingUser.Id }")
		

		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
			<resource name="MediaGalleryPost_Name">Media Gallery Post</resource>
			<resource name="media_gallery">Media Galleries</resource>
			<resource name="no_gallery">No Gallery</resource>
			<resource name="edit">Edit</resource>
			<resource name="cancel">Cancel</resource>
			<resource name="MediaGalleries_Button_Download">Download</resource>
			<resource name="MediaGalleries_Button_View">View</resource>
		  </language>
		</languageResources>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:Navigation_Name}" version="7.0.0.1" description="" instanceIdentifier="c50b1c0e777545559ed8e49d31cb89e4" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="navigation">
    <contentScript>
			
#set($user = $core_v2_user.Accessing)
#set($unreadNotificationCount = 0)
#set($unreadConversationCount = 0)
#set($isUserRegistered = $core_v2_user.IsRegistered($user.Id))
&lt;div class="search"&gt;
	&lt;input type="search" placeholder="$core_v2_encoding.HtmlAttributeEncode($core_v2_language.GetResource('search_for'))" /&gt;
	&lt;a href="#" class="clear-search"&gt;&amp;nbsp;&lt;/a&gt;
&lt;/div&gt;

#set($filter = false)
#set($filter = $core_v2_page.GetQueryStringValue('w_filter'))
#if (!$filter)
	#set($filter = '')
#end
#set($query = false)
#set($query = $core_v2_page.GetQueryStringValue('w_query'))
&lt;div class="search-filters active"&gt;
	&lt;div class="ui-links filters" data-minlinks="100" data-animate="true"&gt;
		&lt;ul&gt;
			&lt;li&gt;&lt;a href="#"#if($filter == '') data-selected#end data-filter=""&gt;$core_v2_language.GetResource('filter_content')&lt;/a&gt;&lt;/li&gt;
			&lt;li&gt;&lt;a href="#"#if($filter =='groups') data-selected#end data-filter="groups"&gt;$core_v2_language.GetResource('filter_groups')&lt;/a&gt;&lt;/li&gt;
			&lt;li&gt;&lt;a href="#"#if($filter == 'users') data-selected#end data-filter="users"&gt;$core_v2_language.GetResource('filter_users')&lt;/a&gt;&lt;/li&gt;
		&lt;/ul&gt;
	&lt;/div&gt;
&lt;/div&gt;
&lt;div class="navigation-list search-results"&gt;&lt;/div&gt;
&lt;div class="navigation-list navigation"&gt;

#if ($isUserRegistered)
	&lt;div class="navigation-item with-avatar"&gt;
		#if ($user.ProfileUrl)
			&lt;a href="$core_v2_encoding.HtmlAttributeEncode($user.ProfileUrl)"&gt;
				&lt;span class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($user.AvatarUrl, 32, 32, "%{border='0', alt=$user.DisplayName, ResizeMethod='ZoomAndCrop'}")&lt;/span&gt;
				$user.DisplayName
			&lt;/a&gt;
		#else
			&lt;span class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($user.AvatarUrl, 32, 32, "%{border='0', alt=$user.DisplayName, ResizeMethod='ZoomAndCrop'}")&lt;/span&gt;
			$user.DisplayName
		#end
	&lt;/div&gt;
	&lt;div class="navigation-item header"&gt;
	&lt;/div&gt;
#else
	&lt;div class="navigation-item with-avatar login"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_authentication.Login())"&gt;$core_v2_language.GetResource('log_in')&lt;/a&gt;
	&lt;/div&gt;
#end

&lt;div class="navigation-item home with-avatar"&gt;
	&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('home'))"&gt;$core_v2_language.GetResource('home')&lt;/a&gt;
&lt;/div&gt;

#if ($isUserRegistered)
	&lt;div class="navigation-item friends with-avatar"&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('user-friends', $user.Id))"&gt;$core_v2_language.GetResource('friends')&lt;/a&gt;&lt;/div&gt;
	&lt;div class="navigation-item groups with-avatar"&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('user-groups', $user.Id))"&gt;$core_v2_language.GetResource('groups')&lt;/a&gt;&lt;/div&gt;
	&lt;div class="navigation-item bookmarks with-avatar"&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('user-bookmarks', $user.Id))"&gt;$core_v2_language.GetResource('bookmarks')&lt;/a&gt;&lt;/div&gt;

	#set ($bookmarks = $core_v2_bookmark.List("%{ PageIndex = $pageIndex, PageSize = 10, SortBy = 'Title', SortOrder = 'Ascending', ContentTypeIds = $core_v2_group.ContentTypeId.ToString() }"))
	#foreach ($bookmark in $bookmarks)
	#beforeall
		&lt;div class="navigation-item header with-label"&gt;
			$core_v2_language.GetResource('bookmarked_groups')
		&lt;/div&gt;
	#each
		#set ($content = false)
		#set ($content = $bookmark.Content)
		#if ($content)
			## determine an image to use. Preferring content over application over container
			#set ($imageUrl = false)
			#set ($imageUrl = $content.AvatarUrl)
			#if (!$imageUrl &amp;&amp; $content.Application)
				#set ($imageUrl = $content.Application.AvatarUrl)
				#if (!$imageUrl &amp;&amp; $content.Application.Container)
					#set ($imageUrl = $content.Application.Container.AvatarUrl)
				#end
			#end
			&lt;div class="navigation-item with-avatar"&gt;
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($content.Url)"&gt;
					#if ($imageUrl)
						&lt;span class="avatar"&gt;
							$core_v2_ui.GetResizedImageHtml($imageUrl, 32, 32, "%{border='0', alt=$content.HtmlName('Web'), ResizeMethod='ZoomAndCrop',border='0'}")
						&lt;/span&gt;
					#end

					#set ($name = $core_v2_language.Truncate($content.HtmlName('Web'), 50, '…'))
					#if ($name.length == 0)
						#set ($name = $core_v2_language.Truncate($content.HtmlDescription('Web'), 50, '…'))
					#end
					$name
				&lt;/a&gt;
			&lt;/div&gt;
		#end
	#afterall
		#if ($bookmarks.TotalCount &gt; $bookmarks.PageSize)
			&lt;div class="navigation-item"&gt;
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('user-bookmarks', $user.Id))"&gt;$core_v2_language.GetResource('more_bookmarks')&lt;/a&gt;
			&lt;/div&gt;
		#end

		&lt;div class="navigation-item header"&gt;
		&lt;/div&gt;
	#end

	&lt;div class="navigation-item with-avatar logout"&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_authentication.Logout())"&gt;$core_v2_language.GetResource('log_out')&lt;/a&gt;&lt;/div&gt;
#else
	#set ($groups = $core_v2_group.List("%{ PageIndex = $pageIndex, PageSize = 10, SortBy = 'SortOrder', SortOrder = 'Ascending', ParentGroupId = $core_v2_group.Root.Id, IncludeAllSubGroups = 'False' }"))
	#foreach ($group in $groups)
	#beforeall
		&lt;div class="navigation-item header with-label"&gt;
			$core_v2_language.GetResource('groups')
		&lt;/div&gt;
	#each
		&lt;div class="navigation-item with-avatar"&gt;
			&lt;a href="$core_v2_encoding.HtmlAttributeEncode($group.Url)"&gt;
				#if ($group.AvatarUrl)
					&lt;span class="avatar"&gt;
						$core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 32, 32, "%{border='0', alt=$group.Name, ResizeMethod='ZoomAndCrop',border='0'}")
					&lt;/span&gt;
				#end

				$core_v2_language.Truncate($group.Name, 50, '…')
			&lt;/a&gt;
		&lt;/div&gt;
	#afterall
		&lt;div class="navigation-item header"&gt;
		&lt;/div&gt;
	#end
#end

#set ($termsOfService = false)
#set ($termsOfService = $core_v2_urls.TermsOfService())
#if ($termsOfService)
	&lt;div class="navigation-item"&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($termsOfService)"&gt;$core_v2_language.GetResource('terms_of_service')&lt;/a&gt;&lt;/div&gt;
#end

&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.navigation.rendered', 'navigation', function(){
		jQuery.telligent.evolution.widgets.navigation.register({
			includeConversationsAndNotifications: #if ($isUserRegistered) true #else false #end,
			wrapper: '#$core_v2_widget.WrapperElementId',
			conversationNotificationTypeId: '$core_v2_conversationMessage.NotificationTypeId.ToString()',
			searchUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('search.vm'))',
			searchQuery: '#if($query)$core_v2_encoding.JavascriptEncode($query)#end',
			searchFilter: '#if($filter)$core_v2_encoding.JavascriptEncode($filter)#end',
			conversationsUrl: '$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('conversations'))',
			notificationsUrl: '$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('notifications'))',
			getUnreadCountsUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('getUnreadCounts.vm'))'
		});
	});
})
&lt;/script&gt;

		
		</contentScript>
    <languageResources>
	  <language key="en-us">
		<resource name="Navigation_Name">Navigation</resource>
		<resource name="log_in">Log In</resource>
		<resource name="home">Home</resource>
		<resource name="notifications">Notifications</resource>
		<resource name="conversations">Conversations</resource>
		<resource name="friends">Friends</resource>
		<resource name="bookmarks">Bookmarks</resource>
		<resource name="log_out">Log Out</resource>
		<resource name="terms_of_service">Terms Of Service</resource>
		<resource name="bookmarked_groups">Bookmarked Groups</resource>
		<resource name="groups">Groups</resource>
		<resource name="search_for">Search for...</resource>
		<resource name="more_bookmarks">More...</resource>
		<resource name="no_matches">No matches were found.</resource>
		<resource name="filter_content">Content</resource>
		<resource name="filter_groups">Groups</resource>
		<resource name="filter_users">People</resource>
		<resource name="groups">Groups</resource>
	  </language>
	</languageResources>
    <files>
      <file name="getUnreadCounts.vm">CiRjb3JlX3YyX3BhZ2UuU2V0Q29udGVudFR5cGUoJ2FwcGxpY2F0aW9uL2pzb24nKQoKI3NldCgkdXNlciA9ICRjb3JlX3YyX3VzZXIuQWNjZXNzaW5nKQojc2V0KCR1bnJlYWROb3RpZmljYXRpb25Db3VudCA9IDApCiNzZXQoJHVucmVhZENvbnZlcnNhdGlvbkNvdW50ID0gMCkKI2lmKCRjb3JlX3YyX3VzZXIuSXNSZWdpc3RlcmVkKCR1c2VyLklkKSkKCSNzZXQgKCRvcHRpb25zID0gIiV7IFBhZ2VJbmRleCA9ICRwYWdlSW5kZXgsIFBhZ2VTaXplID0gJHBhZ2VTaXplLCBJc1JlYWQ9J0ZhbHNlJyB9IikKCSNzZXQgKCRjb252ZXJzYXRpb25NZXNzYWdlTm90aWZpY2F0aW9uRmlsdGVyTmFtZSA9ICJfRmlsdGVyc18ke2NvcmVfdjJfY29udmVyc2F0aW9uTWVzc2FnZS5Ob3RpZmljYXRpb25UeXBlSWR9IikKCSRvcHRpb25zLkFkZCgkY29udmVyc2F0aW9uTWVzc2FnZU5vdGlmaWNhdGlvbkZpbHRlck5hbWUsICdFeGNsdWRlJykKCSNzZXQoJHVucmVhZE5vdGlmaWNhdGlvbkNvdW50ID0gJGNvcmVfdjJfbm90aWZpY2F0aW9uLkxpc3QoJG9wdGlvbnMpLlRvdGFsQ291bnQpCgoJI3NldCgkdW5yZWFkQ29udmVyc2F0aW9uQ291bnQgPSAkY29yZV92Ml9jb252ZXJzYXRpb24uVW5yZWFkQ291bnQoKSkKI2VuZAoKeyJVbnJlYWROb3RpZmljYXRpb25Db3VudCI6JHVucmVhZE5vdGlmaWNhdGlvbkNvdW50LCJVbnJlYWRDb252ZXJzYXRpb25Db3VudCI6JHVucmVhZENvbnZlcnNhdGlvbkNvdW50fQ==</file>
      <file name="search.vm">I3NldCAoJHBhZ2VJbmRleCA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19wYWdlSW5kZXgnKSkKI3NldCAoJHF1ZXJ5ID0gJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X3F1ZXJ5JykpCiNzZXQgKCRmaWx0ZXIgPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfZmlsdGVyJykpCgojc2V0KCRvcHRpb25zID0gIiV7UGFnZUluZGV4ID0gJHBhZ2VJbmRleCwgUGFnZVNpemUgPSAxMCwgUXVlcnkgPSAkcXVlcnl9IikKI2lmICgkZmlsdGVyID09ICdncm91cHMnKQoJJG9wdGlvbnMuQWRkKCdGaWx0ZXJzJywgImNvbnRlbnR0eXBlaWQ6OiRjb3JlX3YyX2dyb3VwLkNvbnRlbnRUeXBlSWQiKQojZWxzZWlmICgkZmlsdGVyID09ICd1c2VycycpCgkkb3B0aW9ucy5BZGQoJ0ZpbHRlcnMnLCAiY29udGVudHR5cGVpZDo6JGNvcmVfdjJfdXNlci5Db250ZW50VHlwZUlkIikKI2Vsc2UKCSNzZXQoJGZpbHRlcnMgPSAnJykKCSNmb3JlYWNoKCRjb250ZW50VHlwZSBpbiAkY29yZV92Ml9jb250ZW50VHlwZS5MaXN0KCkpCgkJI3NldCgkYXBwbGljYXRpb25UeXBlID0gZmFsc2UpCgkJI3NldCgkYXBwbGljYXRpb25UeXBlID0gJGNvcmVfdjJfYXBwbGljYXRpb25UeXBlLkdldCgkY29udGVudFR5cGUuSWQpKQoJCSNzZXQoJGNvbnRhaW5lclR5cGUgPSBmYWxzZSkKCQkjc2V0KCRjb250YWluZXJUeXBlID0gJGNvcmVfdjJfY29udGFpbmVyVHlwZS5HZXQoJGNvbnRlbnRUeXBlLklkKSkKCQkjaWYgKCghJGFwcGxpY2F0aW9uVHlwZSB8fCAkYXBwbGljYXRpb25UeXBlLkVycm9ycy5Db3VudCA+IDApICYmICghJGNvbnRhaW5lclR5cGUgfHwgJGNvbnRhaW5lclR5cGUuRXJyb3JzLkNvdW50ID4gMCkpCgkJCSNpZiAoJGZpbHRlcnMuTGVuZ3RoID09IDApCgkJCQkjc2V0KCRmaWx0ZXJzID0gImNvbnRlbnR0eXBlaWQ6Oigke2NvbnRlbnRUeXBlLklkfSIpCgkJCSNlbHNlCgkJCQkjc2V0KCRmaWx0ZXJzID0gIiR7ZmlsdGVyc30gT1IgJHtjb250ZW50VHlwZS5JZH0iKQoJCSNlbmQKCQkjZW5kCgkjZW5kCgkjaWYoJGZpbHRlcnMuTGVuZ3RoID4gMCkKCQkkb3B0aW9ucy5BZGQoJ0ZpbHRlcnMnLCAiJHtmaWx0ZXJzfSkiKQoJI2VuZAojZW5kCgojc2V0KCRyZXN1bHRzID0gJGNvcmVfdjJfc2VhcmNoUmVzdWx0Lkxpc3QoJG9wdGlvbnMpKQojZm9yZWFjaCgkcmVzdWx0IGluICRyZXN1bHRzKQojZWFjaAoJI3NldCgkYXZhdGFyVXJsID0gZmFsc2UpCgkjaWYoJHJlc3VsdC5Db250ZW50KQoJCSNzZXQoJGF2YXRhclVybCA9ICRyZXN1bHQuQ29udGVudC5BdmF0YXJVcmwpCgkJI2lmICghJGF2YXRhclVybCkKCQkJI3NldCgkYXZhdGFyVXJsID0gJHJlc3VsdC5Db250ZW50LkFwcGxpY2F0aW9uLkF2YXRhclVybCkKCQkJI2lmICghJGF2YXRhclVybCkKCQkJCSNzZXQoJGF2YXRhclVybCA9ICRyZXN1bHQuQ29udGVudC5BcHBsaWNhdGlvbi5Db250YWluZXIuQXZhdGFyVXJsKQoJCQkjZW5kCgkJI2VuZAoJI2VuZAoKCTxkaXYgY2xhc3M9Im5hdmlnYXRpb24taXRlbSNpZigkYXZhdGFyVXJsKSB3aXRoLWF2YXRhciNlbmQiPgoJCTxhIGhyZWY9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJHJlc3VsdC5VcmwpIj4KCQkJI2lmICgkYXZhdGFyVXJsKQoJCQkJPHNwYW4gY2xhc3M9ImF2YXRhciI+CgkJCQkJJGNvcmVfdjJfdWkuR2V0UmVzaXplZEltYWdlSHRtbCgkYXZhdGFyVXJsLCAzMiwgMzIsICIle2JvcmRlcj0nMCcsIGFsdD0kcmVzdWx0LlRpdGxlLCBSZXNpemVNZXRob2Q9J1pvb21BbmRDcm9wJyxib3JkZXI9JzAnfSIpCgkJCQk8L3NwYW4+CgkJCSNlbmQKCgkJCSRjb3JlX3YyX2xhbmd1YWdlLlRydW5jYXRlKCRyZXN1bHQuVGl0bGUsIDUwLCAnhScpCgoJCQkjaWYgKCRjb3JlX3YyX2VuY29kaW5nLkh0bWxEZWNvZGUoJGNvcmVfdjJfbGFuZ3VhZ2UuVHJ1bmNhdGUoJHJlc3VsdC5UaXRsZSwgNTAsICcnKSkgIT0gJGNvcmVfdjJfZW5jb2RpbmcuSHRtbERlY29kZSgkY29yZV92Ml9sYW5ndWFnZS5UcnVuY2F0ZSgkcmVzdWx0LkJvZHksIDUwLCAnJykpKQoJCQkJPHNwYW4gY2xhc3M9ImRlc2NyaXB0aW9uIj4kY29yZV92Ml9sYW5ndWFnZS5UcnVuY2F0ZSgkcmVzdWx0LkJvZHksIDE1MCwgJ4UnKTwvc3Bhbj4KCQkJI2VuZAoJCTwvYT4KCTwvZGl2Pgojbm9kYXRhCgk8ZGl2IGNsYXNzPSJtZXNzYWdlIG5vcmVjb3JkcyI+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ25vX21hdGNoZXMnKTwvZGl2PgoJPGRpdiBjbGFzcz0iZGF0YSI+PC9kaXY+CiNhZnRlcmFsbAoJI3NldCAoJGhhc01vcmUgPSBmYWxzZSkKCSNpZiAoJHJlc3VsdHMuVG90YWxDb3VudCA+ICgoJHJlc3VsdHMuUGFnZUluZGV4ICsgMSkgKiAkcmVzdWx0cy5QYWdlU2l6ZSkpCgkJI3NldCgkaGFzTW9yZSA9IHRydWUpCgkjZW5kCgk8ZGl2IGNsYXNzPSJkYXRhIiAjaWYoJGhhc01vcmUpZGF0YS1oYXNtb3JlPSJ0cnVlIiNlbmQ+PC9kaXY+CiNlbmQ=</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCl7CgoJdmFyIGFwaSA9IHsKCQlyZWdpc3RlcjogZnVuY3Rpb24ob3B0aW9ucykgewoJCQl2YXIgc2VhcmNoVGltZW91dCA9IG51bGwsCgkJCQl1bnJlYWROb3RpZmljYXRpb25Db3VudCA9IG9wdGlvbnMudW5yZWFkTm90aWZpY2F0aW9uQ291bnQsCgkJCQl1bnJlYWRDb252ZXJzYXRpb25Db3VudCA9IG9wdGlvbnMudW5yZWFkQ29udmVyc2F0aW9uQ291bnQsCgkJCQlsYXN0QWN0aXZpdHkgPSAwLAoJCQkJbGFzdE5vdGlmaWNhdGlvbkNoZWNrID0gMCwKCQkJCW5vdGlmaWNhdGlvblBpbmdEdXJhdGlvbiA9IDYwICogMTAwMCwKCQkJCWhlYWRlciA9IG51bGwsCgkJCQlzZWFyY2hJbnB1dCA9ICQob3B0aW9ucy53cmFwcGVyICsgJyBpbnB1dFt0eXBlPSJzZWFyY2giXScpLAoJCQkJc2VhcmNoUmVzdWx0cyA9ICQob3B0aW9ucy53cmFwcGVyKS5maW5kKCdkaXYuc2VhcmNoLXJlc3VsdHMnKSwKCQkJCXNlYXJjaEZpbHRlcnMgPSAkKG9wdGlvbnMud3JhcHBlcikuZmluZCgnZGl2LnNlYXJjaC1maWx0ZXJzJyksCgkJCQlzZWFyY2hOYXZpZ2F0aW9uID0gJChvcHRpb25zLndyYXBwZXIpLmZpbmQoJ2Rpdi5uYXZpZ2F0aW9uJyksCgkJCQlpbml0aWFsaXplSGVhZGVyID0gZnVuY3Rpb24oKSB7CgkJCQkJaGVhZGVyID0gJCgnPHNwYW4gY2xhc3M9ImhlYWRlci1ub3RpZmljYXRpb25zIj48YSBocmVmPSInICsgb3B0aW9ucy5ub3RpZmljYXRpb25zVXJsICsgJyIgY2xhc3M9Im5vdGlmaWNhdGlvbnMiPjxzcGFuIGNsYXNzPSJpY29uIGJlbGwiPjwvc3Bhbj48c3BhbiBjbGFzcz0iY291bnQiIGRhdGEtY291bnQ9IjAiPjwvc3Bhbj48L2E+PGEgaHJlZj0iJyArIG9wdGlvbnMuY29udmVyc2F0aW9uc1VybCArICciIGNsYXNzPSJjb252ZXJzYXRpb25zIj48c3BhbiBjbGFzcz0iaWNvbiBjaGF0Ij48L3NwYW4+PHNwYW4gY2xhc3M9ImNvdW50IiBkYXRhLWNvdW50PSIwIj48L3NwYW4+PC9hPjwvc3Bhbj4nKTsKCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNldEhlYWRlckNvbnRlbnQoaGVhZGVyKTsKCQkJCQlyZXRyaWV2ZVVucmVhZENvdW50cygpOwoJCQkJfSwKCQkJCXVwZGF0ZVVucmVhZENvdW50cyA9IGZ1bmN0aW9uKCkgewoJCQkJCWhlYWRlci5maW5kKCcubm90aWZpY2F0aW9ucyAuY291bnQnKS5odG1sKHVucmVhZE5vdGlmaWNhdGlvbkNvdW50ID09IDAgPyAnJyA6ICh1bnJlYWROb3RpZmljYXRpb25Db3VudCA+IDkgPyAnOSsnIDogdW5yZWFkTm90aWZpY2F0aW9uQ291bnQpKS5hdHRyKCdkYXRhLWNvdW50JywgdW5yZWFkTm90aWZpY2F0aW9uQ291bnQpOwoJCQkJCWhlYWRlci5maW5kKCcuY29udmVyc2F0aW9ucyAuY291bnQnKS5odG1sKHVucmVhZENvbnZlcnNhdGlvbkNvdW50ID09IDAgPyAnJyA6ICh1bnJlYWRDb252ZXJzYXRpb25Db3VudCA+IDkgPyAnOSsnIDogdW5yZWFkQ29udmVyc2F0aW9uQ291bnQpKS5hdHRyKCdkYXRhLWNvdW50JywgdW5yZWFkQ29udmVyc2F0aW9uQ291bnQpOwoJCQkJfSwKCQkJCW5vdGlmaWNhdGlvbkNvdW50VXBkYXRlUGluZyA9IGZ1bmN0aW9uKCkgewoJCQkJCXZhciBjdXJyZW50VGltZSA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCkKCQkJCQlpZiAoY3VycmVudFRpbWUgLSBsYXN0QWN0aXZpdHkgPCAobm90aWZpY2F0aW9uUGluZ0R1cmF0aW9uICogNSkgJiYgY3VycmVudFRpbWUgLSBsYXN0Tm90aWZpY2F0aW9uQ2hlY2sgPiBub3RpZmljYXRpb25QaW5nRHVyYXRpb24pIHsKCQkJCQkJcmV0cmlldmVVbnJlYWRDb3VudHMoKTsKCQkJCQl9CgkJCQl9LAoJCQkJcmVzZXROb3RpZmljYXRpb25DaGVja1RpbWVvdXQgPSBmdW5jdGlvbigpIHsKCQkJCQlsYXN0Tm90aWZpY2F0aW9uQ2hlY2sgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpOwoJCQkJfSwKCQkJCXJldHJpZXZlVW5yZWFkQ291bnRzID0gZnVuY3Rpb24oKSB7CgkJCQkJcmVzZXROb3RpZmljYXRpb25DaGVja1RpbWVvdXQoKTsKCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsKCQkJCQkJdXJsOiBvcHRpb25zLmdldFVucmVhZENvdW50c1VybCwKCQkJCQkJY2FjaGU6IGZhbHNlLAoJCQkJCQlzdWNjZXNzOiBmdW5jdGlvbihyKSB7CgkJCQkJCQl1bnJlYWROb3RpZmljYXRpb25Db3VudCA9IHIuVW5yZWFkTm90aWZpY2F0aW9uQ291bnQ7CgkJCQkJCQl1bnJlYWRDb252ZXJzYXRpb25Db3VudCA9IHIuVW5yZWFkQ29udmVyc2F0aW9uQ291bnQ7CgkJCQkJCQl1cGRhdGVVbnJlYWRDb3VudHMoKTsKCQkJCQkJfQoJCQkJCX0pOwoJCQkJfSwKCQkJCXNob3dTZWFyY2ggPSBmdW5jdGlvbigpIHsKCQkJCQlzZWFyY2hSZXN1bHRzLmVtcHR5KCkuc2hvdygpOwoJCQkJCXNlYXJjaEZpbHRlcnMuc2hvdygpOwoJCQkJCXNlYXJjaE5hdmlnYXRpb24uaGlkZSgpOwoJCQkJfSwKCQkJCXNob3dOYXZpZ2F0aW9uID0gZnVuY3Rpb24oKSB7CgkJCQkJc2VhcmNoUmVzdWx0cy5oaWRlKCk7CgkJCQkJc2VhcmNoRmlsdGVycy5oaWRlKCk7CgkJCQkJc2VhcmNoTmF2aWdhdGlvbi5zaG93KCk7CgkJCQl9LAoJCQkJc2VhcmNoID0gZnVuY3Rpb24oKSB7CgkJCQkJc2hvd1NlYXJjaCgpOwoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2Nyb2xsYWJsZSh7CgkJCQkJCXJlZ2lvbjogJ25hdmlnYXRpb24nLAoJCQkJCQlpbml0aWFsUGFnZUluZGV4OiAtMSwKCQkJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgewoJCQkJCQkJdmFyIGQgPSAkKG9wdGlvbnMud3JhcHBlciArICcgZGl2LnNlYXJjaC1yZXN1bHRzIGRpdi5kYXRhOmxhc3QnKQoJCQkJCQkJaWYgKGQubGVuZ3RoID09IDAgfHwgZC5kYXRhKCdoYXNtb3JlJykpIHsKCQkJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsKCQkJCQkJCQkJdXJsOiBvcHRpb25zLnNlYXJjaFVybCwKCQkJCQkJCQkJZGF0YTogewoJCQkJCQkJCQkJd19wYWdlSW5kZXg6IHBhZ2VJbmRleCwKCQkJCQkJCQkJCXdfcXVlcnk6IG9wdGlvbnMuc2VhcmNoUXVlcnksCgkJCQkJCQkJCQl3X2ZpbHRlcjogb3B0aW9ucy5zZWFyY2hGaWx0ZXIKCQkJCQkJCQkJfSwKCQkJCQkJCQkJc3VjY2VzczogZnVuY3Rpb24ocikgewoJCQkJCQkJCQkJc3VjY2VzcyhyKTsKCQkJCQkJCQkJfSwKCQkJCQkJCQkJZXJyb3I6IGZ1bmN0aW9uKCkgewoJCQkJCQkJCQkJZXJyb3IoKTsKCQkJCQkJCQkJfQoJCQkJCQkJCX0pOwoJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQlzdWNjZXNzKCk7CgkJCQkJCQl9CgkJCQkJCX0sCgkJCQkJCWNvbXBsZXRlOiBmdW5jdGlvbihjb250ZW50KSB7CgkJCQkJCQljb250ZW50ID0gJChjb250ZW50KS5jc3MoeyBvcGFjaXR5OiAwIH0pOwoJCQkJCQkJc2VhcmNoUmVzdWx0cy5hcHBlbmQoY29udGVudCk7CgkJCQkJCQljb250ZW50LmV2b2x1dGlvblRyYW5zZm9ybSh7IG9wYWNpdHk6IDEgfSwgeyBkdXJhdGlvbjogNDAwIH0pOwoJCQkJCQl9CgkJCQkJfSk7CgkJCQl9OwoKCQkJJChvcHRpb25zLndyYXBwZXIgKyAnIC5maWx0ZXJzIGEnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7CgkJCQllLnByZXZlbnREZWZhdWx0KCk7CgkJCQl2YXIgZmlsdGVyID0gJCh0aGlzKS5kYXRhKCdmaWx0ZXInKTsKCQkJCWlmIChmaWx0ZXIgIT0gb3B0aW9ucy5maWx0ZXIpIHsKCQkJCQlvcHRpb25zLnNlYXJjaEZpbHRlciA9IGZpbHRlcjsKCQkJCQkkKG9wdGlvbnMud3JhcHBlciArICcgLmZpbHRlcnMgYScpLnJlbW92ZUF0dHIoJ2RhdGEtc2VsZWN0ZWQnKTsKCQkJCQkkKHRoaXMpLmF0dHIoJ2RhdGEtc2VsZWN0ZWQnLCB0cnVlKTsKCQkJCQlzZWFyY2goKTsKCQkJCX0KCQkJCXJldHVybiBmYWxzZTsKCQkJfSk7CgoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnN1YnNjcmliZSgnbW9iaWxlLmNvbnRlbnQucmVuZGVyZWQnLCAnbmF2aWdhdGlvbicsIGZ1bmN0aW9uKGQpIHsKCQkJCWxhc3RBY3Rpdml0eSA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7CgkJCX0pOwoKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ25vdGlmaWNhdGlvbi5yZWFkJywgJ25hdmlnYXRpb24nLCBmdW5jdGlvbihkKSB7CgkJCQlpZiAoZCAmJiBkLnVucmVhZENvdW50KSB7CgkJCQkJdmFyIGlzQ29udmVyc2F0aW9uID0gKGQudHlwZUlkID09PSB1bmRlZmluZWQgfHwgZC50eXBlSWQgPT0gb3B0aW9ucy5jb252ZXJzYXRpb25Ob3RpZmljYXRpb25UeXBlSWQpOwoKCQkJCQlpZiAoZC51bnJlYWRDb3VudC5zdWJzdHIoMCwgMikgPT0gJy09JyAmJiAhaXNOYU4ocGFyc2VJbnQoZC51bnJlYWRDb3VudC5zdWJzdHIoMiksIDEwKSkpIHsKCQkJCQkJaWYgKGlzQ29udmVyc2F0aW9uKSB7CgkJCQkJCQl1bnJlYWRDb252ZXJzYXRpb25Db3VudCAtPSBwYXJzZUludChkLnVucmVhZENvdW50LnN1YnN0cigyKSwgMTApOwoJCQkJCQkJaWYgKHVucmVhZENvbnZlcnNhdGlvbkNvdW50IDwgMCkgewoJCQkJCQkJCXVucmVhZENvbnZlcnNhdGlvbkNvdW50ID0gMDsKCQkJCQkJCX0KCQkJCQkJfSBlbHNlIHsKCQkJCQkJCXVucmVhZE5vdGlmaWNhdGlvbkNvdW50IC09IHBhcnNlSW50KGQudW5yZWFkQ291bnQuc3Vic3RyKDIpLCAxMCk7CgkJCQkJCQlpZiAodW5yZWFkTm90aWZpY2F0aW9uQ291bnQgPCAwKSB7CgkJCQkJCQkJdW5yZWFkTm90aWZpY2F0aW9uQ291bnQgPSAwOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCXVwZGF0ZVVucmVhZENvdW50cygpOwoJCQkJCX0gZWxzZSBpZiAoZC51bnJlYWRDb3VudC5zdWJzdHIoMCwgMikgPT0gJys9JyAmJiAhaXNOYU4ocGFyc2VJbnQoZC51bnJlYWRDb3VudC5zdWJzdHIoMiksIDEwKSkpIHsKCQkJCQkJaWYgKGlzQ29udmVyc2F0aW9uKSB7CgkJCQkJCQl1bnJlYWRDb252ZXJzYXRpb25Db3VudCArPSBwYXJzZUludChkLnVucmVhZENvdW50LnN1YnN0cigyKSwgMTApOwoJCQkJCQl9IGVsc2UgewoJCQkJCQkJdW5yZWFkTm90aWZpY2F0aW9uQ291bnQgKz0gcGFyc2VJbnQoZC51bnJlYWRDb3VudC5zdWJzdHIoMiksIDEwKTsKCQkJCQkJfQoJCQkJCQl1cGRhdGVVbnJlYWRDb3VudHMoKTsKCQkJCQl9IGVsc2UgaWYgKCFpc05hTihwYXJzZUludChkLnVucmVhZENvdW50LCAxMCkpICYmIHBhcnNlSW50KGQudW5yZWFkQ291bnQsIDEwKSAhPSAodW5yZWFkQ29udmVyc2F0aW9uQ291bnQgKyB1bnJlYWROb3RpZmljYXRpb25Db3VudCkpIHsKCQkJCQkJcmV0cmlldmVVbnJlYWRDb3VudHMoKTsKCQkJCQl9CgkJCQl9CgkJCX0pOwoKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ25vdGlmaWNhdGlvbi5yYWlzZWQnLCAnbmF2aWdhdGlvbicsIGZ1bmN0aW9uKGQpIHsKCQkJCWlmIChkICYmIGQudW5yZWFkQ291bnQgJiYgIWlzTmFOKHBhcnNlSW50KGQudW5yZWFkQ291bnQsIDEwKSkgJiYgcGFyc2VJbnQoZC51bnJlYWRDb3VudCwgMTApICE9ICh1bnJlYWRDb252ZXJzYXRpb25Db3VudCArIHVucmVhZE5vdGlmaWNhdGlvbkNvdW50KSkgewoJCQkJCXJldHJpZXZlVW5yZWFkQ291bnRzKCk7CgkJCQl9IGVsc2UgewoJCQkJCXJlc2V0Tm90aWZpY2F0aW9uQ2hlY2tUaW1lb3V0KCk7CgkJCQl9CgkJCX0pOwoKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ21vYmlsZS5jb250ZW50LmxvYWRpbmcnLCBmdW5jdGlvbihlKXsKCQkJCXNlYXJjaElucHV0LmJsdXIoKTsKCQkJfSk7CgoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnN1YnNjcmliZSgndWkuYm9va21hcmsnLCAnbmF2aWdhdGlvbicsIGZ1bmN0aW9uKGRhdGEpIHsKCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUucmVmcmVzaE5hdmlnYXRpb24oKTsKCQkJfSk7CgoJCQlzZWFyY2hJbnB1dAoJCQkJLmF0dHIoJ2F1dG9jb21wbGV0ZScsICdvZmYnKQoJCQkJLmtleXVwKGZ1bmN0aW9uKGUpIHsKCQkJCQlnbG9iYWwuY2xlYXJUaW1lb3V0KHNlYXJjaFRpbWVvdXQpOwoJCQkJCXZhciBxdWVyeSA9ICQodGhpcykudmFsKCk7CgkJCQkJaWYgKHF1ZXJ5Lmxlbmd0aCA+IDApIHsKCQkJCQkJJChvcHRpb25zLndyYXBwZXIgKyAnIC5zZWFyY2gnKS5hZGRDbGFzcygnd2l0aC12YWx1ZScpOwoJCQkJCQlzZWFyY2hUaW1lb3V0ID0gZ2xvYmFsLnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CgkJCQkJCQlvcHRpb25zLnNlYXJjaFF1ZXJ5ID0gcXVlcnk7CgkJCQkJCQlzZWFyY2goKTsKCQkJCQkJfSwgNDk5KTsKCQkJCQl9IGVsc2UgewoJCQkJCQkkKG9wdGlvbnMud3JhcHBlciArICcgLnNlYXJjaCcpLnJlbW92ZUNsYXNzKCd3aXRoLXZhbHVlJyk7CgkJCQkJCXNob3dOYXZpZ2F0aW9uKCk7CgkJCQkJfQoJCQkJfSk7CgoJCQkkKG9wdGlvbnMud3JhcHBlciArICcgLmNsZWFyLXNlYXJjaCcpCgkJCQkub24oJ3BvaW50ZXJzdGFydCcsIGZ1bmN0aW9uKGUpIHsKCQkJCQllLnByZXZlbnREZWZhdWx0KCk7CgkJCQkJc2VhcmNoSW5wdXQudmFsKCcnKS5mb2N1cygpOwoJCQkJCSQob3B0aW9ucy53cmFwcGVyICsgJyAuc2VhcmNoJykucmVtb3ZlQ2xhc3MoJ3dpdGgtdmFsdWUnKTsKCQkJCQlnbG9iYWwuY2xlYXJUaW1lb3V0KHNlYXJjaFRpbWVvdXQpOwoJCQkJCXNob3dOYXZpZ2F0aW9uKCk7CgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfSk7CgoJCQlpZiAob3B0aW9ucy5zZWFyY2hRdWVyeS5sZW5ndGggPiAwKSB7CgkJCQlzZWFyY2hJbnB1dC52YWwob3B0aW9ucy5zZWFyY2hRdWVyeSk7CgkJCQlzZWFyY2gob3B0aW9ucy5zZWFyY2hRdWVyeSk7CgkJCX0gZWxzZSB7CgkJCQlzaG93TmF2aWdhdGlvbigpOwoJCQl9CgoJCQlzZWFyY2hJbnB1dC5vbih7CgkJCQlmb2N1czogZnVuY3Rpb24oZSkgewoJCQkJCSQob3B0aW9ucy53cmFwcGVyICsgJyAuc2VhcmNoJykuYWRkQ2xhc3MoJ2FjdGl2ZScpOwoJCQkJfSwKCQkJCWJsdXI6IGZ1bmN0aW9uKGUpIHsKCQkJCQkkKG9wdGlvbnMud3JhcHBlciArICcgLnNlYXJjaCcpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTsKCQkJCX0KCQkJfSkKCgkJCWlmKG9wdGlvbnMuaW5jbHVkZUNvbnZlcnNhdGlvbnNBbmROb3RpZmljYXRpb25zKSB7CgkJCQlpbml0aWFsaXplSGVhZGVyKCk7CgkJCQlnbG9iYWwuc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7CgkJCQkJbm90aWZpY2F0aW9uQ291bnRVcGRhdGVQaW5nKCk7CgkJCQl9LCA0OTkpOwoJCQl9CgkJfQoJfQoKCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24gPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24gfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyA9ICQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzIHx8IHt9OwoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMubmF2aWdhdGlvbiA9IGFwaTsKCn0pKGpRdWVyeSwgd2luZG93KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:NotificationList_Name}" version="7.0.0.1" description="" instanceIdentifier="39aa3e84a898400d84f1fd7b8a2c033f" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="notification-list">
    <contentScript>
		

#if (!$core_v2_user.IsRegistered($core_v2_user.Accessing.Id))
	$core_v2_widget.Hide()
#end

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;h1&gt;$core_v2_language.GetResource('notifications')&lt;/h1&gt;
	&lt;/div&gt;
&lt;/div&gt;

## load and render notifications
&lt;div class="post-list notifications"&gt;
	#set($pageIndex = 0)
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.notificationList.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
			conversationNotificationTypeId: '$core_v2_conversationMessage.NotificationTypeId.ToString()'
		});
	});
})
&lt;/script&gt;
		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="NotificationList_Name">Notification List</resource>
		<resource name="notifications">Notifications</resource>
		<resource name="no_notifications">No notifications. Go get busy in the community!</resource>
		<resource name="notifications">Notifications</resource>
	  </language>
	</languageResources>
    <files>
      <file name="list.vm">I3NldCAoJG9wdGlvbnMgPSAiJXsgUGFnZUluZGV4ID0gJHBhZ2VJbmRleCwgUGFnZVNpemUgPSA3IH0iKQokb3B0aW9ucy5BZGQoIl9GaWx0ZXJzXyR7Y29yZV92Ml9jb252ZXJzYXRpb25NZXNzYWdlLk5vdGlmaWNhdGlvblR5cGVJZH0iLCAnRXhjbHVkZScpCiNzZXQoJG5vdGlmaWNhdGlvbnMgPSAkY29yZV92Ml9ub3RpZmljYXRpb24uTGlzdCgkb3B0aW9ucykpCiNmb3JlYWNoKCRub3RpZmljYXRpb24gaW4gJG5vdGlmaWNhdGlvbnMpCiNlYWNoCgkjc2V0ICgkbGFzdEFjdG9yID0gZmFsc2UpCgkjc2V0ICgkYWN0b3JzID0gJG5vdGlmaWNhdGlvbi5BY3RvcnMpCgkjc2V0ICgkbGFzdEluZGV4ID0gJGFjdG9ycy5Db3VudCAtIDEpCgkjc2V0ICgkbGFzdEFjdG9yID0gJGFjdG9ycy5nZXRfaXRlbSgkbGFzdEluZGV4KS5Vc2VyKQoJI3NldCAoJG5vdGlmaWNhdGlvblR5cGUgPSAkY29yZV92Ml9ub3RpZmljYXRpb25UeXBlLkdldCgkbm90aWZpY2F0aW9uLk5vdGlmaWNhdGlvblR5cGVJZCkpCgoJI2lmICgkbm90aWZpY2F0aW9uVHlwZS5Ob3RpZmljYXRpb25UeXBlSWQgPT0gJGNvcmVfdjJfcmF0ZWRJdGVtLk5vdGlmaWNhdGlvblR5cGVJZCkKCQkjc2V0ICgkbGFzdEFjdG9yID0gZmFsc2UpCgkjZW5kCgoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIG5vdGlmaWNhdGlvbiNpZighJG5vdGlmaWNhdGlvbi5Jc1JlYWQpIHVucmVhZCNlbmQiCgkJZGF0YS1ub3RpZmljYXRpb25pZD0iJG5vdGlmaWNhdGlvbi5Ob3RpZmljYXRpb25JZCIKCQlkYXRhLW5vdGlmaWNhdGlvbnR5cGVpZD0iJG5vdGlmaWNhdGlvbi5Ob3RpZmljYXRpb25UeXBlSWQiCgkJZGF0YS10YXJnZXR1cmw9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJG5vdGlmaWNhdGlvbi5UYXJnZXRVcmwpIj4KCQk8ZGl2IGNsYXNzPSJwb3N0Ij4KCQkJI2lmICgkbGFzdEFjdG9yKQoJCQkJPGRpdiBjbGFzcz0iYXZhdGFyIj4KCQkJCQkjaWYgKCRsYXN0QWN0b3IuUHJvZmlsZVVybCkKCQkJCQkJPGEgaHJlZj0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkbGFzdEFjdG9yLlByb2ZpbGVVcmwpIiBjbGFzcz0iaW50ZXJuYWwtbGluayB2aWV3LXVzZXItcHJvZmlsZSI+CgkJCQkJCQkkY29yZV92Ml91aS5HZXRSZXNpemVkSW1hZ2VIdG1sKCRsYXN0QWN0b3IuQXZhdGFyVXJsLCA0MCwgNDAsICIle2JvcmRlcj0nMCcsIGFsdD0kbGFzdEFjdG9yLkRpc3BsYXlOYW1lLCBSZXNpemVNZXRob2Q9J1pvb21BbmRDcm9wJyxib3JkZXI9JzAnfSIpCgkJCQkJCTwvYT4KCQkJCQkjZWxzZQoJCQkJCQkkY29yZV92Ml91aS5HZXRSZXNpemVkSW1hZ2VIdG1sKCRsYXN0QWN0b3IuQXZhdGFyVXJsLCA0MCwgNDAsICIle2JvcmRlcj0nMCcsIGFsdD0kbGFzdEFjdG9yLkRpc3BsYXlOYW1lLCBSZXNpemVNZXRob2Q9J1pvb21BbmRDcm9wJyxib3JkZXI9JzAnfSIpCgkJCQkJI2VuZAoJCQkJPC9kaXY+CgkJCSNlbmQKCQkJPGRpdiBjbGFzcz0iZGF0ZSI+JGNvcmVfdjJfbGFuZ3VhZ2UuRm9ybWF0QWdvRGF0ZSgkbm90aWZpY2F0aW9uLkxhc3RVcGRhdGVkRGF0ZSk8L2Rpdj4KCQkJPGRpdiBjbGFzcz0iY29udGVudCI+CgkJCQkkbm90aWZpY2F0aW9uLk1lc3NhZ2UoJ0h0bWwnKQoJCQk8L2Rpdj4KCQk8L2Rpdj4KCTwvZGl2Pgojbm9kYXRhCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gbm90aWZpY2F0aW9uIj48ZGl2IGNsYXNzPSJtZXNzYWdlIG5vcmVjb3JkcyI+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ25vX25vdGlmaWNhdGlvbnMnKTwvZGl2PjwvZGl2PgojYWZ0ZXJhbGwKCSNzZXQgKCRoYXNNb3JlID0gZmFsc2UpCgkjaWYgKCRub3RpZmljYXRpb25zLlRvdGFsQ291bnQgPiAoKCRub3RpZmljYXRpb25zLlBhZ2VJbmRleCArIDEpICogJG5vdGlmaWNhdGlvbnMuUGFnZVNpemUpKQoJCSNzZXQoJGhhc01vcmUgPSB0cnVlKQoJI2VuZAoJPGRpdiBjbGFzcz0iZGF0YSIgI2lmKCRoYXNNb3JlKWRhdGEtaGFzbW9yZT0idHJ1ZSIjZW5kPjwvZGl2PgojZW5k</file>
      <file name="more.vm">IyMKIyMgQWpheCBjYWxsYmFjayBmb3IgbG9hZGluZyBtb3JlIG5vdGlmaWNhdGlvbnMKIyMKI3NldCAoJHBhZ2VJbmRleCA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19wYWdlSW5kZXgnKSkKJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCdsaXN0LnZtJykK</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpewoKCXZhciBhcGkgPSB7CgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCQkJJChvcHRpb25zLndyYXBwZXIpLm9uKCd0YXAnLCAnZGl2Lm5vdGlmaWNhdGlvbicsIGZ1bmN0aW9uKGUpewoJCQkJdmFyIG4gPSAkKHRoaXMpOwoJCQkJaWYgKG4uaGFzQ2xhc3MoJ3VucmVhZCcpKSB7CgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7CgkJCQkJCXVybDogJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ2FwaS5hc2h4L3YyL25vdGlmaWNhdGlvbi97Tm90aWZpY2F0aW9uSWR9Lmpzb24nLAoJCQkJCQlkYXRhOiB7CgkJCQkJCQlOb3RpZmljYXRpb25JZDogbi5kYXRhKCdub3RpZmljYXRpb25pZCcpLAoJCQkJCQkJTWFya0FzUmVhZDogJ1RydWUnCgkJCQkJCX0sCgkJCQkJCXN1Y2Nlc3M6IGZ1bmN0aW9uKHIpIHsKCQkJCQkJCW4ucmVtb3ZlQ2xhc3MoJ3VucmVhZCcpOwoJCQkJCQkJalF1ZXJ5LnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnB1Ymxpc2goJ25vdGlmaWNhdGlvbi5yZWFkJywgewoJCQkJCQkJCXR5cGVJZDogbi5kYXRhKCdub3RpZmljYXRpb250eXBlaWQnKSwKCQkJCQkJCQl1bnJlYWRDb3VudDogJy09MScKCQkJCQkJCX0pOwoJCQkJCQl9CgkJCQkJfSk7CgkJCQkJLy8gZm9yY2UgYSByZWxvYWQgb2YgdGhpcyBwYWdlIG9uIG5leHQgdmlldyB0byBpbmRpY2F0ZSByZWFkIHN0YXRlCgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5jbGVhckNvbnRlbnQoKTsKCQkJCX0KCQkJfSk7CgoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNjcm9sbGFibGUoewoJCQkJcmVnaW9uOiAnY29udGVudCcsCgkJCQlsb2FkOiBmdW5jdGlvbihwYWdlSW5kZXgsIHN1Y2Nlc3MsIGVycm9yKSB7CgkJCQkJaWYgKCQob3B0aW9ucy53cmFwcGVyICsgJyBkaXYuZGF0YTpsYXN0JykuZGF0YSgnaGFzbW9yZScpKSB7CgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoewoJCQkJCQkJdXJsOiBvcHRpb25zLm1vcmVVcmwsCgkJCQkJCQlkYXRhOiB7CgkJCQkJCQkJd19wYWdlSW5kZXg6IHBhZ2VJbmRleAoJCQkJCQkJfSwKCQkJCQkJCXN1Y2Nlc3M6IGZ1bmN0aW9uKHIpIHsKCQkJCQkJCQlzdWNjZXNzKHIpOwoJCQkJCQkJfSwKCQkJCQkJCWVycm9yOiBmdW5jdGlvbigpIHsKCQkJCQkJCQllcnJvcigpOwoJCQkJCQkJfQoJCQkJCQl9KTsKCQkJCQl9IGVsc2UgewoJCQkJCQlzdWNjZXNzKCk7CgkJCQkJfQoJCQkJfSwKCQkJCWNvbXBsZXRlOiBmdW5jdGlvbihjb250ZW50KSB7CgkJCQkJY29udGVudCA9ICQoY29udGVudCkuY3NzKHsgb3BhY2l0eTogMCB9KTsKCQkJCQkkKG9wdGlvbnMud3JhcHBlcikuZmluZCgnZGl2Lm5vdGlmaWNhdGlvbnMnKS5hcHBlbmQoY29udGVudCk7CgkJCQkJY29udGVudC5ldm9sdXRpb25UcmFuc2Zvcm0oeyBvcGFjaXR5OiAxIH0sIHsgZHVyYXRpb246IDQwMCB9KTsKCQkJCX0KCQkJfSk7CgoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnN1YnNjcmliZSgnbm90aWZpY2F0aW9uLnJhaXNlZCcsIGZ1bmN0aW9uKGQpIHsKCQkJCWlmIChkLnR5cGVJZCAhPSBvcHRpb25zLmNvbnZlcnNhdGlvbk5vdGlmaWNhdGlvblR5cGVJZCkgewoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUucmVmcmVzaCgpOwoJCQkJfQoJCQl9KTsKCQl9Cgl9CgoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy5ub3RpZmljYXRpb25MaXN0ID0gYXBpOwoKfSkoalF1ZXJ5KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:TagCloud_Name}" version="7.0.0.1" description="" instanceIdentifier="0b4c87a9fc284dcb9a159138e5309bd0" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="tag-cloud">
    <contentScript>
		

#set ($groupId = false)
#set ($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#if (!$groupId)
	$core_v2_widget.Hide()
#end
#set ($group = false)
#set ($group = $core_v2_group.Get("%{Id=$groupId}"))
#if (!$group)
	$core_v2_widget.Hide()
#end

#set ($maximumTags = $core_v2_widget.GetIntValue('maximumTags', 25))
#set ($minimumPostsPerTag = $core_v2_widget.GetIntValue('minimumPostsPerTag', 1))
#set ($currentTags = false)
#set ($currentTags = $mobile_v1_urlToken.Value('TagName'))
#set ($cssClasses = $core_v2_utility.MakeList('level-6','level-5','level-4','level-3','level-2','level-1'))


## build base tag query
#set ($query = "%{PageSize=100,PageIndex=0,SortBy='ContentCount',SortOrder='Descending', ContainerIds = $group.ContainerId}")

#if($currentTags)
	$query.Add('Tags', $currentTags)
#end

## load tags
#set ($tags = false)
#set ($tags = $core_v2_tags.List($query))
#set ($sortedTags = $core_v2_tags.Sort($tags, "%{ MinimumItemsPerTag = $minimumPostsPerTag, MaximumNumberOfTags = $maximumTags, CssClasses = $cssClasses }"))

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($group.Url)"&gt;$group.Name&lt;/a&gt;
		#if($currentTags)
			&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('group-tags',$groupId))"&gt;$core_v2_language.GetResource('TagCloud_Title')&lt;/a&gt;
		#end
		&lt;h1&gt;
			#if(!$currentTags)
				$core_v2_language.GetResource('TagCloud_Title')
			#else
				$core_v2_language.FormatString($core_v2_language.GetResource('TagCloud_Results_For'), $core_v2_encoding.HtmlEncode($currentTags))
			#end
		&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 40, 40, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
&lt;/div&gt;

&lt;div&gt;
	#foreach ($tag in $sortedTags)
	#beforeall
		&lt;ul class="tag-list"&gt;
	#each
		&lt;li class="tag-item ${tag.CssClass}"&gt;
			&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('group-tag', $group.Id, $tag.Name))"&gt;&lt;span&gt;&lt;/span&gt;$tag.Name&lt;/a&gt;
		&lt;/li&gt;
	#afterall
		&lt;/ul&gt;
	#nodata
		#if($currentTags)
			&lt;div class="tag-list"&gt;&lt;div class="message norecords"&gt;$core_v2_language.GetResource('TagCloud_NoSubTagsDefined')&lt;/div&gt;&lt;/div&gt;
		#else
			&lt;div class="tag-list"&gt;&lt;div class="message norecords"&gt;$core_v2_language.GetResource('TagCloud_NoTagsDefined')&lt;/div&gt;&lt;/div&gt;
		#end
	#end
&lt;/div&gt;

</contentScript>
    <configuration>
 
	&lt;propertyGroup id="options"&gt;
		&lt;property id="maximumTags" dataType="int" defaultValue="25"/&gt;
		&lt;property id="minimumPostsPerTag" dataType="int" defaultValue="1"/&gt;
	&lt;/propertyGroup&gt;

	</configuration>
    <languageResources>
<language key="en-us">
	<resource name="TagCloud_Name">Tag Cloud</resource>
	<resource name="TagCloud_Title">Tags</resource>
	<resource name="TagCloud_Results_For">{0}</resource>
	<resource name="TagCloud_NoTagsDefined">No tags have been created or used yet.</resource>
	<resource name="TagCloud_NoSubTagsDefined">Sorry, but there are no more tags available to filter with.</resource>
</language>
		</languageResources>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:TaggedContentList_Name}" version="7.0.0.1" description="" instanceIdentifier="26dca1e1a198492395e5a6b6f8a3d0ba" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="tagged-content-list">
    <contentScript>
		

#set ($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#set ($pageSize = $core_v2_widget.GetIntValue('pageSize', 5))
#set ($pageIndex = 0)

#set($group = false)
#set($group = $core_v2_group.Get("%{Id=$groupId}"))
#if (!$group)
	$core_v2_widget.Hide()
#end

&lt;div class="post-list tagged-content"&gt;
	$core_v2_widget.ExecuteFile('list.vm')
&lt;/div&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;

&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.taggedContentList.register({
		moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
				wrapper: '#$core_v2_widget.WrapperElementId',
		pageSize: $pageSize,
			showSubGroups: '$showSubGroups'
		});
	});
})
&lt;/script&gt;
		
</contentScript>
    <configuration>
	
	&lt;propertyGroup id="options"&gt;
		&lt;property id="pageSize" dataType="int" defaultValue="5" /&gt;
	&lt;/propertyGroup&gt;
	
</configuration>
    <languageResources>
	<language key="en-us">
		<resource name="TaggedContentList_Name">Tagged Content List</resource>
		<resource name="TaggedContentList_No_Items">There are no posts with the requested tag.</resource>
	</language>
</languageResources>
    <files>
      <file name="list.vm">I3NldCAoJGN1cnJlbnRUYWdzID0gZmFsc2UpDQojc2V0ICgkY3VycmVudFRhZ3MgPSAkbW9iaWxlX3YxX3VybFRva2VuLlZhbHVlKCdUYWdOYW1lJykpDQojaWYoISRjdXJyZW50VGFncykNCgkkY29yZV92Ml93aWRnZXQuSGlkZSgpDQojZW5kDQoNCiNzZXQgKCRxdWVyeSA9ICIleyBQYWdlU2l6ZSA9ICRwYWdlU2l6ZSwgUGFnZUluZGV4ID0gJHBhZ2VJbmRleCwgVGFncyA9ICRjdXJyZW50VGFncywgQ29udGFpbmVySWRzID0gJGdyb3VwLkNvbnRhaW5lcklkIH0iKQ0KI3NldCgkdGFnZ2VkQ29udGVudCA9ICRjb3JlX3YyX3RhZ2dlZENvbnRlbnQuTGlzdCgkcXVlcnkpKQ0KI2ZvcmVhY2goJGNvbnRlbnQgaW4gJHRhZ2dlZENvbnRlbnQpDQoJI3NldCgkYXZhdGFyVXJsID0gZmFsc2UpDQoJI2lmKCRjb250ZW50LkNvbnRlbnQpDQoJCSNzZXQoJGF2YXRhclVybCA9ICRjb250ZW50LkNvbnRlbnQuQXZhdGFyVXJsKQ0KCQkjaWYgKCEkYXZhdGFyVXJsICYmICRjb250ZW50LkNvbnRlbnQuQ3JlYXRlZEJ5VXNlcklkKQ0KCQkJI3NldCAoJHVzZXIgPSAkY29yZV92Ml91c2VyLkdldCgiJXtJZD0kY29udGVudC5Db250ZW50LkNyZWF0ZWRCeVVzZXJJZH0iKSkNCgkJCSNzZXQoJGF2YXRhclVybCA9ICR1c2VyLkF2YXRhclVybCkNCgkJI2VuZA0KCSNlbmQNCg0KCTxkaXYgY2xhc3M9InBvc3QtbGlzdC1pdGVtIGNvbnRlbnQtaXRlbSIgZGF0YS10YXJnZXR1cmw9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJGNvbnRlbnQuQ29udGVudC5VcmwpIj4NCgkJPGRpdiBjbGFzcz0icG9zdCI+DQoJCQk8ZGl2IGNsYXNzPSJhdmF0YXIiPg0KCQkJCSNpZigkYXZhdGFyVXJsKQ0KCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRjb250ZW50LkNvbnRlbnQuVXJsKSIgY2xhc3M9ImludGVybmFsLWxpbmsgdmlldy11c2VyLXByb2ZpbGUiPg0KCQkJCQkJJGNvcmVfdjJfdWkuR2V0UmVzaXplZEltYWdlSHRtbCgkYXZhdGFyVXJsLCA0MCwgNDAsICIle2JvcmRlcj0nMCcsIFJlc2l6ZU1ldGhvZD0nWm9vbUFuZENyb3AnLGJvcmRlcj0nMCd9IikNCgkJCQkJPC9hPg0KCQkJCSNlbmQNCgkJCTwvZGl2Pg0KCQkJPGRpdiBjbGFzcz0iY29udGVudCI+DQoJCQkJPGEgaHJlZj0iJGNvcmVfdjJfZW5jb2RpbmcuSHRtbEF0dHJpYnV0ZUVuY29kZSgkY29udGVudC5Db250ZW50LlVybCkiPiRjb250ZW50LkNvbnRlbnQuSHRtbE5hbWUoJ1dlYicpPC9hPg0KCQkJPC9kaXY+DQoJCTwvZGl2Pg0KCTwvZGl2Pg0KI25vZGF0YQ0KCTxkaXYgY2xhc3M9InBvc3QtbGlzdC1pdGVtIGNvbnRlbnQtaXRlbSI+PGRpdiBjbGFzcz0ibWVzc2FnZSBub3JlY29yZHMiPiRjb3JlX3YyX2xhbmd1YWdlLkdldFJlc291cmNlKCdUYWdnZWRDb250ZW50TGlzdF9Ob19JdGVtcycpPC9kaXY+PC9kaXY+DQojYWZ0ZXJhbGwNCgkjc2V0ICgkaGFzTW9yZSA9IGZhbHNlKQ0KCSNpZiAoJHRhZ2dlZENvbnRlbnQuVG90YWxDb3VudCA+ICgoJHRhZ2dlZENvbnRlbnQuUGFnZUluZGV4ICsgMSkgKiAkdGFnZ2VkQ29udGVudC5QYWdlU2l6ZSkpDQoJCSNzZXQoJGhhc01vcmUgPSB0cnVlKQ0KCSNlbmQNCgk8ZGl2IGNsYXNzPSJkYXRhIiAjaWYoJGhhc01vcmUpZGF0YS1oYXNtb3JlPSJ0cnVlIiNlbmQ+PC9kaXY+DQojZW5kDQo=</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSB0YWdnZWQgY29udGVudA0KIyMNCiNzZXQgKCRwYWdlSW5kZXggPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfcGFnZUluZGV4JykpDQojc2V0ICgkcGFnZVNpemUgPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfcGFnZVNpemUnKSkNCiNzZXQgKCRncm91cElkID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUludCgkbW9iaWxlX3YxX3VybFRva2VuLlZhbHVlKCdHcm91cElkJykpKQ0KI3NldCgkZ3JvdXAgPSBmYWxzZSkNCiNzZXQoJGdyb3VwID0gJGNvcmVfdjJfZ3JvdXAuR2V0KCIle0lkPSRncm91cElkfSIpKQ0KI2lmICghJGdyb3VwKQ0KCSRjb3JlX3YyX3dpZGdldC5IaWRlKCkNCiNlbmQNCiRjb3JlX3YyX3dpZGdldC5FeGVjdXRlRmlsZSgnbGlzdC52bScpDQo=</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpewoKCXZhciBhcGkgPSB7CgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zY3JvbGxhYmxlKHsKCQkJCXJlZ2lvbjogJ2NvbnRlbnQnLAoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgewoJCQkJCWlmICgkKG9wdGlvbnMud3JhcHBlciArICcgZGl2LmRhdGE6bGFzdCcpLmRhdGEoJ2hhc21vcmUnKSkgewoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsKCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLAoJCQkJCQkJZGF0YTogewoJCQkJCQkJCXdfcGFnZVNpemU6IG9wdGlvbnMucGFnZVNpemUsCgkJCQkJCQkJd19wYWdlSW5kZXg6IHBhZ2VJbmRleAoJCQkJCQkJfSwKCQkJCQkJCXN1Y2Nlc3M6IGZ1bmN0aW9uKHIpIHsKCQkJCQkJCQlzdWNjZXNzKHIpOwoJCQkJCQkJfSwKCQkJCQkJCWVycm9yOiBmdW5jdGlvbigpIHsKCQkJCQkJCQllcnJvcigpOwoJCQkJCQkJfQoJCQkJCQl9KTsKCQkJCQl9IGVsc2UgewoJCQkJCQlzdWNjZXNzKCk7CgkJCQkJfQoJCQkJfSwKCQkJCWNvbXBsZXRlOiBmdW5jdGlvbihjb250ZW50KSB7CgkJCQkJY29udGVudCA9ICQoY29udGVudCkuY3NzKHsgb3BhY2l0eTogMCB9KTsKCQkJCQkkKG9wdGlvbnMud3JhcHBlcikuZmluZCgnZGl2LnBvc3QtbGlzdCcpLmFwcGVuZChjb250ZW50KTsKCQkJCQljb250ZW50LmV2b2x1dGlvblRyYW5zZm9ybSh7IG9wYWNpdHk6IDEgfSwgeyBkdXJhdGlvbjogNDAwIH0pOwoJCQkJfQoJCQl9KTsKCQl9Cgl9CgoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy50YWdnZWRDb250ZW50TGlzdCA9IGFwaTsKCn0pKGpRdWVyeSk7</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:UserBanner_Name}" version="7.0.0.1" description="" instanceIdentifier="134293c01a044077869d09f20b300983" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="user-banner">
    <contentScript>


#set ($userId = false)
#set ($userId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('UserId')))
#if (!$userId)
	$core_v2_widget.Hide()
#end
#set ($user = false)
#set ($user = $core_v2_user.Get("%{ Id = $userId }"))
#if (!$user)
	$core_v2_widget.Hide()
#end

&lt;div class="banner"&gt;
	&lt;div class="avatar"&gt;
		$!core_v2_ui.GetResizedImageHtml($user.AvatarUrl, 120, 120, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }")
	&lt;/div&gt;
	&lt;h1&gt;$!user.DisplayName&lt;/h1&gt;

	&lt;div class="ui-links actions" data-maxlinks="0"&gt;
		&lt;ul&gt;
			#set ($accessingUser = $core_v2_user.Accessing)
			#if ($accessingUser)
				#if($user.Id != $accessingUser.Id)

					#set ($friendship = $core_v2_friendship.Get("%{ UserId = $accessingUser.Id, FriendId = $user.Id }"))

					## Currently friends or requesting
					#if ($friendship &amp;&amp; ($friendship.FriendshipState == 'Approved' || ($friendship.FriendshipState == 'Pending' &amp;&amp; $friendship.Requestor.Id == $accessingUser.Id)))
						#set ($cancelFriendshipLabel = $core_v2_language.GetResource('Unfriend'))
						#set ($cancelType = 'unfriend')
						#if ($friendship.FriendshipState == 'Pending')
							#set ($cancelType = 'cancel')
							#set ($cancelFriendshipLabel = $core_v2_language.GetResource('CancelRequest'))
						#end
						&lt;li&gt;
							&lt;a href="#" class="internal-link cancel-friendship" data-messagename="widget.${core_v2_widget.WrapperElementId}.cancel-friendship" data-requestorid="$accessingUser.Id" data-requesteeid="$user.Id" data-canceltype="$cancelType" &gt;$cancelFriendshipLabel&lt;/a&gt;
						&lt;/li&gt;

					## Requestee - accept/reject pending friendship
					#elseif($friendship &amp;&amp; $friendship.FriendshipState == 'Pending' &amp;&amp; $friendship.Recipient.Id == $accessingUser.Id)
						&lt;li&gt;
							&lt;a href="#" class="internal-link accept-friendship" data-messagename="widget.${core_v2_widget.WrapperElementId}.accept-friendship" data-requestorid="$user.Id" data-requesteeid="$accessingUser.Id"&gt;$core_v2_language.GetResource('AcceptRequest')&lt;/a&gt;
						&lt;/li&gt;
						&lt;li&gt;
							&lt;a href="#" class="internal-link reject-friendship" data-messagename="widget.${core_v2_widget.WrapperElementId}.reject-friendship" data-requestorid="$user.Id" data-requesteeid="$accessingUser.Id"&gt;$core_v2_language.GetResource('RejectRequest')&lt;/a&gt;
						&lt;/li&gt;

					## Not friends, allow requesting
					#else
						## Determine if a custom friend request messgae is needed.
						## This can be known by whether there would otherwise be a desktop modal URL available to provide one
						#set ($friendRequestUrl = false)
						#set ($friendRequestUrl = $core_v2_urls.RequestFriendship($user.Id))
						#if ($friendRequestUrl)
							## set friend request URL to use a specific mobile page
							#set ($friendRequestUrl = $mobile_v1_url.Format('user-requestfriendship', $user.Id))
						#end

						#set ($defaultRequestMessage = '')
						#set ($defaultRequestMessage = $core_v2_configuration.DefaultFriendshipRequestMessage)
						#set ($defaultRequestMessage = $core_v2_ui.FormatHtmlAsText($defaultRequestMessage))

						&lt;li&gt;
							&lt;a href="#"
								class="internal-link request-friendship"
								data-messagename="widget.${core_v2_widget.WrapperElementId}.request-friendship"
								data-requestorid="$accessingUser.Id"
								data-requesteeid="$user.Id"
								data-requesturl=#if($friendRequestUrl) "$core_v2_encoding.HtmlAttributeEncode($friendRequestUrl)" #else "" #end
								data-requestmessage="$core_v2_encoding.HtmlAttributeEncode($defaultRequestMessage)"&gt;
								$core_v2_language.GetResource('RequestFriendship')
							&lt;/a&gt;
						&lt;/li&gt;
					#end

					#set ($follows = 'false')
					#set ($followLink = $core_v2_language.GetResource('Follow'))
					#if ($core_v2_following.Get($accessingUser.Id, "%{ FollowingId = $userId }"))
						#set ($follows = 'true')
						#set ($followLink = $core_v2_language.GetResource('Unfollow'))
					#end
					&lt;li&gt;
						&lt;a href="#" data-messagename="widget.${core_v2_widget.WrapperElementId}.user-follow" data-followerId="$accessingUser.Id" data-followingId="$userId" data-follows="$follows"&gt;$followLink&lt;/a&gt;
					&lt;/li&gt;

					#if ($core_v2_urls.AddConversation($userId))
						&lt;li&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('conversation-add-touser', $userId))"&gt;$core_v2_language.GetResource('SendMessage')&lt;/a&gt;&lt;/li&gt;
					#end
				#end
				&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;$core_v2_language.GetResource('more')&lt;/a&gt;&lt;/li&gt;
				&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;

			#end
		&lt;/ul&gt;
	&lt;/div&gt;

	#set ($navigationItems = $core_v2_customNavigation.FromWidget($core_v2_utility.ParseGuid('19e9689493a4449eb063e61762da2ea4'), 'navigation', "%{Url=$core_v2_page.Url, UserId=$user.Id}"))
	#foreach ($navigationItem in $navigationItems)
		#beforeall
		&lt;div class="ui-links applications" data-minlinks="100" data-animate="true"&gt;
			&lt;ul&gt;
		#each
			#if ($mobile_v1_url.IsRedirected($navigationItem.Url) &amp;&amp; $navigationItem.CssClass != 'internal-link view-user-profile')
				&lt;li&gt;
					&lt;a href="$core_v2_encoding.HtmlAttributeEncode($navigationItem.Url)"&gt;$navigationItem.Label&lt;/a&gt;
				&lt;/li&gt;
			#end
		#afterall
				&lt;li class="application-more"&gt;&lt;a href="#" data-more&gt;$core_v2_language.GetResource('more')&lt;/a&gt;&lt;/li&gt;
				&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
			&lt;/ul&gt;
		&lt;/div&gt;
	#end
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.userBanner.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			followText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('Follow'))',
			unfollowText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('Unfollow'))',
			followedText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('Followed'))',
			unfollowedText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('Unfollowed'))',

			messageFollow: 'widget.${core_v2_widget.WrapperElementId}.user-follow',
			messageRequestFriendship: 'widget.${core_v2_widget.WrapperElementId}.request-friendship',
			messageCancelFriendship: 'widget.${core_v2_widget.WrapperElementId}.cancel-friendship',
			messageAcceptFriendship: 'widget.${core_v2_widget.WrapperElementId}.accept-friendship',
			messageRejectFriendship: 'widget.${core_v2_widget.WrapperElementId}.reject-friendship',

			unfriendConfirmation: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UnfriendConfirmation'))',
			cancelConfirmation: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('CancelRequestConfirmation'))',
			unfriendComplete: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UnfriendComplete'))',
			cancelComplete: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('CancelRequestComplete'))',
			acceptComplete: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('AcceptComplete'))',
			rejectComplete: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('RejectComplete'))',
			requestComplete: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('RequestComplete'))'
		});
	});
});
&lt;/script&gt;


	</contentScript>
    <languageResources>
		<language key="en-us">
			<resource name="UserBanner_Name">User Banner</resource>
			<resource name="SendMessage">Send a Message</resource>
			<resource name="Follow">Start Following</resource>
			<resource name="Unfollow">Stop Following</resource>
			<resource name="Followed">Following started</resource>
			<resource name="Unfollowed">Following stopped</resource>
			<resource name="RequestFriendship">Request friendship</resource>
			<resource name="Unfriend">Unfriend</resource>
			<resource name="CancelRequest">Cancel friendship request</resource>
			<resource name="AcceptRequest">Accept friend request</resource>
			<resource name="RejectRequest">Reject friend request</resource>
			<resource name="cancel">Cancel</resource>
			<resource name="more">More</resource>
			<resource name="UnfriendConfirmation">Are you sure you want to unfriend this person?</resource>
			<resource name="CancelRequestConfirmation">Are you sure you want to cancel this friendship request?</resource>
			<resource name="UnfriendComplete">Unfriended</resource>
			<resource name="CancelRequestComplete">Request canceled</resource>
			<resource name="AcceptComplete">Friendship accepted</resource>
			<resource name="RejectComplete">Friendship rejected</resource>
			<resource name="RequestComplete">Friendship requested</resource>
		</language>
	</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQpewoKCXZhciBtb2RlbCA9IHsKCQlzdGFydEZvbGxvd2luZzogZnVuY3Rpb24gKGZvbGxvd2VySWQsIGZvbGxvd2luZ0lkKSB7CgkJCXJldHVybiAkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNob3dMb2FkaW5nKCQudGVsbGlnZW50LmV2b2x1dGlvbi5wb3N0KHsKCQkJCXVybDogJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ2FwaS5hc2h4L3YyL3VzZXJzL3tGb2xsb3dlcklkfS9mb2xsb3dpbmcuanNvbicsCgkJCQlkYXRhOiB7CgkJCQkJRm9sbG93ZXJJZDogZm9sbG93ZXJJZCwKCQkJCQlGb2xsb3dpbmdJZDogZm9sbG93aW5nSWQKCQkJCX0KCQkJfSkpOwoJCX0sCgoJCXN0b3BGb2xsb3dpbmc6IGZ1bmN0aW9uIChmb2xsb3dlcklkLCBmb2xsb3dpbmdJZCkgewoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygkLnRlbGxpZ2VudC5ldm9sdXRpb24uZGVsKHsKCQkJCXVybDogJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ2FwaS5hc2h4L3YyL3VzZXJzL3tGb2xsb3dlcklkfS9mb2xsb3dpbmcve0ZvbGxvd2luZ0lkfS5qc29uJywKCQkJCWRhdGE6IHsKCQkJCQlGb2xsb3dlcklkOiBmb2xsb3dlcklkLAoJCQkJCUZvbGxvd2luZ0lkOiBmb2xsb3dpbmdJZAoJCQkJfQoJCQl9KSk7CgkJfSwKCgkJcmVxdWVzdEZyaWVuZHNoaXA6IGZ1bmN0aW9uKHJlcXVlc3RvcklkLCByZXF1ZXN0ZWVJZCwgcmVxdWVzdE1lc3NhZ2UpIHsKCQkJcmV0dXJuICQudGVsbGlnZW50LmV2b2x1dGlvbi5wb3N0KHsKCQkJCXVybDogJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ2FwaS5hc2h4L3YyL3VzZXJzL3tSZXF1ZXN0b3JJZH0vZnJpZW5kcy5qc29uJywKCQkJCWRhdGE6IHsKCQkJCQlSZXF1ZXN0b3JJZDogcmVxdWVzdG9ySWQsCgkJCQkJUmVxdWVzdGVlSWQ6IHJlcXVlc3RlZUlkLAoJCQkJCVJlcXVlc3RNZXNzYWdlOiAocmVxdWVzdE1lc3NhZ2UgfHwgJycpCgkJCQl9CgkJCX0pOwoJCX0sCgoJCWNhbmNlbEZyaWVuZHNoaXA6IGZ1bmN0aW9uKHJlcXVlc3RvcklkLCByZXF1ZXN0ZWVJZCkgewoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLmRlbCh7CgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi91c2Vycy97UmVxdWVzdG9ySWR9L2ZyaWVuZHMve1JlcXVlc3RlZUlkfS5qc29uJywKCQkJCWRhdGE6IHsKCQkJCQlSZXF1ZXN0b3JJZDogcmVxdWVzdG9ySWQsCgkJCQkJUmVxdWVzdGVlSWQ6IHJlcXVlc3RlZUlkCgkJCQl9CgkJCX0pOwoJCX0sCgoJCWFjY2VwdEZyaWVuZHNoaXA6IGZ1bmN0aW9uKHJlcXVlc3RvcklkLCByZXF1ZXN0ZWVJZCkgewoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7CgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi91c2Vycy97UmVxdWVzdG9ySWR9L2ZyaWVuZHMve1JlcXVlc3RlZUlkfS5qc29uJywKCQkJCWRhdGE6IHsKCQkJCQlSZXF1ZXN0b3JJZDogcmVxdWVzdG9ySWQsCgkJCQkJUmVxdWVzdGVlSWQ6IHJlcXVlc3RlZUlkLAoJCQkJCUZyaWVuZHNoaXBTdGF0ZTogJ0FwcHJvdmVkJwoJCQkJfQoJCQl9KTsKCQl9LAoKCQlyZWplY3RGcmllbmRzaGlwOiBmdW5jdGlvbihyZXF1ZXN0b3JJZCwgcmVxdWVzdGVlSWQpIHsKCQkJcmV0dXJuIHRoaXMuY2FuY2VsRnJpZW5kc2hpcChyZXF1ZXN0b3JJZCwgcmVxdWVzdGVlSWQpOwoJCX0KCX0KCglmdW5jdGlvbiBoYW5kbGVBY3Rpb25zKGNvbnRleHQpIHsKCQl2YXIgb24gPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnN1YnNjcmliZTsKCgkJLy8gZm9sbG93L3VuZm9sbG93CgkJb24oY29udGV4dC5tZXNzYWdlRm9sbG93LCBmdW5jdGlvbiAoZGF0YSkgewoJCQl2YXIgdGFyZ2V0ID0gJChkYXRhLnRhcmdldCk7CgkJCWlmICghdGFyZ2V0Lmhhc0NsYXNzKCJwcm9jZXNzaW5nIikpIHsKCQkJCXRhcmdldC5hZGRDbGFzcygicHJvY2Vzc2luZyIpLnRleHQoJy4uLicpOwoJCQkJdmFyIGZvbGxvd3MgPSB0YXJnZXQuZGF0YSgnZm9sbG93cycpOwoJCQkJdmFyIGFjdGlvbiA9IGZvbGxvd3MgPyBtb2RlbC5zdG9wRm9sbG93aW5nIDogbW9kZWwuc3RhcnRGb2xsb3dpbmc7CgkJCQlhY3Rpb24odGFyZ2V0LmRhdGEoJ2ZvbGxvd2VyaWQnKSwgdGFyZ2V0LmRhdGEoJ2ZvbGxvd2luZ2lkJykpCgkJCQkJLmRvbmUoZnVuY3Rpb24gKCkgewoJCQkJCQlmb2xsb3dzID0gIWZvbGxvd3M7CgkJCQkJCXRhcmdldC5kYXRhKCdmb2xsb3dzJywgZm9sbG93cyk7CgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuZGlzcGxheU1lc3NhZ2UoCgkJCQkJCQkhZm9sbG93cyA/IGNvbnRleHQudW5mb2xsb3dlZFRleHQgOiBjb250ZXh0LmZvbGxvd2VkVGV4dCwgewoJCQkJCQkJCWRpc2FwcGVhckFmdGVyOiA1MDAwLAoJCQkJCQkJCWNzc0NsYXNzOiAnaW5mbycKCQkJCQkJCX0pOwoJCQkJCX0pCgkJCQkJLmFsd2F5cyhmdW5jdGlvbiAoKSB7CgkJCQkJCXRhcmdldC5yZW1vdmVDbGFzcygicHJvY2Vzc2luZyIpCgkJCQkJCQkgIC50ZXh0KGZvbGxvd3MgPyBjb250ZXh0LnVuZm9sbG93VGV4dCA6IGNvbnRleHQuZm9sbG93VGV4dCApOwoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmhpZGVTaGVldCgpOwoJCQkJCX0pOwoJCQl9CgkJfSk7CgoJCS8vIHJlcXVlc3QgZnJpZW5kc2hpcAoJCW9uKGNvbnRleHQubWVzc2FnZVJlcXVlc3RGcmllbmRzaGlwLCBmdW5jdGlvbihkYXRhKSB7CgkJCXZhciB0YXJnZXQgPSAkKGRhdGEudGFyZ2V0KTsKCQkJdmFyIHJlcXVlc3RVcmwgPSB0YXJnZXQuZGF0YSgncmVxdWVzdHVybCcpOwoJCQkvLyBpZiB0aGlzIHJlcXVpcmVzIGEgY3VzdG9tIHJlcXVlc3QsIHNob3cgdGhhdCBwYWdlCgkJCWlmKHJlcXVlc3RVcmwpIHsKCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUubG9hZChyZXF1ZXN0VXJsKTsKCQkJfSBlbHNlIHsKCQkJCW1vZGVsLnJlcXVlc3RGcmllbmRzaGlwKHRhcmdldC5kYXRhKCdyZXF1ZXN0b3JpZCcpLCB0YXJnZXQuZGF0YSgncmVxdWVzdGVlaWQnKSwgdGFyZ2V0LmRhdGEoJ3JlcXVlc3RtZXNzYWdlJykpCgkJCQkJLmRvbmUoZnVuY3Rpb24oKSB7CgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuZGlzcGxheU1lc3NhZ2UoY29udGV4dC5yZXF1ZXN0Q29tcGxldGUsIHsKCQkJCQkJCWRpc2FwcGVhckFmdGVyOiA1MDAwLAoJCQkJCQkJY3NzQ2xhc3M6ICdpbmZvJwoJCQkJCQl9KTsKCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5yZWZyZXNoKCk7CgkJCQkJfSkKCQkJCQkuYWx3YXlzKGZ1bmN0aW9uKCl7CgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuaGlkZVNoZWV0KCk7CgkJCQkJfSk7CgkJCX0KCQl9KTsKCgkJLy8gdW5mcmllbmQgb3IgY2FuY2VsIHJlcXVlc3QKCQlvbihjb250ZXh0Lm1lc3NhZ2VDYW5jZWxGcmllbmRzaGlwLCBmdW5jdGlvbihkYXRhKSB7CgkJCXZhciB0YXJnZXQgPSAkKGRhdGEudGFyZ2V0KTsKCQkJaWYoY29uZmlybSh0YXJnZXQuZGF0YSgnY2FuY2VsdHlwZScpID09PSAndW5mcmllbmQnID8gY29udGV4dC51bmZyaWVuZENvbmZpcm1hdGlvbiA6IGNvbnRleHQuY2FuY2VsQ29uZmlybWF0aW9uKSkgewoJCQkJbW9kZWwuY2FuY2VsRnJpZW5kc2hpcCh0YXJnZXQuZGF0YSgncmVxdWVzdG9yaWQnKSwgdGFyZ2V0LmRhdGEoJ3JlcXVlc3RlZWlkJykpCgkJCQkJLmRvbmUoZnVuY3Rpb24oKSB7CgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuZGlzcGxheU1lc3NhZ2UoKHRhcmdldC5kYXRhKCdjYW5jZWx0eXBlJykgPT09ICd1bmZyaWVuZCcgPyBjb250ZXh0LnVuZnJpZW5kQ29tcGxldGUgOiBjb250ZXh0LmNhbmNlbENvbXBsZXRlKSwgewoJCQkJCQkJZGlzYXBwZWFyQWZ0ZXI6IDUwMDAsCgkJCQkJCQljc3NDbGFzczogJ2luZm8nCgkJCQkJCX0pOwoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnJlZnJlc2goKTsKCQkJCQl9KQoJCQkJCS5hbHdheXMoZnVuY3Rpb24oKXsKCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlU2hlZXQoKTsKCQkJCQl9KTsKCQkJfQoJCX0pOwoKCQkvLyBhY2NlcHQgcmVxdWVzdAoJCW9uKGNvbnRleHQubWVzc2FnZUFjY2VwdEZyaWVuZHNoaXAsIGZ1bmN0aW9uKGRhdGEpIHsKCQkJdmFyIHRhcmdldCA9ICQoZGF0YS50YXJnZXQpOwoJCQltb2RlbC5hY2NlcHRGcmllbmRzaGlwKHRhcmdldC5kYXRhKCdyZXF1ZXN0b3JpZCcpLCB0YXJnZXQuZGF0YSgncmVxdWVzdGVlaWQnKSkKCQkJCS5kb25lKGZ1bmN0aW9uKCkgewoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuZGlzcGxheU1lc3NhZ2UoY29udGV4dC5hY2NlcHRDb21wbGV0ZSwgewoJCQkJCQlkaXNhcHBlYXJBZnRlcjogNTAwMCwKCQkJCQkJY3NzQ2xhc3M6ICdpbmZvJwoJCQkJCX0pOwoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUucmVmcmVzaCgpOwoJCQkJfSkKCQkJCS5hbHdheXMoZnVuY3Rpb24oKXsKCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmhpZGVTaGVldCgpOwoJCQkJfSk7CgkJfSk7CgoJCS8vIHJlamVjdCByZXF1ZXN0CgkJb24oY29udGV4dC5tZXNzYWdlUmVqZWN0RnJpZW5kc2hpcCwgZnVuY3Rpb24oZGF0YSkgewoJCQl2YXIgdGFyZ2V0ID0gJChkYXRhLnRhcmdldCk7CgkJCW1vZGVsLnJlamVjdEZyaWVuZHNoaXAodGFyZ2V0LmRhdGEoJ3JlcXVlc3RvcmlkJyksIHRhcmdldC5kYXRhKCdyZXF1ZXN0ZWVpZCcpKQoJCQkJLmRvbmUoZnVuY3Rpb24oKSB7CgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5kaXNwbGF5TWVzc2FnZShjb250ZXh0LnJlamVjdENvbXBsZXRlLCB7CgkJCQkJCWRpc2FwcGVhckFmdGVyOiA1MDAwLAoJCQkJCQljc3NDbGFzczogJ2luZm8nCgkJCQkJfSk7CgkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5yZWZyZXNoKCk7CgkJCQl9KQoJCQkJLmFsd2F5cyhmdW5jdGlvbigpewoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuaGlkZVNoZWV0KCk7CgkJCQl9KTsKCQl9KTsKCX0KCgl2YXIgYXBpID0gewoJCXJlZ2lzdGVyOiBmdW5jdGlvbihvcHRpb25zKSB7CgkJCWhhbmRsZUFjdGlvbnMob3B0aW9ucyk7CgkJfQoJfQoKCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24gPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24gfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyA9ICQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzIHx8IHt9OwoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMudXNlckJhbm5lciA9IGFwaTsKCn0pKGpRdWVyeSk7</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:UserBio_Name}" version="7.0.0.1" description="" instanceIdentifier="5f626adb9e784d19898bd6c488fb7ac9" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="user-bio">
    <contentScript>
			

			#set ($userId = false)
			#set ($userId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('UserId')))
			#if (!$userId)
			$core_v2_widget.Hide()
			#end
			#set ($user = false)
			#set ($user = $core_v2_user.Get("%{ Id = $userId }"))
			#if (!$user)
			$core_v2_widget.Hide()
			#end

			&lt;div class="profile"&gt;
				&lt;div class="profile-field-list"&gt;
					&lt;div class="profile-field"&gt;
						&lt;div class="label"&gt;$!core_v2_language.FormatString($core_v2_language.GetResource('UserProfile_Bio'), $user.DisplayName)&lt;/div&gt;
						#set($bio = false)
						#set($bio = $user.Bio())
						#if ($bio &amp;&amp; $core_v2_utility.Trim($bio) != "")
						&lt;div class="value user-generated-content"&gt;$mobile_v1_dataFormat.Detect($bio)&lt;/div&gt;
						#else
						&lt;div class="value"&gt;$core_v2_language.FormatString($core_v2_language.GetResource('UserProfile_Bio_NotEntered'), $user.DisplayName)&lt;/div&gt;
						#end
					&lt;/div&gt;
				&lt;/div&gt;
			&lt;/div&gt;
			
		</contentScript>
    <languageResources>
			<language key="en-us">
				<resource name="UserBio_Name">User Biography</resource>
				<resource name="UserProfile_Bio">About {0}</resource>
				<resource name="UserProfile_Bio_NotEntered">{0} has not entered a biography.</resource>
			</language>
		</languageResources>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:UserBookmarks_Name}" version="7.0.0.1" description="" instanceIdentifier="c3b4a8778b3c4d988e25c8fe886da9e0" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="user-bookmarks">
    <contentScript>


#set ($userId = false)
#set ($userId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('UserId')))
#if (!$userId)
	$core_v2_widget.Hide()
#end
#set ($user = false)
#set ($user = $core_v2_user.Get("%{ Id = $userId }"))
#if (!$user)
	$core_v2_widget.Hide()
#end

## hide widget if the contextual user hasn't enabled favorite sharing
#if (!$user.EnableFavoriteSharing &amp;&amp; $user.Id != $core_v2_user.Accessing.Id)
	$core_v2_widget.Hide()
#end

#set($pageSize = $core_v2_widget.GetIntValue('pageSize', 5))
#set($pageIndex = 0)

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($user.ProfileUrl)"&gt;$user.DisplayName&lt;/a&gt;
		&lt;h1&gt;$!core_v2_language.FormatString($core_v2_language.GetResource('Core_UserBookmarks_Title'), $user.DisplayName)&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$!core_v2_ui.GetResizedImageHtml($user.AvatarUrl, 40, 40, "%{ alt = $user.DisplayName, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
&lt;/div&gt;

#set($filter = false)
#set($filter = $core_v2_page.GetQueryStringValue('w_filter'))
#if (!$filter)
	#set($filter = 'content')
#end
&lt;div class="ui-links filters" data-minlinks="50" data-animate="true"&gt;
	&lt;ul class="activity-filters"&gt;
		&lt;li&gt;&lt;a href="#" data-filter="content" #if($filter == 'content') data-selected #end&gt;$core_v2_language.GetResource('Core_UserBookmarks_ContentLink')&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;&lt;a href="#" data-filter="applications" #if($filter == 'applications') data-selected #end&gt;$core_v2_language.GetResource('Core_UserBookmarks_ApplicationsLink')&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;&lt;a href="#" data-filter="groups" #if($filter == 'groups') data-selected #end&gt;$core_v2_language.GetResource('Core_UserBookmarks_GroupsLink')&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;&lt;a href="#" data-filter="people" #if($filter == 'people') data-selected #end&gt;$core_v2_language.GetResource('Core_UserBookmarks_PeopleLink')&lt;/a&gt;&lt;/li&gt;
	&lt;/ul&gt;
&lt;/div&gt;

## load and render bookmarks
&lt;div class="post-list bookmarks $filter"&gt;
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.userBookmarks.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
		filter: '$filter',
		moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
		pageSize: $pageSize
		});
	});
});
&lt;/script&gt;


</contentScript>
    <configuration>
	
		
	
</configuration>
    <languageResources>
	<language key="en-us">
		<resource name="UserBookmarks_Name">Bookmarks</resource>
		<resource name="Core_UserBookmarks_ContentLink">Content</resource>
		<resource name="Core_UserBookmarks_ApplicationsLink">Applications</resource>
		<resource name="Core_UserBookmarks_GroupsLink">Groups</resource>
		<resource name="Core_UserBookmarks_PeopleLink">People</resource>
		<resource name="Core_UserBookmarks_Title">Bookmarks</resource>
		<resource name="Core_UserBookmarks_No_Bookmarks">{0} has no bookmarks of this type. </resource>
	</language>
</languageResources>
    <files>
      <file name="list.vm">I3NldCAoJGNvbnRlbnRUeXBlcyA9ICcnKQojaWYgKCRmaWx0ZXIgPT0gJ2NvbnRlbnQnKQoJI3NldCAoJGNvbnRlbnRUeXBlcyA9ICIkY29yZV92Ml9mb3J1bVRocmVhZC5Db250ZW50VHlwZUlkLCRjb3JlX3YyX3dpa2lQYWdlLkNvbnRlbnRUeXBlSWQsJGNvcmVfdjJfYmxvZ1Bvc3QuQ29udGVudFR5cGVJZCwkY29yZV92Ml9tZWRpYS5Db250ZW50VHlwZUlkIikKI2Vsc2VpZiAoJGZpbHRlciA9PSAnYXBwbGljYXRpb25zJykKCSNzZXQgKCRjb250ZW50VHlwZXMgPSAiJGNvcmVfdjJfZm9ydW0uQXBwbGljYXRpb25UeXBlSWQsJGNvcmVfdjJfd2lraS5BcHBsaWNhdGlvblR5cGVJZCwkY29yZV92Ml9ibG9nLkFwcGxpY2F0aW9uVHlwZUlkLCRjb3JlX3YyX2dhbGxlcnkuQXBwbGljYXRpb25UeXBlSWQiKQojZWxzZWlmICgkZmlsdGVyID09ICdncm91cHMnKQoJI3NldCAoJGNvbnRlbnRUeXBlcyA9ICIkY29yZV92Ml9ncm91cC5Db250YWluZXJUeXBlSWQiKQojZWxzZWlmICgkZmlsdGVyID09ICdwZW9wbGUnKQoJI3NldCAoJGNvbnRlbnRUeXBlcyA9ICIkY29yZV92Ml91c2VyLkNvbnRlbnRUeXBlSWQiKQojZW5kCgojc2V0ICgkYm9va21hcmtzID0gJGNvcmVfdjJfYm9va21hcmsuTGlzdCgiJXsgVXNlcklkID0gJHVzZXJJZCwgUGFnZVNpemUgPSAkcGFnZVNpemUsIFBhZ2VJbmRleCA9ICRwYWdlSW5kZXgsIENvbnRlbnRUeXBlSWRzID0gJGNvbnRlbnRUeXBlc30iKSkKCiNmb3JlYWNoICgkYm9va21hcmsgaW4gJGJvb2ttYXJrcykKI2VhY2gKCSNzZXQoJGF2YXRhclVybCA9IGZhbHNlKQoJI2lmKCRib29rbWFyay5Db250ZW50KQoJCSNzZXQoJGF2YXRhclVybCA9ICRib29rbWFyay5Db250ZW50LkF2YXRhclVybCkKCQkjaWYgKCEkYXZhdGFyVXJsKQoJCQkjc2V0KCRhdmF0YXJVcmwgPSAkYm9va21hcmsuQ29udGVudC5BcHBsaWNhdGlvbi5BdmF0YXJVcmwpCgkJCSNpZiAoISRhdmF0YXJVcmwpCgkJCQkjc2V0KCRhdmF0YXJVcmwgPSAkYm9va21hcmsuQ29udGVudC5BcHBsaWNhdGlvbi5Db250YWluZXIuQXZhdGFyVXJsKQoJCQkjZW5kCgkJI2VuZAoJI2VuZAoKCTxkaXYgY2xhc3M9InBvc3QtbGlzdC1pdGVtIGNvbnRlbnQtaXRlbSBib29rbWFyayIgZGF0YS10YXJnZXR1cmw9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJGJvb2ttYXJrLkNvbnRlbnQuVXJsKSI+CgkJPGRpdiBjbGFzcz0icG9zdCI+CgkJCTxkaXYgY2xhc3M9ImF2YXRhciI+CgkJCQkjaWYoJGF2YXRhclVybCkKCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRib29rbWFyay5Db250ZW50LlVybCkiIGNsYXNzPSJpbnRlcm5hbC1saW5rIHZpZXctdXNlci1wcm9maWxlIj4KCQkJCQkJJGNvcmVfdjJfdWkuR2V0UmVzaXplZEltYWdlSHRtbCgkYXZhdGFyVXJsLCA0MCwgNDAsICIle2JvcmRlcj0nMCcsIGFsdD0kYWx0LCBSZXNpemVNZXRob2Q9J1pvb21BbmRDcm9wJyxib3JkZXI9JzAnfSIpCgkJCQkJPC9hPgoJCQkJI2VuZAoJCQk8L2Rpdj4KCQkJPGRpdiBjbGFzcz0iY29udGVudCI+CgkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRib29rbWFyay5Db250ZW50LlVybCkiPiRib29rbWFyay5Db250ZW50Lkh0bWxOYW1lKCJXZWIiKTwvYT4KCQkJPC9kaXY+CgkJPC9kaXY+Cgk8L2Rpdj4KI25vZGF0YQoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIGJvb2ttYXJrcyI+PGRpdiBjbGFzcz0ibWVzc2FnZSBub3JlY29yZHMiPiRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdFN0cmluZygkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnQ29yZV9Vc2VyQm9va21hcmtzX05vX0Jvb2ttYXJrcycpLCAkdXNlci5EaXNwbGF5TmFtZSk8L2Rpdj48L2Rpdj4KI2FmdGVyYWxsCgkjc2V0ICgkaGFzTW9yZSA9IGZhbHNlKQoJI2lmICgkYm9va21hcmtzLlRvdGFsQ291bnQgPiAoKCRib29rbWFya3MuUGFnZUluZGV4ICsgMSkgKiAkYm9va21hcmtzLlBhZ2VTaXplKSkKCQkjc2V0KCRoYXNNb3JlID0gdHJ1ZSkKCSNlbmQKCTxkaXYgY2xhc3M9ImRhdGEiICNpZigkaGFzTW9yZSlkYXRhLWhhc21vcmU9InRydWUiI2VuZD48L2Rpdj4KI2VuZAo=</file>
      <file name="more.vm">IyMKIyMgQWpheCBjYWxsYmFjayBmb3IgbG9hZGluZyBtb3JlIGJvb2ttYXJrcwojIwoKI3NldCAoJHBhZ2VJbmRleCA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19wYWdlSW5kZXgnKSkKI3NldCAoJHBhZ2VTaXplID0gJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X3BhZ2VTaXplJykpCgojc2V0ICgkdXNlcklkID0gZmFsc2UpCiNzZXQgKCR1c2VySWQgPSAkY29yZV92Ml91dGlsaXR5LlBhcnNlSW50KCRtb2JpbGVfdjFfdXJsVG9rZW4uVmFsdWUoJ1VzZXJJZCcpKSkKI2lmICghJHVzZXJJZCkKCSRjb3JlX3YyX3dpZGdldC5IaWRlKCkKI2VuZAoKI3NldCgkZmlsdGVyID0gZmFsc2UpCiNzZXQoJGZpbHRlciA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19maWx0ZXInKSkKI2lmICghJGZpbHRlcikKCSNzZXQoJGZpbHRlciA9ICdjb250ZW50JykKI2VuZAoKJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCdsaXN0LnZtJykK</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpewoKCXZhciBhcGkgPSB7CgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuYWRkUmVmcmVzaFBhcmFtZXRlcignd19maWx0ZXInLCBvcHRpb25zLmZpbHRlcik7CgoJCQkkKG9wdGlvbnMud3JhcHBlciArICcgLmZpbHRlcnMgYScpLm9uKCd0YXAnLCBmdW5jdGlvbihlKSB7CgkJCQl2YXIgZmlsdGVyID0gJCh0aGlzKS5kYXRhKCdmaWx0ZXInKTsKCQkJCWlmIChmaWx0ZXIgIT0gb3B0aW9ucy5maWx0ZXIpIHsKCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmFkZFJlZnJlc2hQYXJhbWV0ZXIoJ3dfZmlsdGVyJywgZmlsdGVyKTsKCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnJlZnJlc2goKTsKCQkJCX0KCQkJCXJldHVybiBmYWxzZTsKCQkJfSk7CgoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNjcm9sbGFibGUoewoJCQkJcmVnaW9uOiAnY29udGVudCcsCgkJCQlsb2FkOiBmdW5jdGlvbihwYWdlSW5kZXgsIHN1Y2Nlc3MsIGVycm9yKSB7CgkJCQkJaWYgKCQoJy5ib29rbWFya3MuJyArIG9wdGlvbnMuZmlsdGVyICsgJyBkaXYuZGF0YTpsYXN0JykuZGF0YSgnaGFzbW9yZScpKSB7CgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5nZXQoewoJCQkJCQkJdXJsOiBvcHRpb25zLm1vcmVVcmwsCgkJCQkJCQlkYXRhOiB7CgkJCQkJCQkJd19wYWdlSW5kZXg6IHBhZ2VJbmRleCwKCQkJCQkJCQl3X3BhZ2VTaXplOiBvcHRpb25zLnBhZ2VTaXplCgkJCQkJCQl9LAoJCQkJCQkJc3VjY2VzczogZnVuY3Rpb24ocikgewoJCQkJCQkJCXN1Y2Nlc3Mocik7CgkJCQkJCQl9LAoJCQkJCQkJZXJyb3I6IGZ1bmN0aW9uKCkgewoJCQkJCQkJCWVycm9yKCk7CgkJCQkJCQl9CgkJCQkJCX0pOwoJCQkJCX0gZWxzZSB7CgkJCQkJCXN1Y2Nlc3MoKTsKCQkJCQl9CgkJCQl9LAoJCQkJY29tcGxldGU6IGZ1bmN0aW9uKGNvbnRlbnQpIHsKCQkJCQljb250ZW50ID0gJChjb250ZW50KS5jc3MoeyBvcGFjaXR5OiAwIH0pOwoJCQkJCSQoJ2Rpdi5wb3N0LWxpc3QuYm9va21hcmtzLicgKyBvcHRpb25zLmZpbHRlcikuYXBwZW5kKGNvbnRlbnQpOwoJCQkJCWNvbnRlbnQuZXZvbHV0aW9uVHJhbnNmb3JtKHsgb3BhY2l0eTogMSB9LCB7IGR1cmF0aW9uOiA0MDAgfSk7CgkJCQl9CgkJCX0pOwoKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoInVpLmJvb2ttYXJrIiwgZnVuY3Rpb24oZGF0YSkgewoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5yZWZyZXNoKCk7CgkJCX0pOwoJCX0KCX0KCgkkLnRlbGxpZ2VudCA9ICQudGVsbGlnZW50IHx8IHt9OwoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9OwoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzLnVzZXJCb29rbWFya3MgPSBhcGk7Cgp9KShqUXVlcnkpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:UserFriendshipRequest_Name}" version="7.0.0.1" description="" instanceIdentifier="5c71ade7256f4ce58fe1f8add7f879ac" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="user-friendship-request">
    <contentScript>
		
#set($userId = false)
#set($user = false)
#set($userId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('userId')))
#if ($userId)
	#set ($user = $core_v2_user.Get("%{ Id = $userId }"))
#end
#if (!$user)
	$core_v2_widget.Hide()
#end

#set($bodyId = $core_v2_widget.UniqueId('body'))
#set ($defaultRequestMessage = '')
#set ($defaultRequestMessage = $core_v2_configuration.DefaultFriendshipRequestMessage)
#set ($defaultRequestMessage = $core_v2_ui.FormatHtmlAsText($defaultRequestMessage))

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($user.ProfileUrl)"&gt;$user.DisplayName&lt;/a&gt;
		&lt;h1&gt;$core_v2_language.GetResource('request_friendship')&lt;/h1&gt;
	&lt;/div&gt;
&lt;/div&gt;
&lt;fieldset&gt;
	&lt;div class="form-field editor"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;
			$core_v2_language.FormatString($core_v2_language.GetResource('request'), $user.DisplayName)
		&lt;/label&gt;
		&lt;textarea id="$core_v2_encoding.HtmlAttributeEncode($bodyId)"&gt;$defaultRequestMessage&lt;/textarea&gt;
	&lt;/div&gt;
&lt;/fieldset&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.userFriendshipRequest.register({
			bodyId: '#$core_v2_encoding.JavascriptEncode($bodyId)',
			sendLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('send_request'))',
			requestSent: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('request_sent'))',
			requesteeId: $user.Id,
			requestorId: $core_v2_user.Accessing.Id
		});

		jQuery.telligent.evolution.mobile.refreshable(false);
		jQuery.telligent.evolution.mobile.excludeFromHistory();
	});
})
&lt;/script&gt;
		

		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
		  	<resource name="UserFriendshipRequest_Name">Friendship Request</resource>
			<resource name="request">Send a friendship request to {0}</resource>
			<resource name="send_request">Send</resource>
			<resource name="request_friendship">Request friendship</resource>
			<resource name="request_sent">Friendship requested</resource>
		  </language>
		</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQsIGdsb2JhbCwgdW5kZWYpewoKCWZ1bmN0aW9uIHJlcXVlc3RGcmllbmRzaGlwKHJlcXVlc3RvcklkLCByZXF1ZXN0ZWVJZCwgcmVxdWVzdE1lc3NhZ2UpIHsKCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnBvc3QoewoJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi91c2Vycy97UmVxdWVzdG9ySWR9L2ZyaWVuZHMuanNvbicsCgkJCWRhdGE6IHsKCQkJCVJlcXVlc3RvcklkOiByZXF1ZXN0b3JJZCwKCQkJCVJlcXVlc3RlZUlkOiByZXF1ZXN0ZWVJZCwKCQkJCVJlcXVlc3RNZXNzYWdlOiAocmVxdWVzdE1lc3NhZ2UgfHwgJycpCgkJCX0KCQl9KTsKCX0KCgl2YXIgYXBpID0gewoJCXJlZ2lzdGVyOiBmdW5jdGlvbihvcHRpb25zKSB7CgkJCW9wdGlvbnMuYm9keSA9ICQob3B0aW9ucy5ib2R5SWQpOwoKCQkJdmFyIHNlbmRMaW5rID0gJCgnPGEgaHJlZj0iIyIgY2xhc3M9InN1Ym1pdCI+JyArIG9wdGlvbnMuc2VuZExhYmVsICsgJzwvYT4nKTsKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zZXRIZWFkZXJCdXR0b24oc2VuZExpbmspOwoKCQkJc2VuZExpbmsub24oJ3RhcCcsIGZ1bmN0aW9uKCl7CgkJCQlpZiAob3B0aW9ucy5ib2R5LnZhbCgpLmxlbmd0aCA+IDApIHsKCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNob3dMb2FkaW5nKCk7CgkJCQkJcmVxdWVzdEZyaWVuZHNoaXAob3B0aW9ucy5yZXF1ZXN0b3JJZCwgb3B0aW9ucy5yZXF1ZXN0ZWVJZCwgb3B0aW9ucy5ib2R5LnZhbCgpKQoJCQkJCQkudGhlbihmdW5jdGlvbigpewoJCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5kaXNwbGF5TWVzc2FnZShvcHRpb25zLnJlcXVlc3RTZW50LCB7CgkJCQkJCQkJZGlzYXBwZWFyQWZ0ZXI6IDUwMDAsCgkJCQkJCQkJY3NzQ2xhc3M6ICdpbmZvJwoJCQkJCQkJfSk7CgkJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmJhY2sodHJ1ZSk7CgkJCQkJCX0pCgkJCQkJCS5mYWlsKGZ1bmN0aW9uKCl7CgkJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmhpZGVMb2FkaW5nKCk7CgkJCQkJCX0pOwoJCQkJfQoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9KTsKCQl9Cgl9CgoJJC50ZWxsaWdlbnQgPSAkLnRlbGxpZ2VudCB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsKCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cy51c2VyRnJpZW5kc2hpcFJlcXVlc3QgPSBhcGk7Cgp9KShqUXVlcnksIHdpbmRvdyk7Cg==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:UserFriendships_Name}" version="7.0.0.1" description="" instanceIdentifier="edd96f71e18449ad8c8539f577e8b9fa" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="user-friendships">
    <contentScript>


#set ($userId = false)
#set ($userId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('UserId')))
#if (!$userId)
	$core_v2_widget.Hide()
#end
#set ($user = false)
#set ($user = $core_v2_user.Get("%{ Id = $userId }"))
#if (!$user)
	$core_v2_widget.Hide()
#end

#set($pageSize = $core_v2_widget.GetIntValue('pageSize', 5))
#set($pageIndex = 0)

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($user.ProfileUrl)"&gt;$user.DisplayName&lt;/a&gt;
		&lt;h1&gt;$!core_v2_language.FormatString($core_v2_language.GetResource('UserFriendships_Title'), $user.DisplayName)&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$!core_v2_ui.GetResizedImageHtml($user.AvatarUrl, 40, 40, "%{ alt = $user.DisplayName, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
&lt;/div&gt;
#set ($isUserAccessing = false)
#if ($user.Id == $core_v2_user.Accessing.Id)
	#set ($isUserAccessing = true)
#end
#set($filter = 'friends')
#if ($isUserAccessing)
	#set($filter = $core_v2_page.GetQueryStringValue('w_filter'))
	&lt;div class="ui-links filters" data-minlinks="50" data-animate="true"&gt;
		&lt;ul class="activity-filters"&gt;
			&lt;li&gt;&lt;a href="#" data-filter="friends" #if($filter == 'friends') data-selected #end&gt;$core_v2_language.GetResource('UserFriendships_FriendsLink')&lt;/a&gt;&lt;/li&gt;

			#set ($reviewFriendshipCount = $core_v2_friendship.List("%{ FriendshipState = 'Pending', RecipientId = $user.Id, PageIndex = 0, PageSize = 1 }").TotalCount)
			&lt;li&gt;
				&lt;a href="#" data-filter="review" #if($filter == 'review') data-selected #end&gt;
					$core_v2_language.GetResource('UserFriendships_ReviewLink')
					#if($reviewFriendshipCount &gt; 0)
						&lt;strong&gt;(${reviewFriendshipCount})&lt;/strong&gt;
					#end
				&lt;/a&gt;
			&lt;/li&gt;

			#set ($pendingFriendshipCount = $core_v2_friendship.List("%{ FriendshipState = 'Pending', RequestorId = $user.Id, PageIndex = 0, PageSize = 1 }").TotalCount)
			&lt;li&gt;
				&lt;a href="#" data-filter="pending" #if($filter == 'pending') data-selected #end&gt;
					$core_v2_language.GetResource('UserFriendships_PendingLink')
					#if($pendingFriendshipCount &gt; 0)
						&lt;strong&gt;(${pendingFriendshipCount})&lt;/strong&gt;
					#end
				&lt;/a&gt;
			&lt;/li&gt;
		&lt;/ul&gt;
	&lt;/div&gt;
#end

## load and render friendships
&lt;div class="post-list friendships $filter"&gt;
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.userFriendships.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
		filter: '$filter',
		moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))',
		pageSize: $pageSize,
		friendshipDeleteFriendConfirmation: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UserFriendships_FriendDelete_Confirm'))',
		friendshipRequestCancelConfirmation: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UserFriendships_CancelFriendship_Confirm'))',
		followText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UserFriendships_Follow'))',
		unfollowText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UserFriendships_Unfollow'))',
		followedText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UserFriendships_Followed'))',
		unfollowedText: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('UserFriendships_Unfollowed'))'
		});
	});
});
&lt;/script&gt;


</contentScript>
    <configuration>
	
		
	
</configuration>
    <languageResources>
	<language key="en-us">
		<resource name="UserFriendships_Name">Friendship List</resource>
		<resource name="UserFriendships_FriendsLink">Friends</resource>
		<resource name="UserFriendships_ReviewLink">Requests to Review</resource>
		<resource name="UserFriendships_PendingLink">Your Requests</resource>
		<resource name="UserFriendships_Title">Friends</resource>
		<resource name="UserFriendships_No_Friends">No users have been added to {0}'s friends list.</resource>
		<resource name="UserFriendships_No_Review">You do not have any friendship requests to review.</resource>
		<resource name="UserFriendships_No_Pending">You do not have any pending requests.</resource>
		<resource name="UserFriendships_Approve_Request">Approve</resource>
		<resource name="UserFriendships_Reject_Request">Reject</resource>
		<resource name="UserFriendships_Cancel_Request">Cancel</resource>
		<resource name="UserFriendships_SendMessage">Send a Message</resource>
		<resource name="UserFriendships_Follow">Start Following</resource>
		<resource name="UserFriendships_Unfollow">Stop Following</resource>
		<resource name="UserFriendships_Followed">Following started</resource>
		<resource name="UserFriendships_Unfollowed">Following stopped</resource>
		<resource name="UserFriendships_Cancel">Cancel</resource>
		<resource name="UserFriendships_FriendDelete_Confirm">Are you sure you want to delete this friendship?</resource>
		<resource name="UserFriendships_CancelFriendship_Confirm">Are you sure you want to cancel this friendship request?</resource>
	</language>
</languageResources>
    <files>
      <file name="list.vm">I3NldCAoJHF1ZXJ5ID0gIiV7UGFnZUluZGV4ID0gJHBhZ2VJbmRleCwgUGFnZVNpemUgPSAkcGFnZVNpemUsIFNvcnRCeSA9ICdMYXN0TW9kaWZpZWREYXRlJywgU29ydE9yZGVyID0gJ0Rlc2NlbmRpbmcnIH0iKQoKCiNpZiAoJGZpbHRlciA9PSAncmV2aWV3JykKCSRxdWVyeS5BZGQoJ0ZyaWVuZHNoaXBTdGF0ZScsICdQZW5kaW5nJykKCSRxdWVyeS5BZGQoJ1JlY2lwaWVudElkJywgJHVzZXJJZCkKI2Vsc2VpZiAoJGZpbHRlciA9PSAncGVuZGluZycpCgkkcXVlcnkuQWRkKCdGcmllbmRzaGlwU3RhdGUnLCAnUGVuZGluZycpCgkkcXVlcnkuQWRkKCdSZXF1ZXN0b3JJZCcsICR1c2VySWQpCiNlbHNlCgkkcXVlcnkuQWRkKCdGcmllbmRzaGlwU3RhdGUnLCAnQXBwcm92ZWQnKQoJJHF1ZXJ5LkFkZCgnUmVxdWVzdG9ySWQnLCAkdXNlcklkKQojZW5kCgojc2V0ICgkZnJpZW5kc2hpcHMgPSAkY29yZV92Ml9mcmllbmRzaGlwLkxpc3QoJHF1ZXJ5KSkKCiNmb3JlYWNoICgkZnJpZW5kc2hpcCBpbiAkZnJpZW5kc2hpcHMpCiNlYWNoCgoJI3NldCAoJGZyaWVuZCA9IGZhbHNlKQoJI2lmICgkZnJpZW5kc2hpcC5SZWNpcGllbnQgJiYgJGZyaWVuZHNoaXAuUmVjaXBpZW50LklkID09ICR1c2VySWQpCgkJI3NldCAoJGZyaWVuZCA9ICRmcmllbmRzaGlwLlJlcXVlc3RvcikKCSNlbHNlCgkJI3NldCAoJGZyaWVuZCA9ICRmcmllbmRzaGlwLlJlY2lwaWVudCkKCSNlbmQKCgkjaWYgKCRmcmllbmQpCgkJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIGZyaWVuZHNoaXAiIGRhdGEtdGFyZ2V0dXJsPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRmcmllbmQuVXJsKSI+CgkJCTxkaXYgY2xhc3M9InBvc3QiPgoJCQkJPGRpdiBjbGFzcz0iYXZhdGFyIj4KCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRmcmllbmQuVXJsKSIgY2xhc3M9ImludGVybmFsLWxpbmsgdmlldy11c2VyLXByb2ZpbGUiPgoJCQkJCQkkY29yZV92Ml91aS5HZXRSZXNpemVkSW1hZ2VIdG1sKCRmcmllbmQuQXZhdGFyVXJsLCA0MCwgNDAsICIle2JvcmRlcj0nMCcsIGFsdD0kYWx0LCBSZXNpemVNZXRob2Q9J1pvb21BbmRDcm9wJyxib3JkZXI9JzAnfSIpCgkJCQkJPC9hPgoJCQkJPC9kaXY+CgkJCQk8ZGl2IGNsYXNzPSJjb250ZW50Ij4KCQkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRmcmllbmQuVXJsKSIgY2xhc3M9ImludGVybmFsLWxpbmsgdmlldy11c2VyLXByb2ZpbGUiPiQhZnJpZW5kLkRpc3BsYXlOYW1lPC9hPgoJCQkJPC9kaXY+CgkJCQkjaWYoJGlzVXNlckFjY2Vzc2luZyAmJiAoJGZpbHRlciA9PSAncmV2aWV3JyB8fCAkZmlsdGVyID09ICdwZW5kaW5nJykpCgkJCQkJPGRpdiBjbGFzcz0iYWN0aW9ucyB1aS1saW5rcyIgZGF0YS1taW5saW5rcz0iMCIgZGF0YS1tYXhsaW5rcz0iMiI+CgkJCQkJCTx1bD4KCQkJCQkJCSNpZiAoJGZpbHRlciA9PSAncmV2aWV3JykgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCgkJCQkJCQkJPGxpIGNsYXNzPSJhY3Rpb24tYXBwcm92ZS1yZXF1ZXN0Ij48YSBocmVmPSIjIiBkYXRhLW1lc3NhZ2VuYW1lPSJmcmllbmRzaGlwLmFwcHJvdmUtcmVxdWVzdCIgZGF0YS11c2VySWQ9IiR1c2VySWQiIGRhdGEtZnJpZW5kSWQ9IiRmcmllbmQuSWQiID4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnVXNlckZyaWVuZHNoaXBzX0FwcHJvdmVfUmVxdWVzdCcpPC9hPjwvbGk+CgkJCQkJCQkJPGxpIGNsYXNzPSJhY3Rpb24tcmVqZWN0LXJlcXVlc3QiPjxhIGhyZWY9IiMiIGRhdGEtbWVzc2FnZW5hbWU9ImZyaWVuZHNoaXAucmVqZWN0LXJlcXVlc3QiIGRhdGEtdXNlcklkPSIkdXNlcklkIiBkYXRhLWZyaWVuZElkPSIkZnJpZW5kLklkIiA+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ1VzZXJGcmllbmRzaGlwc19SZWplY3RfUmVxdWVzdCcpPC9hPjwvbGk+CgkJCQkJCQkjZWxzZWlmICgkZmlsdGVyID09ICdwZW5kaW5nJykKCQkJCQkJCQk8bGkgY2xhc3M9ImFjdGlvbi1jYW5jZWwtcmVxdWVzdCI+PGEgaHJlZj0iIyIgZGF0YS1tZXNzYWdlbmFtZT0iZnJpZW5kc2hpcC5jYW5jZWwtcmVxdWVzdCIgZGF0YS11c2VySWQ9IiR1c2VySWQiIGRhdGEtZnJpZW5kSWQ9IiRmcmllbmQuSWQiID4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnVXNlckZyaWVuZHNoaXBzX0NhbmNlbF9SZXF1ZXN0Jyk8L2E+PC9saT4KCQkJCQkJCSNlbmQKCQkJCQkJCTxsaSBjbGFzcz0iYWN0aW9uLW1vcmUiPjxhIGhyZWY9IiMiIGNsYXNzPSJtb3JlIiBkYXRhLW1vcmU+PC9hPjwvbGk+CgkJCQkJCQk8bGk+PGEgaHJlZj0iIyIgZGF0YS1jYW5jZWw+JGNvcmVfdjJfbGFuZ3VhZ2UuR2V0UmVzb3VyY2UoJ1VzZXJGcmllbmRzaGlwc19DYW5jZWwnKTwvYT48L2xpPgoJCQkJCQk8L3VsPgoJCQkJCTwvZGl2PgoJCQkJI2VuZAoJCQk8L2Rpdj4KCQk8L2Rpdj4KCSNlbmQKI25vZGF0YQoJPGRpdiBjbGFzcz0icG9zdC1saXN0LWl0ZW0gY29udGVudC1pdGVtIGZyaWVuZHNoaXBzIj4KCQk8ZGl2IGNsYXNzPSJtZXNzYWdlIG5vcmVjb3JkcyI+CgkJCSNpZiAoJGZpbHRlciA9PSAncmV2aWV3JykKCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdFN0cmluZygkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnVXNlckZyaWVuZHNoaXBzX05vX1JldmlldycpLCAkZnJpZW5kLkRpc3BsYXlOYW1lKQoJCQkjZWxzZWlmICgkZmlsdGVyID09ICdwZW5kaW5nJykKCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdFN0cmluZygkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnVXNlckZyaWVuZHNoaXBzX05vX1BlbmRpbmcnKSwgJGZyaWVuZC5EaXNwbGF5TmFtZSkKCQkJI2Vsc2UKCQkJCSRjb3JlX3YyX2xhbmd1YWdlLkZvcm1hdFN0cmluZygkY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnVXNlckZyaWVuZHNoaXBzX05vX0ZyaWVuZHMnKSwgJGZyaWVuZC5EaXNwbGF5TmFtZSkKCQkJI2VuZAoJCTwvZGl2PgoJPC9kaXY+CiNhZnRlcmFsbAoJI3NldCAoJGhhc01vcmUgPSBmYWxzZSkKCSNpZiAoJGZyaWVuZHNoaXBzLlRvdGFsQ291bnQgPiAoKCRmcmllbmRzaGlwcy5QYWdlSW5kZXggKyAxKSAqICRmcmllbmRzaGlwcy5QYWdlU2l6ZSkpCgkJI3NldCgkaGFzTW9yZSA9IHRydWUpCgkjZW5kCgk8ZGl2IGNsYXNzPSJkYXRhIiAjaWYoJGhhc01vcmUpZGF0YS1oYXNtb3JlPSJ0cnVlIiNlbmQ+PC9kaXY+CiNlbmQ=</file>
      <file name="more.vm">IyMKIyMgQWpheCBjYWxsYmFjayBmb3IgbG9hZGluZyBtb3JlIGZyaWVuZHNoaXBzCiMjCgojc2V0ICgkcGFnZUluZGV4ID0gJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X3BhZ2VJbmRleCcpKQojc2V0ICgkcGFnZVNpemUgPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfcGFnZVNpemUnKSkKCiNzZXQgKCR1c2VySWQgPSBmYWxzZSkKI3NldCAoJHVzZXJJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJG1vYmlsZV92MV91cmxUb2tlbi5WYWx1ZSgnVXNlcklkJykpKQojaWYgKCEkdXNlcklkKQoJJGNvcmVfdjJfd2lkZ2V0LkhpZGUoKQojZW5kCgojc2V0KCRmaWx0ZXIgPSAnZnJpZW5kcycpCiNzZXQgKCRpc1VzZXJBY2Nlc3NpbmcgPSBmYWxzZSkKI2lmICgkdXNlcklkID09ICRjb3JlX3YyX3VzZXIuQWNjZXNzaW5nLklkKQoJI3NldCAoJGlzVXNlckFjY2Vzc2luZyA9IHRydWUpCiNlbmQKCiNpZiAoJGlzVXNlckFjY2Vzc2luZykKCSNzZXQoJGZpbHRlciA9ICRjb3JlX3YyX3BhZ2UuR2V0UXVlcnlTdHJpbmdWYWx1ZSgnd19maWx0ZXInKSkKI2VuZAoKJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCdsaXN0LnZtJykK</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpewoKCXZhciBtb2RlbCA9IHsKCQlyZW1vdmVGcmllbmRzaGlwOiBmdW5jdGlvbiAocmVxdWVzdG9ySWQsIHJlcXVlc3RlZUlkKSB7CgkJCXJldHVybiAkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNob3dMb2FkaW5nKCQudGVsbGlnZW50LmV2b2x1dGlvbi5kZWwoewoJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvdXNlcnMve1JlcXVlc3RvcklkfS9mcmllbmRzL3tSZXF1ZXN0ZWVJZH0uanNvbicsCgkJCQlkYXRhOiB7CgkJCQkJUmVxdWVzdG9ySWQ6IHJlcXVlc3RvcklkLAoJCQkJCVJlcXVlc3RlZUlkOiByZXF1ZXN0ZWVJZAoJCQkJfQoJCQl9KSk7CgkJfSwKCgkJdXBkYXRlRnJpZW5kc2hpcDogZnVuY3Rpb24gKHJlcXVlc3RvcklkLCByZXF1ZXN0ZWVJZCwgZnJpZW5kc2hpcFN0YXRlKSB7CgkJCXJldHVybiAkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNob3dMb2FkaW5nKCQudGVsbGlnZW50LmV2b2x1dGlvbi5wdXQoewoJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvdXNlcnMve1JlcXVlc3RvcklkfS9mcmllbmRzL3tSZXF1ZXN0ZWVJZH0uanNvbicsCgkJCQlkYXRhOiB7CgkJCQkJUmVxdWVzdG9ySWQ6IHJlcXVlc3RvcklkLAoJCQkJCVJlcXVlc3RlZUlkOiByZXF1ZXN0ZWVJZCwKCQkJCQlGcmllbmRzaGlwU3RhdGU6IGZyaWVuZHNoaXBTdGF0ZQoJCQkJfQoJCQl9KSk7CgkJfSwKCgkJc3RhcnRGb2xsb3dpbmc6IGZ1bmN0aW9uIChmb2xsb3dlcklkLCBmb2xsb3dpbmdJZCkgewoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygkLnRlbGxpZ2VudC5ldm9sdXRpb24ucG9zdCh7CgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi91c2Vycy97Rm9sbG93ZXJJZH0vZm9sbG93aW5nLmpzb24nLAoJCQkJZGF0YTogewoJCQkJCUZvbGxvd2VySWQ6IGZvbGxvd2VySWQsCgkJCQkJRm9sbG93aW5nSWQ6IGZvbGxvd2luZ0lkCgkJCQl9CgkJCX0pKTsKCQl9LAoKCQlzdG9wRm9sbG93aW5nOiBmdW5jdGlvbiAoZm9sbG93ZXJJZCwgZm9sbG93aW5nSWQpIHsKCQkJcmV0dXJuICQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoJC50ZWxsaWdlbnQuZXZvbHV0aW9uLmRlbCh7CgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi91c2Vycy97Rm9sbG93ZXJJZH0vZm9sbG93aW5nL3tGb2xsb3dpbmdJZH0uanNvbicsCgkJCQlkYXRhOiB7CgkJCQkJRm9sbG93ZXJJZDogZm9sbG93ZXJJZCwKCQkJCQlGb2xsb3dpbmdJZDogZm9sbG93aW5nSWQKCQkJCX0KCQkJfSkpOwoJCX0KCX0KCgl2YXIgYXBpID0gewoKCQloYW5kbGVBY3Rpb25zOiBmdW5jdGlvbihvcHRpb25zKSB7CgoJCQkvL3JlbW92ZSBmcmllbmQKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ2ZyaWVuZHNoaXAucmVtb3ZlLWZyaWVuZCcsIGZ1bmN0aW9uIChkYXRhKSB7CgkJCQl2YXIgdGFyZ2V0ID0gJChkYXRhLnRhcmdldCk7CgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmhpZGVTaGVldCgpOwoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5jb25maXJtKG9wdGlvbnMuZnJpZW5kc2hpcERlbGV0ZUZyaWVuZENvbmZpcm1hdGlvbiwgZnVuY3Rpb24gKGNvbmZpcm1lZCkgewoJCQkJCWlmIChjb25maXJtZWQpIHsKCQkJCQkJbW9kZWwucmVtb3ZlRnJpZW5kc2hpcCh0YXJnZXQuZGF0YSgndXNlcmlkJyksIHRhcmdldC5kYXRhKCdmcmllbmRpZCcpKQoJCQkJCQkJLmRvbmUoZnVuY3Rpb24gKCkgewoJCQkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUucmVmcmVzaCgpOwoJCQkJCQkJfSk7CgkJCQkJfQoJCQkJfSk7CgkJCX0pOwoKCQkJLy9jYW5jZWwgcmVxdWVzdAoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnN1YnNjcmliZSgnZnJpZW5kc2hpcC5jYW5jZWwtcmVxdWVzdCcsIGZ1bmN0aW9uIChkYXRhKSB7CgkJCQl2YXIgdGFyZ2V0ID0gJChkYXRhLnRhcmdldCk7CgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmhpZGVTaGVldCgpOwoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5jb25maXJtKG9wdGlvbnMuZnJpZW5kc2hpcFJlcXVlc3RDYW5jZWxDb25maXJtYXRpb24sIGZ1bmN0aW9uIChjb25maXJtZWQpIHsKCQkJCQlpZiAoY29uZmlybWVkKSB7CgkJCQkJCW1vZGVsLnJlbW92ZUZyaWVuZHNoaXAodGFyZ2V0LmRhdGEoJ3VzZXJpZCcpLCB0YXJnZXQuZGF0YSgnZnJpZW5kaWQnKSkKCQkJCQkJCS5kb25lKGZ1bmN0aW9uICgpIHsKCQkJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnJlZnJlc2goKTsKCQkJCQkJCX0pOwoJCQkJCX0KCQkJCX0pOwoJCQl9KTsKCgkJCS8vcmVqZWN0IHJlcXVlc3QKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1lc3NhZ2luZy5zdWJzY3JpYmUoJ2ZyaWVuZHNoaXAucmVqZWN0LXJlcXVlc3QnLCBmdW5jdGlvbiAoZGF0YSkgewoJCQkJdmFyIHRhcmdldCA9ICQoZGF0YS50YXJnZXQpOwoJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlU2hlZXQoKTsKCQkJCW1vZGVsLnJlbW92ZUZyaWVuZHNoaXAodGFyZ2V0LmRhdGEoJ2ZyaWVuZGlkJyksIHRhcmdldC5kYXRhKCd1c2VyaWQnKSkKCQkJCQkuZG9uZShmdW5jdGlvbiAoKSB7CgkJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUucmVmcmVzaCgpOwoJCQkJCX0pOwoJCQl9KTsKCgkJCS8vYXBwcm92ZSByZXF1ZXN0CgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tZXNzYWdpbmcuc3Vic2NyaWJlKCdmcmllbmRzaGlwLmFwcHJvdmUtcmVxdWVzdCcsIGZ1bmN0aW9uIChkYXRhKSB7CgkJCQl2YXIgdGFyZ2V0ID0gJChkYXRhLnRhcmdldCk7CgkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmhpZGVTaGVldCgpOwoJCQkJbW9kZWwudXBkYXRlRnJpZW5kc2hpcCh0YXJnZXQuZGF0YSgnZnJpZW5kaWQnKSwgdGFyZ2V0LmRhdGEoJ3VzZXJpZCcpLCAnQXBwcm92ZWQnKQoJCQkJCS5kb25lKGZ1bmN0aW9uICgpIHsKCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5yZWZyZXNoKCk7CgkJCQkJfSk7CgkJCX0pOwoKCQkJLy8gc3RhcnQgLyBzdG9wIGZvbGxvd2luZwoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubWVzc2FnaW5nLnN1YnNjcmliZSgnZnJpZW5kc2hpcC5mb2xsb3cnLCBmdW5jdGlvbiAoZGF0YSkgewoJCQkJdmFyIHRhcmdldCA9ICQoZGF0YS50YXJnZXQpOwoJCQkJaWYgKCF0YXJnZXQuaGFzQ2xhc3MoInByb2Nlc3NpbmciKSkgewoJCQkJCXRhcmdldC5hZGRDbGFzcygicHJvY2Vzc2luZyIpCgkJCQkJCSAgLnRleHQoJy4uLicpOwoJCQkJCXZhciBmb2xsb3dzID0gdGFyZ2V0LmRhdGEoJ2ZvbGxvd3MnKTsKCQkJCQl2YXIgYWN0aW9uID0gZm9sbG93cyA/IG1vZGVsLnN0b3BGb2xsb3dpbmcgOiBtb2RlbC5zdGFydEZvbGxvd2luZzsKCQkJCQlhY3Rpb24odGFyZ2V0LmRhdGEoJ2ZvbGxvd2VyaWQnKSwgdGFyZ2V0LmRhdGEoJ2ZvbGxvd2luZ2lkJykpCgkJCQkJCS5kb25lKGZ1bmN0aW9uICgpIHsKCQkJCQkJCWZvbGxvd3MgPSAhZm9sbG93czsKCQkJCQkJCXRhcmdldC5kYXRhKCdmb2xsb3dzJywgZm9sbG93cyk7CgkJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmRpc3BsYXlNZXNzYWdlKAoJCQkJCQkJCSFmb2xsb3dzID8gb3B0aW9ucy51bmZvbGxvd2VkVGV4dCA6IG9wdGlvbnMuZm9sbG93ZWRUZXh0LCB7CgkJCQkJCQkJCWRpc2FwcGVhckFmdGVyOiA1MDAwLAoJCQkJCQkJCQljc3NDbGFzczogJ2luZm8nCgkJCQkJCQkJfSk7CgkJCQkJCX0pCgkJCQkJCS5hbHdheXMoZnVuY3Rpb24gKCkgewoJCQkJCQkJdGFyZ2V0LnJlbW92ZUNsYXNzKCJwcm9jZXNzaW5nIikKCQkJCQkJCQkgIC50ZXh0KGZvbGxvd3MgPyBvcHRpb25zLnVuZm9sbG93VGV4dCA6IG9wdGlvbnMuZm9sbG93VGV4dCApOwoJCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5oaWRlU2hlZXQoKTsKCQkJCQkJfSk7CgkJCQl9CgkJCX0pOwoJCX0sCgoJCWluaXRTY3JvbGxpbmc6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2Nyb2xsYWJsZSh7CgkJCQlyZWdpb246ICdjb250ZW50JywKCQkJCWxvYWQ6IGZ1bmN0aW9uKHBhZ2VJbmRleCwgc3VjY2VzcywgZXJyb3IpIHsKCQkJCQlpZiAoJCgnLmZyaWVuZHNoaXBzLicgKyBvcHRpb25zLmZpbHRlciArICcgZGl2LmRhdGE6bGFzdCcpLmRhdGEoJ2hhc21vcmUnKSkgewoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsKCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLAoJCQkJCQkJZGF0YTogewoJCQkJCQkJCXdfcGFnZUluZGV4OiBwYWdlSW5kZXgsCgkJCQkJCQkJd19wYWdlU2l6ZTogb3B0aW9ucy5wYWdlU2l6ZQoJCQkJCQkJfSwKCQkJCQkJCXN1Y2Nlc3M6IGZ1bmN0aW9uKHIpIHsKCQkJCQkJCQlzdWNjZXNzKHIpOwoJCQkJCQkJfSwKCQkJCQkJCWVycm9yOiBmdW5jdGlvbigpIHsKCQkJCQkJCQllcnJvcigpOwoJCQkJCQkJfQoJCQkJCQl9KTsKCQkJCQl9IGVsc2UgewoJCQkJCQlzdWNjZXNzKCk7CgkJCQkJfQoJCQkJfSwKCQkJCWNvbXBsZXRlOiBmdW5jdGlvbihjb250ZW50KSB7CgkJCQkJY29udGVudCA9ICQoY29udGVudCkuY3NzKHsgb3BhY2l0eTogMCB9KTsKCQkJCQkkKCdkaXYucG9zdC1saXN0LmZyaWVuZHNoaXBzLicgKyBvcHRpb25zLmZpbHRlcikuYXBwZW5kKGNvbnRlbnQpOwoJCQkJCWNvbnRlbnQuZXZvbHV0aW9uVHJhbnNmb3JtKHsgb3BhY2l0eTogMSB9LCB7IGR1cmF0aW9uOiA0MDAgfSk7CgkJCQl9CgkJCX0pOwoKCQl9LAoKCQlhcHBseUZpbHRlcnM6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCgkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuYWRkUmVmcmVzaFBhcmFtZXRlcignd19maWx0ZXInLCBvcHRpb25zLmZpbHRlcik7CgoJCQkkKG9wdGlvbnMud3JhcHBlciArICcgLmZpbHRlcnMgYScpLm9uKCd0YXAnLCBmdW5jdGlvbihlKSB7CgkJCQl2YXIgZmlsdGVyID0gJCh0aGlzKS5kYXRhKCdmaWx0ZXInKTsKCQkJCWlmIChmaWx0ZXIgIT0gb3B0aW9ucy5maWx0ZXIpIHsKCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmFkZFJlZnJlc2hQYXJhbWV0ZXIoJ3dfZmlsdGVyJywgZmlsdGVyKTsKCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnJlZnJlc2goKTsKCQkJCX0KCQkJCXJldHVybiBmYWxzZTsKCQkJfSk7CgoJCX0sCgoJCXJlZ2lzdGVyOiBmdW5jdGlvbihvcHRpb25zKSB7CgkJCWFwaS5oYW5kbGVBY3Rpb25zKG9wdGlvbnMpOwoJCQlhcGkuaW5pdFNjcm9sbGluZyhvcHRpb25zKTsKCQkJYXBpLmFwcGx5RmlsdGVycyhvcHRpb25zKTsKCgkJfQoJfQoKCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24gPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24gfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyA9ICQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzIHx8IHt9OwoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMudXNlckZyaWVuZHNoaXBzID0gYXBpOwoKfSkoalF1ZXJ5KTs=</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:UserProfile_Name}" version="7.0.0.1" description="" instanceIdentifier="6dd9ec44407f4d5fb9f85292c2004ee0" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="user-profile">
    <contentScript>


#set ($userId = false)
#set ($userId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('UserId')))
#if (!$userId)
	$core_v2_widget.Hide()
#end
#set ($user = false)
#set ($user = $core_v2_user.Get("%{ Id = $userId }"))
#if (!$user)
	$core_v2_widget.Hide()
#end

#set($profileGroup = false)
#set($profileGroupId = $core_v2_widget.GetIntValue('profileFieldGroupId', -1))
#if ($profileGroupId &gt; 0)
	#set($profileGroup = $core_v2_userProfileFieldGroup.Get($profileGroupId))
#else
	#foreach ($pg in $core_v2_userProfileFieldGroup.List())
		#if ($pg.Title.ToLower() == 'mobile')
			#set($profileGroup = $pg)
		#end
	#end
#end

#if (!$profileGroup)
	$core_v2_widget.Hide()
#end

#set($data = $core_v2_page.ParseQueryString(''))
#foreach($profileField in $user.ProfileFields)
	$data.Add($profileField.Label, $core_v2_encoding.HtmlDecode($profileField.Value))
#end

#set($dq = '"')
#set($propertyHeaderFormat = "&lt;div class=${dq}profile-field${dq}&gt;&lt;div class=${dq}label${dq}&gt;{PropertyName}&lt;/div&gt;&lt;div class=${dq}value${dq}&gt;")
#set($propertyFooterFormat = '&lt;/div&gt;&lt;/div&gt;')

&lt;div class="profile"&gt;
	&lt;div class='profile-field-list'&gt;
		#set($form = false)

		#set($form = $core_v2_dynamicForm.RenderForm($core_v2_widget.UniqueId('form'), $core_v2_userProfileFieldGroup.DynamicFormXml($profileGroup.Id, "%{ReadOnly='true'}"), $data, "%{GroupFooterHtmlFormat='',GroupHeaderHtmlFormat='',PropertyFooterHtmlFormat=$propertyFooterFormat,PropertyHeaderHtmlFormat=$propertyHeaderFormat,HidePropertiesWithoutValues='true'}"))
		#if (!$form || $form.Length == 0)
			$core_v2_widget.Hide()
		#else
			$mobile_v1_dataFormat.Detect($form)
		#end

	&lt;/div&gt;
&lt;/div&gt;


</contentScript>
    <configuration>
	
	&lt;propertyGroup id="options" resourceName="Options"&gt;
		&lt;property id="profileFieldGroupId" dataType="int" /&gt;
	&lt;/propertyGroup&gt;
	
</configuration>
    <languageResources>
	<language key="en-us">
		<resource name="UserProfile_Name">User Profile</resource>
	</language>
</languageResources>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:Wiki_Name}" version="7.0.0.1" description="" instanceIdentifier="b763444371d5475e8f7a9a5fa4d184b6" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="wiki">
    <contentScript>
		
#set($wikiId = false)
#set($wikiId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('WikiId')))
#if (!$wikiId)
	$core_v2_widget.Hide()
#end

#set ($accessingUser = $core_v2_user.Accessing)
#set ($accessingUserIsRegistered = false)
#if ($core_v2_user.IsRegistered($accessingUser.Id))
	#set ($accessingUserIsRegistered = true)
#end

#set($wiki = $core_v2_wiki.Get("%{Id=$wikiId}"))
#set($defaultPage = $core_v2_wikiPage.Get("%{PageKey='DefaultWikiPage',WikiId=$wikiId}"))
&lt;div class="post full topic"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($wiki.Group.Url)"&gt;$wiki.Group.Name&lt;/a&gt;
	&lt;/div&gt;
	&lt;h1&gt;$defaultPage.Title&lt;/h1&gt;
	&lt;div class="details"&gt;
		&lt;div class="date"&gt;$core_v2_language.FormatAgoDate($defaultPage.Date)&lt;/div&gt;
	&lt;/div&gt;
	&lt;div class="content user-generated-content"&gt;
		$mobile_v1_dataFormat.Detect($defaultPage.Body())
	&lt;/div&gt;

	#set($showLikes = false)
	#if($accessingUserIsRegistered &amp;&amp; $core_v2_like.CanLike($defaultPage.ContentId, $core_v2_wikiPage.ContentTypeId))
		#set($showLikes = true)
	#end

	&lt;div class="actions ui-links" data-maxlinks="#if($showLikes)1#else 0#end"&gt;
		#if ($showLikes)
			&lt;li class="action-like"&gt;
				#set($format = '{toggle} &lt;span class="count"&gt;&lt;span class="icon"&gt;&lt;/span&gt;{count}&lt;/span&gt;')
				$core_v2_ui.Like($defaultPage.ContentId, $core_v2_wikiPage.ContentTypeId, "%{ Format = $format }")
			&lt;/li&gt;
		#end

		&lt;li&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('wikipage-edit',$defaultPage.Id))"&gt;Edit&lt;/a&gt;&lt;/li&gt;

		#if ($accessingUserIsRegistered &amp;&amp; $core_v2_bookmark.CanBookmark($defaultPage.ContentId, $core_v2_wikiPage.ContentTypeId))
			&lt;li class="action-bookmark"&gt;
				$core_v2_ui.Bookmark($defaultPage.ContentId, $core_v2_wikiPage.ContentTypeId)
			&lt;/li&gt;
		#end

		&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
	&lt;/div&gt;
&lt;/div&gt;


## load and render wiki
&lt;div class="post-list wikis"&gt;
	#set($wikipages = $core_v2_wikiToc.List($wikiId))
	#foreach($wikipage in $wikipages)
		&lt;div class="post-list-item" data-targeturl="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('wikipage',$wikipage.Id))"&gt;
			&lt;div class="post full without-avatar"&gt;
				&lt;div class="content"&gt;
					&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('wikipage',$wikipage.Id))"&gt;$wikipage.Title&lt;/a&gt;
				&lt;/div&gt;
			&lt;/div&gt;
		&lt;/div&gt;
	#end
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.wiki.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			postUrl: '$core_v2_encoding.JavascriptEncode($mobile_v1_url.Format('wiki-addwikipage', $wikiId))',
			canPost: #if($core_v2_nodePermission.Get("wikis", $wikiId, "Wiki_CreatePage").IsAllowed) true#else false#end
		});
	});
})
&lt;/script&gt;
		

		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
		  	<resource name="Wiki_Name">Wiki</resource>
			<resource name="edit">Edit</resource>
			<resource name="delete">Delete</resource>
			<resource name="cancel">Cancel</resource>
			<resource name="post">New</resource>
		  </language>
		</languageResources>
    <files>
      <file name="ui.js">KGZ1bmN0aW9uKCQpew0KDQoNCgl2YXIgYXBpID0gew0KCQlyZWdpc3RlcjogZnVuY3Rpb24ob3B0aW9ucykgew0KCQkJaWYgKG9wdGlvbnMuY2FuUG9zdCkgew0KCQkJCXZhciBwb3N0TGluayA9ICQoJzxhIGhyZWY9IicgKyBvcHRpb25zLnBvc3RVcmwgKyAnIiBjbGFzcz0iYWRkIj4nICsgb3B0aW9ucy5wb3N0TGFiZWwgKyAnPC9hPicpOw0KCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2V0SGVhZGVyQnV0dG9uKHBvc3RMaW5rKTsNCgkJCX0NCgkJfQ0KCX0NCgkkLnRlbGxpZ2VudCA9ICQudGVsbGlnZW50IHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbiA9ICQudGVsbGlnZW50LmV2b2x1dGlvbiB8fCB7fTsNCgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyA9ICQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzLndpa2kgPSBhcGk7DQoNCn0pKGpRdWVyeSk7</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:WikiList_Name}" version="7.0.0.1" description="" instanceIdentifier="a98046dcf707414f83425eabe5b3c393" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="group-wikis">
    <contentScript>
		
#set($groupId = false)
#set($groupId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('GroupId')))
#if (!$groupId)
	$core_v2_widget.Hide()
#end

#set($group = $core_v2_group.Get("%{Id=$groupId}"))
&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($group.Url)"&gt;$group.Name&lt;/a&gt;
		&lt;h1&gt;$core_v2_language.GetResource('wikis')&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div class="avatar"&gt;$core_v2_ui.GetResizedImageHtml($group.AvatarUrl, 40, 40, "%{ alt = $group.Name, ResizeMethod = 'ZoomAndCrop' }")&lt;/div&gt;
&lt;/div&gt;
## load and render wikis
&lt;div class="post-list wikis"&gt;
	#set($pageIndex = 0)
	$core_v2_widget.ExecuteFile("list.vm")
&lt;/div&gt;

## render client script inline since it's short and to avoid extra http requests
&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.wikiList.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			moreUrl: '$core_v2_encoding.JavascriptEncode($core_v2_widget.GetExecutedFileUrl('more.vm'))'
		});
	});
})
&lt;/script&gt;
		

		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
	  <language key="en-us">
		<resource name="WikiList_Name">Wiki List</resource>
		<resource name="wikis">Wikis</resource>
		<resource name="no_wikis">No Wikis</resource>
		<resource name="edit">Edit</resource>
		<resource name="delete">Delete</resource>
		<resource name="Cancel">Cancel</resource>
	  </language>
	</languageResources>
    <files>
      <file name="list.vm">I3NldCgkd2lraXMgPSAkY29yZV92Ml93aWtpLkxpc3QoIiV7R3JvdXBJZD0kZ3JvdXBJZCxQYWdlSW5kZXg9JHBhZ2VJbmRleCxQYWdlU2l6ZT01fSIpKQ0KI2lmKCR3aWtpcy5Ub3RhbENvdW50ID09IDEpDQoJI3NldCgkb25lV2lraSA9ICRjb3JlX3YyX3dpa2kuR2V0KCIle0dyb3VwSWQgPSAkZ3JvdXBJZH0iKSkNCgkkbW9iaWxlX3YxX3VybC5Gb3JtYXQoJ3dpa2knLCRvbmVXaWtpLklkKQ0KI2VuZA0KI2ZvcmVhY2goJHdpa2kgaW4gJHdpa2lzKQ0KI2VhY2gNCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gd2lraSIgZGF0YS10YXJnZXR1cmw9IiRjb3JlX3YyX2VuY29kaW5nLkh0bWxBdHRyaWJ1dGVFbmNvZGUoJG1vYmlsZV92MV91cmwuRm9ybWF0KCd3aWtpJywgJHdpa2kuSWQpKSI+DQoJCTxkaXYgY2xhc3M9InBvc3Qgd2l0aG91dC1hdmF0YXIiPg0KCQkJPGRpdiBjbGFzcz0iZGV0YWlscyI+DQoJCQkJI2lmICgkd2lraS5MYXN0TW9kaWZpZWRVdGNEYXRlKQ0KCQkJCQk8ZGl2IGNsYXNzPSJkYXRlIj4kY29yZV92Ml9sYW5ndWFnZS5Gb3JtYXRBZ29EYXRlKCR3aWtpLkxhc3RNb2RpZmllZFV0Y0RhdGUpPC9kaXY+DQoJCQkJI2VuZA0KCQkJPC9kaXY+DQoJCQk8ZGl2IGNsYXNzPSJjb250ZW50Ij4NCgkJCQk8YSBocmVmPSIkY29yZV92Ml9lbmNvZGluZy5IdG1sQXR0cmlidXRlRW5jb2RlKCRtb2JpbGVfdjFfdXJsLkZvcm1hdCgnd2lraScsICR3aWtpLklkKSkiPiR3aWtpLk5hbWU8L2E+DQoJCQkJPGRpdj4kIXdpa2kuRGVzY3JpcHRpb248L2Rpdj4NCgkJCTwvZGl2Pg0KCQk8L2Rpdj4NCgk8L2Rpdj4NCiNub2RhdGENCgk8ZGl2IGNsYXNzPSJwb3N0LWxpc3QtaXRlbSBjb250ZW50LWl0ZW0gd2lraXMiPjxkaXYgY2xhc3M9Im1lc3NhZ2Ugbm9yZWNvcmRzIj4kY29yZV92Ml9sYW5ndWFnZS5HZXRSZXNvdXJjZSgnbm9fd2lraXMnKTwvZGl2PjwvZGl2Pg0KI2FmdGVyYWxsDQoJI3NldCAoJGhhc01vcmUgPSBmYWxzZSkNCgkjaWYgKCR3aWtpcy5Ub3RhbENvdW50ID4gKCgkd2lraXMuUGFnZUluZGV4ICsgMSkgKiAkd2lraXMuUGFnZVNpemUpKQ0KCQkjc2V0KCRoYXNNb3JlID0gdHJ1ZSkNCgkjZW5kDQoJPGRpdiBjbGFzcz0iZGF0YSIgI2lmKCRoYXNNb3JlKWRhdGEtaGFzbW9yZT0idHJ1ZSIjZW5kPjwvZGl2Pg0KI2VuZA==</file>
      <file name="more.vm">IyMNCiMjIEFqYXggY2FsbGJhY2sgZm9yIGxvYWRpbmcgbW9yZSB3aWtpcw0KIyMNCiNzZXQgKCRwYWdlSW5kZXggPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfcGFnZUluZGV4JykpDQojc2V0KCRncm91cElkID0gZmFsc2UpDQojc2V0KCRncm91cElkID0gJGNvcmVfdjJfdXRpbGl0eS5QYXJzZUludCgkbW9iaWxlX3YxX3VybFRva2VuLlZhbHVlKCdHcm91cElkJykpKQ0KI2lmICghJGdyb3VwSWQpDQoJJGNvcmVfdjJfd2lkZ2V0LkhpZGUoKQ0KI2VuZA0KJGNvcmVfdjJfd2lkZ2V0LkV4ZWN1dGVGaWxlKCdsaXN0LnZtJykNCg==</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpewoKCXZhciBhcGkgPSB7CgkJcmVnaXN0ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zY3JvbGxhYmxlKHsKCQkJCXJlZ2lvbjogJ2NvbnRlbnQnLAoJCQkJbG9hZDogZnVuY3Rpb24ocGFnZUluZGV4LCBzdWNjZXNzLCBlcnJvcikgewoJCQkJCWlmICgkKG9wdGlvbnMud3JhcHBlciArICcgZGl2LmRhdGE6bGFzdCcpLmRhdGEoJ2hhc21vcmUnKSkgewoJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsKCQkJCQkJCXVybDogb3B0aW9ucy5tb3JlVXJsLAoJCQkJCQkJZGF0YTogewoJCQkJCQkJCXdfcGFnZUluZGV4OiBwYWdlSW5kZXgKCQkJCQkJCX0sCgkJCQkJCQlzdWNjZXNzOiBmdW5jdGlvbihyKSB7CgkJCQkJCQkJc3VjY2VzcyhyKTsKCQkJCQkJCX0sCgkJCQkJCQllcnJvcjogZnVuY3Rpb24oKSB7CgkJCQkJCQkJZXJyb3IoKTsKCQkJCQkJCX0KCQkJCQkJfSk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJc3VjY2VzcygpOwoJCQkJCX0KCQkJCX0sCgkJCQljb21wbGV0ZTogZnVuY3Rpb24oY29udGVudCkgewoJCQkJCWNvbnRlbnQgPSAkKGNvbnRlbnQpLmNzcyh7IG9wYWNpdHk6IDAgfSk7CgkJCQkJJChvcHRpb25zLndyYXBwZXIpLmZpbmQoJ2Rpdi5wb3N0LWxpc3QnKS5hcHBlbmQoY29udGVudCk7CgkJCQkJY29udGVudC5ldm9sdXRpb25UcmFuc2Zvcm0oeyBvcGFjaXR5OiAxIH0sIHsgZHVyYXRpb246IDQwMCB9KTsKCQkJCX0KCQkJfSk7CgkJfQoJfQoKCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24gPSAkLnRlbGxpZ2VudC5ldm9sdXRpb24gfHwge307CgkkLnRlbGxpZ2VudC5ldm9sdXRpb24ud2lkZ2V0cyA9ICQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzIHx8IHt9OwoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMud2lraUxpc3QgPSBhcGk7Cgp9KShqUXVlcnkpOw==</file>
    </files>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:WikiPage_Name}" version="7.0.0.1" description="" instanceIdentifier="70bdfebf5e85427c8718871941e88347" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="wikipage">
    <contentScript>
		
#set($wikiPageId = false)
#set($wikiPageId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('WikiPageId')))
#if (!$wikiPageId)
	$core_v2_widget.Hide()
#end
#set($wikiPage = $core_v2_wikiPage.Get("%{Id = $wikiPageId}"))

#set ($accessingUser = $core_v2_user.Accessing)
#set ($accessingUserIsRegistered = false)
#if ($core_v2_user.IsRegistered($accessingUser.Id))
	#set ($accessingUserIsRegistered = true)
#end

&lt;div class="post topic full"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($wikiPage.Application.Container.Url)"&gt;$wikiPage.Application.Container.HtmlName('Web')&lt;/a&gt;
		#set($parentPage = false)
		#set($parentPage = $core_v2_wikiPage.Get("%{Id = $wikiPage.ParentPageId}"))
		#if (!$parentPage)
			#set($parentPage = $core_v2_wikiPage.Get("%{PageKey='DefaultWikiPage',WikiId=$wikiPage.WikiId}"))
			#if ($parentPage)
				&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('wiki', $wikiPage.WikiId))"&gt;$parentPage.Title&lt;/a&gt;
			#end
		#else
			&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('wikipage', $parentPage.Id))"&gt;$parentPage.Title&lt;/a&gt;
		#end
	&lt;/div&gt;
	&lt;h1&gt;$wikiPage.Title&lt;/h1&gt;
	&lt;div class="details"&gt;
		&lt;div class="date"&gt;$core_v2_language.FormatAgoDate($wikiPage.Date)&lt;/div&gt;
	&lt;/div&gt;
	&lt;div class="content user-generated-content"&gt;
		$mobile_v1_dataFormat.Detect($wikiPage.Body())
	&lt;/div&gt;

	#set($showLikes = false)
	#if($accessingUserIsRegistered &amp;&amp; $core_v2_like.CanLike($wikiPage.ContentId, $core_v2_wikiPage.ContentTypeId))
		#set($showLikes = true)
	#end

	&lt;div class="actions ui-links" data-maxlinks="#if($showLikes)1#else 0#end"&gt;
		#if ($showLikes)
			&lt;li class="action-like"&gt;
				#set($format = '{toggle} &lt;span class="count"&gt;&lt;span class="icon"&gt;&lt;/span&gt;{count}&lt;/span&gt;')
				$core_v2_ui.Like($wikiPage.ContentId, $core_v2_wikiPage.ContentTypeId, "%{ Format = $format }")
			&lt;/li&gt;
		#end

		#if ($accessingUserIsRegistered)
			&lt;li&gt;&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('wikipage-edit',$wikiPageId))"&gt;$core_v2_language.GetResource('edit')&lt;/a&gt;&lt;/li&gt;
		#end
		#if ($accessingUserIsRegistered &amp;&amp; $core_v2_bookmark.CanBookmark($wikiPage.ContentId, $core_v2_wikiPage.ContentTypeId))
			&lt;li class="action-bookmark"&gt;
				$core_v2_ui.Bookmark($wikiPage.ContentId, $core_v2_wikiPage.ContentTypeId)
			&lt;/li&gt;
		#end
		&lt;li class="action-moderate"&gt;$core_v2_ui.Moderate($wikiPage.ContentId, $core_v2_wikiPage.ContentTypeId)&lt;/li&gt;

		&lt;li class="action-more"&gt;&lt;a href="#" data-more&gt;&lt;/a&gt;&lt;/li&gt;
		&lt;li&gt;&lt;a href="#" data-cancel&gt;$core_v2_language.GetResource('cancel')&lt;/a&gt;&lt;/li&gt;
	&lt;/div&gt;
&lt;/div&gt;


#if($wikiPage.ChildPageCount &gt; 0)
	&lt;div class="post-list"&gt;
	#set($childWikis = $core_v2_utility.FlattenHierarchy($core_v2_wikiToc.List($wikiPage.WikiId, $wikiPage.Id), 'Children', "%{ExpandToLevel=1}"))
	#foreach($childWiki in $childWikis)
		#set($childWikiPage = $core_v2_wikiPage.Get("%{Id = $childWiki.Item.Id}"))
		&lt;div class="post-list-item" data-targeturl="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('wikipage', $childWikiPage.Id))"&gt;
			&lt;div class="post full without-avatar"&gt;
				&lt;div class="content"&gt;
					&lt;a href="$core_v2_encoding.HtmlAttributeEncode($mobile_v1_url.Format('wikipage', $childWikiPage.Id))"&gt;$childWikiPage.Title&lt;/a&gt;
				&lt;/div&gt;
			&lt;/div&gt;
		&lt;/div&gt;
	#end
	&lt;/div&gt;
#end
		
		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
		  	<resource name="WikiPage_Name">Wiki Page</resource>
			<resource name="edit">Edit</resource>
			<resource name="delete">Delete</resource>
			<resource name="cancel">Cancel</resource>
		  </language>
		</languageResources>
  </scriptedContentFragment>
  <scriptedContentFragment name="${resource:WikiPageAddEdit_Name}" version="7.0.0.1" description="" instanceIdentifier="c216859125284e928e76fa8e045bc9e4" isCacheable="true" varyCacheByUser="true" showHeaderByDefault="false" cssClass="wiki-page-add-edit">
    <contentScript>
		
#set ($pageName = $mobile_v1_url.Current)
#set ($mode = false)
#set ($contentTypeId = $core_v2_wikiPage.ContentTypeId)

#set($wikiPageId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('WikiPageId')))
#if($wikiPageId &lt; 0)
	#set($wikiId = $core_v2_utility.ParseInt($mobile_v1_urlToken.Value('WikiId')))
	#if($wikiId &lt; 0)
		#$core_v2_widget.Hide()
	#end
#end


#if($pageName == 'wiki-addwikipage')
	#set ($mode = 'add')
#elseif ($pageName == 'wikipage-edit')
	#set ($mode = 'edit')
	#set ($editWikiPage = $core_v2_wikiPage.Get("%{Id = $wikiPageId}"))
	#set($wikiId = $editWikiPage.WikiId)
	#if($editWikiPage.ParentPageId &gt; 0)
		#set($parentWikiPage = $core_v2_wikiPage.Get("%{Id = $editWikiPage.ParentPageId}"))
	#end
#else
	#$core_v2_widget.Hide()
#end

#set($wiki = $core_v2_wiki.Get("%{Id = $wikiId}"))

#set ($titleId = $core_v2_widget.UniqueId('Title'))
#set ($parentId = $core_v2_widget.UniqueId('ParentPage'))
#set ($bodyId = $core_v2_widget.UniqueId('Body'))
#set ($subscribeId = $core_v2_widget.UniqueId('Subscribe'))

&lt;div class="banner condensed"&gt;
	&lt;div class="context"&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($wiki.Group.Url)"&gt;$wiki.Group.Name&lt;/a&gt;
		&lt;a href="$core_v2_encoding.HtmlAttributeEncode($wiki.Url)"&gt;$wiki.Name&lt;/a&gt;
		&lt;h1&gt;
			#if ($editWikiPage)
				$editWikiPage.Title
			#else
				$core_v2_language.GetResource('new_page')
			#end
		&lt;/h1&gt;
	&lt;/div&gt;
&lt;/div&gt;
&lt;fieldset&gt;

	## Title
	&lt;div class="form-field text"&gt;
		&lt;label for="$core_v2_encoding.HtmlAttributeEncode($titleId)"&gt;$core_v2_language.GetResource('title')&lt;/label&gt;
		&lt;input type="text" maxlength="256" id="$core_v2_encoding.HtmlAttributeEncode($titleId)" value="#if($mode=='edit')$editWikiPage.Title#end" /&gt;
	&lt;/div&gt;

	## Parent
	#if(!$editWikiPage.IsDefaultPage)
		&lt;div class="form-field text lookup"&gt;
			&lt;label for="$core_v2_encoding.HtmlAttributeEncode($parentId)"&gt;$core_v2_language.GetResource('parentPage')&lt;/label&gt;
			&lt;input type="text" maxlength="256" id="$core_v2_encoding.HtmlAttributeEncode($parentId)" #if($parentWikiPage.Id) value="$parentWikiPage.Id" #end/&gt;
		&lt;/div&gt;
	#end

	## TinyMCE
	&lt;div class="form-field editor"&gt;
		&lt;label for="$core_v2_widget.UniqueId('body')" class="field-item-header hidden"&gt;$core_v2_language.GetResource('Body')&lt;/label&gt;
		&lt;span class="field-item-input"&gt;$core_v2_editor.Render('body',"%{Width='100%', Height='250px', Value='$!editWikiPage.Body()', ContentTypeId=$core_v2_wikiPage.ContentTypeId}")&lt;/span&gt;
	&lt;/div&gt;

	## Email Replies
	#if ($core_v2_user.IsRegistered($core_v2_user.Accessing.Id))
		&lt;div class="form-field checkbox inline-label"&gt;
			&lt;label for="$core_v2_encoding.HtmlAttributeEncode($subscribeId)"&gt;$core_v2_language.GetResource('subscribe')&lt;/label&gt;
			&lt;input id="$core_v2_encoding.HtmlAttributeEncode($subscribeId)" type="checkbox" #if($mode == 'edit' &amp;&amp; $core_v2_wikiPage.IsSubscribed($editWikiPage.Id)) checked="checked" #elseif($mode =='add') checked="checked" #end/&gt;
		&lt;/div&gt;
	#end
&lt;/fieldset&gt;

&lt;script&gt;$core_v2_widget.RenderFile('ui.js')&lt;/script&gt;
&lt;script&gt;
jQuery(function(){
	jQuery.telligent.evolution.messaging.subscribe('mobile.content.rendered', function(){
		jQuery.telligent.evolution.widgets.wikiPageAddEdit.register({
			wrapper: '#$core_v2_widget.WrapperElementId',
			wikiId: $wikiId,
			wikiPageId: #if ($editWikiPage) $editWikiPage.Id #else null #end,
			mode: '$core_v2_encoding.JavascriptEncode($mode)',
			lookupPagesUrl:'$core_v2_widget.GetExecutedFileUrl('LookupPages.vm')',
			getBodyContent: function() { return $core_v2_editor.GetContentScript('body') },
			noPageMatchesText:'$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('WikiPage_NoMatches'))',
			titleInput: '#$core_v2_encoding.JavascriptEncode($titleId)',
			parentInput: '#$core_v2_encoding.JavascriptEncode($parentId)',
			bodyInput: '#$core_v2_encoding.JavascriptEncode($bodyId)',
			subscribeInput: '#$core_v2_encoding.JavascriptEncode($subscribeId)',
			postLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('post'))',
			editLabel: '$core_v2_encoding.JavascriptEncode($core_v2_language.GetResource('edit'))',
			userCanMovePage: #if($userCanMovePage) true#else false#end,
			#if($parentWikiPage)
				parentPageTitle:'$core_v2_encoding.JavascriptEncode($core_v2_language.Truncate($parentWikiPage.Title, 60, "..."))',
			#end
		});

		jQuery.telligent.evolution.mobile.refreshable(false);
		jQuery.telligent.evolution.mobile.excludeFromHistory();
	});
})
&lt;/script&gt;
		

		</contentScript>
    <headerScript>
		</headerScript>
    <languageResources>
		  <language key="en-us">
			<resource name="WikiPageAddEdit_Name">Add Edit Wiki Page</resource>
			<resource name="post">Post</resource>
			<resource name="edit">Edit</resource>
			<resource name="title">Title</resource>
			<resource name="parentPage">Parent page</resource>
			<resource name="parentPlace">Parent page...</resource>
			<resource name="body">Body</resource>
			<resource name="bodyPlace">Body...</resource>
			<resource name="subscribe">Notify me about updates</resource>
			<resource name="WikiPage_NoMatches">No matches can be found</resource>
			<resource name="new_page">New page</resource>
		  </language>
		</languageResources>
    <files>
      <file name="LookupPages.vm">JGNvcmVfdjJfcGFnZS5TZXRDb250ZW50VHlwZSgnYXBwbGljYXRpb24vanNvbicpDQoNCiNzZXQoJHdpa2lJZCA9ICRjb3JlX3YyX3V0aWxpdHkuUGFyc2VJbnQoJGNvcmVfdjJfcGFnZS5HZXRRdWVyeVN0cmluZ1ZhbHVlKCd3X3dpa2lJZCcpKSkNCiNzZXQoJHNlYXJjaFRleHQgPSAkY29yZV92Ml9wYWdlLkdldFF1ZXJ5U3RyaW5nVmFsdWUoJ3dfc2VhcmNoVGV4dCcpLlRvTG93ZXIoKSkNCiNzZXQoJHRvdGFsTWF0Y2hlcyA9IDApDQp7InBhZ2VzIjpbDQoJI2ZvcmVhY2goJHBhZ2UgaW4gJGNvcmVfdjJfdXRpbGl0eS5GbGF0dGVuSGllcmFyY2h5KCRjb3JlX3YyX3dpa2lUb2MuTGlzdCgkd2lraUlkKSwgJ0NoaWxkcmVuJykpDQoJCSNpZigkdG90YWxNYXRjaGVzIDwgMjApCQ0KCQkJI3NldCgkY2hpbGRXaWtpUGFnZSA9ICRjb3JlX3YyX3dpa2lQYWdlLkdldCgiJXtJZCA9ICRwYWdlLkl0ZW0uSWR9IikpDQoJCQkjaWYoISRjaGlsZFdpa2lQYWdlLklzRGVmYXVsdFBhZ2UpDQoJCQkJI2lmKCRwYWdlLkl0ZW0uVGl0bGUuVG9Mb3dlcigpLkNvbnRhaW5zKCRzZWFyY2hUZXh0KSkNCgkJCQkJI3NldCgkdHJ1bmsgPSAkY29yZV92Ml9sYW5ndWFnZS5UcnVuY2F0ZSgkcGFnZS5JdGVtLlRpdGxlLCA1NSwgIi4uLiIpKQ0KCQkJCQl7InBhZ2VJZCI6JHBhZ2UuSXRlbS5JZCwidGl0bGUiOiIkY29yZV92Ml9lbmNvZGluZy5KYXZhc2NyaXB0RW5jb2RlKCR0cnVuaykifSwNCgkJCQkJI3NldCgkdG90YWxNYXRjaGVzID0gJHRvdGFsTWF0Y2hlcyArIDEpDQoJCQkJI2VuZA0KCQkJI2VuZA0KCQkjZW5kDQoJI2VuZA0KbnVsbF19</file>
      <file name="ui.js">KGZ1bmN0aW9uKCQpIHsNCg0KCXZhciBtb2RlbCA9IHsNCgkJYWRkVGhyZWFkOiBmdW5jdGlvbihvcHRpb25zKSB7DQoJCQl2YXIgZGF0YSA9IHsNCgkJCQlXaWtpSWQ6IG9wdGlvbnMud2lraUlkLA0KCQkJCUJvZHk6IG9wdGlvbnMuYm9keSwNCgkJCQlUaXRsZTogb3B0aW9ucy5zdWJqZWN0DQoJCQl9Ow0KCQkJaWYgKG9wdGlvbnMucGFyZW50KSB7DQoJCQkJZGF0YS5QYXJlbnRQYWdlSWQgPSBvcHRpb25zLnBhcmVudC52YWwoKSA/IG9wdGlvbnMucGFyZW50LnZhbCgpIDogLTE7DQoJCQl9DQoNCgkJCXJldHVybiAkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNob3dMb2FkaW5nKCQudGVsbGlnZW50LmV2b2x1dGlvbi5wb3N0KHsNCgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi93aWtpcy97V2lraUlkfS9wYWdlcy5qc29uJywNCgkJCQlkYXRhOiBkYXRhDQoJCQl9KSk7DQoJCX0sDQoJCWVkaXRUaHJlYWQ6IGZ1bmN0aW9uKG9wdGlvbnMpIHsNCgkJCXZhciBkYXRhID0gew0KCQkJCVdpa2lJZDogb3B0aW9ucy53aWtpSWQsDQoJCQkJSWQ6IG9wdGlvbnMud2lraVBhZ2VJZCwNCgkJCQlCb2R5OiBvcHRpb25zLmJvZHksDQoJCQkJVGl0bGU6IG9wdGlvbnMuc3ViamVjdA0KCQkJfTsNCgkJCWlmIChvcHRpb25zLnBhcmVudCkgew0KCQkJCWRhdGEuUGFyZW50UGFnZUlkID0gb3B0aW9ucy5wYXJlbnQudmFsKCkgPyBvcHRpb25zLnBhcmVudC52YWwoKSA6IC0xOw0KCQkJfQ0KDQoJCQlyZXR1cm4gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygkLnRlbGxpZ2VudC5ldm9sdXRpb24ucHV0KHsNCgkJCQl1cmw6ICQudGVsbGlnZW50LmV2b2x1dGlvbi5zaXRlLmdldEJhc2VVcmwoKSArICdhcGkuYXNoeC92Mi93aWtpcy97V2lraUlkfS9wYWdlcy97SWR9Lmpzb24nLA0KCQkJCWRhdGE6IGRhdGENCgkJCX0pKTsNCgkJfQ0KCX0NCg0KCXZhciBiaW5kRWxlbWVudHMgPSBmdW5jdGlvbihvcHRpb25zKSB7DQoJCW9wdGlvbnMucGFyZW50SW5wdXQgPSAkKG9wdGlvbnMucGFyZW50SW5wdXQpOw0KCQlpZiAob3B0aW9ucy5wYXJlbnRJbnB1dCAmJiBvcHRpb25zLmxvb2t1cFBhZ2VzVXJsICYmIG9wdGlvbnMubm9QYWdlTWF0Y2hlc1RleHQpIHsNCgkJCXZhciB0aW1lb3V0ID0gbnVsbDsNCgkJCW9wdGlvbnMucGFyZW50SW5wdXQuZ2xvd0xvb2tVcFRleHRCb3goew0KCQkJCSdtYXhWYWx1ZXMnOjEsDQoJCQkJJ2VtcHR5SHRtbCc6JycsDQoJCQkJJ29uR2V0TG9va1Vwcyc6ZnVuY3Rpb24odGIsIHNlYXJjaFRleHQpIHsNCgkJCQkJdmFyIGRpc2FibGVkID0gdGIuZ2xvd0xvb2tVcFRleHRCb3goJ2Rpc2FibGVkJyk7DQoJCQkJCXdpbmRvdy5jbGVhclRpbWVvdXQodGltZW91dCk7DQoJCQkJCWlmKHNlYXJjaFRleHQgJiYgc2VhcmNoVGV4dC5sZW5ndGggPiAyKSB7DQoJCQkJCQl0Yi5nbG93TG9va1VwVGV4dEJveCgndXBkYXRlU3VnZ2VzdGlvbnMnLCBbdGIuZ2xvd0xvb2tVcFRleHRCb3goJ2NyZWF0ZUxvb2tVcCcsJycsJzxkaXYgc3R5bGU9InRleHQtYWxpZ246IGNlbnRlcjsiPjxpbWcgc3JjPSInICsgJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnNpdGUuZ2V0QmFzZVVybCgpICsgJ3V0aWxpdHkvc3Bpbm5lci5naWYiIC8+PC9kaXY+JywnPGRpdiBzdHlsZT0idGV4dC1hbGlnbjogY2VudGVyOyI+PGltZyBzcmM9IicgKyAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAndXRpbGl0eS9zcGlubmVyLmdpZiIgYWx0PSLigKYiIC8+PC9kaXY+JywgZmFsc2UpXSk7DQoJCQkJCQl0aW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7DQoJCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLm1vYmlsZS5zaG93TG9hZGluZygkLnRlbGxpZ2VudC5ldm9sdXRpb24uZ2V0KHsNCgkJCQkJCQkJdXJsOiBvcHRpb25zLmxvb2t1cFBhZ2VzVXJsLA0KCQkJCQkJCQlkYXRhOiB7DQoJCQkJCQkJCQl3X3dpa2lJZDogb3B0aW9ucy53aWtpSWQsDQoJCQkJCQkJCQl3X3NlYXJjaFRleHQ6IHNlYXJjaFRleHQNCgkJCQkJCQkJfSwgc3VjY2VzczogZnVuY3Rpb24ocmVzcG9uc2UpIHsNCgkJCQkJCQkJCWlmIChyZXNwb25zZSAmJiByZXNwb25zZS5wYWdlcy5sZW5ndGggPiAxKQ0KCQkJCQkJCQkJew0KCQkJCQkJCQkJCXZhciBzdWdnZXN0aW9ucyA9IFtdOw0KCQkJCQkJCQkJCWZvciAodmFyIGkgPSAwOyBpIDwgcmVzcG9uc2UucGFnZXMubGVuZ3RoIC0gMTsgaSsrKQ0KCQkJCQkJCQkJCQlzdWdnZXN0aW9uc1tzdWdnZXN0aW9ucy5sZW5ndGhdID0gdGIuZ2xvd0xvb2tVcFRleHRCb3goJ2NyZWF0ZUxvb2tVcCcscmVzcG9uc2UucGFnZXNbaV0ucGFnZUlkLHJlc3BvbnNlLnBhZ2VzW2ldLnRpdGxlLHJlc3BvbnNlLnBhZ2VzW2ldLnRpdGxlLHRydWUpOw0KCQkJCQkJCQkJCXRiLmdsb3dMb29rVXBUZXh0Qm94KCd1cGRhdGVTdWdnZXN0aW9ucycsIHN1Z2dlc3Rpb25zKTsNCgkJCQkJCQkJCX0NCgkJCQkJCQkJCWVsc2UNCgkJCQkJCQkJCQl0Yi5nbG93TG9va1VwVGV4dEJveCgndXBkYXRlU3VnZ2VzdGlvbnMnLCBbdGIuZ2xvd0xvb2tVcFRleHRCb3goJ2NyZWF0ZUxvb2tVcCcsJycsb3B0aW9ucy5ub1BhZ2VNYXRjaGVzVGV4dCxvcHRpb25zLm5vUGFnZU1hdGNoZXNUZXh0LGZhbHNlKV0pOw0KCQkJCQkJCQl9DQoJCQkJCQkJfSkpOw0KCQkJCQkJfSwgNzQ5KTsNCgkJCQkJfQ0KCQkJCX0sDQoJCQkJJ3NlbGVjdGVkTG9va1Vwc0h0bWwnOiAob3B0aW9ucy5wYXJlbnRQYWdlVGl0bGUgPyBbb3B0aW9ucy5wYXJlbnRQYWdlVGl0bGVdIDogW10pDQoJCQl9KTsNCgkJfQ0KCX0NCgl2YXIgYXBpID0gew0KCQlyZWdpc3RlcjogZnVuY3Rpb24ob3B0aW9ucykgew0KDQoJCQl2YXIgdGl0bGVJbnB1dCA9ICQob3B0aW9ucy50aXRsZUlucHV0KSwNCgkJCQlzdWJzY3JpYmVJbnB1dCA9ICQob3B0aW9ucy5zdWJzY3JpYmVJbnB1dCksDQoJCQkJd2lraUlkSW5wdXQgPSBvcHRpb25zLndpa2lJZCwNCgkJCQlwb3N0TGluayA9ICQoJzxhIGhyZWY9IiMiIGNsYXNzPSJzdWJtaXQiPicgKyAob3B0aW9ucy5tb2RlID09ICdhZGQnID8gb3B0aW9ucy5wb3N0TGFiZWwgOiBvcHRpb25zLmVkaXRMYWJlbCkgKyAnPC9hPicpOw0KDQoJCQlwb3N0TGluay5vbigndGFwJywgZnVuY3Rpb24oKXsNCgkJCQl2YXIgYm9keSA9ICQudHJpbShvcHRpb25zLmdldEJvZHlDb250ZW50KCkpLA0KCQkJCQlzdWJqZWN0ID0gJC50cmltKHRpdGxlSW5wdXQudmFsKCkpLA0KCQkJCQlwYXJlbnQgPSAkKG9wdGlvbnMucGFyZW50SW5wdXQpLA0KCQkJCQl3aWtpSWQgPSAkLnRyaW0od2lraUlkSW5wdXQpLA0KCQkJCQlzdWJzY3JpYmUgPSBzdWJzY3JpYmVJbnB1dC5pcygnOmNoZWNrZWQnKSwNCgkJCQkJc3VibWl0QWN0aW9uOw0KDQoJCQkJaWYoYm9keS5sZW5ndGggPiAwICYmIHN1YmplY3QubGVuZ3RoID4gMCkgew0KCQkJCQlpZihvcHRpb25zLm1vZGUgPT0gJ2FkZCcpIHsNCgkJCQkJCXN1Ym1pdEFjdGlvbiA9IG1vZGVsLmFkZFRocmVhZCh7DQoJCQkJCQkJc3ViamVjdDogc3ViamVjdCwNCgkJCQkJCQlwYXJlbnQ6IHBhcmVudCwNCgkJCQkJCQlib2R5OiBib2R5LA0KCQkJCQkJCXdpa2lJZDogd2lraUlkLA0KCQkJCQkJCXN1YnNjcmliZVRvVGhyZWFkOiBzdWJzY3JpYmVJbnB1dC5sZW5ndGggPT0gMCA/IG51bGwgOiBzdWJzY3JpYmVJbnB1dC5pcygnOmNoZWNrZWQnKQ0KCQkJCQkJfSk7DQoJCQkJCX0gZWxzZSBpZihvcHRpb25zLm1vZGUgPT0gJ2VkaXQnKSB7DQoJCQkJCQlzdWJtaXRBY3Rpb24gPSBtb2RlbC5lZGl0VGhyZWFkKHsNCgkJCQkJCQlzdWJqZWN0OiBzdWJqZWN0LA0KCQkJCQkJCXBhcmVudDogcGFyZW50LA0KCQkJCQkJCWJvZHk6IGJvZHksDQoJCQkJCQkJd2lraUlkOiB3aWtpSWQsDQoJCQkJCQkJd2lraVBhZ2VJZDogb3B0aW9ucy53aWtpUGFnZUlkLA0KCQkJCQkJCXN1YnNjcmliZVRvVGhyZWFkOiAoc3Vic2NyaWJlSW5wdXQubGVuZ3RoID09IDAgPyBudWxsIDogc3Vic2NyaWJlSW5wdXQuaXMoJzpjaGVja2VkJykpDQoJCQkJCQl9KTsNCgkJCQkJfQ0KDQoJCQkJCSQudGVsbGlnZW50LmV2b2x1dGlvbi5tb2JpbGUuc2hvd0xvYWRpbmcoc3VibWl0QWN0aW9uKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXsNCgkJCQkJCXZhciBsaW5rID0gJy93aWtpcGFnZXMvJyArIHJlc3BvbnNlLldpa2lQYWdlLklkOw0KCQkJCQkJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLnB1dCh7DQoJCQkJCQkJdXJsOiAkLnRlbGxpZ2VudC5ldm9sdXRpb24uc2l0ZS5nZXRCYXNlVXJsKCkgKyAnYXBpLmFzaHgvdjIvd2lraXMve3dpa2lpZH0vcGFnZXMve3dpa2lwYWdlaWR9L3N1YnNjcmlwdGlvbnMuanNvbicsDQoJCQkJCQkJZGF0YTogew0KCQkJCQkJCQl3aWtpaWQ6IHJlc3BvbnNlLldpa2lQYWdlLldpa2lJZCwNCgkJCQkJCQkJd2lraXBhZ2VpZDogcmVzcG9uc2UuV2lraVBhZ2UuSWQsDQoJCQkJCQkJCUlzU3Vic2NyaWJlZDogc3Vic2NyaWJlDQoJCQkJCQkJfQ0KCQkJCQkJfSkuZG9uZShmdW5jdGlvbigpIHsNCgkJCQkJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLmxvYWQobGluaywgeyByZWZyZXNoOiB0cnVlIH0pOw0KCQkJCQkJfSk7DQoJCQkJCX0pOw0KCQkJCX0NCgkJCX0pOw0KDQoJCQkkLnRlbGxpZ2VudC5ldm9sdXRpb24ubW9iaWxlLnNldEhlYWRlckJ1dHRvbihwb3N0TGluayk7DQoNCgkJCWJpbmRFbGVtZW50cyhvcHRpb25zKTsNCgkJfQ0KCX0NCg0KCSQudGVsbGlnZW50ID0gJC50ZWxsaWdlbnQgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uIHx8IHt9Ow0KCSQudGVsbGlnZW50LmV2b2x1dGlvbi53aWRnZXRzID0gJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMgfHwge307DQoJJC50ZWxsaWdlbnQuZXZvbHV0aW9uLndpZGdldHMud2lraVBhZ2VBZGRFZGl0ID0gYXBpOw0KDQp9KShqUXVlcnksIHdpbmRvdyk7</file>
    </files>
  </scriptedContentFragment>
</scriptedContentFragments>